var m0=t=>{throw TypeError(t)};var wh=(t,e,n)=>e.has(t)||m0("Cannot "+n);var N=(t,e,n)=>(wh(t,e,"read from private field"),n?n.call(t):e.get(t)),he=(t,e,n)=>e.has(t)?m0("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(t):e.set(t,n),te=(t,e,n,r)=>(wh(t,e,"write to private field"),r?r.call(t,n):e.set(t,n),n),Se=(t,e,n)=>(wh(t,e,"access private method"),n);var uc=(t,e,n,r)=>({set _(o){te(t,e,o,n)},get _(){return N(t,e,r)}});import{c as De}from"./ui-DW48STyt.js";function NR(t,e){for(var n=0;n<e.length;n++){const r=e[n];if(typeof r!="string"&&!Array.isArray(r)){for(const o in r)if(o!=="default"&&!(o in t)){const i=Object.getOwnPropertyDescriptor(r,o);i&&Object.defineProperty(t,o,i.get?i:{enumerable:!0,get:()=>r[o]})}}}return Object.freeze(Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}))}var Yn=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Xx(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}function OR(t){if(t.__esModule)return t;var e=t.default;if(typeof e=="function"){var n=function r(){return this instanceof r?Reflect.construct(e,arguments,this.constructor):e.apply(this,arguments)};n.prototype=e.prototype}else n={};return Object.defineProperty(n,"__esModule",{value:!0}),Object.keys(t).forEach(function(r){var o=Object.getOwnPropertyDescriptor(t,r);Object.defineProperty(n,r,o.get?o:{enumerable:!0,get:function(){return t[r]}})}),n}var Yx={exports:{}},bf={},Qx={exports:{}},Ie={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Ll=Symbol.for("react.element"),FR=Symbol.for("react.portal"),MR=Symbol.for("react.fragment"),LR=Symbol.for("react.strict_mode"),BR=Symbol.for("react.profiler"),$R=Symbol.for("react.provider"),jR=Symbol.for("react.context"),WR=Symbol.for("react.forward_ref"),UR=Symbol.for("react.suspense"),zR=Symbol.for("react.memo"),VR=Symbol.for("react.lazy"),g0=Symbol.iterator;function HR(t){return t===null||typeof t!="object"?null:(t=g0&&t[g0]||t["@@iterator"],typeof t=="function"?t:null)}var Jx={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},Zx=Object.assign,eb={};function au(t,e,n){this.props=t,this.context=e,this.refs=eb,this.updater=n||Jx}au.prototype.isReactComponent={};au.prototype.setState=function(t,e){if(typeof t!="object"&&typeof t!="function"&&t!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,t,e,"setState")};au.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")};function tb(){}tb.prototype=au.prototype;function Wm(t,e,n){this.props=t,this.context=e,this.refs=eb,this.updater=n||Jx}var Um=Wm.prototype=new tb;Um.constructor=Wm;Zx(Um,au.prototype);Um.isPureReactComponent=!0;var y0=Array.isArray,nb=Object.prototype.hasOwnProperty,zm={current:null},rb={key:!0,ref:!0,__self:!0,__source:!0};function ob(t,e,n){var r,o={},i=null,a=null;if(e!=null)for(r in e.ref!==void 0&&(a=e.ref),e.key!==void 0&&(i=""+e.key),e)nb.call(e,r)&&!rb.hasOwnProperty(r)&&(o[r]=e[r]);var s=arguments.length-2;if(s===1)o.children=n;else if(1<s){for(var u=Array(s),l=0;l<s;l++)u[l]=arguments[l+2];o.children=u}if(t&&t.defaultProps)for(r in s=t.defaultProps,s)o[r]===void 0&&(o[r]=s[r]);return{$$typeof:Ll,type:t,key:i,ref:a,props:o,_owner:zm.current}}function GR(t,e){return{$$typeof:Ll,type:t.type,key:e,ref:t.ref,props:t.props,_owner:t._owner}}function Vm(t){return typeof t=="object"&&t!==null&&t.$$typeof===Ll}function qR(t){var e={"=":"=0",":":"=2"};return"$"+t.replace(/[=:]/g,function(n){return e[n]})}var w0=/\/+/g;function xh(t,e){return typeof t=="object"&&t!==null&&t.key!=null?qR(""+t.key):e.toString(36)}function Zc(t,e,n,r,o){var i=typeof t;(i==="undefined"||i==="boolean")&&(t=null);var a=!1;if(t===null)a=!0;else switch(i){case"string":case"number":a=!0;break;case"object":switch(t.$$typeof){case Ll:case FR:a=!0}}if(a)return a=t,o=o(a),t=r===""?"."+xh(a,0):r,y0(o)?(n="",t!=null&&(n=t.replace(w0,"$&/")+"/"),Zc(o,e,n,"",function(l){return l})):o!=null&&(Vm(o)&&(o=GR(o,n+(!o.key||a&&a.key===o.key?"":(""+o.key).replace(w0,"$&/")+"/")+t)),e.push(o)),1;if(a=0,r=r===""?".":r+":",y0(t))for(var s=0;s<t.length;s++){i=t[s];var u=r+xh(i,s);a+=Zc(i,e,n,u,o)}else if(u=HR(t),typeof u=="function")for(t=u.call(t),s=0;!(i=t.next()).done;)i=i.value,u=r+xh(i,s++),a+=Zc(i,e,n,u,o);else if(i==="object")throw e=String(t),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return a}function lc(t,e,n){if(t==null)return t;var r=[],o=0;return Zc(t,r,"","",function(i){return e.call(n,i,o++)}),r}function KR(t){if(t._status===-1){var e=t._result;e=e(),e.then(function(n){(t._status===0||t._status===-1)&&(t._status=1,t._result=n)},function(n){(t._status===0||t._status===-1)&&(t._status=2,t._result=n)}),t._status===-1&&(t._status=0,t._result=e)}if(t._status===1)return t._result.default;throw t._result}var sn={current:null},ed={transition:null},XR={ReactCurrentDispatcher:sn,ReactCurrentBatchConfig:ed,ReactCurrentOwner:zm};function ib(){throw Error("act(...) is not supported in production builds of React.")}Ie.Children={map:lc,forEach:function(t,e,n){lc(t,function(){e.apply(this,arguments)},n)},count:function(t){var e=0;return lc(t,function(){e++}),e},toArray:function(t){return lc(t,function(e){return e})||[]},only:function(t){if(!Vm(t))throw Error("React.Children.only expected to receive a single React element child.");return t}};Ie.Component=au;Ie.Fragment=MR;Ie.Profiler=BR;Ie.PureComponent=Wm;Ie.StrictMode=LR;Ie.Suspense=UR;Ie.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=XR;Ie.act=ib;Ie.cloneElement=function(t,e,n){if(t==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+t+".");var r=Zx({},t.props),o=t.key,i=t.ref,a=t._owner;if(e!=null){if(e.ref!==void 0&&(i=e.ref,a=zm.current),e.key!==void 0&&(o=""+e.key),t.type&&t.type.defaultProps)var s=t.type.defaultProps;for(u in e)nb.call(e,u)&&!rb.hasOwnProperty(u)&&(r[u]=e[u]===void 0&&s!==void 0?s[u]:e[u])}var u=arguments.length-2;if(u===1)r.children=n;else if(1<u){s=Array(u);for(var l=0;l<u;l++)s[l]=arguments[l+2];r.children=s}return{$$typeof:Ll,type:t.type,key:o,ref:i,props:r,_owner:a}};Ie.createContext=function(t){return t={$$typeof:jR,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},t.Provider={$$typeof:$R,_context:t},t.Consumer=t};Ie.createElement=ob;Ie.createFactory=function(t){var e=ob.bind(null,t);return e.type=t,e};Ie.createRef=function(){return{current:null}};Ie.forwardRef=function(t){return{$$typeof:WR,render:t}};Ie.isValidElement=Vm;Ie.lazy=function(t){return{$$typeof:VR,_payload:{_status:-1,_result:t},_init:KR}};Ie.memo=function(t,e){return{$$typeof:zR,type:t,compare:e===void 0?null:e}};Ie.startTransition=function(t){var e=ed.transition;ed.transition={};try{t()}finally{ed.transition=e}};Ie.unstable_act=ib;Ie.useCallback=function(t,e){return sn.current.useCallback(t,e)};Ie.useContext=function(t){return sn.current.useContext(t)};Ie.useDebugValue=function(){};Ie.useDeferredValue=function(t){return sn.current.useDeferredValue(t)};Ie.useEffect=function(t,e){return sn.current.useEffect(t,e)};Ie.useId=function(){return sn.current.useId()};Ie.useImperativeHandle=function(t,e,n){return sn.current.useImperativeHandle(t,e,n)};Ie.useInsertionEffect=function(t,e){return sn.current.useInsertionEffect(t,e)};Ie.useLayoutEffect=function(t,e){return sn.current.useLayoutEffect(t,e)};Ie.useMemo=function(t,e){return sn.current.useMemo(t,e)};Ie.useReducer=function(t,e,n){return sn.current.useReducer(t,e,n)};Ie.useRef=function(t){return sn.current.useRef(t)};Ie.useState=function(t){return sn.current.useState(t)};Ie.useSyncExternalStore=function(t,e,n){return sn.current.useSyncExternalStore(t,e,n)};Ie.useTransition=function(){return sn.current.useTransition()};Ie.version="18.3.1";Qx.exports=Ie;var k=Qx.exports;const J=Xx(k),Hm=NR({__proto__:null,default:J},[k]);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var YR=k,QR=Symbol.for("react.element"),JR=Symbol.for("react.fragment"),ZR=Object.prototype.hasOwnProperty,eT=YR.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,tT={key:!0,ref:!0,__self:!0,__source:!0};function ab(t,e,n){var r,o={},i=null,a=null;n!==void 0&&(i=""+n),e.key!==void 0&&(i=""+e.key),e.ref!==void 0&&(a=e.ref);for(r in e)ZR.call(e,r)&&!tT.hasOwnProperty(r)&&(o[r]=e[r]);if(t&&t.defaultProps)for(r in e=t.defaultProps,e)o[r]===void 0&&(o[r]=e[r]);return{$$typeof:QR,type:t,key:i,ref:a,props:o,_owner:eT.current}}bf.Fragment=JR;bf.jsx=ab;bf.jsxs=ab;Yx.exports=bf;var G=Yx.exports,sb={exports:{}},Ln={},ub={exports:{}},lb={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(t){function e(D,F){var $=D.length;D.push(F);e:for(;0<$;){var q=$-1>>>1,K=D[q];if(0<o(K,F))D[q]=F,D[$]=K,$=q;else break e}}function n(D){return D.length===0?null:D[0]}function r(D){if(D.length===0)return null;var F=D[0],$=D.pop();if($!==F){D[0]=$;e:for(var q=0,K=D.length,Q=K>>>1;q<Q;){var Z=2*(q+1)-1,ue=D[Z],fe=Z+1,oe=D[fe];if(0>o(ue,$))fe<K&&0>o(oe,ue)?(D[q]=oe,D[fe]=$,q=fe):(D[q]=ue,D[Z]=$,q=Z);else if(fe<K&&0>o(oe,$))D[q]=oe,D[fe]=$,q=fe;else break e}}return F}function o(D,F){var $=D.sortIndex-F.sortIndex;return $!==0?$:D.id-F.id}if(typeof performance=="object"&&typeof performance.now=="function"){var i=performance;t.unstable_now=function(){return i.now()}}else{var a=Date,s=a.now();t.unstable_now=function(){return a.now()-s}}var u=[],l=[],c=1,d=null,f=3,h=!1,v=!1,p=!1,m=typeof setTimeout=="function"?setTimeout:null,g=typeof clearTimeout=="function"?clearTimeout:null,y=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function w(D){for(var F=n(l);F!==null;){if(F.callback===null)r(l);else if(F.startTime<=D)r(l),F.sortIndex=F.expirationTime,e(u,F);else break;F=n(l)}}function x(D){if(p=!1,w(D),!v)if(n(u)!==null)v=!0,W(b);else{var F=n(l);F!==null&&U(x,F.startTime-D)}}function b(D,F){v=!1,p&&(p=!1,g(C),C=-1),h=!0;var $=f;try{for(w(F),d=n(u);d!==null&&(!(d.expirationTime>F)||D&&!P());){var q=d.callback;if(typeof q=="function"){d.callback=null,f=d.priorityLevel;var K=q(d.expirationTime<=F);F=t.unstable_now(),typeof K=="function"?d.callback=K:d===n(u)&&r(u),w(F)}else r(u);d=n(u)}if(d!==null)var Q=!0;else{var Z=n(l);Z!==null&&U(x,Z.startTime-F),Q=!1}return Q}finally{d=null,f=$,h=!1}}var _=!1,E=null,C=-1,R=5,S=-1;function P(){return!(t.unstable_now()-S<R)}function A(){if(E!==null){var D=t.unstable_now();S=D;var F=!0;try{F=E(!0,D)}finally{F?B():(_=!1,E=null)}}else _=!1}var B;if(typeof y=="function")B=function(){y(A)};else if(typeof MessageChannel<"u"){var M=new MessageChannel,j=M.port2;M.port1.onmessage=A,B=function(){j.postMessage(null)}}else B=function(){m(A,0)};function W(D){E=D,_||(_=!0,B())}function U(D,F){C=m(function(){D(t.unstable_now())},F)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(D){D.callback=null},t.unstable_continueExecution=function(){v||h||(v=!0,W(b))},t.unstable_forceFrameRate=function(D){0>D||125<D?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):R=0<D?Math.floor(1e3/D):5},t.unstable_getCurrentPriorityLevel=function(){return f},t.unstable_getFirstCallbackNode=function(){return n(u)},t.unstable_next=function(D){switch(f){case 1:case 2:case 3:var F=3;break;default:F=f}var $=f;f=F;try{return D()}finally{f=$}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(D,F){switch(D){case 1:case 2:case 3:case 4:case 5:break;default:D=3}var $=f;f=D;try{return F()}finally{f=$}},t.unstable_scheduleCallback=function(D,F,$){var q=t.unstable_now();switch(typeof $=="object"&&$!==null?($=$.delay,$=typeof $=="number"&&0<$?q+$:q):$=q,D){case 1:var K=-1;break;case 2:K=250;break;case 5:K=1073741823;break;case 4:K=1e4;break;default:K=5e3}return K=$+K,D={id:c++,callback:F,priorityLevel:D,startTime:$,expirationTime:K,sortIndex:-1},$>q?(D.sortIndex=$,e(l,D),n(u)===null&&D===n(l)&&(p?(g(C),C=-1):p=!0,U(x,$-q))):(D.sortIndex=K,e(u,D),v||h||(v=!0,W(b))),D},t.unstable_shouldYield=P,t.unstable_wrapCallback=function(D){var F=f;return function(){var $=f;f=F;try{return D.apply(this,arguments)}finally{f=$}}}})(lb);ub.exports=lb;var nT=ub.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var rT=k,Mn=nT;function Y(t){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+t,n=1;n<arguments.length;n++)e+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var cb=new Set,nl={};function ka(t,e){Gs(t,e),Gs(t+"Capture",e)}function Gs(t,e){for(nl[t]=e,t=0;t<e.length;t++)cb.add(e[t])}var yo=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Wp=Object.prototype.hasOwnProperty,oT=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,x0={},b0={};function iT(t){return Wp.call(b0,t)?!0:Wp.call(x0,t)?!1:oT.test(t)?b0[t]=!0:(x0[t]=!0,!1)}function aT(t,e,n,r){if(n!==null&&n.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return r?!1:n!==null?!n.acceptsBooleans:(t=t.toLowerCase().slice(0,5),t!=="data-"&&t!=="aria-");default:return!1}}function sT(t,e,n,r){if(e===null||typeof e>"u"||aT(t,e,n,r))return!0;if(r)return!1;if(n!==null)switch(n.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function un(t,e,n,r,o,i,a){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=r,this.attributeNamespace=o,this.mustUseProperty=n,this.propertyName=t,this.type=e,this.sanitizeURL=i,this.removeEmptyString=a}var $t={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(t){$t[t]=new un(t,0,!1,t,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(t){var e=t[0];$t[e]=new un(e,1,!1,t[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(t){$t[t]=new un(t,2,!1,t.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(t){$t[t]=new un(t,2,!1,t,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(t){$t[t]=new un(t,3,!1,t.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(t){$t[t]=new un(t,3,!0,t,null,!1,!1)});["capture","download"].forEach(function(t){$t[t]=new un(t,4,!1,t,null,!1,!1)});["cols","rows","size","span"].forEach(function(t){$t[t]=new un(t,6,!1,t,null,!1,!1)});["rowSpan","start"].forEach(function(t){$t[t]=new un(t,5,!1,t.toLowerCase(),null,!1,!1)});var Gm=/[\-:]([a-z])/g;function qm(t){return t[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(t){var e=t.replace(Gm,qm);$t[e]=new un(e,1,!1,t,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(t){var e=t.replace(Gm,qm);$t[e]=new un(e,1,!1,t,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(t){var e=t.replace(Gm,qm);$t[e]=new un(e,1,!1,t,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(t){$t[t]=new un(t,1,!1,t.toLowerCase(),null,!1,!1)});$t.xlinkHref=new un("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(t){$t[t]=new un(t,1,!1,t.toLowerCase(),null,!0,!0)});function Km(t,e,n,r){var o=$t.hasOwnProperty(e)?$t[e]:null;(o!==null?o.type!==0:r||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(sT(e,n,o,r)&&(n=null),r||o===null?iT(e)&&(n===null?t.removeAttribute(e):t.setAttribute(e,""+n)):o.mustUseProperty?t[o.propertyName]=n===null?o.type===3?!1:"":n:(e=o.attributeName,r=o.attributeNamespace,n===null?t.removeAttribute(e):(o=o.type,n=o===3||o===4&&n===!0?"":""+n,r?t.setAttributeNS(r,e,n):t.setAttribute(e,n))))}var So=rT.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,cc=Symbol.for("react.element"),os=Symbol.for("react.portal"),is=Symbol.for("react.fragment"),Xm=Symbol.for("react.strict_mode"),Up=Symbol.for("react.profiler"),db=Symbol.for("react.provider"),fb=Symbol.for("react.context"),Ym=Symbol.for("react.forward_ref"),zp=Symbol.for("react.suspense"),Vp=Symbol.for("react.suspense_list"),Qm=Symbol.for("react.memo"),Go=Symbol.for("react.lazy"),hb=Symbol.for("react.offscreen"),_0=Symbol.iterator;function wu(t){return t===null||typeof t!="object"?null:(t=_0&&t[_0]||t["@@iterator"],typeof t=="function"?t:null)}var it=Object.assign,bh;function Ou(t){if(bh===void 0)try{throw Error()}catch(n){var e=n.stack.trim().match(/\n( *(at )?)/);bh=e&&e[1]||""}return`
`+bh+t}var _h=!1;function Eh(t,e){if(!t||_h)return"";_h=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(l){var r=l}Reflect.construct(t,[],e)}else{try{e.call()}catch(l){r=l}t.call(e.prototype)}else{try{throw Error()}catch(l){r=l}t()}}catch(l){if(l&&r&&typeof l.stack=="string"){for(var o=l.stack.split(`
`),i=r.stack.split(`
`),a=o.length-1,s=i.length-1;1<=a&&0<=s&&o[a]!==i[s];)s--;for(;1<=a&&0<=s;a--,s--)if(o[a]!==i[s]){if(a!==1||s!==1)do if(a--,s--,0>s||o[a]!==i[s]){var u=`
`+o[a].replace(" at new "," at ");return t.displayName&&u.includes("<anonymous>")&&(u=u.replace("<anonymous>",t.displayName)),u}while(1<=a&&0<=s);break}}}finally{_h=!1,Error.prepareStackTrace=n}return(t=t?t.displayName||t.name:"")?Ou(t):""}function uT(t){switch(t.tag){case 5:return Ou(t.type);case 16:return Ou("Lazy");case 13:return Ou("Suspense");case 19:return Ou("SuspenseList");case 0:case 2:case 15:return t=Eh(t.type,!1),t;case 11:return t=Eh(t.type.render,!1),t;case 1:return t=Eh(t.type,!0),t;default:return""}}function Hp(t){if(t==null)return null;if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case is:return"Fragment";case os:return"Portal";case Up:return"Profiler";case Xm:return"StrictMode";case zp:return"Suspense";case Vp:return"SuspenseList"}if(typeof t=="object")switch(t.$$typeof){case fb:return(t.displayName||"Context")+".Consumer";case db:return(t._context.displayName||"Context")+".Provider";case Ym:var e=t.render;return t=t.displayName,t||(t=e.displayName||e.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case Qm:return e=t.displayName||null,e!==null?e:Hp(t.type)||"Memo";case Go:e=t._payload,t=t._init;try{return Hp(t(e))}catch{}}return null}function lT(t){var e=t.type;switch(t.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return t=e.render,t=t.displayName||t.name||"",e.displayName||(t!==""?"ForwardRef("+t+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Hp(e);case 8:return e===Xm?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function Si(t){switch(typeof t){case"boolean":case"number":case"string":case"undefined":return t;case"object":return t;default:return""}}function pb(t){var e=t.type;return(t=t.nodeName)&&t.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function cT(t){var e=pb(t)?"checked":"value",n=Object.getOwnPropertyDescriptor(t.constructor.prototype,e),r=""+t[e];if(!t.hasOwnProperty(e)&&typeof n<"u"&&typeof n.get=="function"&&typeof n.set=="function"){var o=n.get,i=n.set;return Object.defineProperty(t,e,{configurable:!0,get:function(){return o.call(this)},set:function(a){r=""+a,i.call(this,a)}}),Object.defineProperty(t,e,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(a){r=""+a},stopTracking:function(){t._valueTracker=null,delete t[e]}}}}function dc(t){t._valueTracker||(t._valueTracker=cT(t))}function vb(t){if(!t)return!1;var e=t._valueTracker;if(!e)return!0;var n=e.getValue(),r="";return t&&(r=pb(t)?t.checked?"true":"false":t.value),t=r,t!==n?(e.setValue(t),!0):!1}function md(t){if(t=t||(typeof document<"u"?document:void 0),typeof t>"u")return null;try{return t.activeElement||t.body}catch{return t.body}}function Gp(t,e){var n=e.checked;return it({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:n??t._wrapperState.initialChecked})}function E0(t,e){var n=e.defaultValue==null?"":e.defaultValue,r=e.checked!=null?e.checked:e.defaultChecked;n=Si(e.value!=null?e.value:n),t._wrapperState={initialChecked:r,initialValue:n,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function mb(t,e){e=e.checked,e!=null&&Km(t,"checked",e,!1)}function qp(t,e){mb(t,e);var n=Si(e.value),r=e.type;if(n!=null)r==="number"?(n===0&&t.value===""||t.value!=n)&&(t.value=""+n):t.value!==""+n&&(t.value=""+n);else if(r==="submit"||r==="reset"){t.removeAttribute("value");return}e.hasOwnProperty("value")?Kp(t,e.type,n):e.hasOwnProperty("defaultValue")&&Kp(t,e.type,Si(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(t.defaultChecked=!!e.defaultChecked)}function C0(t,e,n){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var r=e.type;if(!(r!=="submit"&&r!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+t._wrapperState.initialValue,n||e===t.value||(t.value=e),t.defaultValue=e}n=t.name,n!==""&&(t.name=""),t.defaultChecked=!!t._wrapperState.initialChecked,n!==""&&(t.name=n)}function Kp(t,e,n){(e!=="number"||md(t.ownerDocument)!==t)&&(n==null?t.defaultValue=""+t._wrapperState.initialValue:t.defaultValue!==""+n&&(t.defaultValue=""+n))}var Fu=Array.isArray;function ms(t,e,n,r){if(t=t.options,e){e={};for(var o=0;o<n.length;o++)e["$"+n[o]]=!0;for(n=0;n<t.length;n++)o=e.hasOwnProperty("$"+t[n].value),t[n].selected!==o&&(t[n].selected=o),o&&r&&(t[n].defaultSelected=!0)}else{for(n=""+Si(n),e=null,o=0;o<t.length;o++){if(t[o].value===n){t[o].selected=!0,r&&(t[o].defaultSelected=!0);return}e!==null||t[o].disabled||(e=t[o])}e!==null&&(e.selected=!0)}}function Xp(t,e){if(e.dangerouslySetInnerHTML!=null)throw Error(Y(91));return it({},e,{value:void 0,defaultValue:void 0,children:""+t._wrapperState.initialValue})}function S0(t,e){var n=e.value;if(n==null){if(n=e.children,e=e.defaultValue,n!=null){if(e!=null)throw Error(Y(92));if(Fu(n)){if(1<n.length)throw Error(Y(93));n=n[0]}e=n}e==null&&(e=""),n=e}t._wrapperState={initialValue:Si(n)}}function gb(t,e){var n=Si(e.value),r=Si(e.defaultValue);n!=null&&(n=""+n,n!==t.value&&(t.value=n),e.defaultValue==null&&t.defaultValue!==n&&(t.defaultValue=n)),r!=null&&(t.defaultValue=""+r)}function k0(t){var e=t.textContent;e===t._wrapperState.initialValue&&e!==""&&e!==null&&(t.value=e)}function yb(t){switch(t){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Yp(t,e){return t==null||t==="http://www.w3.org/1999/xhtml"?yb(e):t==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":t}var fc,wb=function(t){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,n,r,o){MSApp.execUnsafeLocalFunction(function(){return t(e,n,r,o)})}:t}(function(t,e){if(t.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in t)t.innerHTML=e;else{for(fc=fc||document.createElement("div"),fc.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=fc.firstChild;t.firstChild;)t.removeChild(t.firstChild);for(;e.firstChild;)t.appendChild(e.firstChild)}});function rl(t,e){if(e){var n=t.firstChild;if(n&&n===t.lastChild&&n.nodeType===3){n.nodeValue=e;return}}t.textContent=e}var ju={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},dT=["Webkit","ms","Moz","O"];Object.keys(ju).forEach(function(t){dT.forEach(function(e){e=e+t.charAt(0).toUpperCase()+t.substring(1),ju[e]=ju[t]})});function xb(t,e,n){return e==null||typeof e=="boolean"||e===""?"":n||typeof e!="number"||e===0||ju.hasOwnProperty(t)&&ju[t]?(""+e).trim():e+"px"}function bb(t,e){t=t.style;for(var n in e)if(e.hasOwnProperty(n)){var r=n.indexOf("--")===0,o=xb(n,e[n],r);n==="float"&&(n="cssFloat"),r?t.setProperty(n,o):t[n]=o}}var fT=it({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Qp(t,e){if(e){if(fT[t]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(Y(137,t));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(Y(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(Y(61))}if(e.style!=null&&typeof e.style!="object")throw Error(Y(62))}}function Jp(t,e){if(t.indexOf("-")===-1)return typeof e.is=="string";switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Zp=null;function Jm(t){return t=t.target||t.srcElement||window,t.correspondingUseElement&&(t=t.correspondingUseElement),t.nodeType===3?t.parentNode:t}var ev=null,gs=null,ys=null;function R0(t){if(t=jl(t)){if(typeof ev!="function")throw Error(Y(280));var e=t.stateNode;e&&(e=kf(e),ev(t.stateNode,t.type,e))}}function _b(t){gs?ys?ys.push(t):ys=[t]:gs=t}function Eb(){if(gs){var t=gs,e=ys;if(ys=gs=null,R0(t),e)for(t=0;t<e.length;t++)R0(e[t])}}function Cb(t,e){return t(e)}function Sb(){}var Ch=!1;function kb(t,e,n){if(Ch)return t(e,n);Ch=!0;try{return Cb(t,e,n)}finally{Ch=!1,(gs!==null||ys!==null)&&(Sb(),Eb())}}function ol(t,e){var n=t.stateNode;if(n===null)return null;var r=kf(n);if(r===null)return null;n=r[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(t=t.type,r=!(t==="button"||t==="input"||t==="select"||t==="textarea")),t=!r;break e;default:t=!1}if(t)return null;if(n&&typeof n!="function")throw Error(Y(231,e,typeof n));return n}var tv=!1;if(yo)try{var xu={};Object.defineProperty(xu,"passive",{get:function(){tv=!0}}),window.addEventListener("test",xu,xu),window.removeEventListener("test",xu,xu)}catch{tv=!1}function hT(t,e,n,r,o,i,a,s,u){var l=Array.prototype.slice.call(arguments,3);try{e.apply(n,l)}catch(c){this.onError(c)}}var Wu=!1,gd=null,yd=!1,nv=null,pT={onError:function(t){Wu=!0,gd=t}};function vT(t,e,n,r,o,i,a,s,u){Wu=!1,gd=null,hT.apply(pT,arguments)}function mT(t,e,n,r,o,i,a,s,u){if(vT.apply(this,arguments),Wu){if(Wu){var l=gd;Wu=!1,gd=null}else throw Error(Y(198));yd||(yd=!0,nv=l)}}function Ra(t){var e=t,n=t;if(t.alternate)for(;e.return;)e=e.return;else{t=e;do e=t,e.flags&4098&&(n=e.return),t=e.return;while(t)}return e.tag===3?n:null}function Rb(t){if(t.tag===13){var e=t.memoizedState;if(e===null&&(t=t.alternate,t!==null&&(e=t.memoizedState)),e!==null)return e.dehydrated}return null}function T0(t){if(Ra(t)!==t)throw Error(Y(188))}function gT(t){var e=t.alternate;if(!e){if(e=Ra(t),e===null)throw Error(Y(188));return e!==t?null:t}for(var n=t,r=e;;){var o=n.return;if(o===null)break;var i=o.alternate;if(i===null){if(r=o.return,r!==null){n=r;continue}break}if(o.child===i.child){for(i=o.child;i;){if(i===n)return T0(o),t;if(i===r)return T0(o),e;i=i.sibling}throw Error(Y(188))}if(n.return!==r.return)n=o,r=i;else{for(var a=!1,s=o.child;s;){if(s===n){a=!0,n=o,r=i;break}if(s===r){a=!0,r=o,n=i;break}s=s.sibling}if(!a){for(s=i.child;s;){if(s===n){a=!0,n=i,r=o;break}if(s===r){a=!0,r=i,n=o;break}s=s.sibling}if(!a)throw Error(Y(189))}}if(n.alternate!==r)throw Error(Y(190))}if(n.tag!==3)throw Error(Y(188));return n.stateNode.current===n?t:e}function Tb(t){return t=gT(t),t!==null?Ib(t):null}function Ib(t){if(t.tag===5||t.tag===6)return t;for(t=t.child;t!==null;){var e=Ib(t);if(e!==null)return e;t=t.sibling}return null}var Ab=Mn.unstable_scheduleCallback,I0=Mn.unstable_cancelCallback,yT=Mn.unstable_shouldYield,wT=Mn.unstable_requestPaint,ct=Mn.unstable_now,xT=Mn.unstable_getCurrentPriorityLevel,Zm=Mn.unstable_ImmediatePriority,Pb=Mn.unstable_UserBlockingPriority,wd=Mn.unstable_NormalPriority,bT=Mn.unstable_LowPriority,Db=Mn.unstable_IdlePriority,_f=null,Ur=null;function _T(t){if(Ur&&typeof Ur.onCommitFiberRoot=="function")try{Ur.onCommitFiberRoot(_f,t,void 0,(t.current.flags&128)===128)}catch{}}var mr=Math.clz32?Math.clz32:ST,ET=Math.log,CT=Math.LN2;function ST(t){return t>>>=0,t===0?32:31-(ET(t)/CT|0)|0}var hc=64,pc=4194304;function Mu(t){switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return t&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return t}}function xd(t,e){var n=t.pendingLanes;if(n===0)return 0;var r=0,o=t.suspendedLanes,i=t.pingedLanes,a=n&268435455;if(a!==0){var s=a&~o;s!==0?r=Mu(s):(i&=a,i!==0&&(r=Mu(i)))}else a=n&~o,a!==0?r=Mu(a):i!==0&&(r=Mu(i));if(r===0)return 0;if(e!==0&&e!==r&&!(e&o)&&(o=r&-r,i=e&-e,o>=i||o===16&&(i&4194240)!==0))return e;if(r&4&&(r|=n&16),e=t.entangledLanes,e!==0)for(t=t.entanglements,e&=r;0<e;)n=31-mr(e),o=1<<n,r|=t[n],e&=~o;return r}function kT(t,e){switch(t){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function RT(t,e){for(var n=t.suspendedLanes,r=t.pingedLanes,o=t.expirationTimes,i=t.pendingLanes;0<i;){var a=31-mr(i),s=1<<a,u=o[a];u===-1?(!(s&n)||s&r)&&(o[a]=kT(s,e)):u<=e&&(t.expiredLanes|=s),i&=~s}}function rv(t){return t=t.pendingLanes&-1073741825,t!==0?t:t&1073741824?1073741824:0}function Nb(){var t=hc;return hc<<=1,!(hc&4194240)&&(hc=64),t}function Sh(t){for(var e=[],n=0;31>n;n++)e.push(t);return e}function Bl(t,e,n){t.pendingLanes|=e,e!==536870912&&(t.suspendedLanes=0,t.pingedLanes=0),t=t.eventTimes,e=31-mr(e),t[e]=n}function TT(t,e){var n=t.pendingLanes&~e;t.pendingLanes=e,t.suspendedLanes=0,t.pingedLanes=0,t.expiredLanes&=e,t.mutableReadLanes&=e,t.entangledLanes&=e,e=t.entanglements;var r=t.eventTimes;for(t=t.expirationTimes;0<n;){var o=31-mr(n),i=1<<o;e[o]=0,r[o]=-1,t[o]=-1,n&=~i}}function eg(t,e){var n=t.entangledLanes|=e;for(t=t.entanglements;n;){var r=31-mr(n),o=1<<r;o&e|t[r]&e&&(t[r]|=e),n&=~o}}var $e=0;function Ob(t){return t&=-t,1<t?4<t?t&268435455?16:536870912:4:1}var Fb,tg,Mb,Lb,Bb,ov=!1,vc=[],fi=null,hi=null,pi=null,il=new Map,al=new Map,Ko=[],IT="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function A0(t,e){switch(t){case"focusin":case"focusout":fi=null;break;case"dragenter":case"dragleave":hi=null;break;case"mouseover":case"mouseout":pi=null;break;case"pointerover":case"pointerout":il.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":al.delete(e.pointerId)}}function bu(t,e,n,r,o,i){return t===null||t.nativeEvent!==i?(t={blockedOn:e,domEventName:n,eventSystemFlags:r,nativeEvent:i,targetContainers:[o]},e!==null&&(e=jl(e),e!==null&&tg(e)),t):(t.eventSystemFlags|=r,e=t.targetContainers,o!==null&&e.indexOf(o)===-1&&e.push(o),t)}function AT(t,e,n,r,o){switch(e){case"focusin":return fi=bu(fi,t,e,n,r,o),!0;case"dragenter":return hi=bu(hi,t,e,n,r,o),!0;case"mouseover":return pi=bu(pi,t,e,n,r,o),!0;case"pointerover":var i=o.pointerId;return il.set(i,bu(il.get(i)||null,t,e,n,r,o)),!0;case"gotpointercapture":return i=o.pointerId,al.set(i,bu(al.get(i)||null,t,e,n,r,o)),!0}return!1}function $b(t){var e=Ji(t.target);if(e!==null){var n=Ra(e);if(n!==null){if(e=n.tag,e===13){if(e=Rb(n),e!==null){t.blockedOn=e,Bb(t.priority,function(){Mb(n)});return}}else if(e===3&&n.stateNode.current.memoizedState.isDehydrated){t.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}t.blockedOn=null}function td(t){if(t.blockedOn!==null)return!1;for(var e=t.targetContainers;0<e.length;){var n=iv(t.domEventName,t.eventSystemFlags,e[0],t.nativeEvent);if(n===null){n=t.nativeEvent;var r=new n.constructor(n.type,n);Zp=r,n.target.dispatchEvent(r),Zp=null}else return e=jl(n),e!==null&&tg(e),t.blockedOn=n,!1;e.shift()}return!0}function P0(t,e,n){td(t)&&n.delete(e)}function PT(){ov=!1,fi!==null&&td(fi)&&(fi=null),hi!==null&&td(hi)&&(hi=null),pi!==null&&td(pi)&&(pi=null),il.forEach(P0),al.forEach(P0)}function _u(t,e){t.blockedOn===e&&(t.blockedOn=null,ov||(ov=!0,Mn.unstable_scheduleCallback(Mn.unstable_NormalPriority,PT)))}function sl(t){function e(o){return _u(o,t)}if(0<vc.length){_u(vc[0],t);for(var n=1;n<vc.length;n++){var r=vc[n];r.blockedOn===t&&(r.blockedOn=null)}}for(fi!==null&&_u(fi,t),hi!==null&&_u(hi,t),pi!==null&&_u(pi,t),il.forEach(e),al.forEach(e),n=0;n<Ko.length;n++)r=Ko[n],r.blockedOn===t&&(r.blockedOn=null);for(;0<Ko.length&&(n=Ko[0],n.blockedOn===null);)$b(n),n.blockedOn===null&&Ko.shift()}var ws=So.ReactCurrentBatchConfig,bd=!0;function DT(t,e,n,r){var o=$e,i=ws.transition;ws.transition=null;try{$e=1,ng(t,e,n,r)}finally{$e=o,ws.transition=i}}function NT(t,e,n,r){var o=$e,i=ws.transition;ws.transition=null;try{$e=4,ng(t,e,n,r)}finally{$e=o,ws.transition=i}}function ng(t,e,n,r){if(bd){var o=iv(t,e,n,r);if(o===null)Fh(t,e,r,_d,n),A0(t,r);else if(AT(o,t,e,n,r))r.stopPropagation();else if(A0(t,r),e&4&&-1<IT.indexOf(t)){for(;o!==null;){var i=jl(o);if(i!==null&&Fb(i),i=iv(t,e,n,r),i===null&&Fh(t,e,r,_d,n),i===o)break;o=i}o!==null&&r.stopPropagation()}else Fh(t,e,r,null,n)}}var _d=null;function iv(t,e,n,r){if(_d=null,t=Jm(r),t=Ji(t),t!==null)if(e=Ra(t),e===null)t=null;else if(n=e.tag,n===13){if(t=Rb(e),t!==null)return t;t=null}else if(n===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;t=null}else e!==t&&(t=null);return _d=t,null}function jb(t){switch(t){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(xT()){case Zm:return 1;case Pb:return 4;case wd:case bT:return 16;case Db:return 536870912;default:return 16}default:return 16}}var si=null,rg=null,nd=null;function Wb(){if(nd)return nd;var t,e=rg,n=e.length,r,o="value"in si?si.value:si.textContent,i=o.length;for(t=0;t<n&&e[t]===o[t];t++);var a=n-t;for(r=1;r<=a&&e[n-r]===o[i-r];r++);return nd=o.slice(t,1<r?1-r:void 0)}function rd(t){var e=t.keyCode;return"charCode"in t?(t=t.charCode,t===0&&e===13&&(t=13)):t=e,t===10&&(t=13),32<=t||t===13?t:0}function mc(){return!0}function D0(){return!1}function Bn(t){function e(n,r,o,i,a){this._reactName=n,this._targetInst=o,this.type=r,this.nativeEvent=i,this.target=a,this.currentTarget=null;for(var s in t)t.hasOwnProperty(s)&&(n=t[s],this[s]=n?n(i):i[s]);return this.isDefaultPrevented=(i.defaultPrevented!=null?i.defaultPrevented:i.returnValue===!1)?mc:D0,this.isPropagationStopped=D0,this}return it(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n&&(n.preventDefault?n.preventDefault():typeof n.returnValue!="unknown"&&(n.returnValue=!1),this.isDefaultPrevented=mc)},stopPropagation:function(){var n=this.nativeEvent;n&&(n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!="unknown"&&(n.cancelBubble=!0),this.isPropagationStopped=mc)},persist:function(){},isPersistent:mc}),e}var su={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},og=Bn(su),$l=it({},su,{view:0,detail:0}),OT=Bn($l),kh,Rh,Eu,Ef=it({},$l,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:ig,button:0,buttons:0,relatedTarget:function(t){return t.relatedTarget===void 0?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==Eu&&(Eu&&t.type==="mousemove"?(kh=t.screenX-Eu.screenX,Rh=t.screenY-Eu.screenY):Rh=kh=0,Eu=t),kh)},movementY:function(t){return"movementY"in t?t.movementY:Rh}}),N0=Bn(Ef),FT=it({},Ef,{dataTransfer:0}),MT=Bn(FT),LT=it({},$l,{relatedTarget:0}),Th=Bn(LT),BT=it({},su,{animationName:0,elapsedTime:0,pseudoElement:0}),$T=Bn(BT),jT=it({},su,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),WT=Bn(jT),UT=it({},su,{data:0}),O0=Bn(UT),zT={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},VT={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},HT={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function GT(t){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(t):(t=HT[t])?!!e[t]:!1}function ig(){return GT}var qT=it({},$l,{key:function(t){if(t.key){var e=zT[t.key]||t.key;if(e!=="Unidentified")return e}return t.type==="keypress"?(t=rd(t),t===13?"Enter":String.fromCharCode(t)):t.type==="keydown"||t.type==="keyup"?VT[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:ig,charCode:function(t){return t.type==="keypress"?rd(t):0},keyCode:function(t){return t.type==="keydown"||t.type==="keyup"?t.keyCode:0},which:function(t){return t.type==="keypress"?rd(t):t.type==="keydown"||t.type==="keyup"?t.keyCode:0}}),KT=Bn(qT),XT=it({},Ef,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),F0=Bn(XT),YT=it({},$l,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:ig}),QT=Bn(YT),JT=it({},su,{propertyName:0,elapsedTime:0,pseudoElement:0}),ZT=Bn(JT),eI=it({},Ef,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),tI=Bn(eI),nI=[9,13,27,32],ag=yo&&"CompositionEvent"in window,Uu=null;yo&&"documentMode"in document&&(Uu=document.documentMode);var rI=yo&&"TextEvent"in window&&!Uu,Ub=yo&&(!ag||Uu&&8<Uu&&11>=Uu),M0=" ",L0=!1;function zb(t,e){switch(t){case"keyup":return nI.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Vb(t){return t=t.detail,typeof t=="object"&&"data"in t?t.data:null}var as=!1;function oI(t,e){switch(t){case"compositionend":return Vb(e);case"keypress":return e.which!==32?null:(L0=!0,M0);case"textInput":return t=e.data,t===M0&&L0?null:t;default:return null}}function iI(t,e){if(as)return t==="compositionend"||!ag&&zb(t,e)?(t=Wb(),nd=rg=si=null,as=!1,t):null;switch(t){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return Ub&&e.locale!=="ko"?null:e.data;default:return null}}var aI={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function B0(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e==="input"?!!aI[t.type]:e==="textarea"}function Hb(t,e,n,r){_b(r),e=Ed(e,"onChange"),0<e.length&&(n=new og("onChange","change",null,n,r),t.push({event:n,listeners:e}))}var zu=null,ul=null;function sI(t){n2(t,0)}function Cf(t){var e=ls(t);if(vb(e))return t}function uI(t,e){if(t==="change")return e}var Gb=!1;if(yo){var Ih;if(yo){var Ah="oninput"in document;if(!Ah){var $0=document.createElement("div");$0.setAttribute("oninput","return;"),Ah=typeof $0.oninput=="function"}Ih=Ah}else Ih=!1;Gb=Ih&&(!document.documentMode||9<document.documentMode)}function j0(){zu&&(zu.detachEvent("onpropertychange",qb),ul=zu=null)}function qb(t){if(t.propertyName==="value"&&Cf(ul)){var e=[];Hb(e,ul,t,Jm(t)),kb(sI,e)}}function lI(t,e,n){t==="focusin"?(j0(),zu=e,ul=n,zu.attachEvent("onpropertychange",qb)):t==="focusout"&&j0()}function cI(t){if(t==="selectionchange"||t==="keyup"||t==="keydown")return Cf(ul)}function dI(t,e){if(t==="click")return Cf(e)}function fI(t,e){if(t==="input"||t==="change")return Cf(e)}function hI(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var wr=typeof Object.is=="function"?Object.is:hI;function ll(t,e){if(wr(t,e))return!0;if(typeof t!="object"||t===null||typeof e!="object"||e===null)return!1;var n=Object.keys(t),r=Object.keys(e);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var o=n[r];if(!Wp.call(e,o)||!wr(t[o],e[o]))return!1}return!0}function W0(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function U0(t,e){var n=W0(t);t=0;for(var r;n;){if(n.nodeType===3){if(r=t+n.textContent.length,t<=e&&r>=e)return{node:n,offset:e-t};t=r}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=W0(n)}}function Kb(t,e){return t&&e?t===e?!0:t&&t.nodeType===3?!1:e&&e.nodeType===3?Kb(t,e.parentNode):"contains"in t?t.contains(e):t.compareDocumentPosition?!!(t.compareDocumentPosition(e)&16):!1:!1}function Xb(){for(var t=window,e=md();e instanceof t.HTMLIFrameElement;){try{var n=typeof e.contentWindow.location.href=="string"}catch{n=!1}if(n)t=e.contentWindow;else break;e=md(t.document)}return e}function sg(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e&&(e==="input"&&(t.type==="text"||t.type==="search"||t.type==="tel"||t.type==="url"||t.type==="password")||e==="textarea"||t.contentEditable==="true")}function pI(t){var e=Xb(),n=t.focusedElem,r=t.selectionRange;if(e!==n&&n&&n.ownerDocument&&Kb(n.ownerDocument.documentElement,n)){if(r!==null&&sg(n)){if(e=r.start,t=r.end,t===void 0&&(t=e),"selectionStart"in n)n.selectionStart=e,n.selectionEnd=Math.min(t,n.value.length);else if(t=(e=n.ownerDocument||document)&&e.defaultView||window,t.getSelection){t=t.getSelection();var o=n.textContent.length,i=Math.min(r.start,o);r=r.end===void 0?i:Math.min(r.end,o),!t.extend&&i>r&&(o=r,r=i,i=o),o=U0(n,i);var a=U0(n,r);o&&a&&(t.rangeCount!==1||t.anchorNode!==o.node||t.anchorOffset!==o.offset||t.focusNode!==a.node||t.focusOffset!==a.offset)&&(e=e.createRange(),e.setStart(o.node,o.offset),t.removeAllRanges(),i>r?(t.addRange(e),t.extend(a.node,a.offset)):(e.setEnd(a.node,a.offset),t.addRange(e)))}}for(e=[],t=n;t=t.parentNode;)t.nodeType===1&&e.push({element:t,left:t.scrollLeft,top:t.scrollTop});for(typeof n.focus=="function"&&n.focus(),n=0;n<e.length;n++)t=e[n],t.element.scrollLeft=t.left,t.element.scrollTop=t.top}}var vI=yo&&"documentMode"in document&&11>=document.documentMode,ss=null,av=null,Vu=null,sv=!1;function z0(t,e,n){var r=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;sv||ss==null||ss!==md(r)||(r=ss,"selectionStart"in r&&sg(r)?r={start:r.selectionStart,end:r.selectionEnd}:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection(),r={anchorNode:r.anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset}),Vu&&ll(Vu,r)||(Vu=r,r=Ed(av,"onSelect"),0<r.length&&(e=new og("onSelect","select",null,e,n),t.push({event:e,listeners:r}),e.target=ss)))}function gc(t,e){var n={};return n[t.toLowerCase()]=e.toLowerCase(),n["Webkit"+t]="webkit"+e,n["Moz"+t]="moz"+e,n}var us={animationend:gc("Animation","AnimationEnd"),animationiteration:gc("Animation","AnimationIteration"),animationstart:gc("Animation","AnimationStart"),transitionend:gc("Transition","TransitionEnd")},Ph={},Yb={};yo&&(Yb=document.createElement("div").style,"AnimationEvent"in window||(delete us.animationend.animation,delete us.animationiteration.animation,delete us.animationstart.animation),"TransitionEvent"in window||delete us.transitionend.transition);function Sf(t){if(Ph[t])return Ph[t];if(!us[t])return t;var e=us[t],n;for(n in e)if(e.hasOwnProperty(n)&&n in Yb)return Ph[t]=e[n];return t}var Qb=Sf("animationend"),Jb=Sf("animationiteration"),Zb=Sf("animationstart"),e2=Sf("transitionend"),t2=new Map,V0="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Pi(t,e){t2.set(t,e),ka(e,[t])}for(var Dh=0;Dh<V0.length;Dh++){var Nh=V0[Dh],mI=Nh.toLowerCase(),gI=Nh[0].toUpperCase()+Nh.slice(1);Pi(mI,"on"+gI)}Pi(Qb,"onAnimationEnd");Pi(Jb,"onAnimationIteration");Pi(Zb,"onAnimationStart");Pi("dblclick","onDoubleClick");Pi("focusin","onFocus");Pi("focusout","onBlur");Pi(e2,"onTransitionEnd");Gs("onMouseEnter",["mouseout","mouseover"]);Gs("onMouseLeave",["mouseout","mouseover"]);Gs("onPointerEnter",["pointerout","pointerover"]);Gs("onPointerLeave",["pointerout","pointerover"]);ka("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));ka("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));ka("onBeforeInput",["compositionend","keypress","textInput","paste"]);ka("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));ka("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));ka("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Lu="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),yI=new Set("cancel close invalid load scroll toggle".split(" ").concat(Lu));function H0(t,e,n){var r=t.type||"unknown-event";t.currentTarget=n,mT(r,e,void 0,t),t.currentTarget=null}function n2(t,e){e=(e&4)!==0;for(var n=0;n<t.length;n++){var r=t[n],o=r.event;r=r.listeners;e:{var i=void 0;if(e)for(var a=r.length-1;0<=a;a--){var s=r[a],u=s.instance,l=s.currentTarget;if(s=s.listener,u!==i&&o.isPropagationStopped())break e;H0(o,s,l),i=u}else for(a=0;a<r.length;a++){if(s=r[a],u=s.instance,l=s.currentTarget,s=s.listener,u!==i&&o.isPropagationStopped())break e;H0(o,s,l),i=u}}}if(yd)throw t=nv,yd=!1,nv=null,t}function Xe(t,e){var n=e[fv];n===void 0&&(n=e[fv]=new Set);var r=t+"__bubble";n.has(r)||(r2(e,t,2,!1),n.add(r))}function Oh(t,e,n){var r=0;e&&(r|=4),r2(n,t,r,e)}var yc="_reactListening"+Math.random().toString(36).slice(2);function cl(t){if(!t[yc]){t[yc]=!0,cb.forEach(function(n){n!=="selectionchange"&&(yI.has(n)||Oh(n,!1,t),Oh(n,!0,t))});var e=t.nodeType===9?t:t.ownerDocument;e===null||e[yc]||(e[yc]=!0,Oh("selectionchange",!1,e))}}function r2(t,e,n,r){switch(jb(e)){case 1:var o=DT;break;case 4:o=NT;break;default:o=ng}n=o.bind(null,e,n,t),o=void 0,!tv||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(o=!0),r?o!==void 0?t.addEventListener(e,n,{capture:!0,passive:o}):t.addEventListener(e,n,!0):o!==void 0?t.addEventListener(e,n,{passive:o}):t.addEventListener(e,n,!1)}function Fh(t,e,n,r,o){var i=r;if(!(e&1)&&!(e&2)&&r!==null)e:for(;;){if(r===null)return;var a=r.tag;if(a===3||a===4){var s=r.stateNode.containerInfo;if(s===o||s.nodeType===8&&s.parentNode===o)break;if(a===4)for(a=r.return;a!==null;){var u=a.tag;if((u===3||u===4)&&(u=a.stateNode.containerInfo,u===o||u.nodeType===8&&u.parentNode===o))return;a=a.return}for(;s!==null;){if(a=Ji(s),a===null)return;if(u=a.tag,u===5||u===6){r=i=a;continue e}s=s.parentNode}}r=r.return}kb(function(){var l=i,c=Jm(n),d=[];e:{var f=t2.get(t);if(f!==void 0){var h=og,v=t;switch(t){case"keypress":if(rd(n)===0)break e;case"keydown":case"keyup":h=KT;break;case"focusin":v="focus",h=Th;break;case"focusout":v="blur",h=Th;break;case"beforeblur":case"afterblur":h=Th;break;case"click":if(n.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":h=N0;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":h=MT;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":h=QT;break;case Qb:case Jb:case Zb:h=$T;break;case e2:h=ZT;break;case"scroll":h=OT;break;case"wheel":h=tI;break;case"copy":case"cut":case"paste":h=WT;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":h=F0}var p=(e&4)!==0,m=!p&&t==="scroll",g=p?f!==null?f+"Capture":null:f;p=[];for(var y=l,w;y!==null;){w=y;var x=w.stateNode;if(w.tag===5&&x!==null&&(w=x,g!==null&&(x=ol(y,g),x!=null&&p.push(dl(y,x,w)))),m)break;y=y.return}0<p.length&&(f=new h(f,v,null,n,c),d.push({event:f,listeners:p}))}}if(!(e&7)){e:{if(f=t==="mouseover"||t==="pointerover",h=t==="mouseout"||t==="pointerout",f&&n!==Zp&&(v=n.relatedTarget||n.fromElement)&&(Ji(v)||v[wo]))break e;if((h||f)&&(f=c.window===c?c:(f=c.ownerDocument)?f.defaultView||f.parentWindow:window,h?(v=n.relatedTarget||n.toElement,h=l,v=v?Ji(v):null,v!==null&&(m=Ra(v),v!==m||v.tag!==5&&v.tag!==6)&&(v=null)):(h=null,v=l),h!==v)){if(p=N0,x="onMouseLeave",g="onMouseEnter",y="mouse",(t==="pointerout"||t==="pointerover")&&(p=F0,x="onPointerLeave",g="onPointerEnter",y="pointer"),m=h==null?f:ls(h),w=v==null?f:ls(v),f=new p(x,y+"leave",h,n,c),f.target=m,f.relatedTarget=w,x=null,Ji(c)===l&&(p=new p(g,y+"enter",v,n,c),p.target=w,p.relatedTarget=m,x=p),m=x,h&&v)t:{for(p=h,g=v,y=0,w=p;w;w=$a(w))y++;for(w=0,x=g;x;x=$a(x))w++;for(;0<y-w;)p=$a(p),y--;for(;0<w-y;)g=$a(g),w--;for(;y--;){if(p===g||g!==null&&p===g.alternate)break t;p=$a(p),g=$a(g)}p=null}else p=null;h!==null&&G0(d,f,h,p,!1),v!==null&&m!==null&&G0(d,m,v,p,!0)}}e:{if(f=l?ls(l):window,h=f.nodeName&&f.nodeName.toLowerCase(),h==="select"||h==="input"&&f.type==="file")var b=uI;else if(B0(f))if(Gb)b=fI;else{b=cI;var _=lI}else(h=f.nodeName)&&h.toLowerCase()==="input"&&(f.type==="checkbox"||f.type==="radio")&&(b=dI);if(b&&(b=b(t,l))){Hb(d,b,n,c);break e}_&&_(t,f,l),t==="focusout"&&(_=f._wrapperState)&&_.controlled&&f.type==="number"&&Kp(f,"number",f.value)}switch(_=l?ls(l):window,t){case"focusin":(B0(_)||_.contentEditable==="true")&&(ss=_,av=l,Vu=null);break;case"focusout":Vu=av=ss=null;break;case"mousedown":sv=!0;break;case"contextmenu":case"mouseup":case"dragend":sv=!1,z0(d,n,c);break;case"selectionchange":if(vI)break;case"keydown":case"keyup":z0(d,n,c)}var E;if(ag)e:{switch(t){case"compositionstart":var C="onCompositionStart";break e;case"compositionend":C="onCompositionEnd";break e;case"compositionupdate":C="onCompositionUpdate";break e}C=void 0}else as?zb(t,n)&&(C="onCompositionEnd"):t==="keydown"&&n.keyCode===229&&(C="onCompositionStart");C&&(Ub&&n.locale!=="ko"&&(as||C!=="onCompositionStart"?C==="onCompositionEnd"&&as&&(E=Wb()):(si=c,rg="value"in si?si.value:si.textContent,as=!0)),_=Ed(l,C),0<_.length&&(C=new O0(C,t,null,n,c),d.push({event:C,listeners:_}),E?C.data=E:(E=Vb(n),E!==null&&(C.data=E)))),(E=rI?oI(t,n):iI(t,n))&&(l=Ed(l,"onBeforeInput"),0<l.length&&(c=new O0("onBeforeInput","beforeinput",null,n,c),d.push({event:c,listeners:l}),c.data=E))}n2(d,e)})}function dl(t,e,n){return{instance:t,listener:e,currentTarget:n}}function Ed(t,e){for(var n=e+"Capture",r=[];t!==null;){var o=t,i=o.stateNode;o.tag===5&&i!==null&&(o=i,i=ol(t,n),i!=null&&r.unshift(dl(t,i,o)),i=ol(t,e),i!=null&&r.push(dl(t,i,o))),t=t.return}return r}function $a(t){if(t===null)return null;do t=t.return;while(t&&t.tag!==5);return t||null}function G0(t,e,n,r,o){for(var i=e._reactName,a=[];n!==null&&n!==r;){var s=n,u=s.alternate,l=s.stateNode;if(u!==null&&u===r)break;s.tag===5&&l!==null&&(s=l,o?(u=ol(n,i),u!=null&&a.unshift(dl(n,u,s))):o||(u=ol(n,i),u!=null&&a.push(dl(n,u,s)))),n=n.return}a.length!==0&&t.push({event:e,listeners:a})}var wI=/\r\n?/g,xI=/\u0000|\uFFFD/g;function q0(t){return(typeof t=="string"?t:""+t).replace(wI,`
`).replace(xI,"")}function wc(t,e,n){if(e=q0(e),q0(t)!==e&&n)throw Error(Y(425))}function Cd(){}var uv=null,lv=null;function cv(t,e){return t==="textarea"||t==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var dv=typeof setTimeout=="function"?setTimeout:void 0,bI=typeof clearTimeout=="function"?clearTimeout:void 0,K0=typeof Promise=="function"?Promise:void 0,_I=typeof queueMicrotask=="function"?queueMicrotask:typeof K0<"u"?function(t){return K0.resolve(null).then(t).catch(EI)}:dv;function EI(t){setTimeout(function(){throw t})}function Mh(t,e){var n=e,r=0;do{var o=n.nextSibling;if(t.removeChild(n),o&&o.nodeType===8)if(n=o.data,n==="/$"){if(r===0){t.removeChild(o),sl(e);return}r--}else n!=="$"&&n!=="$?"&&n!=="$!"||r++;n=o}while(n);sl(e)}function vi(t){for(;t!=null;t=t.nextSibling){var e=t.nodeType;if(e===1||e===3)break;if(e===8){if(e=t.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return t}function X0(t){t=t.previousSibling;for(var e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="$"||n==="$!"||n==="$?"){if(e===0)return t;e--}else n==="/$"&&e++}t=t.previousSibling}return null}var uu=Math.random().toString(36).slice(2),Mr="__reactFiber$"+uu,fl="__reactProps$"+uu,wo="__reactContainer$"+uu,fv="__reactEvents$"+uu,CI="__reactListeners$"+uu,SI="__reactHandles$"+uu;function Ji(t){var e=t[Mr];if(e)return e;for(var n=t.parentNode;n;){if(e=n[wo]||n[Mr]){if(n=e.alternate,e.child!==null||n!==null&&n.child!==null)for(t=X0(t);t!==null;){if(n=t[Mr])return n;t=X0(t)}return e}t=n,n=t.parentNode}return null}function jl(t){return t=t[Mr]||t[wo],!t||t.tag!==5&&t.tag!==6&&t.tag!==13&&t.tag!==3?null:t}function ls(t){if(t.tag===5||t.tag===6)return t.stateNode;throw Error(Y(33))}function kf(t){return t[fl]||null}var hv=[],cs=-1;function Di(t){return{current:t}}function Qe(t){0>cs||(t.current=hv[cs],hv[cs]=null,cs--)}function Ge(t,e){cs++,hv[cs]=t.current,t.current=e}var ki={},Qt=Di(ki),yn=Di(!1),va=ki;function qs(t,e){var n=t.type.contextTypes;if(!n)return ki;var r=t.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===e)return r.__reactInternalMemoizedMaskedChildContext;var o={},i;for(i in n)o[i]=e[i];return r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=e,t.__reactInternalMemoizedMaskedChildContext=o),o}function wn(t){return t=t.childContextTypes,t!=null}function Sd(){Qe(yn),Qe(Qt)}function Y0(t,e,n){if(Qt.current!==ki)throw Error(Y(168));Ge(Qt,e),Ge(yn,n)}function o2(t,e,n){var r=t.stateNode;if(e=e.childContextTypes,typeof r.getChildContext!="function")return n;r=r.getChildContext();for(var o in r)if(!(o in e))throw Error(Y(108,lT(t)||"Unknown",o));return it({},n,r)}function kd(t){return t=(t=t.stateNode)&&t.__reactInternalMemoizedMergedChildContext||ki,va=Qt.current,Ge(Qt,t),Ge(yn,yn.current),!0}function Q0(t,e,n){var r=t.stateNode;if(!r)throw Error(Y(169));n?(t=o2(t,e,va),r.__reactInternalMemoizedMergedChildContext=t,Qe(yn),Qe(Qt),Ge(Qt,t)):Qe(yn),Ge(yn,n)}var lo=null,Rf=!1,Lh=!1;function i2(t){lo===null?lo=[t]:lo.push(t)}function kI(t){Rf=!0,i2(t)}function Ni(){if(!Lh&&lo!==null){Lh=!0;var t=0,e=$e;try{var n=lo;for($e=1;t<n.length;t++){var r=n[t];do r=r(!0);while(r!==null)}lo=null,Rf=!1}catch(o){throw lo!==null&&(lo=lo.slice(t+1)),Ab(Zm,Ni),o}finally{$e=e,Lh=!1}}return null}var ds=[],fs=0,Rd=null,Td=0,Un=[],zn=0,ma=null,po=1,vo="";function Hi(t,e){ds[fs++]=Td,ds[fs++]=Rd,Rd=t,Td=e}function a2(t,e,n){Un[zn++]=po,Un[zn++]=vo,Un[zn++]=ma,ma=t;var r=po;t=vo;var o=32-mr(r)-1;r&=~(1<<o),n+=1;var i=32-mr(e)+o;if(30<i){var a=o-o%5;i=(r&(1<<a)-1).toString(32),r>>=a,o-=a,po=1<<32-mr(e)+o|n<<o|r,vo=i+t}else po=1<<i|n<<o|r,vo=t}function ug(t){t.return!==null&&(Hi(t,1),a2(t,1,0))}function lg(t){for(;t===Rd;)Rd=ds[--fs],ds[fs]=null,Td=ds[--fs],ds[fs]=null;for(;t===ma;)ma=Un[--zn],Un[zn]=null,vo=Un[--zn],Un[zn]=null,po=Un[--zn],Un[zn]=null}var Nn=null,In=null,Ze=!1,hr=null;function s2(t,e){var n=Gn(5,null,null,0);n.elementType="DELETED",n.stateNode=e,n.return=t,e=t.deletions,e===null?(t.deletions=[n],t.flags|=16):e.push(n)}function J0(t,e){switch(t.tag){case 5:var n=t.type;return e=e.nodeType!==1||n.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(t.stateNode=e,Nn=t,In=vi(e.firstChild),!0):!1;case 6:return e=t.pendingProps===""||e.nodeType!==3?null:e,e!==null?(t.stateNode=e,Nn=t,In=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(n=ma!==null?{id:po,overflow:vo}:null,t.memoizedState={dehydrated:e,treeContext:n,retryLane:1073741824},n=Gn(18,null,null,0),n.stateNode=e,n.return=t,t.child=n,Nn=t,In=null,!0):!1;default:return!1}}function pv(t){return(t.mode&1)!==0&&(t.flags&128)===0}function vv(t){if(Ze){var e=In;if(e){var n=e;if(!J0(t,e)){if(pv(t))throw Error(Y(418));e=vi(n.nextSibling);var r=Nn;e&&J0(t,e)?s2(r,n):(t.flags=t.flags&-4097|2,Ze=!1,Nn=t)}}else{if(pv(t))throw Error(Y(418));t.flags=t.flags&-4097|2,Ze=!1,Nn=t}}}function Z0(t){for(t=t.return;t!==null&&t.tag!==5&&t.tag!==3&&t.tag!==13;)t=t.return;Nn=t}function xc(t){if(t!==Nn)return!1;if(!Ze)return Z0(t),Ze=!0,!1;var e;if((e=t.tag!==3)&&!(e=t.tag!==5)&&(e=t.type,e=e!=="head"&&e!=="body"&&!cv(t.type,t.memoizedProps)),e&&(e=In)){if(pv(t))throw u2(),Error(Y(418));for(;e;)s2(t,e),e=vi(e.nextSibling)}if(Z0(t),t.tag===13){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(Y(317));e:{for(t=t.nextSibling,e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="/$"){if(e===0){In=vi(t.nextSibling);break e}e--}else n!=="$"&&n!=="$!"&&n!=="$?"||e++}t=t.nextSibling}In=null}}else In=Nn?vi(t.stateNode.nextSibling):null;return!0}function u2(){for(var t=In;t;)t=vi(t.nextSibling)}function Ks(){In=Nn=null,Ze=!1}function cg(t){hr===null?hr=[t]:hr.push(t)}var RI=So.ReactCurrentBatchConfig;function Cu(t,e,n){if(t=n.ref,t!==null&&typeof t!="function"&&typeof t!="object"){if(n._owner){if(n=n._owner,n){if(n.tag!==1)throw Error(Y(309));var r=n.stateNode}if(!r)throw Error(Y(147,t));var o=r,i=""+t;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===i?e.ref:(e=function(a){var s=o.refs;a===null?delete s[i]:s[i]=a},e._stringRef=i,e)}if(typeof t!="string")throw Error(Y(284));if(!n._owner)throw Error(Y(290,t))}return t}function bc(t,e){throw t=Object.prototype.toString.call(e),Error(Y(31,t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t))}function e1(t){var e=t._init;return e(t._payload)}function l2(t){function e(g,y){if(t){var w=g.deletions;w===null?(g.deletions=[y],g.flags|=16):w.push(y)}}function n(g,y){if(!t)return null;for(;y!==null;)e(g,y),y=y.sibling;return null}function r(g,y){for(g=new Map;y!==null;)y.key!==null?g.set(y.key,y):g.set(y.index,y),y=y.sibling;return g}function o(g,y){return g=wi(g,y),g.index=0,g.sibling=null,g}function i(g,y,w){return g.index=w,t?(w=g.alternate,w!==null?(w=w.index,w<y?(g.flags|=2,y):w):(g.flags|=2,y)):(g.flags|=1048576,y)}function a(g){return t&&g.alternate===null&&(g.flags|=2),g}function s(g,y,w,x){return y===null||y.tag!==6?(y=Vh(w,g.mode,x),y.return=g,y):(y=o(y,w),y.return=g,y)}function u(g,y,w,x){var b=w.type;return b===is?c(g,y,w.props.children,x,w.key):y!==null&&(y.elementType===b||typeof b=="object"&&b!==null&&b.$$typeof===Go&&e1(b)===y.type)?(x=o(y,w.props),x.ref=Cu(g,y,w),x.return=g,x):(x=cd(w.type,w.key,w.props,null,g.mode,x),x.ref=Cu(g,y,w),x.return=g,x)}function l(g,y,w,x){return y===null||y.tag!==4||y.stateNode.containerInfo!==w.containerInfo||y.stateNode.implementation!==w.implementation?(y=Hh(w,g.mode,x),y.return=g,y):(y=o(y,w.children||[]),y.return=g,y)}function c(g,y,w,x,b){return y===null||y.tag!==7?(y=ha(w,g.mode,x,b),y.return=g,y):(y=o(y,w),y.return=g,y)}function d(g,y,w){if(typeof y=="string"&&y!==""||typeof y=="number")return y=Vh(""+y,g.mode,w),y.return=g,y;if(typeof y=="object"&&y!==null){switch(y.$$typeof){case cc:return w=cd(y.type,y.key,y.props,null,g.mode,w),w.ref=Cu(g,null,y),w.return=g,w;case os:return y=Hh(y,g.mode,w),y.return=g,y;case Go:var x=y._init;return d(g,x(y._payload),w)}if(Fu(y)||wu(y))return y=ha(y,g.mode,w,null),y.return=g,y;bc(g,y)}return null}function f(g,y,w,x){var b=y!==null?y.key:null;if(typeof w=="string"&&w!==""||typeof w=="number")return b!==null?null:s(g,y,""+w,x);if(typeof w=="object"&&w!==null){switch(w.$$typeof){case cc:return w.key===b?u(g,y,w,x):null;case os:return w.key===b?l(g,y,w,x):null;case Go:return b=w._init,f(g,y,b(w._payload),x)}if(Fu(w)||wu(w))return b!==null?null:c(g,y,w,x,null);bc(g,w)}return null}function h(g,y,w,x,b){if(typeof x=="string"&&x!==""||typeof x=="number")return g=g.get(w)||null,s(y,g,""+x,b);if(typeof x=="object"&&x!==null){switch(x.$$typeof){case cc:return g=g.get(x.key===null?w:x.key)||null,u(y,g,x,b);case os:return g=g.get(x.key===null?w:x.key)||null,l(y,g,x,b);case Go:var _=x._init;return h(g,y,w,_(x._payload),b)}if(Fu(x)||wu(x))return g=g.get(w)||null,c(y,g,x,b,null);bc(y,x)}return null}function v(g,y,w,x){for(var b=null,_=null,E=y,C=y=0,R=null;E!==null&&C<w.length;C++){E.index>C?(R=E,E=null):R=E.sibling;var S=f(g,E,w[C],x);if(S===null){E===null&&(E=R);break}t&&E&&S.alternate===null&&e(g,E),y=i(S,y,C),_===null?b=S:_.sibling=S,_=S,E=R}if(C===w.length)return n(g,E),Ze&&Hi(g,C),b;if(E===null){for(;C<w.length;C++)E=d(g,w[C],x),E!==null&&(y=i(E,y,C),_===null?b=E:_.sibling=E,_=E);return Ze&&Hi(g,C),b}for(E=r(g,E);C<w.length;C++)R=h(E,g,C,w[C],x),R!==null&&(t&&R.alternate!==null&&E.delete(R.key===null?C:R.key),y=i(R,y,C),_===null?b=R:_.sibling=R,_=R);return t&&E.forEach(function(P){return e(g,P)}),Ze&&Hi(g,C),b}function p(g,y,w,x){var b=wu(w);if(typeof b!="function")throw Error(Y(150));if(w=b.call(w),w==null)throw Error(Y(151));for(var _=b=null,E=y,C=y=0,R=null,S=w.next();E!==null&&!S.done;C++,S=w.next()){E.index>C?(R=E,E=null):R=E.sibling;var P=f(g,E,S.value,x);if(P===null){E===null&&(E=R);break}t&&E&&P.alternate===null&&e(g,E),y=i(P,y,C),_===null?b=P:_.sibling=P,_=P,E=R}if(S.done)return n(g,E),Ze&&Hi(g,C),b;if(E===null){for(;!S.done;C++,S=w.next())S=d(g,S.value,x),S!==null&&(y=i(S,y,C),_===null?b=S:_.sibling=S,_=S);return Ze&&Hi(g,C),b}for(E=r(g,E);!S.done;C++,S=w.next())S=h(E,g,C,S.value,x),S!==null&&(t&&S.alternate!==null&&E.delete(S.key===null?C:S.key),y=i(S,y,C),_===null?b=S:_.sibling=S,_=S);return t&&E.forEach(function(A){return e(g,A)}),Ze&&Hi(g,C),b}function m(g,y,w,x){if(typeof w=="object"&&w!==null&&w.type===is&&w.key===null&&(w=w.props.children),typeof w=="object"&&w!==null){switch(w.$$typeof){case cc:e:{for(var b=w.key,_=y;_!==null;){if(_.key===b){if(b=w.type,b===is){if(_.tag===7){n(g,_.sibling),y=o(_,w.props.children),y.return=g,g=y;break e}}else if(_.elementType===b||typeof b=="object"&&b!==null&&b.$$typeof===Go&&e1(b)===_.type){n(g,_.sibling),y=o(_,w.props),y.ref=Cu(g,_,w),y.return=g,g=y;break e}n(g,_);break}else e(g,_);_=_.sibling}w.type===is?(y=ha(w.props.children,g.mode,x,w.key),y.return=g,g=y):(x=cd(w.type,w.key,w.props,null,g.mode,x),x.ref=Cu(g,y,w),x.return=g,g=x)}return a(g);case os:e:{for(_=w.key;y!==null;){if(y.key===_)if(y.tag===4&&y.stateNode.containerInfo===w.containerInfo&&y.stateNode.implementation===w.implementation){n(g,y.sibling),y=o(y,w.children||[]),y.return=g,g=y;break e}else{n(g,y);break}else e(g,y);y=y.sibling}y=Hh(w,g.mode,x),y.return=g,g=y}return a(g);case Go:return _=w._init,m(g,y,_(w._payload),x)}if(Fu(w))return v(g,y,w,x);if(wu(w))return p(g,y,w,x);bc(g,w)}return typeof w=="string"&&w!==""||typeof w=="number"?(w=""+w,y!==null&&y.tag===6?(n(g,y.sibling),y=o(y,w),y.return=g,g=y):(n(g,y),y=Vh(w,g.mode,x),y.return=g,g=y),a(g)):n(g,y)}return m}var Xs=l2(!0),c2=l2(!1),Id=Di(null),Ad=null,hs=null,dg=null;function fg(){dg=hs=Ad=null}function hg(t){var e=Id.current;Qe(Id),t._currentValue=e}function mv(t,e,n){for(;t!==null;){var r=t.alternate;if((t.childLanes&e)!==e?(t.childLanes|=e,r!==null&&(r.childLanes|=e)):r!==null&&(r.childLanes&e)!==e&&(r.childLanes|=e),t===n)break;t=t.return}}function xs(t,e){Ad=t,dg=hs=null,t=t.dependencies,t!==null&&t.firstContext!==null&&(t.lanes&e&&(gn=!0),t.firstContext=null)}function Qn(t){var e=t._currentValue;if(dg!==t)if(t={context:t,memoizedValue:e,next:null},hs===null){if(Ad===null)throw Error(Y(308));hs=t,Ad.dependencies={lanes:0,firstContext:t}}else hs=hs.next=t;return e}var Zi=null;function pg(t){Zi===null?Zi=[t]:Zi.push(t)}function d2(t,e,n,r){var o=e.interleaved;return o===null?(n.next=n,pg(e)):(n.next=o.next,o.next=n),e.interleaved=n,xo(t,r)}function xo(t,e){t.lanes|=e;var n=t.alternate;for(n!==null&&(n.lanes|=e),n=t,t=t.return;t!==null;)t.childLanes|=e,n=t.alternate,n!==null&&(n.childLanes|=e),n=t,t=t.return;return n.tag===3?n.stateNode:null}var qo=!1;function vg(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function f2(t,e){t=t.updateQueue,e.updateQueue===t&&(e.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,effects:t.effects})}function mo(t,e){return{eventTime:t,lane:e,tag:0,payload:null,callback:null,next:null}}function mi(t,e,n){var r=t.updateQueue;if(r===null)return null;if(r=r.shared,Oe&2){var o=r.pending;return o===null?e.next=e:(e.next=o.next,o.next=e),r.pending=e,xo(t,n)}return o=r.interleaved,o===null?(e.next=e,pg(r)):(e.next=o.next,o.next=e),r.interleaved=e,xo(t,n)}function od(t,e,n){if(e=e.updateQueue,e!==null&&(e=e.shared,(n&4194240)!==0)){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,eg(t,n)}}function t1(t,e){var n=t.updateQueue,r=t.alternate;if(r!==null&&(r=r.updateQueue,n===r)){var o=null,i=null;if(n=n.firstBaseUpdate,n!==null){do{var a={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};i===null?o=i=a:i=i.next=a,n=n.next}while(n!==null);i===null?o=i=e:i=i.next=e}else o=i=e;n={baseState:r.baseState,firstBaseUpdate:o,lastBaseUpdate:i,shared:r.shared,effects:r.effects},t.updateQueue=n;return}t=n.lastBaseUpdate,t===null?n.firstBaseUpdate=e:t.next=e,n.lastBaseUpdate=e}function Pd(t,e,n,r){var o=t.updateQueue;qo=!1;var i=o.firstBaseUpdate,a=o.lastBaseUpdate,s=o.shared.pending;if(s!==null){o.shared.pending=null;var u=s,l=u.next;u.next=null,a===null?i=l:a.next=l,a=u;var c=t.alternate;c!==null&&(c=c.updateQueue,s=c.lastBaseUpdate,s!==a&&(s===null?c.firstBaseUpdate=l:s.next=l,c.lastBaseUpdate=u))}if(i!==null){var d=o.baseState;a=0,c=l=u=null,s=i;do{var f=s.lane,h=s.eventTime;if((r&f)===f){c!==null&&(c=c.next={eventTime:h,lane:0,tag:s.tag,payload:s.payload,callback:s.callback,next:null});e:{var v=t,p=s;switch(f=e,h=n,p.tag){case 1:if(v=p.payload,typeof v=="function"){d=v.call(h,d,f);break e}d=v;break e;case 3:v.flags=v.flags&-65537|128;case 0:if(v=p.payload,f=typeof v=="function"?v.call(h,d,f):v,f==null)break e;d=it({},d,f);break e;case 2:qo=!0}}s.callback!==null&&s.lane!==0&&(t.flags|=64,f=o.effects,f===null?o.effects=[s]:f.push(s))}else h={eventTime:h,lane:f,tag:s.tag,payload:s.payload,callback:s.callback,next:null},c===null?(l=c=h,u=d):c=c.next=h,a|=f;if(s=s.next,s===null){if(s=o.shared.pending,s===null)break;f=s,s=f.next,f.next=null,o.lastBaseUpdate=f,o.shared.pending=null}}while(!0);if(c===null&&(u=d),o.baseState=u,o.firstBaseUpdate=l,o.lastBaseUpdate=c,e=o.shared.interleaved,e!==null){o=e;do a|=o.lane,o=o.next;while(o!==e)}else i===null&&(o.shared.lanes=0);ya|=a,t.lanes=a,t.memoizedState=d}}function n1(t,e,n){if(t=e.effects,e.effects=null,t!==null)for(e=0;e<t.length;e++){var r=t[e],o=r.callback;if(o!==null){if(r.callback=null,r=n,typeof o!="function")throw Error(Y(191,o));o.call(r)}}}var Wl={},zr=Di(Wl),hl=Di(Wl),pl=Di(Wl);function ea(t){if(t===Wl)throw Error(Y(174));return t}function mg(t,e){switch(Ge(pl,e),Ge(hl,t),Ge(zr,Wl),t=e.nodeType,t){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:Yp(null,"");break;default:t=t===8?e.parentNode:e,e=t.namespaceURI||null,t=t.tagName,e=Yp(e,t)}Qe(zr),Ge(zr,e)}function Ys(){Qe(zr),Qe(hl),Qe(pl)}function h2(t){ea(pl.current);var e=ea(zr.current),n=Yp(e,t.type);e!==n&&(Ge(hl,t),Ge(zr,n))}function gg(t){hl.current===t&&(Qe(zr),Qe(hl))}var tt=Di(0);function Dd(t){for(var e=t;e!==null;){if(e.tag===13){var n=e.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||n.data==="$?"||n.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var Bh=[];function yg(){for(var t=0;t<Bh.length;t++)Bh[t]._workInProgressVersionPrimary=null;Bh.length=0}var id=So.ReactCurrentDispatcher,$h=So.ReactCurrentBatchConfig,ga=0,ot=null,wt=null,Tt=null,Nd=!1,Hu=!1,vl=0,TI=0;function Ut(){throw Error(Y(321))}function wg(t,e){if(e===null)return!1;for(var n=0;n<e.length&&n<t.length;n++)if(!wr(t[n],e[n]))return!1;return!0}function xg(t,e,n,r,o,i){if(ga=i,ot=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,id.current=t===null||t.memoizedState===null?DI:NI,t=n(r,o),Hu){i=0;do{if(Hu=!1,vl=0,25<=i)throw Error(Y(301));i+=1,Tt=wt=null,e.updateQueue=null,id.current=OI,t=n(r,o)}while(Hu)}if(id.current=Od,e=wt!==null&&wt.next!==null,ga=0,Tt=wt=ot=null,Nd=!1,e)throw Error(Y(300));return t}function bg(){var t=vl!==0;return vl=0,t}function Ir(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Tt===null?ot.memoizedState=Tt=t:Tt=Tt.next=t,Tt}function Jn(){if(wt===null){var t=ot.alternate;t=t!==null?t.memoizedState:null}else t=wt.next;var e=Tt===null?ot.memoizedState:Tt.next;if(e!==null)Tt=e,wt=t;else{if(t===null)throw Error(Y(310));wt=t,t={memoizedState:wt.memoizedState,baseState:wt.baseState,baseQueue:wt.baseQueue,queue:wt.queue,next:null},Tt===null?ot.memoizedState=Tt=t:Tt=Tt.next=t}return Tt}function ml(t,e){return typeof e=="function"?e(t):e}function jh(t){var e=Jn(),n=e.queue;if(n===null)throw Error(Y(311));n.lastRenderedReducer=t;var r=wt,o=r.baseQueue,i=n.pending;if(i!==null){if(o!==null){var a=o.next;o.next=i.next,i.next=a}r.baseQueue=o=i,n.pending=null}if(o!==null){i=o.next,r=r.baseState;var s=a=null,u=null,l=i;do{var c=l.lane;if((ga&c)===c)u!==null&&(u=u.next={lane:0,action:l.action,hasEagerState:l.hasEagerState,eagerState:l.eagerState,next:null}),r=l.hasEagerState?l.eagerState:t(r,l.action);else{var d={lane:c,action:l.action,hasEagerState:l.hasEagerState,eagerState:l.eagerState,next:null};u===null?(s=u=d,a=r):u=u.next=d,ot.lanes|=c,ya|=c}l=l.next}while(l!==null&&l!==i);u===null?a=r:u.next=s,wr(r,e.memoizedState)||(gn=!0),e.memoizedState=r,e.baseState=a,e.baseQueue=u,n.lastRenderedState=r}if(t=n.interleaved,t!==null){o=t;do i=o.lane,ot.lanes|=i,ya|=i,o=o.next;while(o!==t)}else o===null&&(n.lanes=0);return[e.memoizedState,n.dispatch]}function Wh(t){var e=Jn(),n=e.queue;if(n===null)throw Error(Y(311));n.lastRenderedReducer=t;var r=n.dispatch,o=n.pending,i=e.memoizedState;if(o!==null){n.pending=null;var a=o=o.next;do i=t(i,a.action),a=a.next;while(a!==o);wr(i,e.memoizedState)||(gn=!0),e.memoizedState=i,e.baseQueue===null&&(e.baseState=i),n.lastRenderedState=i}return[i,r]}function p2(){}function v2(t,e){var n=ot,r=Jn(),o=e(),i=!wr(r.memoizedState,o);if(i&&(r.memoizedState=o,gn=!0),r=r.queue,_g(y2.bind(null,n,r,t),[t]),r.getSnapshot!==e||i||Tt!==null&&Tt.memoizedState.tag&1){if(n.flags|=2048,gl(9,g2.bind(null,n,r,o,e),void 0,null),It===null)throw Error(Y(349));ga&30||m2(n,e,o)}return o}function m2(t,e,n){t.flags|=16384,t={getSnapshot:e,value:n},e=ot.updateQueue,e===null?(e={lastEffect:null,stores:null},ot.updateQueue=e,e.stores=[t]):(n=e.stores,n===null?e.stores=[t]:n.push(t))}function g2(t,e,n,r){e.value=n,e.getSnapshot=r,w2(e)&&x2(t)}function y2(t,e,n){return n(function(){w2(e)&&x2(t)})}function w2(t){var e=t.getSnapshot;t=t.value;try{var n=e();return!wr(t,n)}catch{return!0}}function x2(t){var e=xo(t,1);e!==null&&gr(e,t,1,-1)}function r1(t){var e=Ir();return typeof t=="function"&&(t=t()),e.memoizedState=e.baseState=t,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:ml,lastRenderedState:t},e.queue=t,t=t.dispatch=PI.bind(null,ot,t),[e.memoizedState,t]}function gl(t,e,n,r){return t={tag:t,create:e,destroy:n,deps:r,next:null},e=ot.updateQueue,e===null?(e={lastEffect:null,stores:null},ot.updateQueue=e,e.lastEffect=t.next=t):(n=e.lastEffect,n===null?e.lastEffect=t.next=t:(r=n.next,n.next=t,t.next=r,e.lastEffect=t)),t}function b2(){return Jn().memoizedState}function ad(t,e,n,r){var o=Ir();ot.flags|=t,o.memoizedState=gl(1|e,n,void 0,r===void 0?null:r)}function Tf(t,e,n,r){var o=Jn();r=r===void 0?null:r;var i=void 0;if(wt!==null){var a=wt.memoizedState;if(i=a.destroy,r!==null&&wg(r,a.deps)){o.memoizedState=gl(e,n,i,r);return}}ot.flags|=t,o.memoizedState=gl(1|e,n,i,r)}function o1(t,e){return ad(8390656,8,t,e)}function _g(t,e){return Tf(2048,8,t,e)}function _2(t,e){return Tf(4,2,t,e)}function E2(t,e){return Tf(4,4,t,e)}function C2(t,e){if(typeof e=="function")return t=t(),e(t),function(){e(null)};if(e!=null)return t=t(),e.current=t,function(){e.current=null}}function S2(t,e,n){return n=n!=null?n.concat([t]):null,Tf(4,4,C2.bind(null,e,t),n)}function Eg(){}function k2(t,e){var n=Jn();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&wg(e,r[1])?r[0]:(n.memoizedState=[t,e],t)}function R2(t,e){var n=Jn();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&wg(e,r[1])?r[0]:(t=t(),n.memoizedState=[t,e],t)}function T2(t,e,n){return ga&21?(wr(n,e)||(n=Nb(),ot.lanes|=n,ya|=n,t.baseState=!0),e):(t.baseState&&(t.baseState=!1,gn=!0),t.memoizedState=n)}function II(t,e){var n=$e;$e=n!==0&&4>n?n:4,t(!0);var r=$h.transition;$h.transition={};try{t(!1),e()}finally{$e=n,$h.transition=r}}function I2(){return Jn().memoizedState}function AI(t,e,n){var r=yi(t);if(n={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null},A2(t))P2(e,n);else if(n=d2(t,e,n,r),n!==null){var o=an();gr(n,t,r,o),D2(n,e,r)}}function PI(t,e,n){var r=yi(t),o={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null};if(A2(t))P2(e,o);else{var i=t.alternate;if(t.lanes===0&&(i===null||i.lanes===0)&&(i=e.lastRenderedReducer,i!==null))try{var a=e.lastRenderedState,s=i(a,n);if(o.hasEagerState=!0,o.eagerState=s,wr(s,a)){var u=e.interleaved;u===null?(o.next=o,pg(e)):(o.next=u.next,u.next=o),e.interleaved=o;return}}catch{}finally{}n=d2(t,e,o,r),n!==null&&(o=an(),gr(n,t,r,o),D2(n,e,r))}}function A2(t){var e=t.alternate;return t===ot||e!==null&&e===ot}function P2(t,e){Hu=Nd=!0;var n=t.pending;n===null?e.next=e:(e.next=n.next,n.next=e),t.pending=e}function D2(t,e,n){if(n&4194240){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,eg(t,n)}}var Od={readContext:Qn,useCallback:Ut,useContext:Ut,useEffect:Ut,useImperativeHandle:Ut,useInsertionEffect:Ut,useLayoutEffect:Ut,useMemo:Ut,useReducer:Ut,useRef:Ut,useState:Ut,useDebugValue:Ut,useDeferredValue:Ut,useTransition:Ut,useMutableSource:Ut,useSyncExternalStore:Ut,useId:Ut,unstable_isNewReconciler:!1},DI={readContext:Qn,useCallback:function(t,e){return Ir().memoizedState=[t,e===void 0?null:e],t},useContext:Qn,useEffect:o1,useImperativeHandle:function(t,e,n){return n=n!=null?n.concat([t]):null,ad(4194308,4,C2.bind(null,e,t),n)},useLayoutEffect:function(t,e){return ad(4194308,4,t,e)},useInsertionEffect:function(t,e){return ad(4,2,t,e)},useMemo:function(t,e){var n=Ir();return e=e===void 0?null:e,t=t(),n.memoizedState=[t,e],t},useReducer:function(t,e,n){var r=Ir();return e=n!==void 0?n(e):e,r.memoizedState=r.baseState=e,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:e},r.queue=t,t=t.dispatch=AI.bind(null,ot,t),[r.memoizedState,t]},useRef:function(t){var e=Ir();return t={current:t},e.memoizedState=t},useState:r1,useDebugValue:Eg,useDeferredValue:function(t){return Ir().memoizedState=t},useTransition:function(){var t=r1(!1),e=t[0];return t=II.bind(null,t[1]),Ir().memoizedState=t,[e,t]},useMutableSource:function(){},useSyncExternalStore:function(t,e,n){var r=ot,o=Ir();if(Ze){if(n===void 0)throw Error(Y(407));n=n()}else{if(n=e(),It===null)throw Error(Y(349));ga&30||m2(r,e,n)}o.memoizedState=n;var i={value:n,getSnapshot:e};return o.queue=i,o1(y2.bind(null,r,i,t),[t]),r.flags|=2048,gl(9,g2.bind(null,r,i,n,e),void 0,null),n},useId:function(){var t=Ir(),e=It.identifierPrefix;if(Ze){var n=vo,r=po;n=(r&~(1<<32-mr(r)-1)).toString(32)+n,e=":"+e+"R"+n,n=vl++,0<n&&(e+="H"+n.toString(32)),e+=":"}else n=TI++,e=":"+e+"r"+n.toString(32)+":";return t.memoizedState=e},unstable_isNewReconciler:!1},NI={readContext:Qn,useCallback:k2,useContext:Qn,useEffect:_g,useImperativeHandle:S2,useInsertionEffect:_2,useLayoutEffect:E2,useMemo:R2,useReducer:jh,useRef:b2,useState:function(){return jh(ml)},useDebugValue:Eg,useDeferredValue:function(t){var e=Jn();return T2(e,wt.memoizedState,t)},useTransition:function(){var t=jh(ml)[0],e=Jn().memoizedState;return[t,e]},useMutableSource:p2,useSyncExternalStore:v2,useId:I2,unstable_isNewReconciler:!1},OI={readContext:Qn,useCallback:k2,useContext:Qn,useEffect:_g,useImperativeHandle:S2,useInsertionEffect:_2,useLayoutEffect:E2,useMemo:R2,useReducer:Wh,useRef:b2,useState:function(){return Wh(ml)},useDebugValue:Eg,useDeferredValue:function(t){var e=Jn();return wt===null?e.memoizedState=t:T2(e,wt.memoizedState,t)},useTransition:function(){var t=Wh(ml)[0],e=Jn().memoizedState;return[t,e]},useMutableSource:p2,useSyncExternalStore:v2,useId:I2,unstable_isNewReconciler:!1};function ur(t,e){if(t&&t.defaultProps){e=it({},e),t=t.defaultProps;for(var n in t)e[n]===void 0&&(e[n]=t[n]);return e}return e}function gv(t,e,n,r){e=t.memoizedState,n=n(r,e),n=n==null?e:it({},e,n),t.memoizedState=n,t.lanes===0&&(t.updateQueue.baseState=n)}var If={isMounted:function(t){return(t=t._reactInternals)?Ra(t)===t:!1},enqueueSetState:function(t,e,n){t=t._reactInternals;var r=an(),o=yi(t),i=mo(r,o);i.payload=e,n!=null&&(i.callback=n),e=mi(t,i,o),e!==null&&(gr(e,t,o,r),od(e,t,o))},enqueueReplaceState:function(t,e,n){t=t._reactInternals;var r=an(),o=yi(t),i=mo(r,o);i.tag=1,i.payload=e,n!=null&&(i.callback=n),e=mi(t,i,o),e!==null&&(gr(e,t,o,r),od(e,t,o))},enqueueForceUpdate:function(t,e){t=t._reactInternals;var n=an(),r=yi(t),o=mo(n,r);o.tag=2,e!=null&&(o.callback=e),e=mi(t,o,r),e!==null&&(gr(e,t,r,n),od(e,t,r))}};function i1(t,e,n,r,o,i,a){return t=t.stateNode,typeof t.shouldComponentUpdate=="function"?t.shouldComponentUpdate(r,i,a):e.prototype&&e.prototype.isPureReactComponent?!ll(n,r)||!ll(o,i):!0}function N2(t,e,n){var r=!1,o=ki,i=e.contextType;return typeof i=="object"&&i!==null?i=Qn(i):(o=wn(e)?va:Qt.current,r=e.contextTypes,i=(r=r!=null)?qs(t,o):ki),e=new e(n,i),t.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=If,t.stateNode=e,e._reactInternals=t,r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=o,t.__reactInternalMemoizedMaskedChildContext=i),e}function a1(t,e,n,r){t=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(n,r),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(n,r),e.state!==t&&If.enqueueReplaceState(e,e.state,null)}function yv(t,e,n,r){var o=t.stateNode;o.props=n,o.state=t.memoizedState,o.refs={},vg(t);var i=e.contextType;typeof i=="object"&&i!==null?o.context=Qn(i):(i=wn(e)?va:Qt.current,o.context=qs(t,i)),o.state=t.memoizedState,i=e.getDerivedStateFromProps,typeof i=="function"&&(gv(t,e,i,n),o.state=t.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof o.getSnapshotBeforeUpdate=="function"||typeof o.UNSAFE_componentWillMount!="function"&&typeof o.componentWillMount!="function"||(e=o.state,typeof o.componentWillMount=="function"&&o.componentWillMount(),typeof o.UNSAFE_componentWillMount=="function"&&o.UNSAFE_componentWillMount(),e!==o.state&&If.enqueueReplaceState(o,o.state,null),Pd(t,n,o,r),o.state=t.memoizedState),typeof o.componentDidMount=="function"&&(t.flags|=4194308)}function Qs(t,e){try{var n="",r=e;do n+=uT(r),r=r.return;while(r);var o=n}catch(i){o=`
Error generating stack: `+i.message+`
`+i.stack}return{value:t,source:e,stack:o,digest:null}}function Uh(t,e,n){return{value:t,source:null,stack:n??null,digest:e??null}}function wv(t,e){try{console.error(e.value)}catch(n){setTimeout(function(){throw n})}}var FI=typeof WeakMap=="function"?WeakMap:Map;function O2(t,e,n){n=mo(-1,n),n.tag=3,n.payload={element:null};var r=e.value;return n.callback=function(){Md||(Md=!0,Iv=r),wv(t,e)},n}function F2(t,e,n){n=mo(-1,n),n.tag=3;var r=t.type.getDerivedStateFromError;if(typeof r=="function"){var o=e.value;n.payload=function(){return r(o)},n.callback=function(){wv(t,e)}}var i=t.stateNode;return i!==null&&typeof i.componentDidCatch=="function"&&(n.callback=function(){wv(t,e),typeof r!="function"&&(gi===null?gi=new Set([this]):gi.add(this));var a=e.stack;this.componentDidCatch(e.value,{componentStack:a!==null?a:""})}),n}function s1(t,e,n){var r=t.pingCache;if(r===null){r=t.pingCache=new FI;var o=new Set;r.set(e,o)}else o=r.get(e),o===void 0&&(o=new Set,r.set(e,o));o.has(n)||(o.add(n),t=XI.bind(null,t,e,n),e.then(t,t))}function u1(t){do{var e;if((e=t.tag===13)&&(e=t.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return t;t=t.return}while(t!==null);return null}function l1(t,e,n,r,o){return t.mode&1?(t.flags|=65536,t.lanes=o,t):(t===e?t.flags|=65536:(t.flags|=128,n.flags|=131072,n.flags&=-52805,n.tag===1&&(n.alternate===null?n.tag=17:(e=mo(-1,1),e.tag=2,mi(n,e,1))),n.lanes|=1),t)}var MI=So.ReactCurrentOwner,gn=!1;function rn(t,e,n,r){e.child=t===null?c2(e,null,n,r):Xs(e,t.child,n,r)}function c1(t,e,n,r,o){n=n.render;var i=e.ref;return xs(e,o),r=xg(t,e,n,r,i,o),n=bg(),t!==null&&!gn?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~o,bo(t,e,o)):(Ze&&n&&ug(e),e.flags|=1,rn(t,e,r,o),e.child)}function d1(t,e,n,r,o){if(t===null){var i=n.type;return typeof i=="function"&&!Pg(i)&&i.defaultProps===void 0&&n.compare===null&&n.defaultProps===void 0?(e.tag=15,e.type=i,M2(t,e,i,r,o)):(t=cd(n.type,null,r,e,e.mode,o),t.ref=e.ref,t.return=e,e.child=t)}if(i=t.child,!(t.lanes&o)){var a=i.memoizedProps;if(n=n.compare,n=n!==null?n:ll,n(a,r)&&t.ref===e.ref)return bo(t,e,o)}return e.flags|=1,t=wi(i,r),t.ref=e.ref,t.return=e,e.child=t}function M2(t,e,n,r,o){if(t!==null){var i=t.memoizedProps;if(ll(i,r)&&t.ref===e.ref)if(gn=!1,e.pendingProps=r=i,(t.lanes&o)!==0)t.flags&131072&&(gn=!0);else return e.lanes=t.lanes,bo(t,e,o)}return xv(t,e,n,r,o)}function L2(t,e,n){var r=e.pendingProps,o=r.children,i=t!==null?t.memoizedState:null;if(r.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},Ge(vs,Sn),Sn|=n;else{if(!(n&1073741824))return t=i!==null?i.baseLanes|n:n,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:t,cachePool:null,transitions:null},e.updateQueue=null,Ge(vs,Sn),Sn|=t,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=i!==null?i.baseLanes:n,Ge(vs,Sn),Sn|=r}else i!==null?(r=i.baseLanes|n,e.memoizedState=null):r=n,Ge(vs,Sn),Sn|=r;return rn(t,e,o,n),e.child}function B2(t,e){var n=e.ref;(t===null&&n!==null||t!==null&&t.ref!==n)&&(e.flags|=512,e.flags|=2097152)}function xv(t,e,n,r,o){var i=wn(n)?va:Qt.current;return i=qs(e,i),xs(e,o),n=xg(t,e,n,r,i,o),r=bg(),t!==null&&!gn?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~o,bo(t,e,o)):(Ze&&r&&ug(e),e.flags|=1,rn(t,e,n,o),e.child)}function f1(t,e,n,r,o){if(wn(n)){var i=!0;kd(e)}else i=!1;if(xs(e,o),e.stateNode===null)sd(t,e),N2(e,n,r),yv(e,n,r,o),r=!0;else if(t===null){var a=e.stateNode,s=e.memoizedProps;a.props=s;var u=a.context,l=n.contextType;typeof l=="object"&&l!==null?l=Qn(l):(l=wn(n)?va:Qt.current,l=qs(e,l));var c=n.getDerivedStateFromProps,d=typeof c=="function"||typeof a.getSnapshotBeforeUpdate=="function";d||typeof a.UNSAFE_componentWillReceiveProps!="function"&&typeof a.componentWillReceiveProps!="function"||(s!==r||u!==l)&&a1(e,a,r,l),qo=!1;var f=e.memoizedState;a.state=f,Pd(e,r,a,o),u=e.memoizedState,s!==r||f!==u||yn.current||qo?(typeof c=="function"&&(gv(e,n,c,r),u=e.memoizedState),(s=qo||i1(e,n,s,r,f,u,l))?(d||typeof a.UNSAFE_componentWillMount!="function"&&typeof a.componentWillMount!="function"||(typeof a.componentWillMount=="function"&&a.componentWillMount(),typeof a.UNSAFE_componentWillMount=="function"&&a.UNSAFE_componentWillMount()),typeof a.componentDidMount=="function"&&(e.flags|=4194308)):(typeof a.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=r,e.memoizedState=u),a.props=r,a.state=u,a.context=l,r=s):(typeof a.componentDidMount=="function"&&(e.flags|=4194308),r=!1)}else{a=e.stateNode,f2(t,e),s=e.memoizedProps,l=e.type===e.elementType?s:ur(e.type,s),a.props=l,d=e.pendingProps,f=a.context,u=n.contextType,typeof u=="object"&&u!==null?u=Qn(u):(u=wn(n)?va:Qt.current,u=qs(e,u));var h=n.getDerivedStateFromProps;(c=typeof h=="function"||typeof a.getSnapshotBeforeUpdate=="function")||typeof a.UNSAFE_componentWillReceiveProps!="function"&&typeof a.componentWillReceiveProps!="function"||(s!==d||f!==u)&&a1(e,a,r,u),qo=!1,f=e.memoizedState,a.state=f,Pd(e,r,a,o);var v=e.memoizedState;s!==d||f!==v||yn.current||qo?(typeof h=="function"&&(gv(e,n,h,r),v=e.memoizedState),(l=qo||i1(e,n,l,r,f,v,u)||!1)?(c||typeof a.UNSAFE_componentWillUpdate!="function"&&typeof a.componentWillUpdate!="function"||(typeof a.componentWillUpdate=="function"&&a.componentWillUpdate(r,v,u),typeof a.UNSAFE_componentWillUpdate=="function"&&a.UNSAFE_componentWillUpdate(r,v,u)),typeof a.componentDidUpdate=="function"&&(e.flags|=4),typeof a.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof a.componentDidUpdate!="function"||s===t.memoizedProps&&f===t.memoizedState||(e.flags|=4),typeof a.getSnapshotBeforeUpdate!="function"||s===t.memoizedProps&&f===t.memoizedState||(e.flags|=1024),e.memoizedProps=r,e.memoizedState=v),a.props=r,a.state=v,a.context=u,r=l):(typeof a.componentDidUpdate!="function"||s===t.memoizedProps&&f===t.memoizedState||(e.flags|=4),typeof a.getSnapshotBeforeUpdate!="function"||s===t.memoizedProps&&f===t.memoizedState||(e.flags|=1024),r=!1)}return bv(t,e,n,r,i,o)}function bv(t,e,n,r,o,i){B2(t,e);var a=(e.flags&128)!==0;if(!r&&!a)return o&&Q0(e,n,!1),bo(t,e,i);r=e.stateNode,MI.current=e;var s=a&&typeof n.getDerivedStateFromError!="function"?null:r.render();return e.flags|=1,t!==null&&a?(e.child=Xs(e,t.child,null,i),e.child=Xs(e,null,s,i)):rn(t,e,s,i),e.memoizedState=r.state,o&&Q0(e,n,!0),e.child}function $2(t){var e=t.stateNode;e.pendingContext?Y0(t,e.pendingContext,e.pendingContext!==e.context):e.context&&Y0(t,e.context,!1),mg(t,e.containerInfo)}function h1(t,e,n,r,o){return Ks(),cg(o),e.flags|=256,rn(t,e,n,r),e.child}var _v={dehydrated:null,treeContext:null,retryLane:0};function Ev(t){return{baseLanes:t,cachePool:null,transitions:null}}function j2(t,e,n){var r=e.pendingProps,o=tt.current,i=!1,a=(e.flags&128)!==0,s;if((s=a)||(s=t!==null&&t.memoizedState===null?!1:(o&2)!==0),s?(i=!0,e.flags&=-129):(t===null||t.memoizedState!==null)&&(o|=1),Ge(tt,o&1),t===null)return vv(e),t=e.memoizedState,t!==null&&(t=t.dehydrated,t!==null)?(e.mode&1?t.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(a=r.children,t=r.fallback,i?(r=e.mode,i=e.child,a={mode:"hidden",children:a},!(r&1)&&i!==null?(i.childLanes=0,i.pendingProps=a):i=Df(a,r,0,null),t=ha(t,r,n,null),i.return=e,t.return=e,i.sibling=t,e.child=i,e.child.memoizedState=Ev(n),e.memoizedState=_v,t):Cg(e,a));if(o=t.memoizedState,o!==null&&(s=o.dehydrated,s!==null))return LI(t,e,a,r,s,o,n);if(i){i=r.fallback,a=e.mode,o=t.child,s=o.sibling;var u={mode:"hidden",children:r.children};return!(a&1)&&e.child!==o?(r=e.child,r.childLanes=0,r.pendingProps=u,e.deletions=null):(r=wi(o,u),r.subtreeFlags=o.subtreeFlags&14680064),s!==null?i=wi(s,i):(i=ha(i,a,n,null),i.flags|=2),i.return=e,r.return=e,r.sibling=i,e.child=r,r=i,i=e.child,a=t.child.memoizedState,a=a===null?Ev(n):{baseLanes:a.baseLanes|n,cachePool:null,transitions:a.transitions},i.memoizedState=a,i.childLanes=t.childLanes&~n,e.memoizedState=_v,r}return i=t.child,t=i.sibling,r=wi(i,{mode:"visible",children:r.children}),!(e.mode&1)&&(r.lanes=n),r.return=e,r.sibling=null,t!==null&&(n=e.deletions,n===null?(e.deletions=[t],e.flags|=16):n.push(t)),e.child=r,e.memoizedState=null,r}function Cg(t,e){return e=Df({mode:"visible",children:e},t.mode,0,null),e.return=t,t.child=e}function _c(t,e,n,r){return r!==null&&cg(r),Xs(e,t.child,null,n),t=Cg(e,e.pendingProps.children),t.flags|=2,e.memoizedState=null,t}function LI(t,e,n,r,o,i,a){if(n)return e.flags&256?(e.flags&=-257,r=Uh(Error(Y(422))),_c(t,e,a,r)):e.memoizedState!==null?(e.child=t.child,e.flags|=128,null):(i=r.fallback,o=e.mode,r=Df({mode:"visible",children:r.children},o,0,null),i=ha(i,o,a,null),i.flags|=2,r.return=e,i.return=e,r.sibling=i,e.child=r,e.mode&1&&Xs(e,t.child,null,a),e.child.memoizedState=Ev(a),e.memoizedState=_v,i);if(!(e.mode&1))return _c(t,e,a,null);if(o.data==="$!"){if(r=o.nextSibling&&o.nextSibling.dataset,r)var s=r.dgst;return r=s,i=Error(Y(419)),r=Uh(i,r,void 0),_c(t,e,a,r)}if(s=(a&t.childLanes)!==0,gn||s){if(r=It,r!==null){switch(a&-a){case 4:o=2;break;case 16:o=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:o=32;break;case 536870912:o=268435456;break;default:o=0}o=o&(r.suspendedLanes|a)?0:o,o!==0&&o!==i.retryLane&&(i.retryLane=o,xo(t,o),gr(r,t,o,-1))}return Ag(),r=Uh(Error(Y(421))),_c(t,e,a,r)}return o.data==="$?"?(e.flags|=128,e.child=t.child,e=YI.bind(null,t),o._reactRetry=e,null):(t=i.treeContext,In=vi(o.nextSibling),Nn=e,Ze=!0,hr=null,t!==null&&(Un[zn++]=po,Un[zn++]=vo,Un[zn++]=ma,po=t.id,vo=t.overflow,ma=e),e=Cg(e,r.children),e.flags|=4096,e)}function p1(t,e,n){t.lanes|=e;var r=t.alternate;r!==null&&(r.lanes|=e),mv(t.return,e,n)}function zh(t,e,n,r,o){var i=t.memoizedState;i===null?t.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:o}:(i.isBackwards=e,i.rendering=null,i.renderingStartTime=0,i.last=r,i.tail=n,i.tailMode=o)}function W2(t,e,n){var r=e.pendingProps,o=r.revealOrder,i=r.tail;if(rn(t,e,r.children,n),r=tt.current,r&2)r=r&1|2,e.flags|=128;else{if(t!==null&&t.flags&128)e:for(t=e.child;t!==null;){if(t.tag===13)t.memoizedState!==null&&p1(t,n,e);else if(t.tag===19)p1(t,n,e);else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;t.sibling===null;){if(t.return===null||t.return===e)break e;t=t.return}t.sibling.return=t.return,t=t.sibling}r&=1}if(Ge(tt,r),!(e.mode&1))e.memoizedState=null;else switch(o){case"forwards":for(n=e.child,o=null;n!==null;)t=n.alternate,t!==null&&Dd(t)===null&&(o=n),n=n.sibling;n=o,n===null?(o=e.child,e.child=null):(o=n.sibling,n.sibling=null),zh(e,!1,o,n,i);break;case"backwards":for(n=null,o=e.child,e.child=null;o!==null;){if(t=o.alternate,t!==null&&Dd(t)===null){e.child=o;break}t=o.sibling,o.sibling=n,n=o,o=t}zh(e,!0,n,null,i);break;case"together":zh(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function sd(t,e){!(e.mode&1)&&t!==null&&(t.alternate=null,e.alternate=null,e.flags|=2)}function bo(t,e,n){if(t!==null&&(e.dependencies=t.dependencies),ya|=e.lanes,!(n&e.childLanes))return null;if(t!==null&&e.child!==t.child)throw Error(Y(153));if(e.child!==null){for(t=e.child,n=wi(t,t.pendingProps),e.child=n,n.return=e;t.sibling!==null;)t=t.sibling,n=n.sibling=wi(t,t.pendingProps),n.return=e;n.sibling=null}return e.child}function BI(t,e,n){switch(e.tag){case 3:$2(e),Ks();break;case 5:h2(e);break;case 1:wn(e.type)&&kd(e);break;case 4:mg(e,e.stateNode.containerInfo);break;case 10:var r=e.type._context,o=e.memoizedProps.value;Ge(Id,r._currentValue),r._currentValue=o;break;case 13:if(r=e.memoizedState,r!==null)return r.dehydrated!==null?(Ge(tt,tt.current&1),e.flags|=128,null):n&e.child.childLanes?j2(t,e,n):(Ge(tt,tt.current&1),t=bo(t,e,n),t!==null?t.sibling:null);Ge(tt,tt.current&1);break;case 19:if(r=(n&e.childLanes)!==0,t.flags&128){if(r)return W2(t,e,n);e.flags|=128}if(o=e.memoizedState,o!==null&&(o.rendering=null,o.tail=null,o.lastEffect=null),Ge(tt,tt.current),r)break;return null;case 22:case 23:return e.lanes=0,L2(t,e,n)}return bo(t,e,n)}var U2,Cv,z2,V2;U2=function(t,e){for(var n=e.child;n!==null;){if(n.tag===5||n.tag===6)t.appendChild(n.stateNode);else if(n.tag!==4&&n.child!==null){n.child.return=n,n=n.child;continue}if(n===e)break;for(;n.sibling===null;){if(n.return===null||n.return===e)return;n=n.return}n.sibling.return=n.return,n=n.sibling}};Cv=function(){};z2=function(t,e,n,r){var o=t.memoizedProps;if(o!==r){t=e.stateNode,ea(zr.current);var i=null;switch(n){case"input":o=Gp(t,o),r=Gp(t,r),i=[];break;case"select":o=it({},o,{value:void 0}),r=it({},r,{value:void 0}),i=[];break;case"textarea":o=Xp(t,o),r=Xp(t,r),i=[];break;default:typeof o.onClick!="function"&&typeof r.onClick=="function"&&(t.onclick=Cd)}Qp(n,r);var a;n=null;for(l in o)if(!r.hasOwnProperty(l)&&o.hasOwnProperty(l)&&o[l]!=null)if(l==="style"){var s=o[l];for(a in s)s.hasOwnProperty(a)&&(n||(n={}),n[a]="")}else l!=="dangerouslySetInnerHTML"&&l!=="children"&&l!=="suppressContentEditableWarning"&&l!=="suppressHydrationWarning"&&l!=="autoFocus"&&(nl.hasOwnProperty(l)?i||(i=[]):(i=i||[]).push(l,null));for(l in r){var u=r[l];if(s=o!=null?o[l]:void 0,r.hasOwnProperty(l)&&u!==s&&(u!=null||s!=null))if(l==="style")if(s){for(a in s)!s.hasOwnProperty(a)||u&&u.hasOwnProperty(a)||(n||(n={}),n[a]="");for(a in u)u.hasOwnProperty(a)&&s[a]!==u[a]&&(n||(n={}),n[a]=u[a])}else n||(i||(i=[]),i.push(l,n)),n=u;else l==="dangerouslySetInnerHTML"?(u=u?u.__html:void 0,s=s?s.__html:void 0,u!=null&&s!==u&&(i=i||[]).push(l,u)):l==="children"?typeof u!="string"&&typeof u!="number"||(i=i||[]).push(l,""+u):l!=="suppressContentEditableWarning"&&l!=="suppressHydrationWarning"&&(nl.hasOwnProperty(l)?(u!=null&&l==="onScroll"&&Xe("scroll",t),i||s===u||(i=[])):(i=i||[]).push(l,u))}n&&(i=i||[]).push("style",n);var l=i;(e.updateQueue=l)&&(e.flags|=4)}};V2=function(t,e,n,r){n!==r&&(e.flags|=4)};function Su(t,e){if(!Ze)switch(t.tailMode){case"hidden":e=t.tail;for(var n=null;e!==null;)e.alternate!==null&&(n=e),e=e.sibling;n===null?t.tail=null:n.sibling=null;break;case"collapsed":n=t.tail;for(var r=null;n!==null;)n.alternate!==null&&(r=n),n=n.sibling;r===null?e||t.tail===null?t.tail=null:t.tail.sibling=null:r.sibling=null}}function zt(t){var e=t.alternate!==null&&t.alternate.child===t.child,n=0,r=0;if(e)for(var o=t.child;o!==null;)n|=o.lanes|o.childLanes,r|=o.subtreeFlags&14680064,r|=o.flags&14680064,o.return=t,o=o.sibling;else for(o=t.child;o!==null;)n|=o.lanes|o.childLanes,r|=o.subtreeFlags,r|=o.flags,o.return=t,o=o.sibling;return t.subtreeFlags|=r,t.childLanes=n,e}function $I(t,e,n){var r=e.pendingProps;switch(lg(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return zt(e),null;case 1:return wn(e.type)&&Sd(),zt(e),null;case 3:return r=e.stateNode,Ys(),Qe(yn),Qe(Qt),yg(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),(t===null||t.child===null)&&(xc(e)?e.flags|=4:t===null||t.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,hr!==null&&(Dv(hr),hr=null))),Cv(t,e),zt(e),null;case 5:gg(e);var o=ea(pl.current);if(n=e.type,t!==null&&e.stateNode!=null)z2(t,e,n,r,o),t.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!r){if(e.stateNode===null)throw Error(Y(166));return zt(e),null}if(t=ea(zr.current),xc(e)){r=e.stateNode,n=e.type;var i=e.memoizedProps;switch(r[Mr]=e,r[fl]=i,t=(e.mode&1)!==0,n){case"dialog":Xe("cancel",r),Xe("close",r);break;case"iframe":case"object":case"embed":Xe("load",r);break;case"video":case"audio":for(o=0;o<Lu.length;o++)Xe(Lu[o],r);break;case"source":Xe("error",r);break;case"img":case"image":case"link":Xe("error",r),Xe("load",r);break;case"details":Xe("toggle",r);break;case"input":E0(r,i),Xe("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!i.multiple},Xe("invalid",r);break;case"textarea":S0(r,i),Xe("invalid",r)}Qp(n,i),o=null;for(var a in i)if(i.hasOwnProperty(a)){var s=i[a];a==="children"?typeof s=="string"?r.textContent!==s&&(i.suppressHydrationWarning!==!0&&wc(r.textContent,s,t),o=["children",s]):typeof s=="number"&&r.textContent!==""+s&&(i.suppressHydrationWarning!==!0&&wc(r.textContent,s,t),o=["children",""+s]):nl.hasOwnProperty(a)&&s!=null&&a==="onScroll"&&Xe("scroll",r)}switch(n){case"input":dc(r),C0(r,i,!0);break;case"textarea":dc(r),k0(r);break;case"select":case"option":break;default:typeof i.onClick=="function"&&(r.onclick=Cd)}r=o,e.updateQueue=r,r!==null&&(e.flags|=4)}else{a=o.nodeType===9?o:o.ownerDocument,t==="http://www.w3.org/1999/xhtml"&&(t=yb(n)),t==="http://www.w3.org/1999/xhtml"?n==="script"?(t=a.createElement("div"),t.innerHTML="<script><\/script>",t=t.removeChild(t.firstChild)):typeof r.is=="string"?t=a.createElement(n,{is:r.is}):(t=a.createElement(n),n==="select"&&(a=t,r.multiple?a.multiple=!0:r.size&&(a.size=r.size))):t=a.createElementNS(t,n),t[Mr]=e,t[fl]=r,U2(t,e,!1,!1),e.stateNode=t;e:{switch(a=Jp(n,r),n){case"dialog":Xe("cancel",t),Xe("close",t),o=r;break;case"iframe":case"object":case"embed":Xe("load",t),o=r;break;case"video":case"audio":for(o=0;o<Lu.length;o++)Xe(Lu[o],t);o=r;break;case"source":Xe("error",t),o=r;break;case"img":case"image":case"link":Xe("error",t),Xe("load",t),o=r;break;case"details":Xe("toggle",t),o=r;break;case"input":E0(t,r),o=Gp(t,r),Xe("invalid",t);break;case"option":o=r;break;case"select":t._wrapperState={wasMultiple:!!r.multiple},o=it({},r,{value:void 0}),Xe("invalid",t);break;case"textarea":S0(t,r),o=Xp(t,r),Xe("invalid",t);break;default:o=r}Qp(n,o),s=o;for(i in s)if(s.hasOwnProperty(i)){var u=s[i];i==="style"?bb(t,u):i==="dangerouslySetInnerHTML"?(u=u?u.__html:void 0,u!=null&&wb(t,u)):i==="children"?typeof u=="string"?(n!=="textarea"||u!=="")&&rl(t,u):typeof u=="number"&&rl(t,""+u):i!=="suppressContentEditableWarning"&&i!=="suppressHydrationWarning"&&i!=="autoFocus"&&(nl.hasOwnProperty(i)?u!=null&&i==="onScroll"&&Xe("scroll",t):u!=null&&Km(t,i,u,a))}switch(n){case"input":dc(t),C0(t,r,!1);break;case"textarea":dc(t),k0(t);break;case"option":r.value!=null&&t.setAttribute("value",""+Si(r.value));break;case"select":t.multiple=!!r.multiple,i=r.value,i!=null?ms(t,!!r.multiple,i,!1):r.defaultValue!=null&&ms(t,!!r.multiple,r.defaultValue,!0);break;default:typeof o.onClick=="function"&&(t.onclick=Cd)}switch(n){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return zt(e),null;case 6:if(t&&e.stateNode!=null)V2(t,e,t.memoizedProps,r);else{if(typeof r!="string"&&e.stateNode===null)throw Error(Y(166));if(n=ea(pl.current),ea(zr.current),xc(e)){if(r=e.stateNode,n=e.memoizedProps,r[Mr]=e,(i=r.nodeValue!==n)&&(t=Nn,t!==null))switch(t.tag){case 3:wc(r.nodeValue,n,(t.mode&1)!==0);break;case 5:t.memoizedProps.suppressHydrationWarning!==!0&&wc(r.nodeValue,n,(t.mode&1)!==0)}i&&(e.flags|=4)}else r=(n.nodeType===9?n:n.ownerDocument).createTextNode(r),r[Mr]=e,e.stateNode=r}return zt(e),null;case 13:if(Qe(tt),r=e.memoizedState,t===null||t.memoizedState!==null&&t.memoizedState.dehydrated!==null){if(Ze&&In!==null&&e.mode&1&&!(e.flags&128))u2(),Ks(),e.flags|=98560,i=!1;else if(i=xc(e),r!==null&&r.dehydrated!==null){if(t===null){if(!i)throw Error(Y(318));if(i=e.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(Y(317));i[Mr]=e}else Ks(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;zt(e),i=!1}else hr!==null&&(Dv(hr),hr=null),i=!0;if(!i)return e.flags&65536?e:null}return e.flags&128?(e.lanes=n,e):(r=r!==null,r!==(t!==null&&t.memoizedState!==null)&&r&&(e.child.flags|=8192,e.mode&1&&(t===null||tt.current&1?bt===0&&(bt=3):Ag())),e.updateQueue!==null&&(e.flags|=4),zt(e),null);case 4:return Ys(),Cv(t,e),t===null&&cl(e.stateNode.containerInfo),zt(e),null;case 10:return hg(e.type._context),zt(e),null;case 17:return wn(e.type)&&Sd(),zt(e),null;case 19:if(Qe(tt),i=e.memoizedState,i===null)return zt(e),null;if(r=(e.flags&128)!==0,a=i.rendering,a===null)if(r)Su(i,!1);else{if(bt!==0||t!==null&&t.flags&128)for(t=e.child;t!==null;){if(a=Dd(t),a!==null){for(e.flags|=128,Su(i,!1),r=a.updateQueue,r!==null&&(e.updateQueue=r,e.flags|=4),e.subtreeFlags=0,r=n,n=e.child;n!==null;)i=n,t=r,i.flags&=14680066,a=i.alternate,a===null?(i.childLanes=0,i.lanes=t,i.child=null,i.subtreeFlags=0,i.memoizedProps=null,i.memoizedState=null,i.updateQueue=null,i.dependencies=null,i.stateNode=null):(i.childLanes=a.childLanes,i.lanes=a.lanes,i.child=a.child,i.subtreeFlags=0,i.deletions=null,i.memoizedProps=a.memoizedProps,i.memoizedState=a.memoizedState,i.updateQueue=a.updateQueue,i.type=a.type,t=a.dependencies,i.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),n=n.sibling;return Ge(tt,tt.current&1|2),e.child}t=t.sibling}i.tail!==null&&ct()>Js&&(e.flags|=128,r=!0,Su(i,!1),e.lanes=4194304)}else{if(!r)if(t=Dd(a),t!==null){if(e.flags|=128,r=!0,n=t.updateQueue,n!==null&&(e.updateQueue=n,e.flags|=4),Su(i,!0),i.tail===null&&i.tailMode==="hidden"&&!a.alternate&&!Ze)return zt(e),null}else 2*ct()-i.renderingStartTime>Js&&n!==1073741824&&(e.flags|=128,r=!0,Su(i,!1),e.lanes=4194304);i.isBackwards?(a.sibling=e.child,e.child=a):(n=i.last,n!==null?n.sibling=a:e.child=a,i.last=a)}return i.tail!==null?(e=i.tail,i.rendering=e,i.tail=e.sibling,i.renderingStartTime=ct(),e.sibling=null,n=tt.current,Ge(tt,r?n&1|2:n&1),e):(zt(e),null);case 22:case 23:return Ig(),r=e.memoizedState!==null,t!==null&&t.memoizedState!==null!==r&&(e.flags|=8192),r&&e.mode&1?Sn&1073741824&&(zt(e),e.subtreeFlags&6&&(e.flags|=8192)):zt(e),null;case 24:return null;case 25:return null}throw Error(Y(156,e.tag))}function jI(t,e){switch(lg(e),e.tag){case 1:return wn(e.type)&&Sd(),t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 3:return Ys(),Qe(yn),Qe(Qt),yg(),t=e.flags,t&65536&&!(t&128)?(e.flags=t&-65537|128,e):null;case 5:return gg(e),null;case 13:if(Qe(tt),t=e.memoizedState,t!==null&&t.dehydrated!==null){if(e.alternate===null)throw Error(Y(340));Ks()}return t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 19:return Qe(tt),null;case 4:return Ys(),null;case 10:return hg(e.type._context),null;case 22:case 23:return Ig(),null;case 24:return null;default:return null}}var Ec=!1,Gt=!1,WI=typeof WeakSet=="function"?WeakSet:Set,re=null;function ps(t,e){var n=t.ref;if(n!==null)if(typeof n=="function")try{n(null)}catch(r){lt(t,e,r)}else n.current=null}function Sv(t,e,n){try{n()}catch(r){lt(t,e,r)}}var v1=!1;function UI(t,e){if(uv=bd,t=Xb(),sg(t)){if("selectionStart"in t)var n={start:t.selectionStart,end:t.selectionEnd};else e:{n=(n=t.ownerDocument)&&n.defaultView||window;var r=n.getSelection&&n.getSelection();if(r&&r.rangeCount!==0){n=r.anchorNode;var o=r.anchorOffset,i=r.focusNode;r=r.focusOffset;try{n.nodeType,i.nodeType}catch{n=null;break e}var a=0,s=-1,u=-1,l=0,c=0,d=t,f=null;t:for(;;){for(var h;d!==n||o!==0&&d.nodeType!==3||(s=a+o),d!==i||r!==0&&d.nodeType!==3||(u=a+r),d.nodeType===3&&(a+=d.nodeValue.length),(h=d.firstChild)!==null;)f=d,d=h;for(;;){if(d===t)break t;if(f===n&&++l===o&&(s=a),f===i&&++c===r&&(u=a),(h=d.nextSibling)!==null)break;d=f,f=d.parentNode}d=h}n=s===-1||u===-1?null:{start:s,end:u}}else n=null}n=n||{start:0,end:0}}else n=null;for(lv={focusedElem:t,selectionRange:n},bd=!1,re=e;re!==null;)if(e=re,t=e.child,(e.subtreeFlags&1028)!==0&&t!==null)t.return=e,re=t;else for(;re!==null;){e=re;try{var v=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(v!==null){var p=v.memoizedProps,m=v.memoizedState,g=e.stateNode,y=g.getSnapshotBeforeUpdate(e.elementType===e.type?p:ur(e.type,p),m);g.__reactInternalSnapshotBeforeUpdate=y}break;case 3:var w=e.stateNode.containerInfo;w.nodeType===1?w.textContent="":w.nodeType===9&&w.documentElement&&w.removeChild(w.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(Y(163))}}catch(x){lt(e,e.return,x)}if(t=e.sibling,t!==null){t.return=e.return,re=t;break}re=e.return}return v=v1,v1=!1,v}function Gu(t,e,n){var r=e.updateQueue;if(r=r!==null?r.lastEffect:null,r!==null){var o=r=r.next;do{if((o.tag&t)===t){var i=o.destroy;o.destroy=void 0,i!==void 0&&Sv(e,n,i)}o=o.next}while(o!==r)}}function Af(t,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var n=e=e.next;do{if((n.tag&t)===t){var r=n.create;n.destroy=r()}n=n.next}while(n!==e)}}function kv(t){var e=t.ref;if(e!==null){var n=t.stateNode;switch(t.tag){case 5:t=n;break;default:t=n}typeof e=="function"?e(t):e.current=t}}function H2(t){var e=t.alternate;e!==null&&(t.alternate=null,H2(e)),t.child=null,t.deletions=null,t.sibling=null,t.tag===5&&(e=t.stateNode,e!==null&&(delete e[Mr],delete e[fl],delete e[fv],delete e[CI],delete e[SI])),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}function G2(t){return t.tag===5||t.tag===3||t.tag===4}function m1(t){e:for(;;){for(;t.sibling===null;){if(t.return===null||G2(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;t.tag!==5&&t.tag!==6&&t.tag!==18;){if(t.flags&2||t.child===null||t.tag===4)continue e;t.child.return=t,t=t.child}if(!(t.flags&2))return t.stateNode}}function Rv(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.nodeType===8?n.parentNode.insertBefore(t,e):n.insertBefore(t,e):(n.nodeType===8?(e=n.parentNode,e.insertBefore(t,n)):(e=n,e.appendChild(t)),n=n._reactRootContainer,n!=null||e.onclick!==null||(e.onclick=Cd));else if(r!==4&&(t=t.child,t!==null))for(Rv(t,e,n),t=t.sibling;t!==null;)Rv(t,e,n),t=t.sibling}function Tv(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.insertBefore(t,e):n.appendChild(t);else if(r!==4&&(t=t.child,t!==null))for(Tv(t,e,n),t=t.sibling;t!==null;)Tv(t,e,n),t=t.sibling}var Ot=null,dr=!1;function Lo(t,e,n){for(n=n.child;n!==null;)q2(t,e,n),n=n.sibling}function q2(t,e,n){if(Ur&&typeof Ur.onCommitFiberUnmount=="function")try{Ur.onCommitFiberUnmount(_f,n)}catch{}switch(n.tag){case 5:Gt||ps(n,e);case 6:var r=Ot,o=dr;Ot=null,Lo(t,e,n),Ot=r,dr=o,Ot!==null&&(dr?(t=Ot,n=n.stateNode,t.nodeType===8?t.parentNode.removeChild(n):t.removeChild(n)):Ot.removeChild(n.stateNode));break;case 18:Ot!==null&&(dr?(t=Ot,n=n.stateNode,t.nodeType===8?Mh(t.parentNode,n):t.nodeType===1&&Mh(t,n),sl(t)):Mh(Ot,n.stateNode));break;case 4:r=Ot,o=dr,Ot=n.stateNode.containerInfo,dr=!0,Lo(t,e,n),Ot=r,dr=o;break;case 0:case 11:case 14:case 15:if(!Gt&&(r=n.updateQueue,r!==null&&(r=r.lastEffect,r!==null))){o=r=r.next;do{var i=o,a=i.destroy;i=i.tag,a!==void 0&&(i&2||i&4)&&Sv(n,e,a),o=o.next}while(o!==r)}Lo(t,e,n);break;case 1:if(!Gt&&(ps(n,e),r=n.stateNode,typeof r.componentWillUnmount=="function"))try{r.props=n.memoizedProps,r.state=n.memoizedState,r.componentWillUnmount()}catch(s){lt(n,e,s)}Lo(t,e,n);break;case 21:Lo(t,e,n);break;case 22:n.mode&1?(Gt=(r=Gt)||n.memoizedState!==null,Lo(t,e,n),Gt=r):Lo(t,e,n);break;default:Lo(t,e,n)}}function g1(t){var e=t.updateQueue;if(e!==null){t.updateQueue=null;var n=t.stateNode;n===null&&(n=t.stateNode=new WI),e.forEach(function(r){var o=QI.bind(null,t,r);n.has(r)||(n.add(r),r.then(o,o))})}}function ir(t,e){var n=e.deletions;if(n!==null)for(var r=0;r<n.length;r++){var o=n[r];try{var i=t,a=e,s=a;e:for(;s!==null;){switch(s.tag){case 5:Ot=s.stateNode,dr=!1;break e;case 3:Ot=s.stateNode.containerInfo,dr=!0;break e;case 4:Ot=s.stateNode.containerInfo,dr=!0;break e}s=s.return}if(Ot===null)throw Error(Y(160));q2(i,a,o),Ot=null,dr=!1;var u=o.alternate;u!==null&&(u.return=null),o.return=null}catch(l){lt(o,e,l)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)K2(e,t),e=e.sibling}function K2(t,e){var n=t.alternate,r=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:if(ir(e,t),Rr(t),r&4){try{Gu(3,t,t.return),Af(3,t)}catch(p){lt(t,t.return,p)}try{Gu(5,t,t.return)}catch(p){lt(t,t.return,p)}}break;case 1:ir(e,t),Rr(t),r&512&&n!==null&&ps(n,n.return);break;case 5:if(ir(e,t),Rr(t),r&512&&n!==null&&ps(n,n.return),t.flags&32){var o=t.stateNode;try{rl(o,"")}catch(p){lt(t,t.return,p)}}if(r&4&&(o=t.stateNode,o!=null)){var i=t.memoizedProps,a=n!==null?n.memoizedProps:i,s=t.type,u=t.updateQueue;if(t.updateQueue=null,u!==null)try{s==="input"&&i.type==="radio"&&i.name!=null&&mb(o,i),Jp(s,a);var l=Jp(s,i);for(a=0;a<u.length;a+=2){var c=u[a],d=u[a+1];c==="style"?bb(o,d):c==="dangerouslySetInnerHTML"?wb(o,d):c==="children"?rl(o,d):Km(o,c,d,l)}switch(s){case"input":qp(o,i);break;case"textarea":gb(o,i);break;case"select":var f=o._wrapperState.wasMultiple;o._wrapperState.wasMultiple=!!i.multiple;var h=i.value;h!=null?ms(o,!!i.multiple,h,!1):f!==!!i.multiple&&(i.defaultValue!=null?ms(o,!!i.multiple,i.defaultValue,!0):ms(o,!!i.multiple,i.multiple?[]:"",!1))}o[fl]=i}catch(p){lt(t,t.return,p)}}break;case 6:if(ir(e,t),Rr(t),r&4){if(t.stateNode===null)throw Error(Y(162));o=t.stateNode,i=t.memoizedProps;try{o.nodeValue=i}catch(p){lt(t,t.return,p)}}break;case 3:if(ir(e,t),Rr(t),r&4&&n!==null&&n.memoizedState.isDehydrated)try{sl(e.containerInfo)}catch(p){lt(t,t.return,p)}break;case 4:ir(e,t),Rr(t);break;case 13:ir(e,t),Rr(t),o=t.child,o.flags&8192&&(i=o.memoizedState!==null,o.stateNode.isHidden=i,!i||o.alternate!==null&&o.alternate.memoizedState!==null||(Rg=ct())),r&4&&g1(t);break;case 22:if(c=n!==null&&n.memoizedState!==null,t.mode&1?(Gt=(l=Gt)||c,ir(e,t),Gt=l):ir(e,t),Rr(t),r&8192){if(l=t.memoizedState!==null,(t.stateNode.isHidden=l)&&!c&&t.mode&1)for(re=t,c=t.child;c!==null;){for(d=re=c;re!==null;){switch(f=re,h=f.child,f.tag){case 0:case 11:case 14:case 15:Gu(4,f,f.return);break;case 1:ps(f,f.return);var v=f.stateNode;if(typeof v.componentWillUnmount=="function"){r=f,n=f.return;try{e=r,v.props=e.memoizedProps,v.state=e.memoizedState,v.componentWillUnmount()}catch(p){lt(r,n,p)}}break;case 5:ps(f,f.return);break;case 22:if(f.memoizedState!==null){w1(d);continue}}h!==null?(h.return=f,re=h):w1(d)}c=c.sibling}e:for(c=null,d=t;;){if(d.tag===5){if(c===null){c=d;try{o=d.stateNode,l?(i=o.style,typeof i.setProperty=="function"?i.setProperty("display","none","important"):i.display="none"):(s=d.stateNode,u=d.memoizedProps.style,a=u!=null&&u.hasOwnProperty("display")?u.display:null,s.style.display=xb("display",a))}catch(p){lt(t,t.return,p)}}}else if(d.tag===6){if(c===null)try{d.stateNode.nodeValue=l?"":d.memoizedProps}catch(p){lt(t,t.return,p)}}else if((d.tag!==22&&d.tag!==23||d.memoizedState===null||d===t)&&d.child!==null){d.child.return=d,d=d.child;continue}if(d===t)break e;for(;d.sibling===null;){if(d.return===null||d.return===t)break e;c===d&&(c=null),d=d.return}c===d&&(c=null),d.sibling.return=d.return,d=d.sibling}}break;case 19:ir(e,t),Rr(t),r&4&&g1(t);break;case 21:break;default:ir(e,t),Rr(t)}}function Rr(t){var e=t.flags;if(e&2){try{e:{for(var n=t.return;n!==null;){if(G2(n)){var r=n;break e}n=n.return}throw Error(Y(160))}switch(r.tag){case 5:var o=r.stateNode;r.flags&32&&(rl(o,""),r.flags&=-33);var i=m1(t);Tv(t,i,o);break;case 3:case 4:var a=r.stateNode.containerInfo,s=m1(t);Rv(t,s,a);break;default:throw Error(Y(161))}}catch(u){lt(t,t.return,u)}t.flags&=-3}e&4096&&(t.flags&=-4097)}function zI(t,e,n){re=t,X2(t)}function X2(t,e,n){for(var r=(t.mode&1)!==0;re!==null;){var o=re,i=o.child;if(o.tag===22&&r){var a=o.memoizedState!==null||Ec;if(!a){var s=o.alternate,u=s!==null&&s.memoizedState!==null||Gt;s=Ec;var l=Gt;if(Ec=a,(Gt=u)&&!l)for(re=o;re!==null;)a=re,u=a.child,a.tag===22&&a.memoizedState!==null?x1(o):u!==null?(u.return=a,re=u):x1(o);for(;i!==null;)re=i,X2(i),i=i.sibling;re=o,Ec=s,Gt=l}y1(t)}else o.subtreeFlags&8772&&i!==null?(i.return=o,re=i):y1(t)}}function y1(t){for(;re!==null;){var e=re;if(e.flags&8772){var n=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:Gt||Af(5,e);break;case 1:var r=e.stateNode;if(e.flags&4&&!Gt)if(n===null)r.componentDidMount();else{var o=e.elementType===e.type?n.memoizedProps:ur(e.type,n.memoizedProps);r.componentDidUpdate(o,n.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var i=e.updateQueue;i!==null&&n1(e,i,r);break;case 3:var a=e.updateQueue;if(a!==null){if(n=null,e.child!==null)switch(e.child.tag){case 5:n=e.child.stateNode;break;case 1:n=e.child.stateNode}n1(e,a,n)}break;case 5:var s=e.stateNode;if(n===null&&e.flags&4){n=s;var u=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":u.autoFocus&&n.focus();break;case"img":u.src&&(n.src=u.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var l=e.alternate;if(l!==null){var c=l.memoizedState;if(c!==null){var d=c.dehydrated;d!==null&&sl(d)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(Y(163))}Gt||e.flags&512&&kv(e)}catch(f){lt(e,e.return,f)}}if(e===t){re=null;break}if(n=e.sibling,n!==null){n.return=e.return,re=n;break}re=e.return}}function w1(t){for(;re!==null;){var e=re;if(e===t){re=null;break}var n=e.sibling;if(n!==null){n.return=e.return,re=n;break}re=e.return}}function x1(t){for(;re!==null;){var e=re;try{switch(e.tag){case 0:case 11:case 15:var n=e.return;try{Af(4,e)}catch(u){lt(e,n,u)}break;case 1:var r=e.stateNode;if(typeof r.componentDidMount=="function"){var o=e.return;try{r.componentDidMount()}catch(u){lt(e,o,u)}}var i=e.return;try{kv(e)}catch(u){lt(e,i,u)}break;case 5:var a=e.return;try{kv(e)}catch(u){lt(e,a,u)}}}catch(u){lt(e,e.return,u)}if(e===t){re=null;break}var s=e.sibling;if(s!==null){s.return=e.return,re=s;break}re=e.return}}var VI=Math.ceil,Fd=So.ReactCurrentDispatcher,Sg=So.ReactCurrentOwner,Xn=So.ReactCurrentBatchConfig,Oe=0,It=null,ht=null,Bt=0,Sn=0,vs=Di(0),bt=0,yl=null,ya=0,Pf=0,kg=0,qu=null,hn=null,Rg=0,Js=1/0,so=null,Md=!1,Iv=null,gi=null,Cc=!1,ui=null,Ld=0,Ku=0,Av=null,ud=-1,ld=0;function an(){return Oe&6?ct():ud!==-1?ud:ud=ct()}function yi(t){return t.mode&1?Oe&2&&Bt!==0?Bt&-Bt:RI.transition!==null?(ld===0&&(ld=Nb()),ld):(t=$e,t!==0||(t=window.event,t=t===void 0?16:jb(t.type)),t):1}function gr(t,e,n,r){if(50<Ku)throw Ku=0,Av=null,Error(Y(185));Bl(t,n,r),(!(Oe&2)||t!==It)&&(t===It&&(!(Oe&2)&&(Pf|=n),bt===4&&Xo(t,Bt)),xn(t,r),n===1&&Oe===0&&!(e.mode&1)&&(Js=ct()+500,Rf&&Ni()))}function xn(t,e){var n=t.callbackNode;RT(t,e);var r=xd(t,t===It?Bt:0);if(r===0)n!==null&&I0(n),t.callbackNode=null,t.callbackPriority=0;else if(e=r&-r,t.callbackPriority!==e){if(n!=null&&I0(n),e===1)t.tag===0?kI(b1.bind(null,t)):i2(b1.bind(null,t)),_I(function(){!(Oe&6)&&Ni()}),n=null;else{switch(Ob(r)){case 1:n=Zm;break;case 4:n=Pb;break;case 16:n=wd;break;case 536870912:n=Db;break;default:n=wd}n=r_(n,Y2.bind(null,t))}t.callbackPriority=e,t.callbackNode=n}}function Y2(t,e){if(ud=-1,ld=0,Oe&6)throw Error(Y(327));var n=t.callbackNode;if(bs()&&t.callbackNode!==n)return null;var r=xd(t,t===It?Bt:0);if(r===0)return null;if(r&30||r&t.expiredLanes||e)e=Bd(t,r);else{e=r;var o=Oe;Oe|=2;var i=J2();(It!==t||Bt!==e)&&(so=null,Js=ct()+500,fa(t,e));do try{qI();break}catch(s){Q2(t,s)}while(!0);fg(),Fd.current=i,Oe=o,ht!==null?e=0:(It=null,Bt=0,e=bt)}if(e!==0){if(e===2&&(o=rv(t),o!==0&&(r=o,e=Pv(t,o))),e===1)throw n=yl,fa(t,0),Xo(t,r),xn(t,ct()),n;if(e===6)Xo(t,r);else{if(o=t.current.alternate,!(r&30)&&!HI(o)&&(e=Bd(t,r),e===2&&(i=rv(t),i!==0&&(r=i,e=Pv(t,i))),e===1))throw n=yl,fa(t,0),Xo(t,r),xn(t,ct()),n;switch(t.finishedWork=o,t.finishedLanes=r,e){case 0:case 1:throw Error(Y(345));case 2:Gi(t,hn,so);break;case 3:if(Xo(t,r),(r&130023424)===r&&(e=Rg+500-ct(),10<e)){if(xd(t,0)!==0)break;if(o=t.suspendedLanes,(o&r)!==r){an(),t.pingedLanes|=t.suspendedLanes&o;break}t.timeoutHandle=dv(Gi.bind(null,t,hn,so),e);break}Gi(t,hn,so);break;case 4:if(Xo(t,r),(r&4194240)===r)break;for(e=t.eventTimes,o=-1;0<r;){var a=31-mr(r);i=1<<a,a=e[a],a>o&&(o=a),r&=~i}if(r=o,r=ct()-r,r=(120>r?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*VI(r/1960))-r,10<r){t.timeoutHandle=dv(Gi.bind(null,t,hn,so),r);break}Gi(t,hn,so);break;case 5:Gi(t,hn,so);break;default:throw Error(Y(329))}}}return xn(t,ct()),t.callbackNode===n?Y2.bind(null,t):null}function Pv(t,e){var n=qu;return t.current.memoizedState.isDehydrated&&(fa(t,e).flags|=256),t=Bd(t,e),t!==2&&(e=hn,hn=n,e!==null&&Dv(e)),t}function Dv(t){hn===null?hn=t:hn.push.apply(hn,t)}function HI(t){for(var e=t;;){if(e.flags&16384){var n=e.updateQueue;if(n!==null&&(n=n.stores,n!==null))for(var r=0;r<n.length;r++){var o=n[r],i=o.getSnapshot;o=o.value;try{if(!wr(i(),o))return!1}catch{return!1}}}if(n=e.child,e.subtreeFlags&16384&&n!==null)n.return=e,e=n;else{if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function Xo(t,e){for(e&=~kg,e&=~Pf,t.suspendedLanes|=e,t.pingedLanes&=~e,t=t.expirationTimes;0<e;){var n=31-mr(e),r=1<<n;t[n]=-1,e&=~r}}function b1(t){if(Oe&6)throw Error(Y(327));bs();var e=xd(t,0);if(!(e&1))return xn(t,ct()),null;var n=Bd(t,e);if(t.tag!==0&&n===2){var r=rv(t);r!==0&&(e=r,n=Pv(t,r))}if(n===1)throw n=yl,fa(t,0),Xo(t,e),xn(t,ct()),n;if(n===6)throw Error(Y(345));return t.finishedWork=t.current.alternate,t.finishedLanes=e,Gi(t,hn,so),xn(t,ct()),null}function Tg(t,e){var n=Oe;Oe|=1;try{return t(e)}finally{Oe=n,Oe===0&&(Js=ct()+500,Rf&&Ni())}}function wa(t){ui!==null&&ui.tag===0&&!(Oe&6)&&bs();var e=Oe;Oe|=1;var n=Xn.transition,r=$e;try{if(Xn.transition=null,$e=1,t)return t()}finally{$e=r,Xn.transition=n,Oe=e,!(Oe&6)&&Ni()}}function Ig(){Sn=vs.current,Qe(vs)}function fa(t,e){t.finishedWork=null,t.finishedLanes=0;var n=t.timeoutHandle;if(n!==-1&&(t.timeoutHandle=-1,bI(n)),ht!==null)for(n=ht.return;n!==null;){var r=n;switch(lg(r),r.tag){case 1:r=r.type.childContextTypes,r!=null&&Sd();break;case 3:Ys(),Qe(yn),Qe(Qt),yg();break;case 5:gg(r);break;case 4:Ys();break;case 13:Qe(tt);break;case 19:Qe(tt);break;case 10:hg(r.type._context);break;case 22:case 23:Ig()}n=n.return}if(It=t,ht=t=wi(t.current,null),Bt=Sn=e,bt=0,yl=null,kg=Pf=ya=0,hn=qu=null,Zi!==null){for(e=0;e<Zi.length;e++)if(n=Zi[e],r=n.interleaved,r!==null){n.interleaved=null;var o=r.next,i=n.pending;if(i!==null){var a=i.next;i.next=o,r.next=a}n.pending=r}Zi=null}return t}function Q2(t,e){do{var n=ht;try{if(fg(),id.current=Od,Nd){for(var r=ot.memoizedState;r!==null;){var o=r.queue;o!==null&&(o.pending=null),r=r.next}Nd=!1}if(ga=0,Tt=wt=ot=null,Hu=!1,vl=0,Sg.current=null,n===null||n.return===null){bt=1,yl=e,ht=null;break}e:{var i=t,a=n.return,s=n,u=e;if(e=Bt,s.flags|=32768,u!==null&&typeof u=="object"&&typeof u.then=="function"){var l=u,c=s,d=c.tag;if(!(c.mode&1)&&(d===0||d===11||d===15)){var f=c.alternate;f?(c.updateQueue=f.updateQueue,c.memoizedState=f.memoizedState,c.lanes=f.lanes):(c.updateQueue=null,c.memoizedState=null)}var h=u1(a);if(h!==null){h.flags&=-257,l1(h,a,s,i,e),h.mode&1&&s1(i,l,e),e=h,u=l;var v=e.updateQueue;if(v===null){var p=new Set;p.add(u),e.updateQueue=p}else v.add(u);break e}else{if(!(e&1)){s1(i,l,e),Ag();break e}u=Error(Y(426))}}else if(Ze&&s.mode&1){var m=u1(a);if(m!==null){!(m.flags&65536)&&(m.flags|=256),l1(m,a,s,i,e),cg(Qs(u,s));break e}}i=u=Qs(u,s),bt!==4&&(bt=2),qu===null?qu=[i]:qu.push(i),i=a;do{switch(i.tag){case 3:i.flags|=65536,e&=-e,i.lanes|=e;var g=O2(i,u,e);t1(i,g);break e;case 1:s=u;var y=i.type,w=i.stateNode;if(!(i.flags&128)&&(typeof y.getDerivedStateFromError=="function"||w!==null&&typeof w.componentDidCatch=="function"&&(gi===null||!gi.has(w)))){i.flags|=65536,e&=-e,i.lanes|=e;var x=F2(i,s,e);t1(i,x);break e}}i=i.return}while(i!==null)}e_(n)}catch(b){e=b,ht===n&&n!==null&&(ht=n=n.return);continue}break}while(!0)}function J2(){var t=Fd.current;return Fd.current=Od,t===null?Od:t}function Ag(){(bt===0||bt===3||bt===2)&&(bt=4),It===null||!(ya&268435455)&&!(Pf&268435455)||Xo(It,Bt)}function Bd(t,e){var n=Oe;Oe|=2;var r=J2();(It!==t||Bt!==e)&&(so=null,fa(t,e));do try{GI();break}catch(o){Q2(t,o)}while(!0);if(fg(),Oe=n,Fd.current=r,ht!==null)throw Error(Y(261));return It=null,Bt=0,bt}function GI(){for(;ht!==null;)Z2(ht)}function qI(){for(;ht!==null&&!yT();)Z2(ht)}function Z2(t){var e=n_(t.alternate,t,Sn);t.memoizedProps=t.pendingProps,e===null?e_(t):ht=e,Sg.current=null}function e_(t){var e=t;do{var n=e.alternate;if(t=e.return,e.flags&32768){if(n=jI(n,e),n!==null){n.flags&=32767,ht=n;return}if(t!==null)t.flags|=32768,t.subtreeFlags=0,t.deletions=null;else{bt=6,ht=null;return}}else if(n=$I(n,e,Sn),n!==null){ht=n;return}if(e=e.sibling,e!==null){ht=e;return}ht=e=t}while(e!==null);bt===0&&(bt=5)}function Gi(t,e,n){var r=$e,o=Xn.transition;try{Xn.transition=null,$e=1,KI(t,e,n,r)}finally{Xn.transition=o,$e=r}return null}function KI(t,e,n,r){do bs();while(ui!==null);if(Oe&6)throw Error(Y(327));n=t.finishedWork;var o=t.finishedLanes;if(n===null)return null;if(t.finishedWork=null,t.finishedLanes=0,n===t.current)throw Error(Y(177));t.callbackNode=null,t.callbackPriority=0;var i=n.lanes|n.childLanes;if(TT(t,i),t===It&&(ht=It=null,Bt=0),!(n.subtreeFlags&2064)&&!(n.flags&2064)||Cc||(Cc=!0,r_(wd,function(){return bs(),null})),i=(n.flags&15990)!==0,n.subtreeFlags&15990||i){i=Xn.transition,Xn.transition=null;var a=$e;$e=1;var s=Oe;Oe|=4,Sg.current=null,UI(t,n),K2(n,t),pI(lv),bd=!!uv,lv=uv=null,t.current=n,zI(n),wT(),Oe=s,$e=a,Xn.transition=i}else t.current=n;if(Cc&&(Cc=!1,ui=t,Ld=o),i=t.pendingLanes,i===0&&(gi=null),_T(n.stateNode),xn(t,ct()),e!==null)for(r=t.onRecoverableError,n=0;n<e.length;n++)o=e[n],r(o.value,{componentStack:o.stack,digest:o.digest});if(Md)throw Md=!1,t=Iv,Iv=null,t;return Ld&1&&t.tag!==0&&bs(),i=t.pendingLanes,i&1?t===Av?Ku++:(Ku=0,Av=t):Ku=0,Ni(),null}function bs(){if(ui!==null){var t=Ob(Ld),e=Xn.transition,n=$e;try{if(Xn.transition=null,$e=16>t?16:t,ui===null)var r=!1;else{if(t=ui,ui=null,Ld=0,Oe&6)throw Error(Y(331));var o=Oe;for(Oe|=4,re=t.current;re!==null;){var i=re,a=i.child;if(re.flags&16){var s=i.deletions;if(s!==null){for(var u=0;u<s.length;u++){var l=s[u];for(re=l;re!==null;){var c=re;switch(c.tag){case 0:case 11:case 15:Gu(8,c,i)}var d=c.child;if(d!==null)d.return=c,re=d;else for(;re!==null;){c=re;var f=c.sibling,h=c.return;if(H2(c),c===l){re=null;break}if(f!==null){f.return=h,re=f;break}re=h}}}var v=i.alternate;if(v!==null){var p=v.child;if(p!==null){v.child=null;do{var m=p.sibling;p.sibling=null,p=m}while(p!==null)}}re=i}}if(i.subtreeFlags&2064&&a!==null)a.return=i,re=a;else e:for(;re!==null;){if(i=re,i.flags&2048)switch(i.tag){case 0:case 11:case 15:Gu(9,i,i.return)}var g=i.sibling;if(g!==null){g.return=i.return,re=g;break e}re=i.return}}var y=t.current;for(re=y;re!==null;){a=re;var w=a.child;if(a.subtreeFlags&2064&&w!==null)w.return=a,re=w;else e:for(a=y;re!==null;){if(s=re,s.flags&2048)try{switch(s.tag){case 0:case 11:case 15:Af(9,s)}}catch(b){lt(s,s.return,b)}if(s===a){re=null;break e}var x=s.sibling;if(x!==null){x.return=s.return,re=x;break e}re=s.return}}if(Oe=o,Ni(),Ur&&typeof Ur.onPostCommitFiberRoot=="function")try{Ur.onPostCommitFiberRoot(_f,t)}catch{}r=!0}return r}finally{$e=n,Xn.transition=e}}return!1}function _1(t,e,n){e=Qs(n,e),e=O2(t,e,1),t=mi(t,e,1),e=an(),t!==null&&(Bl(t,1,e),xn(t,e))}function lt(t,e,n){if(t.tag===3)_1(t,t,n);else for(;e!==null;){if(e.tag===3){_1(e,t,n);break}else if(e.tag===1){var r=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof r.componentDidCatch=="function"&&(gi===null||!gi.has(r))){t=Qs(n,t),t=F2(e,t,1),e=mi(e,t,1),t=an(),e!==null&&(Bl(e,1,t),xn(e,t));break}}e=e.return}}function XI(t,e,n){var r=t.pingCache;r!==null&&r.delete(e),e=an(),t.pingedLanes|=t.suspendedLanes&n,It===t&&(Bt&n)===n&&(bt===4||bt===3&&(Bt&130023424)===Bt&&500>ct()-Rg?fa(t,0):kg|=n),xn(t,e)}function t_(t,e){e===0&&(t.mode&1?(e=pc,pc<<=1,!(pc&130023424)&&(pc=4194304)):e=1);var n=an();t=xo(t,e),t!==null&&(Bl(t,e,n),xn(t,n))}function YI(t){var e=t.memoizedState,n=0;e!==null&&(n=e.retryLane),t_(t,n)}function QI(t,e){var n=0;switch(t.tag){case 13:var r=t.stateNode,o=t.memoizedState;o!==null&&(n=o.retryLane);break;case 19:r=t.stateNode;break;default:throw Error(Y(314))}r!==null&&r.delete(e),t_(t,n)}var n_;n_=function(t,e,n){if(t!==null)if(t.memoizedProps!==e.pendingProps||yn.current)gn=!0;else{if(!(t.lanes&n)&&!(e.flags&128))return gn=!1,BI(t,e,n);gn=!!(t.flags&131072)}else gn=!1,Ze&&e.flags&1048576&&a2(e,Td,e.index);switch(e.lanes=0,e.tag){case 2:var r=e.type;sd(t,e),t=e.pendingProps;var o=qs(e,Qt.current);xs(e,n),o=xg(null,e,r,t,o,n);var i=bg();return e.flags|=1,typeof o=="object"&&o!==null&&typeof o.render=="function"&&o.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,wn(r)?(i=!0,kd(e)):i=!1,e.memoizedState=o.state!==null&&o.state!==void 0?o.state:null,vg(e),o.updater=If,e.stateNode=o,o._reactInternals=e,yv(e,r,t,n),e=bv(null,e,r,!0,i,n)):(e.tag=0,Ze&&i&&ug(e),rn(null,e,o,n),e=e.child),e;case 16:r=e.elementType;e:{switch(sd(t,e),t=e.pendingProps,o=r._init,r=o(r._payload),e.type=r,o=e.tag=ZI(r),t=ur(r,t),o){case 0:e=xv(null,e,r,t,n);break e;case 1:e=f1(null,e,r,t,n);break e;case 11:e=c1(null,e,r,t,n);break e;case 14:e=d1(null,e,r,ur(r.type,t),n);break e}throw Error(Y(306,r,""))}return e;case 0:return r=e.type,o=e.pendingProps,o=e.elementType===r?o:ur(r,o),xv(t,e,r,o,n);case 1:return r=e.type,o=e.pendingProps,o=e.elementType===r?o:ur(r,o),f1(t,e,r,o,n);case 3:e:{if($2(e),t===null)throw Error(Y(387));r=e.pendingProps,i=e.memoizedState,o=i.element,f2(t,e),Pd(e,r,null,n);var a=e.memoizedState;if(r=a.element,i.isDehydrated)if(i={element:r,isDehydrated:!1,cache:a.cache,pendingSuspenseBoundaries:a.pendingSuspenseBoundaries,transitions:a.transitions},e.updateQueue.baseState=i,e.memoizedState=i,e.flags&256){o=Qs(Error(Y(423)),e),e=h1(t,e,r,n,o);break e}else if(r!==o){o=Qs(Error(Y(424)),e),e=h1(t,e,r,n,o);break e}else for(In=vi(e.stateNode.containerInfo.firstChild),Nn=e,Ze=!0,hr=null,n=c2(e,null,r,n),e.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling;else{if(Ks(),r===o){e=bo(t,e,n);break e}rn(t,e,r,n)}e=e.child}return e;case 5:return h2(e),t===null&&vv(e),r=e.type,o=e.pendingProps,i=t!==null?t.memoizedProps:null,a=o.children,cv(r,o)?a=null:i!==null&&cv(r,i)&&(e.flags|=32),B2(t,e),rn(t,e,a,n),e.child;case 6:return t===null&&vv(e),null;case 13:return j2(t,e,n);case 4:return mg(e,e.stateNode.containerInfo),r=e.pendingProps,t===null?e.child=Xs(e,null,r,n):rn(t,e,r,n),e.child;case 11:return r=e.type,o=e.pendingProps,o=e.elementType===r?o:ur(r,o),c1(t,e,r,o,n);case 7:return rn(t,e,e.pendingProps,n),e.child;case 8:return rn(t,e,e.pendingProps.children,n),e.child;case 12:return rn(t,e,e.pendingProps.children,n),e.child;case 10:e:{if(r=e.type._context,o=e.pendingProps,i=e.memoizedProps,a=o.value,Ge(Id,r._currentValue),r._currentValue=a,i!==null)if(wr(i.value,a)){if(i.children===o.children&&!yn.current){e=bo(t,e,n);break e}}else for(i=e.child,i!==null&&(i.return=e);i!==null;){var s=i.dependencies;if(s!==null){a=i.child;for(var u=s.firstContext;u!==null;){if(u.context===r){if(i.tag===1){u=mo(-1,n&-n),u.tag=2;var l=i.updateQueue;if(l!==null){l=l.shared;var c=l.pending;c===null?u.next=u:(u.next=c.next,c.next=u),l.pending=u}}i.lanes|=n,u=i.alternate,u!==null&&(u.lanes|=n),mv(i.return,n,e),s.lanes|=n;break}u=u.next}}else if(i.tag===10)a=i.type===e.type?null:i.child;else if(i.tag===18){if(a=i.return,a===null)throw Error(Y(341));a.lanes|=n,s=a.alternate,s!==null&&(s.lanes|=n),mv(a,n,e),a=i.sibling}else a=i.child;if(a!==null)a.return=i;else for(a=i;a!==null;){if(a===e){a=null;break}if(i=a.sibling,i!==null){i.return=a.return,a=i;break}a=a.return}i=a}rn(t,e,o.children,n),e=e.child}return e;case 9:return o=e.type,r=e.pendingProps.children,xs(e,n),o=Qn(o),r=r(o),e.flags|=1,rn(t,e,r,n),e.child;case 14:return r=e.type,o=ur(r,e.pendingProps),o=ur(r.type,o),d1(t,e,r,o,n);case 15:return M2(t,e,e.type,e.pendingProps,n);case 17:return r=e.type,o=e.pendingProps,o=e.elementType===r?o:ur(r,o),sd(t,e),e.tag=1,wn(r)?(t=!0,kd(e)):t=!1,xs(e,n),N2(e,r,o),yv(e,r,o,n),bv(null,e,r,!0,t,n);case 19:return W2(t,e,n);case 22:return L2(t,e,n)}throw Error(Y(156,e.tag))};function r_(t,e){return Ab(t,e)}function JI(t,e,n,r){this.tag=t,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Gn(t,e,n,r){return new JI(t,e,n,r)}function Pg(t){return t=t.prototype,!(!t||!t.isReactComponent)}function ZI(t){if(typeof t=="function")return Pg(t)?1:0;if(t!=null){if(t=t.$$typeof,t===Ym)return 11;if(t===Qm)return 14}return 2}function wi(t,e){var n=t.alternate;return n===null?(n=Gn(t.tag,e,t.key,t.mode),n.elementType=t.elementType,n.type=t.type,n.stateNode=t.stateNode,n.alternate=t,t.alternate=n):(n.pendingProps=e,n.type=t.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=t.flags&14680064,n.childLanes=t.childLanes,n.lanes=t.lanes,n.child=t.child,n.memoizedProps=t.memoizedProps,n.memoizedState=t.memoizedState,n.updateQueue=t.updateQueue,e=t.dependencies,n.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},n.sibling=t.sibling,n.index=t.index,n.ref=t.ref,n}function cd(t,e,n,r,o,i){var a=2;if(r=t,typeof t=="function")Pg(t)&&(a=1);else if(typeof t=="string")a=5;else e:switch(t){case is:return ha(n.children,o,i,e);case Xm:a=8,o|=8;break;case Up:return t=Gn(12,n,e,o|2),t.elementType=Up,t.lanes=i,t;case zp:return t=Gn(13,n,e,o),t.elementType=zp,t.lanes=i,t;case Vp:return t=Gn(19,n,e,o),t.elementType=Vp,t.lanes=i,t;case hb:return Df(n,o,i,e);default:if(typeof t=="object"&&t!==null)switch(t.$$typeof){case db:a=10;break e;case fb:a=9;break e;case Ym:a=11;break e;case Qm:a=14;break e;case Go:a=16,r=null;break e}throw Error(Y(130,t==null?t:typeof t,""))}return e=Gn(a,n,e,o),e.elementType=t,e.type=r,e.lanes=i,e}function ha(t,e,n,r){return t=Gn(7,t,r,e),t.lanes=n,t}function Df(t,e,n,r){return t=Gn(22,t,r,e),t.elementType=hb,t.lanes=n,t.stateNode={isHidden:!1},t}function Vh(t,e,n){return t=Gn(6,t,null,e),t.lanes=n,t}function Hh(t,e,n){return e=Gn(4,t.children!==null?t.children:[],t.key,e),e.lanes=n,e.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},e}function eA(t,e,n,r,o){this.tag=e,this.containerInfo=t,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Sh(0),this.expirationTimes=Sh(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Sh(0),this.identifierPrefix=r,this.onRecoverableError=o,this.mutableSourceEagerHydrationData=null}function Dg(t,e,n,r,o,i,a,s,u){return t=new eA(t,e,n,s,u),e===1?(e=1,i===!0&&(e|=8)):e=0,i=Gn(3,null,null,e),t.current=i,i.stateNode=t,i.memoizedState={element:r,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},vg(i),t}function tA(t,e,n){var r=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:os,key:r==null?null:""+r,children:t,containerInfo:e,implementation:n}}function o_(t){if(!t)return ki;t=t._reactInternals;e:{if(Ra(t)!==t||t.tag!==1)throw Error(Y(170));var e=t;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(wn(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(Y(171))}if(t.tag===1){var n=t.type;if(wn(n))return o2(t,n,e)}return e}function i_(t,e,n,r,o,i,a,s,u){return t=Dg(n,r,!0,t,o,i,a,s,u),t.context=o_(null),n=t.current,r=an(),o=yi(n),i=mo(r,o),i.callback=e??null,mi(n,i,o),t.current.lanes=o,Bl(t,o,r),xn(t,r),t}function Nf(t,e,n,r){var o=e.current,i=an(),a=yi(o);return n=o_(n),e.context===null?e.context=n:e.pendingContext=n,e=mo(i,a),e.payload={element:t},r=r===void 0?null:r,r!==null&&(e.callback=r),t=mi(o,e,a),t!==null&&(gr(t,o,a,i),od(t,o,a)),a}function $d(t){if(t=t.current,!t.child)return null;switch(t.child.tag){case 5:return t.child.stateNode;default:return t.child.stateNode}}function E1(t,e){if(t=t.memoizedState,t!==null&&t.dehydrated!==null){var n=t.retryLane;t.retryLane=n!==0&&n<e?n:e}}function Ng(t,e){E1(t,e),(t=t.alternate)&&E1(t,e)}function nA(){return null}var a_=typeof reportError=="function"?reportError:function(t){console.error(t)};function Og(t){this._internalRoot=t}Of.prototype.render=Og.prototype.render=function(t){var e=this._internalRoot;if(e===null)throw Error(Y(409));Nf(t,e,null,null)};Of.prototype.unmount=Og.prototype.unmount=function(){var t=this._internalRoot;if(t!==null){this._internalRoot=null;var e=t.containerInfo;wa(function(){Nf(null,t,null,null)}),e[wo]=null}};function Of(t){this._internalRoot=t}Of.prototype.unstable_scheduleHydration=function(t){if(t){var e=Lb();t={blockedOn:null,target:t,priority:e};for(var n=0;n<Ko.length&&e!==0&&e<Ko[n].priority;n++);Ko.splice(n,0,t),n===0&&$b(t)}};function Fg(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11)}function Ff(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11&&(t.nodeType!==8||t.nodeValue!==" react-mount-point-unstable "))}function C1(){}function rA(t,e,n,r,o){if(o){if(typeof r=="function"){var i=r;r=function(){var l=$d(a);i.call(l)}}var a=i_(e,r,t,0,null,!1,!1,"",C1);return t._reactRootContainer=a,t[wo]=a.current,cl(t.nodeType===8?t.parentNode:t),wa(),a}for(;o=t.lastChild;)t.removeChild(o);if(typeof r=="function"){var s=r;r=function(){var l=$d(u);s.call(l)}}var u=Dg(t,0,!1,null,null,!1,!1,"",C1);return t._reactRootContainer=u,t[wo]=u.current,cl(t.nodeType===8?t.parentNode:t),wa(function(){Nf(e,u,n,r)}),u}function Mf(t,e,n,r,o){var i=n._reactRootContainer;if(i){var a=i;if(typeof o=="function"){var s=o;o=function(){var u=$d(a);s.call(u)}}Nf(e,a,t,o)}else a=rA(n,e,t,o,r);return $d(a)}Fb=function(t){switch(t.tag){case 3:var e=t.stateNode;if(e.current.memoizedState.isDehydrated){var n=Mu(e.pendingLanes);n!==0&&(eg(e,n|1),xn(e,ct()),!(Oe&6)&&(Js=ct()+500,Ni()))}break;case 13:wa(function(){var r=xo(t,1);if(r!==null){var o=an();gr(r,t,1,o)}}),Ng(t,1)}};tg=function(t){if(t.tag===13){var e=xo(t,134217728);if(e!==null){var n=an();gr(e,t,134217728,n)}Ng(t,134217728)}};Mb=function(t){if(t.tag===13){var e=yi(t),n=xo(t,e);if(n!==null){var r=an();gr(n,t,e,r)}Ng(t,e)}};Lb=function(){return $e};Bb=function(t,e){var n=$e;try{return $e=t,e()}finally{$e=n}};ev=function(t,e,n){switch(e){case"input":if(qp(t,n),e=n.name,n.type==="radio"&&e!=null){for(n=t;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<n.length;e++){var r=n[e];if(r!==t&&r.form===t.form){var o=kf(r);if(!o)throw Error(Y(90));vb(r),qp(r,o)}}}break;case"textarea":gb(t,n);break;case"select":e=n.value,e!=null&&ms(t,!!n.multiple,e,!1)}};Cb=Tg;Sb=wa;var oA={usingClientEntryPoint:!1,Events:[jl,ls,kf,_b,Eb,Tg]},ku={findFiberByHostInstance:Ji,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},iA={bundleType:ku.bundleType,version:ku.version,rendererPackageName:ku.rendererPackageName,rendererConfig:ku.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:So.ReactCurrentDispatcher,findHostInstanceByFiber:function(t){return t=Tb(t),t===null?null:t.stateNode},findFiberByHostInstance:ku.findFiberByHostInstance||nA,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Sc=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Sc.isDisabled&&Sc.supportsFiber)try{_f=Sc.inject(iA),Ur=Sc}catch{}}Ln.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=oA;Ln.createPortal=function(t,e){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!Fg(e))throw Error(Y(200));return tA(t,e,null,n)};Ln.createRoot=function(t,e){if(!Fg(t))throw Error(Y(299));var n=!1,r="",o=a_;return e!=null&&(e.unstable_strictMode===!0&&(n=!0),e.identifierPrefix!==void 0&&(r=e.identifierPrefix),e.onRecoverableError!==void 0&&(o=e.onRecoverableError)),e=Dg(t,1,!1,null,null,n,!1,r,o),t[wo]=e.current,cl(t.nodeType===8?t.parentNode:t),new Og(e)};Ln.findDOMNode=function(t){if(t==null)return null;if(t.nodeType===1)return t;var e=t._reactInternals;if(e===void 0)throw typeof t.render=="function"?Error(Y(188)):(t=Object.keys(t).join(","),Error(Y(268,t)));return t=Tb(e),t=t===null?null:t.stateNode,t};Ln.flushSync=function(t){return wa(t)};Ln.hydrate=function(t,e,n){if(!Ff(e))throw Error(Y(200));return Mf(null,t,e,!0,n)};Ln.hydrateRoot=function(t,e,n){if(!Fg(t))throw Error(Y(405));var r=n!=null&&n.hydratedSources||null,o=!1,i="",a=a_;if(n!=null&&(n.unstable_strictMode===!0&&(o=!0),n.identifierPrefix!==void 0&&(i=n.identifierPrefix),n.onRecoverableError!==void 0&&(a=n.onRecoverableError)),e=i_(e,null,t,1,n??null,o,!1,i,a),t[wo]=e.current,cl(t),r)for(t=0;t<r.length;t++)n=r[t],o=n._getVersion,o=o(n._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[n,o]:e.mutableSourceEagerHydrationData.push(n,o);return new Of(e)};Ln.render=function(t,e,n){if(!Ff(e))throw Error(Y(200));return Mf(null,t,e,!1,n)};Ln.unmountComponentAtNode=function(t){if(!Ff(t))throw Error(Y(40));return t._reactRootContainer?(wa(function(){Mf(null,null,t,!1,function(){t._reactRootContainer=null,t[wo]=null})}),!0):!1};Ln.unstable_batchedUpdates=Tg;Ln.unstable_renderSubtreeIntoContainer=function(t,e,n,r){if(!Ff(n))throw Error(Y(200));if(t==null||t._reactInternals===void 0)throw Error(Y(38));return Mf(t,e,n,!1,r)};Ln.version="18.3.1-next-f1338f8080-20240426";function s_(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(s_)}catch(t){console.error(t)}}s_(),sb.exports=Ln;var Ul=sb.exports;const u_=Xx(Ul);var aA,S1=Ul;aA=S1.createRoot,S1.hydrateRoot;function k1(t,e){if(typeof t=="function")return t(e);t!=null&&(t.current=e)}function l_(...t){return e=>{let n=!1;const r=t.map(o=>{const i=k1(o,e);return!n&&typeof i=="function"&&(n=!0),i});if(n)return()=>{for(let o=0;o<r.length;o++){const i=r[o];typeof i=="function"?i():k1(t[o],null)}}}}function Pt(...t){return k.useCallback(l_(...t),t)}function sA(t,e){const n=k.createContext(e),r=i=>{const{children:a,...s}=i,u=k.useMemo(()=>s,Object.values(s));return G.jsx(n.Provider,{value:u,children:a})};r.displayName=t+"Provider";function o(i){const a=k.useContext(n);if(a)return a;if(e!==void 0)return e;throw new Error(`\`${i}\` must be used within \`${t}\``)}return[r,o]}function Oi(t,e=[]){let n=[];function r(i,a){const s=k.createContext(a),u=n.length;n=[...n,a];const l=d=>{var g;const{scope:f,children:h,...v}=d,p=((g=f==null?void 0:f[t])==null?void 0:g[u])||s,m=k.useMemo(()=>v,Object.values(v));return G.jsx(p.Provider,{value:m,children:h})};l.displayName=i+"Provider";function c(d,f){var p;const h=((p=f==null?void 0:f[t])==null?void 0:p[u])||s,v=k.useContext(h);if(v)return v;if(a!==void 0)return a;throw new Error(`\`${d}\` must be used within \`${i}\``)}return[l,c]}const o=()=>{const i=n.map(a=>k.createContext(a));return function(s){const u=(s==null?void 0:s[t])||i;return k.useMemo(()=>({[`__scope${t}`]:{...s,[t]:u}}),[s,u])}};return o.scopeName=t,[r,uA(o,...e)]}function uA(...t){const e=t[0];if(t.length===1)return e;const n=()=>{const r=t.map(o=>({useScope:o(),scopeName:o.scopeName}));return function(i){const a=r.reduce((s,{useScope:u,scopeName:l})=>{const d=u(i)[`__scope${l}`];return{...s,...d}},{});return k.useMemo(()=>({[`__scope${e.scopeName}`]:a}),[a])}};return n.scopeName=e.scopeName,n}function wl(t){const e=lA(t),n=k.forwardRef((r,o)=>{const{children:i,...a}=r,s=k.Children.toArray(i),u=s.find(cA);if(u){const l=u.props.children,c=s.map(d=>d===u?k.Children.count(l)>1?k.Children.only(null):k.isValidElement(l)?l.props.children:null:d);return G.jsx(e,{...a,ref:o,children:k.isValidElement(l)?k.cloneElement(l,void 0,c):null})}return G.jsx(e,{...a,ref:o,children:i})});return n.displayName=`${t}.Slot`,n}var $6=wl("Slot");function lA(t){const e=k.forwardRef((n,r)=>{const{children:o,...i}=n;if(k.isValidElement(o)){const a=fA(o),s=dA(i,o.props);return o.type!==k.Fragment&&(s.ref=r?l_(r,a):a),k.cloneElement(o,s)}return k.Children.count(o)>1?k.Children.only(null):null});return e.displayName=`${t}.SlotClone`,e}var c_=Symbol("radix.slottable");function d_(t){const e=({children:n})=>G.jsx(G.Fragment,{children:n});return e.displayName=`${t}.Slottable`,e.__radixId=c_,e}function cA(t){return k.isValidElement(t)&&typeof t.type=="function"&&"__radixId"in t.type&&t.type.__radixId===c_}function dA(t,e){const n={...e};for(const r in e){const o=t[r],i=e[r];/^on[A-Z]/.test(r)?o&&i?n[r]=(...s)=>{const u=i(...s);return o(...s),u}:o&&(n[r]=o):r==="style"?n[r]={...o,...i}:r==="className"&&(n[r]=[o,i].filter(Boolean).join(" "))}return{...t,...n}}function fA(t){var r,o;let e=(r=Object.getOwnPropertyDescriptor(t.props,"ref"))==null?void 0:r.get,n=e&&"isReactWarning"in e&&e.isReactWarning;return n?t.ref:(e=(o=Object.getOwnPropertyDescriptor(t,"ref"))==null?void 0:o.get,n=e&&"isReactWarning"in e&&e.isReactWarning,n?t.props.ref:t.props.ref||t.ref)}function f_(t){const e=t+"CollectionProvider",[n,r]=Oi(e),[o,i]=n(e,{collectionRef:{current:null},itemMap:new Map}),a=p=>{const{scope:m,children:g}=p,y=J.useRef(null),w=J.useRef(new Map).current;return G.jsx(o,{scope:m,itemMap:w,collectionRef:y,children:g})};a.displayName=e;const s=t+"CollectionSlot",u=wl(s),l=J.forwardRef((p,m)=>{const{scope:g,children:y}=p,w=i(s,g),x=Pt(m,w.collectionRef);return G.jsx(u,{ref:x,children:y})});l.displayName=s;const c=t+"CollectionItemSlot",d="data-radix-collection-item",f=wl(c),h=J.forwardRef((p,m)=>{const{scope:g,children:y,...w}=p,x=J.useRef(null),b=Pt(m,x),_=i(c,g);return J.useEffect(()=>(_.itemMap.set(x,{ref:x,...w}),()=>void _.itemMap.delete(x))),G.jsx(f,{[d]:"",ref:b,children:y})});h.displayName=c;function v(p){const m=i(t+"CollectionConsumer",p);return J.useCallback(()=>{const y=m.collectionRef.current;if(!y)return[];const w=Array.from(y.querySelectorAll(`[${d}]`));return Array.from(m.itemMap.values()).sort((_,E)=>w.indexOf(_.ref.current)-w.indexOf(E.ref.current))},[m.collectionRef,m.itemMap])}return[{Provider:a,Slot:l,ItemSlot:h},v,r]}var hA=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","select","span","svg","ul"],Ve=hA.reduce((t,e)=>{const n=wl(`Primitive.${e}`),r=k.forwardRef((o,i)=>{const{asChild:a,...s}=o,u=a?n:e;return typeof window<"u"&&(window[Symbol.for("radix-ui")]=!0),G.jsx(u,{...s,ref:i})});return r.displayName=`Primitive.${e}`,{...t,[e]:r}},{});function h_(t,e){t&&Ul.flushSync(()=>t.dispatchEvent(e))}function xr(t){const e=k.useRef(t);return k.useEffect(()=>{e.current=t}),k.useMemo(()=>(...n)=>{var r;return(r=e.current)==null?void 0:r.call(e,...n)},[])}function pA(t,e=globalThis==null?void 0:globalThis.document){const n=xr(t);k.useEffect(()=>{const r=o=>{o.key==="Escape"&&n(o)};return e.addEventListener("keydown",r,{capture:!0}),()=>e.removeEventListener("keydown",r,{capture:!0})},[n,e])}var vA="DismissableLayer",Nv="dismissableLayer.update",mA="dismissableLayer.pointerDownOutside",gA="dismissableLayer.focusOutside",R1,p_=k.createContext({layers:new Set,layersWithOutsidePointerEventsDisabled:new Set,branches:new Set}),Lf=k.forwardRef((t,e)=>{const{disableOutsidePointerEvents:n=!1,onEscapeKeyDown:r,onPointerDownOutside:o,onFocusOutside:i,onInteractOutside:a,onDismiss:s,...u}=t,l=k.useContext(p_),[c,d]=k.useState(null),f=(c==null?void 0:c.ownerDocument)??(globalThis==null?void 0:globalThis.document),[,h]=k.useState({}),v=Pt(e,E=>d(E)),p=Array.from(l.layers),[m]=[...l.layersWithOutsidePointerEventsDisabled].slice(-1),g=p.indexOf(m),y=c?p.indexOf(c):-1,w=l.layersWithOutsidePointerEventsDisabled.size>0,x=y>=g,b=wA(E=>{const C=E.target,R=[...l.branches].some(S=>S.contains(C));!x||R||(o==null||o(E),a==null||a(E),E.defaultPrevented||s==null||s())},f),_=xA(E=>{const C=E.target;[...l.branches].some(S=>S.contains(C))||(i==null||i(E),a==null||a(E),E.defaultPrevented||s==null||s())},f);return pA(E=>{y===l.layers.size-1&&(r==null||r(E),!E.defaultPrevented&&s&&(E.preventDefault(),s()))},f),k.useEffect(()=>{if(c)return n&&(l.layersWithOutsidePointerEventsDisabled.size===0&&(R1=f.body.style.pointerEvents,f.body.style.pointerEvents="none"),l.layersWithOutsidePointerEventsDisabled.add(c)),l.layers.add(c),T1(),()=>{n&&l.layersWithOutsidePointerEventsDisabled.size===1&&(f.body.style.pointerEvents=R1)}},[c,f,n,l]),k.useEffect(()=>()=>{c&&(l.layers.delete(c),l.layersWithOutsidePointerEventsDisabled.delete(c),T1())},[c,l]),k.useEffect(()=>{const E=()=>h({});return document.addEventListener(Nv,E),()=>document.removeEventListener(Nv,E)},[]),G.jsx(Ve.div,{...u,ref:v,style:{pointerEvents:w?x?"auto":"none":void 0,...t.style},onFocusCapture:De(t.onFocusCapture,_.onFocusCapture),onBlurCapture:De(t.onBlurCapture,_.onBlurCapture),onPointerDownCapture:De(t.onPointerDownCapture,b.onPointerDownCapture)})});Lf.displayName=vA;var yA="DismissableLayerBranch",v_=k.forwardRef((t,e)=>{const n=k.useContext(p_),r=k.useRef(null),o=Pt(e,r);return k.useEffect(()=>{const i=r.current;if(i)return n.branches.add(i),()=>{n.branches.delete(i)}},[n.branches]),G.jsx(Ve.div,{...t,ref:o})});v_.displayName=yA;function wA(t,e=globalThis==null?void 0:globalThis.document){const n=xr(t),r=k.useRef(!1),o=k.useRef(()=>{});return k.useEffect(()=>{const i=s=>{if(s.target&&!r.current){let u=function(){m_(mA,n,l,{discrete:!0})};const l={originalEvent:s};s.pointerType==="touch"?(e.removeEventListener("click",o.current),o.current=u,e.addEventListener("click",o.current,{once:!0})):u()}else e.removeEventListener("click",o.current);r.current=!1},a=window.setTimeout(()=>{e.addEventListener("pointerdown",i)},0);return()=>{window.clearTimeout(a),e.removeEventListener("pointerdown",i),e.removeEventListener("click",o.current)}},[e,n]),{onPointerDownCapture:()=>r.current=!0}}function xA(t,e=globalThis==null?void 0:globalThis.document){const n=xr(t),r=k.useRef(!1);return k.useEffect(()=>{const o=i=>{i.target&&!r.current&&m_(gA,n,{originalEvent:i},{discrete:!1})};return e.addEventListener("focusin",o),()=>e.removeEventListener("focusin",o)},[e,n]),{onFocusCapture:()=>r.current=!0,onBlurCapture:()=>r.current=!1}}function T1(){const t=new CustomEvent(Nv);document.dispatchEvent(t)}function m_(t,e,n,{discrete:r}){const o=n.originalEvent.target,i=new CustomEvent(t,{bubbles:!1,cancelable:!0,detail:n});e&&o.addEventListener(t,e,{once:!0}),r?h_(o,i):o.dispatchEvent(i)}var bA=Lf,_A=v_,_o=globalThis!=null&&globalThis.document?k.useLayoutEffect:()=>{},EA="Portal",Mg=k.forwardRef((t,e)=>{var s;const{container:n,...r}=t,[o,i]=k.useState(!1);_o(()=>i(!0),[]);const a=n||o&&((s=globalThis==null?void 0:globalThis.document)==null?void 0:s.body);return a?u_.createPortal(G.jsx(Ve.div,{...r,ref:e}),a):null});Mg.displayName=EA;function CA(t,e){return k.useReducer((n,r)=>e[n][r]??n,t)}var Ta=t=>{const{present:e,children:n}=t,r=SA(e),o=typeof n=="function"?n({present:r.isPresent}):k.Children.only(n),i=Pt(r.ref,kA(o));return typeof n=="function"||r.isPresent?k.cloneElement(o,{ref:i}):null};Ta.displayName="Presence";function SA(t){const[e,n]=k.useState(),r=k.useRef(null),o=k.useRef(t),i=k.useRef("none"),a=t?"mounted":"unmounted",[s,u]=CA(a,{mounted:{UNMOUNT:"unmounted",ANIMATION_OUT:"unmountSuspended"},unmountSuspended:{MOUNT:"mounted",ANIMATION_END:"unmounted"},unmounted:{MOUNT:"mounted"}});return k.useEffect(()=>{const l=kc(r.current);i.current=s==="mounted"?l:"none"},[s]),_o(()=>{const l=r.current,c=o.current;if(c!==t){const f=i.current,h=kc(l);t?u("MOUNT"):h==="none"||(l==null?void 0:l.display)==="none"?u("UNMOUNT"):u(c&&f!==h?"ANIMATION_OUT":"UNMOUNT"),o.current=t}},[t,u]),_o(()=>{if(e){let l;const c=e.ownerDocument.defaultView??window,d=h=>{const p=kc(r.current).includes(h.animationName);if(h.target===e&&p&&(u("ANIMATION_END"),!o.current)){const m=e.style.animationFillMode;e.style.animationFillMode="forwards",l=c.setTimeout(()=>{e.style.animationFillMode==="forwards"&&(e.style.animationFillMode=m)})}},f=h=>{h.target===e&&(i.current=kc(r.current))};return e.addEventListener("animationstart",f),e.addEventListener("animationcancel",d),e.addEventListener("animationend",d),()=>{c.clearTimeout(l),e.removeEventListener("animationstart",f),e.removeEventListener("animationcancel",d),e.removeEventListener("animationend",d)}}else u("ANIMATION_END")},[e,u]),{isPresent:["mounted","unmountSuspended"].includes(s),ref:k.useCallback(l=>{r.current=l?getComputedStyle(l):null,n(l)},[])}}function kc(t){return(t==null?void 0:t.animationName)||"none"}function kA(t){var r,o;let e=(r=Object.getOwnPropertyDescriptor(t.props,"ref"))==null?void 0:r.get,n=e&&"isReactWarning"in e&&e.isReactWarning;return n?t.ref:(e=(o=Object.getOwnPropertyDescriptor(t,"ref"))==null?void 0:o.get,n=e&&"isReactWarning"in e&&e.isReactWarning,n?t.props.ref:t.props.ref||t.ref)}var RA=Hm[" useInsertionEffect ".trim().toString()]||_o;function Bf({prop:t,defaultProp:e,onChange:n=()=>{},caller:r}){const[o,i,a]=TA({defaultProp:e,onChange:n}),s=t!==void 0,u=s?t:o;{const c=k.useRef(t!==void 0);k.useEffect(()=>{const d=c.current;d!==s&&console.warn(`${r} is changing from ${d?"controlled":"uncontrolled"} to ${s?"controlled":"uncontrolled"}. Components should not switch from controlled to uncontrolled (or vice versa). Decide between using a controlled or uncontrolled value for the lifetime of the component.`),c.current=s},[s,r])}const l=k.useCallback(c=>{var d;if(s){const f=IA(c)?c(t):c;f!==t&&((d=a.current)==null||d.call(a,f))}else i(c)},[s,t,i,a]);return[u,l]}function TA({defaultProp:t,onChange:e}){const[n,r]=k.useState(t),o=k.useRef(n),i=k.useRef(e);return RA(()=>{i.current=e},[e]),k.useEffect(()=>{var a;o.current!==n&&((a=i.current)==null||a.call(i,n),o.current=n)},[n,o]),[n,r,i]}function IA(t){return typeof t=="function"}var AA=Object.freeze({position:"absolute",border:0,width:1,height:1,padding:0,margin:-1,overflow:"hidden",clip:"rect(0, 0, 0, 0)",whiteSpace:"nowrap",wordWrap:"normal"}),PA="VisuallyHidden",$f=k.forwardRef((t,e)=>G.jsx(Ve.span,{...t,ref:e,style:{...AA,...t.style}}));$f.displayName=PA;var DA=$f,Lg="ToastProvider",[Bg,NA,OA]=f_("Toast"),[g_,j6]=Oi("Toast",[OA]),[FA,jf]=g_(Lg),y_=t=>{const{__scopeToast:e,label:n="Notification",duration:r=5e3,swipeDirection:o="right",swipeThreshold:i=50,children:a}=t,[s,u]=k.useState(null),[l,c]=k.useState(0),d=k.useRef(!1),f=k.useRef(!1);return n.trim()||console.error(`Invalid prop \`label\` supplied to \`${Lg}\`. Expected non-empty \`string\`.`),G.jsx(Bg.Provider,{scope:e,children:G.jsx(FA,{scope:e,label:n,duration:r,swipeDirection:o,swipeThreshold:i,toastCount:l,viewport:s,onViewportChange:u,onToastAdd:k.useCallback(()=>c(h=>h+1),[]),onToastRemove:k.useCallback(()=>c(h=>h-1),[]),isFocusedToastEscapeKeyDownRef:d,isClosePausedRef:f,children:a})})};y_.displayName=Lg;var w_="ToastViewport",MA=["F8"],Ov="toast.viewportPause",Fv="toast.viewportResume",x_=k.forwardRef((t,e)=>{const{__scopeToast:n,hotkey:r=MA,label:o="Notifications ({hotkey})",...i}=t,a=jf(w_,n),s=NA(n),u=k.useRef(null),l=k.useRef(null),c=k.useRef(null),d=k.useRef(null),f=Pt(e,d,a.onViewportChange),h=r.join("+").replace(/Key/g,"").replace(/Digit/g,""),v=a.toastCount>0;k.useEffect(()=>{const m=g=>{var w;r.length!==0&&r.every(x=>g[x]||g.code===x)&&((w=d.current)==null||w.focus())};return document.addEventListener("keydown",m),()=>document.removeEventListener("keydown",m)},[r]),k.useEffect(()=>{const m=u.current,g=d.current;if(v&&m&&g){const y=()=>{if(!a.isClosePausedRef.current){const _=new CustomEvent(Ov);g.dispatchEvent(_),a.isClosePausedRef.current=!0}},w=()=>{if(a.isClosePausedRef.current){const _=new CustomEvent(Fv);g.dispatchEvent(_),a.isClosePausedRef.current=!1}},x=_=>{!m.contains(_.relatedTarget)&&w()},b=()=>{m.contains(document.activeElement)||w()};return m.addEventListener("focusin",y),m.addEventListener("focusout",x),m.addEventListener("pointermove",y),m.addEventListener("pointerleave",b),window.addEventListener("blur",y),window.addEventListener("focus",w),()=>{m.removeEventListener("focusin",y),m.removeEventListener("focusout",x),m.removeEventListener("pointermove",y),m.removeEventListener("pointerleave",b),window.removeEventListener("blur",y),window.removeEventListener("focus",w)}}},[v,a.isClosePausedRef]);const p=k.useCallback(({tabbingDirection:m})=>{const y=s().map(w=>{const x=w.ref.current,b=[x,...XA(x)];return m==="forwards"?b:b.reverse()});return(m==="forwards"?y.reverse():y).flat()},[s]);return k.useEffect(()=>{const m=d.current;if(m){const g=y=>{var b,_,E;const w=y.altKey||y.ctrlKey||y.metaKey;if(y.key==="Tab"&&!w){const C=document.activeElement,R=y.shiftKey;if(y.target===m&&R){(b=l.current)==null||b.focus();return}const A=p({tabbingDirection:R?"backwards":"forwards"}),B=A.findIndex(M=>M===C);Gh(A.slice(B+1))?y.preventDefault():R?(_=l.current)==null||_.focus():(E=c.current)==null||E.focus()}};return m.addEventListener("keydown",g),()=>m.removeEventListener("keydown",g)}},[s,p]),G.jsxs(_A,{ref:u,role:"region","aria-label":o.replace("{hotkey}",h),tabIndex:-1,style:{pointerEvents:v?void 0:"none"},children:[v&&G.jsx(Mv,{ref:l,onFocusFromOutsideViewport:()=>{const m=p({tabbingDirection:"forwards"});Gh(m)}}),G.jsx(Bg.Slot,{scope:n,children:G.jsx(Ve.ol,{tabIndex:-1,...i,ref:f})}),v&&G.jsx(Mv,{ref:c,onFocusFromOutsideViewport:()=>{const m=p({tabbingDirection:"backwards"});Gh(m)}})]})});x_.displayName=w_;var b_="ToastFocusProxy",Mv=k.forwardRef((t,e)=>{const{__scopeToast:n,onFocusFromOutsideViewport:r,...o}=t,i=jf(b_,n);return G.jsx($f,{"aria-hidden":!0,tabIndex:0,...o,ref:e,style:{position:"fixed"},onFocus:a=>{var l;const s=a.relatedTarget;!((l=i.viewport)!=null&&l.contains(s))&&r()}})});Mv.displayName=b_;var zl="Toast",LA="toast.swipeStart",BA="toast.swipeMove",$A="toast.swipeCancel",jA="toast.swipeEnd",__=k.forwardRef((t,e)=>{const{forceMount:n,open:r,defaultOpen:o,onOpenChange:i,...a}=t,[s,u]=Bf({prop:r,defaultProp:o??!0,onChange:i,caller:zl});return G.jsx(Ta,{present:n||s,children:G.jsx(zA,{open:s,...a,ref:e,onClose:()=>u(!1),onPause:xr(t.onPause),onResume:xr(t.onResume),onSwipeStart:De(t.onSwipeStart,l=>{l.currentTarget.setAttribute("data-swipe","start")}),onSwipeMove:De(t.onSwipeMove,l=>{const{x:c,y:d}=l.detail.delta;l.currentTarget.setAttribute("data-swipe","move"),l.currentTarget.style.setProperty("--radix-toast-swipe-move-x",`${c}px`),l.currentTarget.style.setProperty("--radix-toast-swipe-move-y",`${d}px`)}),onSwipeCancel:De(t.onSwipeCancel,l=>{l.currentTarget.setAttribute("data-swipe","cancel"),l.currentTarget.style.removeProperty("--radix-toast-swipe-move-x"),l.currentTarget.style.removeProperty("--radix-toast-swipe-move-y"),l.currentTarget.style.removeProperty("--radix-toast-swipe-end-x"),l.currentTarget.style.removeProperty("--radix-toast-swipe-end-y")}),onSwipeEnd:De(t.onSwipeEnd,l=>{const{x:c,y:d}=l.detail.delta;l.currentTarget.setAttribute("data-swipe","end"),l.currentTarget.style.removeProperty("--radix-toast-swipe-move-x"),l.currentTarget.style.removeProperty("--radix-toast-swipe-move-y"),l.currentTarget.style.setProperty("--radix-toast-swipe-end-x",`${c}px`),l.currentTarget.style.setProperty("--radix-toast-swipe-end-y",`${d}px`),u(!1)})})})});__.displayName=zl;var[WA,UA]=g_(zl,{onClose(){}}),zA=k.forwardRef((t,e)=>{const{__scopeToast:n,type:r="foreground",duration:o,open:i,onClose:a,onEscapeKeyDown:s,onPause:u,onResume:l,onSwipeStart:c,onSwipeMove:d,onSwipeCancel:f,onSwipeEnd:h,...v}=t,p=jf(zl,n),[m,g]=k.useState(null),y=Pt(e,M=>g(M)),w=k.useRef(null),x=k.useRef(null),b=o||p.duration,_=k.useRef(0),E=k.useRef(b),C=k.useRef(0),{onToastAdd:R,onToastRemove:S}=p,P=xr(()=>{var j;(m==null?void 0:m.contains(document.activeElement))&&((j=p.viewport)==null||j.focus()),a()}),A=k.useCallback(M=>{!M||M===1/0||(window.clearTimeout(C.current),_.current=new Date().getTime(),C.current=window.setTimeout(P,M))},[P]);k.useEffect(()=>{const M=p.viewport;if(M){const j=()=>{A(E.current),l==null||l()},W=()=>{const U=new Date().getTime()-_.current;E.current=E.current-U,window.clearTimeout(C.current),u==null||u()};return M.addEventListener(Ov,W),M.addEventListener(Fv,j),()=>{M.removeEventListener(Ov,W),M.removeEventListener(Fv,j)}}},[p.viewport,b,u,l,A]),k.useEffect(()=>{i&&!p.isClosePausedRef.current&&A(b)},[i,b,p.isClosePausedRef,A]),k.useEffect(()=>(R(),()=>S()),[R,S]);const B=k.useMemo(()=>m?I_(m):null,[m]);return p.viewport?G.jsxs(G.Fragment,{children:[B&&G.jsx(VA,{__scopeToast:n,role:"status","aria-live":r==="foreground"?"assertive":"polite","aria-atomic":!0,children:B}),G.jsx(WA,{scope:n,onClose:P,children:Ul.createPortal(G.jsx(Bg.ItemSlot,{scope:n,children:G.jsx(bA,{asChild:!0,onEscapeKeyDown:De(s,()=>{p.isFocusedToastEscapeKeyDownRef.current||P(),p.isFocusedToastEscapeKeyDownRef.current=!1}),children:G.jsx(Ve.li,{role:"status","aria-live":"off","aria-atomic":!0,tabIndex:0,"data-state":i?"open":"closed","data-swipe-direction":p.swipeDirection,...v,ref:y,style:{userSelect:"none",touchAction:"none",...t.style},onKeyDown:De(t.onKeyDown,M=>{M.key==="Escape"&&(s==null||s(M.nativeEvent),M.nativeEvent.defaultPrevented||(p.isFocusedToastEscapeKeyDownRef.current=!0,P()))}),onPointerDown:De(t.onPointerDown,M=>{M.button===0&&(w.current={x:M.clientX,y:M.clientY})}),onPointerMove:De(t.onPointerMove,M=>{if(!w.current)return;const j=M.clientX-w.current.x,W=M.clientY-w.current.y,U=!!x.current,D=["left","right"].includes(p.swipeDirection),F=["left","up"].includes(p.swipeDirection)?Math.min:Math.max,$=D?F(0,j):0,q=D?0:F(0,W),K=M.pointerType==="touch"?10:2,Q={x:$,y:q},Z={originalEvent:M,delta:Q};U?(x.current=Q,Rc(BA,d,Z,{discrete:!1})):I1(Q,p.swipeDirection,K)?(x.current=Q,Rc(LA,c,Z,{discrete:!1}),M.target.setPointerCapture(M.pointerId)):(Math.abs(j)>K||Math.abs(W)>K)&&(w.current=null)}),onPointerUp:De(t.onPointerUp,M=>{const j=x.current,W=M.target;if(W.hasPointerCapture(M.pointerId)&&W.releasePointerCapture(M.pointerId),x.current=null,w.current=null,j){const U=M.currentTarget,D={originalEvent:M,delta:j};I1(j,p.swipeDirection,p.swipeThreshold)?Rc(jA,h,D,{discrete:!0}):Rc($A,f,D,{discrete:!0}),U.addEventListener("click",F=>F.preventDefault(),{once:!0})}})})})}),p.viewport)})]}):null}),VA=t=>{const{__scopeToast:e,children:n,...r}=t,o=jf(zl,e),[i,a]=k.useState(!1),[s,u]=k.useState(!1);return qA(()=>a(!0)),k.useEffect(()=>{const l=window.setTimeout(()=>u(!0),1e3);return()=>window.clearTimeout(l)},[]),s?null:G.jsx(Mg,{asChild:!0,children:G.jsx($f,{...r,children:i&&G.jsxs(G.Fragment,{children:[o.label," ",n]})})})},HA="ToastTitle",E_=k.forwardRef((t,e)=>{const{__scopeToast:n,...r}=t;return G.jsx(Ve.div,{...r,ref:e})});E_.displayName=HA;var GA="ToastDescription",C_=k.forwardRef((t,e)=>{const{__scopeToast:n,...r}=t;return G.jsx(Ve.div,{...r,ref:e})});C_.displayName=GA;var S_="ToastAction",k_=k.forwardRef((t,e)=>{const{altText:n,...r}=t;return n.trim()?G.jsx(T_,{altText:n,asChild:!0,children:G.jsx($g,{...r,ref:e})}):(console.error(`Invalid prop \`altText\` supplied to \`${S_}\`. Expected non-empty \`string\`.`),null)});k_.displayName=S_;var R_="ToastClose",$g=k.forwardRef((t,e)=>{const{__scopeToast:n,...r}=t,o=UA(R_,n);return G.jsx(T_,{asChild:!0,children:G.jsx(Ve.button,{type:"button",...r,ref:e,onClick:De(t.onClick,o.onClose)})})});$g.displayName=R_;var T_=k.forwardRef((t,e)=>{const{__scopeToast:n,altText:r,...o}=t;return G.jsx(Ve.div,{"data-radix-toast-announce-exclude":"","data-radix-toast-announce-alt":r||void 0,...o,ref:e})});function I_(t){const e=[];return Array.from(t.childNodes).forEach(r=>{if(r.nodeType===r.TEXT_NODE&&r.textContent&&e.push(r.textContent),KA(r)){const o=r.ariaHidden||r.hidden||r.style.display==="none",i=r.dataset.radixToastAnnounceExclude==="";if(!o)if(i){const a=r.dataset.radixToastAnnounceAlt;a&&e.push(a)}else e.push(...I_(r))}}),e}function Rc(t,e,n,{discrete:r}){const o=n.originalEvent.currentTarget,i=new CustomEvent(t,{bubbles:!0,cancelable:!0,detail:n});e&&o.addEventListener(t,e,{once:!0}),r?h_(o,i):o.dispatchEvent(i)}var I1=(t,e,n=0)=>{const r=Math.abs(t.x),o=Math.abs(t.y),i=r>o;return e==="left"||e==="right"?i&&r>n:!i&&o>n};function qA(t=()=>{}){const e=xr(t);_o(()=>{let n=0,r=0;return n=window.requestAnimationFrame(()=>r=window.requestAnimationFrame(e)),()=>{window.cancelAnimationFrame(n),window.cancelAnimationFrame(r)}},[e])}function KA(t){return t.nodeType===t.ELEMENT_NODE}function XA(t){const e=[],n=document.createTreeWalker(t,NodeFilter.SHOW_ELEMENT,{acceptNode:r=>{const o=r.tagName==="INPUT"&&r.type==="hidden";return r.disabled||r.hidden||o?NodeFilter.FILTER_SKIP:r.tabIndex>=0?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}});for(;n.nextNode();)e.push(n.currentNode);return e}function Gh(t){const e=document.activeElement;return t.some(n=>n===e?!0:(n.focus(),document.activeElement!==e))}var W6=y_,U6=x_,z6=__,V6=E_,H6=C_,G6=k_,q6=$g;function A_(t){var e,n,r="";if(typeof t=="string"||typeof t=="number")r+=t;else if(typeof t=="object")if(Array.isArray(t)){var o=t.length;for(e=0;e<o;e++)t[e]&&(n=A_(t[e]))&&(r&&(r+=" "),r+=n)}else for(n in t)t[n]&&(r&&(r+=" "),r+=n);return r}function YA(){for(var t,e,n=0,r="",o=arguments.length;n<o;n++)(t=arguments[n])&&(e=A_(t))&&(r&&(r+=" "),r+=e);return r}const A1=t=>typeof t=="boolean"?`${t}`:t===0?"0":t,P1=YA,K6=(t,e)=>n=>{var r;if((e==null?void 0:e.variants)==null)return P1(t,n==null?void 0:n.class,n==null?void 0:n.className);const{variants:o,defaultVariants:i}=e,a=Object.keys(o).map(l=>{const c=n==null?void 0:n[l],d=i==null?void 0:i[l];if(c===null)return null;const f=A1(c)||A1(d);return o[l][f]}),s=n&&Object.entries(n).reduce((l,c)=>{let[d,f]=c;return f===void 0||(l[d]=f),l},{}),u=e==null||(r=e.compoundVariants)===null||r===void 0?void 0:r.reduce((l,c)=>{let{class:d,className:f,...h}=c;return Object.entries(h).every(v=>{let[p,m]=v;return Array.isArray(m)?m.includes({...i,...s}[p]):{...i,...s}[p]===m})?[...l,d,f]:l},[]);return P1(t,a,u,n==null?void 0:n.class,n==null?void 0:n.className)};/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const QA=t=>t.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),P_=(...t)=>t.filter((e,n,r)=>!!e&&e.trim()!==""&&r.indexOf(e)===n).join(" ").trim();/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var JA={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ZA=k.forwardRef(({color:t="currentColor",size:e=24,strokeWidth:n=2,absoluteStrokeWidth:r,className:o="",children:i,iconNode:a,...s},u)=>k.createElement("svg",{ref:u,...JA,width:e,height:e,stroke:t,strokeWidth:r?Number(n)*24/Number(e):n,className:P_("lucide",o),...s},[...a.map(([l,c])=>k.createElement(l,c)),...Array.isArray(i)?i:[i]]));/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const et=(t,e)=>{const n=k.forwardRef(({className:r,...o},i)=>k.createElement(ZA,{ref:i,iconNode:e,className:P_(`lucide-${QA(t)}`,r),...o}));return n.displayName=`${t}`,n};/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const X6=et("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Y6=et("BookOpen",[["path",{d:"M12 7v14",key:"1akyts"}],["path",{d:"M3 18a1 1 0 0 1-1-1V4a1 1 0 0 1 1-1h5a4 4 0 0 1 4 4 4 4 0 0 1 4-4h5a1 1 0 0 1 1 1v13a1 1 0 0 1-1 1h-6a3 3 0 0 0-3 3 3 3 0 0 0-3-3z",key:"ruj8y"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Q6=et("Camera",[["path",{d:"M14.5 4h-5L7 7H4a2 2 0 0 0-2 2v9a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V9a2 2 0 0 0-2-2h-3l-2.5-3z",key:"1tc9qg"}],["circle",{cx:"12",cy:"13",r:"3",key:"1vg3eu"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const J6=et("CircleCheckBig",[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Z6=et("CircleX",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const eV=et("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const tV=et("Download",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const nV=et("EyeOff",[["path",{d:"M10.733 5.076a10.744 10.744 0 0 1 11.205 6.575 1 1 0 0 1 0 .696 10.747 10.747 0 0 1-1.444 2.49",key:"ct8e1f"}],["path",{d:"M14.084 14.158a3 3 0 0 1-4.242-4.242",key:"151rxh"}],["path",{d:"M17.479 17.499a10.75 10.75 0 0 1-15.417-5.151 1 1 0 0 1 0-.696 10.75 10.75 0 0 1 4.446-5.143",key:"13bj9a"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rV=et("Eye",[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const oV=et("GraduationCap",[["path",{d:"M21.42 10.922a1 1 0 0 0-.019-1.838L12.83 5.18a2 2 0 0 0-1.66 0L2.6 9.08a1 1 0 0 0 0 1.832l8.57 3.908a2 2 0 0 0 1.66 0z",key:"j76jl0"}],["path",{d:"M22 10v6",key:"1lu8f3"}],["path",{d:"M6 12.5V16a6 3 0 0 0 12 0v-3.5",key:"1r8lef"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const iV=et("History",[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}],["path",{d:"M12 7v5l4 2",key:"1fdv2h"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const aV=et("List",[["path",{d:"M3 12h.01",key:"nlz23k"}],["path",{d:"M3 18h.01",key:"1tta3j"}],["path",{d:"M3 6h.01",key:"1rqtza"}],["path",{d:"M8 12h13",key:"1za7za"}],["path",{d:"M8 18h13",key:"1lx6n3"}],["path",{d:"M8 6h13",key:"ik3vkj"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const sV=et("LogIn",[["path",{d:"M15 3h4a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2h-4",key:"u53s6r"}],["polyline",{points:"10 17 15 12 10 7",key:"1ail0h"}],["line",{x1:"15",x2:"3",y1:"12",y2:"12",key:"v6grx8"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const uV=et("LogOut",[["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}],["polyline",{points:"16 17 21 12 16 7",key:"1gabdz"}],["line",{x1:"21",x2:"9",y1:"12",y2:"12",key:"1uyos4"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const lV=et("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const cV=et("RotateCcw",[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const dV=et("Settings",[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fV=et("Smartphone",[["rect",{width:"14",height:"20",x:"5",y:"2",rx:"2",ry:"2",key:"1yt0o3"}],["path",{d:"M12 18h.01",key:"mhygvu"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const hV=et("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pV=et("UserMinus",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"22",x2:"16",y1:"11",y2:"11",key:"1shjgl"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vV=et("UserPlus",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"19",x2:"19",y1:"8",y2:"14",key:"1bvyxn"}],["line",{x1:"22",x2:"16",y1:"11",y2:"11",key:"1shjgl"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const mV=et("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gV=et("Users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const yV=et("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]),jg="-",eP=t=>{const e=nP(t),{conflictingClassGroups:n,conflictingClassGroupModifiers:r}=t;return{getClassGroupId:a=>{const s=a.split(jg);return s[0]===""&&s.length!==1&&s.shift(),D_(s,e)||tP(a)},getConflictingClassGroupIds:(a,s)=>{const u=n[a]||[];return s&&r[a]?[...u,...r[a]]:u}}},D_=(t,e)=>{var a;if(t.length===0)return e.classGroupId;const n=t[0],r=e.nextPart.get(n),o=r?D_(t.slice(1),r):void 0;if(o)return o;if(e.validators.length===0)return;const i=t.join(jg);return(a=e.validators.find(({validator:s})=>s(i)))==null?void 0:a.classGroupId},D1=/^\[(.+)\]$/,tP=t=>{if(D1.test(t)){const e=D1.exec(t)[1],n=e==null?void 0:e.substring(0,e.indexOf(":"));if(n)return"arbitrary.."+n}},nP=t=>{const{theme:e,prefix:n}=t,r={nextPart:new Map,validators:[]};return oP(Object.entries(t.classGroups),n).forEach(([i,a])=>{Lv(a,r,i,e)}),r},Lv=(t,e,n,r)=>{t.forEach(o=>{if(typeof o=="string"){const i=o===""?e:N1(e,o);i.classGroupId=n;return}if(typeof o=="function"){if(rP(o)){Lv(o(r),e,n,r);return}e.validators.push({validator:o,classGroupId:n});return}Object.entries(o).forEach(([i,a])=>{Lv(a,N1(e,i),n,r)})})},N1=(t,e)=>{let n=t;return e.split(jg).forEach(r=>{n.nextPart.has(r)||n.nextPart.set(r,{nextPart:new Map,validators:[]}),n=n.nextPart.get(r)}),n},rP=t=>t.isThemeGetter,oP=(t,e)=>e?t.map(([n,r])=>{const o=r.map(i=>typeof i=="string"?e+i:typeof i=="object"?Object.fromEntries(Object.entries(i).map(([a,s])=>[e+a,s])):i);return[n,o]}):t,iP=t=>{if(t<1)return{get:()=>{},set:()=>{}};let e=0,n=new Map,r=new Map;const o=(i,a)=>{n.set(i,a),e++,e>t&&(e=0,r=n,n=new Map)};return{get(i){let a=n.get(i);if(a!==void 0)return a;if((a=r.get(i))!==void 0)return o(i,a),a},set(i,a){n.has(i)?n.set(i,a):o(i,a)}}},N_="!",aP=t=>{const{separator:e,experimentalParseClassName:n}=t,r=e.length===1,o=e[0],i=e.length,a=s=>{const u=[];let l=0,c=0,d;for(let m=0;m<s.length;m++){let g=s[m];if(l===0){if(g===o&&(r||s.slice(m,m+i)===e)){u.push(s.slice(c,m)),c=m+i;continue}if(g==="/"){d=m;continue}}g==="["?l++:g==="]"&&l--}const f=u.length===0?s:s.substring(c),h=f.startsWith(N_),v=h?f.substring(1):f,p=d&&d>c?d-c:void 0;return{modifiers:u,hasImportantModifier:h,baseClassName:v,maybePostfixModifierPosition:p}};return n?s=>n({className:s,parseClassName:a}):a},sP=t=>{if(t.length<=1)return t;const e=[];let n=[];return t.forEach(r=>{r[0]==="["?(e.push(...n.sort(),r),n=[]):n.push(r)}),e.push(...n.sort()),e},uP=t=>({cache:iP(t.cacheSize),parseClassName:aP(t),...eP(t)}),lP=/\s+/,cP=(t,e)=>{const{parseClassName:n,getClassGroupId:r,getConflictingClassGroupIds:o}=e,i=[],a=t.trim().split(lP);let s="";for(let u=a.length-1;u>=0;u-=1){const l=a[u],{modifiers:c,hasImportantModifier:d,baseClassName:f,maybePostfixModifierPosition:h}=n(l);let v=!!h,p=r(v?f.substring(0,h):f);if(!p){if(!v){s=l+(s.length>0?" "+s:s);continue}if(p=r(f),!p){s=l+(s.length>0?" "+s:s);continue}v=!1}const m=sP(c).join(":"),g=d?m+N_:m,y=g+p;if(i.includes(y))continue;i.push(y);const w=o(p,v);for(let x=0;x<w.length;++x){const b=w[x];i.push(g+b)}s=l+(s.length>0?" "+s:s)}return s};function dP(){let t=0,e,n,r="";for(;t<arguments.length;)(e=arguments[t++])&&(n=O_(e))&&(r&&(r+=" "),r+=n);return r}const O_=t=>{if(typeof t=="string")return t;let e,n="";for(let r=0;r<t.length;r++)t[r]&&(e=O_(t[r]))&&(n&&(n+=" "),n+=e);return n};function fP(t,...e){let n,r,o,i=a;function a(u){const l=e.reduce((c,d)=>d(c),t());return n=uP(l),r=n.cache.get,o=n.cache.set,i=s,s(u)}function s(u){const l=r(u);if(l)return l;const c=cP(u,n);return o(u,c),c}return function(){return i(dP.apply(null,arguments))}}const Ke=t=>{const e=n=>n[t]||[];return e.isThemeGetter=!0,e},F_=/^\[(?:([a-z-]+):)?(.+)\]$/i,hP=/^\d+\/\d+$/,pP=new Set(["px","full","screen"]),vP=/^(\d+(\.\d+)?)?(xs|sm|md|lg|xl)$/,mP=/\d+(%|px|r?em|[sdl]?v([hwib]|min|max)|pt|pc|in|cm|mm|cap|ch|ex|r?lh|cq(w|h|i|b|min|max))|\b(calc|min|max|clamp)\(.+\)|^0$/,gP=/^(rgba?|hsla?|hwb|(ok)?(lab|lch))\(.+\)$/,yP=/^(inset_)?-?((\d+)?\.?(\d+)[a-z]+|0)_-?((\d+)?\.?(\d+)[a-z]+|0)/,wP=/^(url|image|image-set|cross-fade|element|(repeating-)?(linear|radial|conic)-gradient)\(.+\)$/,no=t=>_s(t)||pP.has(t)||hP.test(t),Bo=t=>lu(t,"length",RP),_s=t=>!!t&&!Number.isNaN(Number(t)),qh=t=>lu(t,"number",_s),Ru=t=>!!t&&Number.isInteger(Number(t)),xP=t=>t.endsWith("%")&&_s(t.slice(0,-1)),_e=t=>F_.test(t),$o=t=>vP.test(t),bP=new Set(["length","size","percentage"]),_P=t=>lu(t,bP,M_),EP=t=>lu(t,"position",M_),CP=new Set(["image","url"]),SP=t=>lu(t,CP,IP),kP=t=>lu(t,"",TP),Tu=()=>!0,lu=(t,e,n)=>{const r=F_.exec(t);return r?r[1]?typeof e=="string"?r[1]===e:e.has(r[1]):n(r[2]):!1},RP=t=>mP.test(t)&&!gP.test(t),M_=()=>!1,TP=t=>yP.test(t),IP=t=>wP.test(t),AP=()=>{const t=Ke("colors"),e=Ke("spacing"),n=Ke("blur"),r=Ke("brightness"),o=Ke("borderColor"),i=Ke("borderRadius"),a=Ke("borderSpacing"),s=Ke("borderWidth"),u=Ke("contrast"),l=Ke("grayscale"),c=Ke("hueRotate"),d=Ke("invert"),f=Ke("gap"),h=Ke("gradientColorStops"),v=Ke("gradientColorStopPositions"),p=Ke("inset"),m=Ke("margin"),g=Ke("opacity"),y=Ke("padding"),w=Ke("saturate"),x=Ke("scale"),b=Ke("sepia"),_=Ke("skew"),E=Ke("space"),C=Ke("translate"),R=()=>["auto","contain","none"],S=()=>["auto","hidden","clip","visible","scroll"],P=()=>["auto",_e,e],A=()=>[_e,e],B=()=>["",no,Bo],M=()=>["auto",_s,_e],j=()=>["bottom","center","left","left-bottom","left-top","right","right-bottom","right-top","top"],W=()=>["solid","dashed","dotted","double","none"],U=()=>["normal","multiply","screen","overlay","darken","lighten","color-dodge","color-burn","hard-light","soft-light","difference","exclusion","hue","saturation","color","luminosity"],D=()=>["start","end","center","between","around","evenly","stretch"],F=()=>["","0",_e],$=()=>["auto","avoid","all","avoid-page","page","left","right","column"],q=()=>[_s,_e];return{cacheSize:500,separator:":",theme:{colors:[Tu],spacing:[no,Bo],blur:["none","",$o,_e],brightness:q(),borderColor:[t],borderRadius:["none","","full",$o,_e],borderSpacing:A(),borderWidth:B(),contrast:q(),grayscale:F(),hueRotate:q(),invert:F(),gap:A(),gradientColorStops:[t],gradientColorStopPositions:[xP,Bo],inset:P(),margin:P(),opacity:q(),padding:A(),saturate:q(),scale:q(),sepia:F(),skew:q(),space:A(),translate:A()},classGroups:{aspect:[{aspect:["auto","square","video",_e]}],container:["container"],columns:[{columns:[$o]}],"break-after":[{"break-after":$()}],"break-before":[{"break-before":$()}],"break-inside":[{"break-inside":["auto","avoid","avoid-page","avoid-column"]}],"box-decoration":[{"box-decoration":["slice","clone"]}],box:[{box:["border","content"]}],display:["block","inline-block","inline","flex","inline-flex","table","inline-table","table-caption","table-cell","table-column","table-column-group","table-footer-group","table-header-group","table-row-group","table-row","flow-root","grid","inline-grid","contents","list-item","hidden"],float:[{float:["right","left","none","start","end"]}],clear:[{clear:["left","right","both","none","start","end"]}],isolation:["isolate","isolation-auto"],"object-fit":[{object:["contain","cover","fill","none","scale-down"]}],"object-position":[{object:[...j(),_e]}],overflow:[{overflow:S()}],"overflow-x":[{"overflow-x":S()}],"overflow-y":[{"overflow-y":S()}],overscroll:[{overscroll:R()}],"overscroll-x":[{"overscroll-x":R()}],"overscroll-y":[{"overscroll-y":R()}],position:["static","fixed","absolute","relative","sticky"],inset:[{inset:[p]}],"inset-x":[{"inset-x":[p]}],"inset-y":[{"inset-y":[p]}],start:[{start:[p]}],end:[{end:[p]}],top:[{top:[p]}],right:[{right:[p]}],bottom:[{bottom:[p]}],left:[{left:[p]}],visibility:["visible","invisible","collapse"],z:[{z:["auto",Ru,_e]}],basis:[{basis:P()}],"flex-direction":[{flex:["row","row-reverse","col","col-reverse"]}],"flex-wrap":[{flex:["wrap","wrap-reverse","nowrap"]}],flex:[{flex:["1","auto","initial","none",_e]}],grow:[{grow:F()}],shrink:[{shrink:F()}],order:[{order:["first","last","none",Ru,_e]}],"grid-cols":[{"grid-cols":[Tu]}],"col-start-end":[{col:["auto",{span:["full",Ru,_e]},_e]}],"col-start":[{"col-start":M()}],"col-end":[{"col-end":M()}],"grid-rows":[{"grid-rows":[Tu]}],"row-start-end":[{row:["auto",{span:[Ru,_e]},_e]}],"row-start":[{"row-start":M()}],"row-end":[{"row-end":M()}],"grid-flow":[{"grid-flow":["row","col","dense","row-dense","col-dense"]}],"auto-cols":[{"auto-cols":["auto","min","max","fr",_e]}],"auto-rows":[{"auto-rows":["auto","min","max","fr",_e]}],gap:[{gap:[f]}],"gap-x":[{"gap-x":[f]}],"gap-y":[{"gap-y":[f]}],"justify-content":[{justify:["normal",...D()]}],"justify-items":[{"justify-items":["start","end","center","stretch"]}],"justify-self":[{"justify-self":["auto","start","end","center","stretch"]}],"align-content":[{content:["normal",...D(),"baseline"]}],"align-items":[{items:["start","end","center","baseline","stretch"]}],"align-self":[{self:["auto","start","end","center","stretch","baseline"]}],"place-content":[{"place-content":[...D(),"baseline"]}],"place-items":[{"place-items":["start","end","center","baseline","stretch"]}],"place-self":[{"place-self":["auto","start","end","center","stretch"]}],p:[{p:[y]}],px:[{px:[y]}],py:[{py:[y]}],ps:[{ps:[y]}],pe:[{pe:[y]}],pt:[{pt:[y]}],pr:[{pr:[y]}],pb:[{pb:[y]}],pl:[{pl:[y]}],m:[{m:[m]}],mx:[{mx:[m]}],my:[{my:[m]}],ms:[{ms:[m]}],me:[{me:[m]}],mt:[{mt:[m]}],mr:[{mr:[m]}],mb:[{mb:[m]}],ml:[{ml:[m]}],"space-x":[{"space-x":[E]}],"space-x-reverse":["space-x-reverse"],"space-y":[{"space-y":[E]}],"space-y-reverse":["space-y-reverse"],w:[{w:["auto","min","max","fit","svw","lvw","dvw",_e,e]}],"min-w":[{"min-w":[_e,e,"min","max","fit"]}],"max-w":[{"max-w":[_e,e,"none","full","min","max","fit","prose",{screen:[$o]},$o]}],h:[{h:[_e,e,"auto","min","max","fit","svh","lvh","dvh"]}],"min-h":[{"min-h":[_e,e,"min","max","fit","svh","lvh","dvh"]}],"max-h":[{"max-h":[_e,e,"min","max","fit","svh","lvh","dvh"]}],size:[{size:[_e,e,"auto","min","max","fit"]}],"font-size":[{text:["base",$o,Bo]}],"font-smoothing":["antialiased","subpixel-antialiased"],"font-style":["italic","not-italic"],"font-weight":[{font:["thin","extralight","light","normal","medium","semibold","bold","extrabold","black",qh]}],"font-family":[{font:[Tu]}],"fvn-normal":["normal-nums"],"fvn-ordinal":["ordinal"],"fvn-slashed-zero":["slashed-zero"],"fvn-figure":["lining-nums","oldstyle-nums"],"fvn-spacing":["proportional-nums","tabular-nums"],"fvn-fraction":["diagonal-fractions","stacked-fractions"],tracking:[{tracking:["tighter","tight","normal","wide","wider","widest",_e]}],"line-clamp":[{"line-clamp":["none",_s,qh]}],leading:[{leading:["none","tight","snug","normal","relaxed","loose",no,_e]}],"list-image":[{"list-image":["none",_e]}],"list-style-type":[{list:["none","disc","decimal",_e]}],"list-style-position":[{list:["inside","outside"]}],"placeholder-color":[{placeholder:[t]}],"placeholder-opacity":[{"placeholder-opacity":[g]}],"text-alignment":[{text:["left","center","right","justify","start","end"]}],"text-color":[{text:[t]}],"text-opacity":[{"text-opacity":[g]}],"text-decoration":["underline","overline","line-through","no-underline"],"text-decoration-style":[{decoration:[...W(),"wavy"]}],"text-decoration-thickness":[{decoration:["auto","from-font",no,Bo]}],"underline-offset":[{"underline-offset":["auto",no,_e]}],"text-decoration-color":[{decoration:[t]}],"text-transform":["uppercase","lowercase","capitalize","normal-case"],"text-overflow":["truncate","text-ellipsis","text-clip"],"text-wrap":[{text:["wrap","nowrap","balance","pretty"]}],indent:[{indent:A()}],"vertical-align":[{align:["baseline","top","middle","bottom","text-top","text-bottom","sub","super",_e]}],whitespace:[{whitespace:["normal","nowrap","pre","pre-line","pre-wrap","break-spaces"]}],break:[{break:["normal","words","all","keep"]}],hyphens:[{hyphens:["none","manual","auto"]}],content:[{content:["none",_e]}],"bg-attachment":[{bg:["fixed","local","scroll"]}],"bg-clip":[{"bg-clip":["border","padding","content","text"]}],"bg-opacity":[{"bg-opacity":[g]}],"bg-origin":[{"bg-origin":["border","padding","content"]}],"bg-position":[{bg:[...j(),EP]}],"bg-repeat":[{bg:["no-repeat",{repeat:["","x","y","round","space"]}]}],"bg-size":[{bg:["auto","cover","contain",_P]}],"bg-image":[{bg:["none",{"gradient-to":["t","tr","r","br","b","bl","l","tl"]},SP]}],"bg-color":[{bg:[t]}],"gradient-from-pos":[{from:[v]}],"gradient-via-pos":[{via:[v]}],"gradient-to-pos":[{to:[v]}],"gradient-from":[{from:[h]}],"gradient-via":[{via:[h]}],"gradient-to":[{to:[h]}],rounded:[{rounded:[i]}],"rounded-s":[{"rounded-s":[i]}],"rounded-e":[{"rounded-e":[i]}],"rounded-t":[{"rounded-t":[i]}],"rounded-r":[{"rounded-r":[i]}],"rounded-b":[{"rounded-b":[i]}],"rounded-l":[{"rounded-l":[i]}],"rounded-ss":[{"rounded-ss":[i]}],"rounded-se":[{"rounded-se":[i]}],"rounded-ee":[{"rounded-ee":[i]}],"rounded-es":[{"rounded-es":[i]}],"rounded-tl":[{"rounded-tl":[i]}],"rounded-tr":[{"rounded-tr":[i]}],"rounded-br":[{"rounded-br":[i]}],"rounded-bl":[{"rounded-bl":[i]}],"border-w":[{border:[s]}],"border-w-x":[{"border-x":[s]}],"border-w-y":[{"border-y":[s]}],"border-w-s":[{"border-s":[s]}],"border-w-e":[{"border-e":[s]}],"border-w-t":[{"border-t":[s]}],"border-w-r":[{"border-r":[s]}],"border-w-b":[{"border-b":[s]}],"border-w-l":[{"border-l":[s]}],"border-opacity":[{"border-opacity":[g]}],"border-style":[{border:[...W(),"hidden"]}],"divide-x":[{"divide-x":[s]}],"divide-x-reverse":["divide-x-reverse"],"divide-y":[{"divide-y":[s]}],"divide-y-reverse":["divide-y-reverse"],"divide-opacity":[{"divide-opacity":[g]}],"divide-style":[{divide:W()}],"border-color":[{border:[o]}],"border-color-x":[{"border-x":[o]}],"border-color-y":[{"border-y":[o]}],"border-color-s":[{"border-s":[o]}],"border-color-e":[{"border-e":[o]}],"border-color-t":[{"border-t":[o]}],"border-color-r":[{"border-r":[o]}],"border-color-b":[{"border-b":[o]}],"border-color-l":[{"border-l":[o]}],"divide-color":[{divide:[o]}],"outline-style":[{outline:["",...W()]}],"outline-offset":[{"outline-offset":[no,_e]}],"outline-w":[{outline:[no,Bo]}],"outline-color":[{outline:[t]}],"ring-w":[{ring:B()}],"ring-w-inset":["ring-inset"],"ring-color":[{ring:[t]}],"ring-opacity":[{"ring-opacity":[g]}],"ring-offset-w":[{"ring-offset":[no,Bo]}],"ring-offset-color":[{"ring-offset":[t]}],shadow:[{shadow:["","inner","none",$o,kP]}],"shadow-color":[{shadow:[Tu]}],opacity:[{opacity:[g]}],"mix-blend":[{"mix-blend":[...U(),"plus-lighter","plus-darker"]}],"bg-blend":[{"bg-blend":U()}],filter:[{filter:["","none"]}],blur:[{blur:[n]}],brightness:[{brightness:[r]}],contrast:[{contrast:[u]}],"drop-shadow":[{"drop-shadow":["","none",$o,_e]}],grayscale:[{grayscale:[l]}],"hue-rotate":[{"hue-rotate":[c]}],invert:[{invert:[d]}],saturate:[{saturate:[w]}],sepia:[{sepia:[b]}],"backdrop-filter":[{"backdrop-filter":["","none"]}],"backdrop-blur":[{"backdrop-blur":[n]}],"backdrop-brightness":[{"backdrop-brightness":[r]}],"backdrop-contrast":[{"backdrop-contrast":[u]}],"backdrop-grayscale":[{"backdrop-grayscale":[l]}],"backdrop-hue-rotate":[{"backdrop-hue-rotate":[c]}],"backdrop-invert":[{"backdrop-invert":[d]}],"backdrop-opacity":[{"backdrop-opacity":[g]}],"backdrop-saturate":[{"backdrop-saturate":[w]}],"backdrop-sepia":[{"backdrop-sepia":[b]}],"border-collapse":[{border:["collapse","separate"]}],"border-spacing":[{"border-spacing":[a]}],"border-spacing-x":[{"border-spacing-x":[a]}],"border-spacing-y":[{"border-spacing-y":[a]}],"table-layout":[{table:["auto","fixed"]}],caption:[{caption:["top","bottom"]}],transition:[{transition:["none","all","","colors","opacity","shadow","transform",_e]}],duration:[{duration:q()}],ease:[{ease:["linear","in","out","in-out",_e]}],delay:[{delay:q()}],animate:[{animate:["none","spin","ping","pulse","bounce",_e]}],transform:[{transform:["","gpu","none"]}],scale:[{scale:[x]}],"scale-x":[{"scale-x":[x]}],"scale-y":[{"scale-y":[x]}],rotate:[{rotate:[Ru,_e]}],"translate-x":[{"translate-x":[C]}],"translate-y":[{"translate-y":[C]}],"skew-x":[{"skew-x":[_]}],"skew-y":[{"skew-y":[_]}],"transform-origin":[{origin:["center","top","top-right","right","bottom-right","bottom","bottom-left","left","top-left",_e]}],accent:[{accent:["auto",t]}],appearance:[{appearance:["none","auto"]}],cursor:[{cursor:["auto","default","pointer","wait","text","move","help","not-allowed","none","context-menu","progress","cell","crosshair","vertical-text","alias","copy","no-drop","grab","grabbing","all-scroll","col-resize","row-resize","n-resize","e-resize","s-resize","w-resize","ne-resize","nw-resize","se-resize","sw-resize","ew-resize","ns-resize","nesw-resize","nwse-resize","zoom-in","zoom-out",_e]}],"caret-color":[{caret:[t]}],"pointer-events":[{"pointer-events":["none","auto"]}],resize:[{resize:["none","y","x",""]}],"scroll-behavior":[{scroll:["auto","smooth"]}],"scroll-m":[{"scroll-m":A()}],"scroll-mx":[{"scroll-mx":A()}],"scroll-my":[{"scroll-my":A()}],"scroll-ms":[{"scroll-ms":A()}],"scroll-me":[{"scroll-me":A()}],"scroll-mt":[{"scroll-mt":A()}],"scroll-mr":[{"scroll-mr":A()}],"scroll-mb":[{"scroll-mb":A()}],"scroll-ml":[{"scroll-ml":A()}],"scroll-p":[{"scroll-p":A()}],"scroll-px":[{"scroll-px":A()}],"scroll-py":[{"scroll-py":A()}],"scroll-ps":[{"scroll-ps":A()}],"scroll-pe":[{"scroll-pe":A()}],"scroll-pt":[{"scroll-pt":A()}],"scroll-pr":[{"scroll-pr":A()}],"scroll-pb":[{"scroll-pb":A()}],"scroll-pl":[{"scroll-pl":A()}],"snap-align":[{snap:["start","end","center","align-none"]}],"snap-stop":[{snap:["normal","always"]}],"snap-type":[{snap:["none","x","y","both"]}],"snap-strictness":[{snap:["mandatory","proximity"]}],touch:[{touch:["auto","none","manipulation"]}],"touch-x":[{"touch-pan":["x","left","right"]}],"touch-y":[{"touch-pan":["y","up","down"]}],"touch-pz":["touch-pinch-zoom"],select:[{select:["none","text","all","auto"]}],"will-change":[{"will-change":["auto","scroll","contents","transform",_e]}],fill:[{fill:[t,"none"]}],"stroke-w":[{stroke:[no,Bo,qh]}],stroke:[{stroke:[t,"none"]}],sr:["sr-only","not-sr-only"],"forced-color-adjust":[{"forced-color-adjust":["auto","none"]}]},conflictingClassGroups:{overflow:["overflow-x","overflow-y"],overscroll:["overscroll-x","overscroll-y"],inset:["inset-x","inset-y","start","end","top","right","bottom","left"],"inset-x":["right","left"],"inset-y":["top","bottom"],flex:["basis","grow","shrink"],gap:["gap-x","gap-y"],p:["px","py","ps","pe","pt","pr","pb","pl"],px:["pr","pl"],py:["pt","pb"],m:["mx","my","ms","me","mt","mr","mb","ml"],mx:["mr","ml"],my:["mt","mb"],size:["w","h"],"font-size":["leading"],"fvn-normal":["fvn-ordinal","fvn-slashed-zero","fvn-figure","fvn-spacing","fvn-fraction"],"fvn-ordinal":["fvn-normal"],"fvn-slashed-zero":["fvn-normal"],"fvn-figure":["fvn-normal"],"fvn-spacing":["fvn-normal"],"fvn-fraction":["fvn-normal"],"line-clamp":["display","overflow"],rounded:["rounded-s","rounded-e","rounded-t","rounded-r","rounded-b","rounded-l","rounded-ss","rounded-se","rounded-ee","rounded-es","rounded-tl","rounded-tr","rounded-br","rounded-bl"],"rounded-s":["rounded-ss","rounded-es"],"rounded-e":["rounded-se","rounded-ee"],"rounded-t":["rounded-tl","rounded-tr"],"rounded-r":["rounded-tr","rounded-br"],"rounded-b":["rounded-br","rounded-bl"],"rounded-l":["rounded-tl","rounded-bl"],"border-spacing":["border-spacing-x","border-spacing-y"],"border-w":["border-w-s","border-w-e","border-w-t","border-w-r","border-w-b","border-w-l"],"border-w-x":["border-w-r","border-w-l"],"border-w-y":["border-w-t","border-w-b"],"border-color":["border-color-s","border-color-e","border-color-t","border-color-r","border-color-b","border-color-l"],"border-color-x":["border-color-r","border-color-l"],"border-color-y":["border-color-t","border-color-b"],"scroll-m":["scroll-mx","scroll-my","scroll-ms","scroll-me","scroll-mt","scroll-mr","scroll-mb","scroll-ml"],"scroll-mx":["scroll-mr","scroll-ml"],"scroll-my":["scroll-mt","scroll-mb"],"scroll-p":["scroll-px","scroll-py","scroll-ps","scroll-pe","scroll-pt","scroll-pr","scroll-pb","scroll-pl"],"scroll-px":["scroll-pr","scroll-pl"],"scroll-py":["scroll-pt","scroll-pb"],touch:["touch-x","touch-y","touch-pz"],"touch-x":["touch"],"touch-y":["touch"],"touch-pz":["touch"]},conflictingClassGroupModifiers:{"font-size":["leading"]}}},wV=fP(AP);var O1=["light","dark"],PP="(prefers-color-scheme: dark)",DP=k.createContext(void 0),NP={setTheme:t=>{},themes:[]},xV=()=>{var t;return(t=k.useContext(DP))!=null?t:NP};k.memo(({forcedTheme:t,storageKey:e,attribute:n,enableSystem:r,enableColorScheme:o,defaultTheme:i,value:a,attrs:s,nonce:u})=>{let l=i==="system",c=n==="class"?`var d=document.documentElement,c=d.classList;${`c.remove(${s.map(v=>`'${v}'`).join(",")})`};`:`var d=document.documentElement,n='${n}',s='setAttribute';`,d=o?O1.includes(i)&&i?`if(e==='light'||e==='dark'||!e)d.style.colorScheme=e||'${i}'`:"if(e==='light'||e==='dark')d.style.colorScheme=e":"",f=(v,p=!1,m=!0)=>{let g=a?a[v]:v,y=p?v+"|| ''":`'${g}'`,w="";return o&&m&&!p&&O1.includes(v)&&(w+=`d.style.colorScheme = '${v}';`),n==="class"?p||g?w+=`c.add(${y})`:w+="null":g&&(w+=`d[s](n,${y})`),w},h=t?`!function(){${c}${f(t)}}()`:r?`!function(){try{${c}var e=localStorage.getItem('${e}');if('system'===e||(!e&&${l})){var t='${PP}',m=window.matchMedia(t);if(m.media!==t||m.matches){${f("dark")}}else{${f("light")}}}else if(e){${a?`var x=${JSON.stringify(a)};`:""}${f(a?"x[e]":"e",!0)}}${l?"":"else{"+f(i,!1,!1)+"}"}${d}}catch(e){}}()`:`!function(){try{${c}var e=localStorage.getItem('${e}');if(e){${a?`var x=${JSON.stringify(a)};`:""}${f(a?"x[e]":"e",!0)}}else{${f(i,!1,!1)};}${d}}catch(t){}}();`;return k.createElement("script",{nonce:u,dangerouslySetInnerHTML:{__html:h}})});var OP=t=>{switch(t){case"success":return LP;case"info":return $P;case"warning":return BP;case"error":return jP;default:return null}},FP=Array(12).fill(0),MP=({visible:t,className:e})=>J.createElement("div",{className:["sonner-loading-wrapper",e].filter(Boolean).join(" "),"data-visible":t},J.createElement("div",{className:"sonner-spinner"},FP.map((n,r)=>J.createElement("div",{className:"sonner-loading-bar",key:`spinner-bar-${r}`})))),LP=J.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",height:"20",width:"20"},J.createElement("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.857-9.809a.75.75 0 00-1.214-.882l-3.483 4.79-1.88-1.88a.75.75 0 10-1.06 1.061l2.5 2.5a.75.75 0 001.137-.089l4-5.5z",clipRule:"evenodd"})),BP=J.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",height:"20",width:"20"},J.createElement("path",{fillRule:"evenodd",d:"M9.401 3.003c1.155-2 4.043-2 5.197 0l7.355 12.748c1.154 2-.29 4.5-2.599 4.5H4.645c-2.309 0-3.752-2.5-2.598-4.5L9.4 3.003zM12 8.25a.75.75 0 01.75.75v3.75a.75.75 0 01-1.5 0V9a.75.75 0 01.75-.75zm0 8.25a.75.75 0 100-1.5.75.75 0 000 1.5z",clipRule:"evenodd"})),$P=J.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",height:"20",width:"20"},J.createElement("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a.75.75 0 000 1.5h.253a.25.25 0 01.244.304l-.459 2.066A1.75 1.75 0 0010.747 15H11a.75.75 0 000-1.5h-.253a.25.25 0 01-.244-.304l.459-2.066A1.75 1.75 0 009.253 9H9z",clipRule:"evenodd"})),jP=J.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",height:"20",width:"20"},J.createElement("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-8-5a.75.75 0 01.75.75v4.5a.75.75 0 01-1.5 0v-4.5A.75.75 0 0110 5zm0 10a1 1 0 100-2 1 1 0 000 2z",clipRule:"evenodd"})),WP=J.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"},J.createElement("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),J.createElement("line",{x1:"6",y1:"6",x2:"18",y2:"18"})),UP=()=>{let[t,e]=J.useState(document.hidden);return J.useEffect(()=>{let n=()=>{e(document.hidden)};return document.addEventListener("visibilitychange",n),()=>window.removeEventListener("visibilitychange",n)},[]),t},Bv=1,zP=class{constructor(){this.subscribe=e=>(this.subscribers.push(e),()=>{let n=this.subscribers.indexOf(e);this.subscribers.splice(n,1)}),this.publish=e=>{this.subscribers.forEach(n=>n(e))},this.addToast=e=>{this.publish(e),this.toasts=[...this.toasts,e]},this.create=e=>{var n;let{message:r,...o}=e,i=typeof(e==null?void 0:e.id)=="number"||((n=e.id)==null?void 0:n.length)>0?e.id:Bv++,a=this.toasts.find(u=>u.id===i),s=e.dismissible===void 0?!0:e.dismissible;return this.dismissedToasts.has(i)&&this.dismissedToasts.delete(i),a?this.toasts=this.toasts.map(u=>u.id===i?(this.publish({...u,...e,id:i,title:r}),{...u,...e,id:i,dismissible:s,title:r}):u):this.addToast({title:r,...o,dismissible:s,id:i}),i},this.dismiss=e=>(this.dismissedToasts.add(e),e||this.toasts.forEach(n=>{this.subscribers.forEach(r=>r({id:n.id,dismiss:!0}))}),this.subscribers.forEach(n=>n({id:e,dismiss:!0})),e),this.message=(e,n)=>this.create({...n,message:e}),this.error=(e,n)=>this.create({...n,message:e,type:"error"}),this.success=(e,n)=>this.create({...n,type:"success",message:e}),this.info=(e,n)=>this.create({...n,type:"info",message:e}),this.warning=(e,n)=>this.create({...n,type:"warning",message:e}),this.loading=(e,n)=>this.create({...n,type:"loading",message:e}),this.promise=(e,n)=>{if(!n)return;let r;n.loading!==void 0&&(r=this.create({...n,promise:e,type:"loading",message:n.loading,description:typeof n.description!="function"?n.description:void 0}));let o=e instanceof Promise?e:e(),i=r!==void 0,a,s=o.then(async l=>{if(a=["resolve",l],J.isValidElement(l))i=!1,this.create({id:r,type:"default",message:l});else if(HP(l)&&!l.ok){i=!1;let c=typeof n.error=="function"?await n.error(`HTTP error! status: ${l.status}`):n.error,d=typeof n.description=="function"?await n.description(`HTTP error! status: ${l.status}`):n.description;this.create({id:r,type:"error",message:c,description:d})}else if(n.success!==void 0){i=!1;let c=typeof n.success=="function"?await n.success(l):n.success,d=typeof n.description=="function"?await n.description(l):n.description;this.create({id:r,type:"success",message:c,description:d})}}).catch(async l=>{if(a=["reject",l],n.error!==void 0){i=!1;let c=typeof n.error=="function"?await n.error(l):n.error,d=typeof n.description=="function"?await n.description(l):n.description;this.create({id:r,type:"error",message:c,description:d})}}).finally(()=>{var l;i&&(this.dismiss(r),r=void 0),(l=n.finally)==null||l.call(n)}),u=()=>new Promise((l,c)=>s.then(()=>a[0]==="reject"?c(a[1]):l(a[1])).catch(c));return typeof r!="string"&&typeof r!="number"?{unwrap:u}:Object.assign(r,{unwrap:u})},this.custom=(e,n)=>{let r=(n==null?void 0:n.id)||Bv++;return this.create({jsx:e(r),id:r,...n}),r},this.getActiveToasts=()=>this.toasts.filter(e=>!this.dismissedToasts.has(e.id)),this.subscribers=[],this.toasts=[],this.dismissedToasts=new Set}},fn=new zP,VP=(t,e)=>{let n=(e==null?void 0:e.id)||Bv++;return fn.addToast({title:t,...e,id:n}),n},HP=t=>t&&typeof t=="object"&&"ok"in t&&typeof t.ok=="boolean"&&"status"in t&&typeof t.status=="number",GP=VP,qP=()=>fn.toasts,KP=()=>fn.getActiveToasts();Object.assign(GP,{success:fn.success,info:fn.info,warning:fn.warning,error:fn.error,custom:fn.custom,message:fn.message,promise:fn.promise,dismiss:fn.dismiss,loading:fn.loading},{getHistory:qP,getToasts:KP});function XP(t,{insertAt:e}={}){if(typeof document>"u")return;let n=document.head||document.getElementsByTagName("head")[0],r=document.createElement("style");r.type="text/css",e==="top"&&n.firstChild?n.insertBefore(r,n.firstChild):n.appendChild(r),r.styleSheet?r.styleSheet.cssText=t:r.appendChild(document.createTextNode(t))}XP(`:where(html[dir="ltr"]),:where([data-sonner-toaster][dir="ltr"]){--toast-icon-margin-start: -3px;--toast-icon-margin-end: 4px;--toast-svg-margin-start: -1px;--toast-svg-margin-end: 0px;--toast-button-margin-start: auto;--toast-button-margin-end: 0;--toast-close-button-start: 0;--toast-close-button-end: unset;--toast-close-button-transform: translate(-35%, -35%)}:where(html[dir="rtl"]),:where([data-sonner-toaster][dir="rtl"]){--toast-icon-margin-start: 4px;--toast-icon-margin-end: -3px;--toast-svg-margin-start: 0px;--toast-svg-margin-end: -1px;--toast-button-margin-start: 0;--toast-button-margin-end: auto;--toast-close-button-start: unset;--toast-close-button-end: 0;--toast-close-button-transform: translate(35%, -35%)}:where([data-sonner-toaster]){position:fixed;width:var(--width);font-family:ui-sans-serif,system-ui,-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Helvetica Neue,Arial,Noto Sans,sans-serif,Apple Color Emoji,Segoe UI Emoji,Segoe UI Symbol,Noto Color Emoji;--gray1: hsl(0, 0%, 99%);--gray2: hsl(0, 0%, 97.3%);--gray3: hsl(0, 0%, 95.1%);--gray4: hsl(0, 0%, 93%);--gray5: hsl(0, 0%, 90.9%);--gray6: hsl(0, 0%, 88.7%);--gray7: hsl(0, 0%, 85.8%);--gray8: hsl(0, 0%, 78%);--gray9: hsl(0, 0%, 56.1%);--gray10: hsl(0, 0%, 52.3%);--gray11: hsl(0, 0%, 43.5%);--gray12: hsl(0, 0%, 9%);--border-radius: 8px;box-sizing:border-box;padding:0;margin:0;list-style:none;outline:none;z-index:999999999;transition:transform .4s ease}:where([data-sonner-toaster][data-lifted="true"]){transform:translateY(-10px)}@media (hover: none) and (pointer: coarse){:where([data-sonner-toaster][data-lifted="true"]){transform:none}}:where([data-sonner-toaster][data-x-position="right"]){right:var(--offset-right)}:where([data-sonner-toaster][data-x-position="left"]){left:var(--offset-left)}:where([data-sonner-toaster][data-x-position="center"]){left:50%;transform:translate(-50%)}:where([data-sonner-toaster][data-y-position="top"]){top:var(--offset-top)}:where([data-sonner-toaster][data-y-position="bottom"]){bottom:var(--offset-bottom)}:where([data-sonner-toast]){--y: translateY(100%);--lift-amount: calc(var(--lift) * var(--gap));z-index:var(--z-index);position:absolute;opacity:0;transform:var(--y);filter:blur(0);touch-action:none;transition:transform .4s,opacity .4s,height .4s,box-shadow .2s;box-sizing:border-box;outline:none;overflow-wrap:anywhere}:where([data-sonner-toast][data-styled="true"]){padding:16px;background:var(--normal-bg);border:1px solid var(--normal-border);color:var(--normal-text);border-radius:var(--border-radius);box-shadow:0 4px 12px #0000001a;width:var(--width);font-size:13px;display:flex;align-items:center;gap:6px}:where([data-sonner-toast]:focus-visible){box-shadow:0 4px 12px #0000001a,0 0 0 2px #0003}:where([data-sonner-toast][data-y-position="top"]){top:0;--y: translateY(-100%);--lift: 1;--lift-amount: calc(1 * var(--gap))}:where([data-sonner-toast][data-y-position="bottom"]){bottom:0;--y: translateY(100%);--lift: -1;--lift-amount: calc(var(--lift) * var(--gap))}:where([data-sonner-toast]) :where([data-description]){font-weight:400;line-height:1.4;color:inherit}:where([data-sonner-toast]) :where([data-title]){font-weight:500;line-height:1.5;color:inherit}:where([data-sonner-toast]) :where([data-icon]){display:flex;height:16px;width:16px;position:relative;justify-content:flex-start;align-items:center;flex-shrink:0;margin-left:var(--toast-icon-margin-start);margin-right:var(--toast-icon-margin-end)}:where([data-sonner-toast][data-promise="true"]) :where([data-icon])>svg{opacity:0;transform:scale(.8);transform-origin:center;animation:sonner-fade-in .3s ease forwards}:where([data-sonner-toast]) :where([data-icon])>*{flex-shrink:0}:where([data-sonner-toast]) :where([data-icon]) svg{margin-left:var(--toast-svg-margin-start);margin-right:var(--toast-svg-margin-end)}:where([data-sonner-toast]) :where([data-content]){display:flex;flex-direction:column;gap:2px}[data-sonner-toast][data-styled=true] [data-button]{border-radius:4px;padding-left:8px;padding-right:8px;height:24px;font-size:12px;color:var(--normal-bg);background:var(--normal-text);margin-left:var(--toast-button-margin-start);margin-right:var(--toast-button-margin-end);border:none;cursor:pointer;outline:none;display:flex;align-items:center;flex-shrink:0;transition:opacity .4s,box-shadow .2s}:where([data-sonner-toast]) :where([data-button]):focus-visible{box-shadow:0 0 0 2px #0006}:where([data-sonner-toast]) :where([data-button]):first-of-type{margin-left:var(--toast-button-margin-start);margin-right:var(--toast-button-margin-end)}:where([data-sonner-toast]) :where([data-cancel]){color:var(--normal-text);background:rgba(0,0,0,.08)}:where([data-sonner-toast][data-theme="dark"]) :where([data-cancel]){background:rgba(255,255,255,.3)}:where([data-sonner-toast]) :where([data-close-button]){position:absolute;left:var(--toast-close-button-start);right:var(--toast-close-button-end);top:0;height:20px;width:20px;display:flex;justify-content:center;align-items:center;padding:0;color:var(--gray12);border:1px solid var(--gray4);transform:var(--toast-close-button-transform);border-radius:50%;cursor:pointer;z-index:1;transition:opacity .1s,background .2s,border-color .2s}[data-sonner-toast] [data-close-button]{background:var(--gray1)}:where([data-sonner-toast]) :where([data-close-button]):focus-visible{box-shadow:0 4px 12px #0000001a,0 0 0 2px #0003}:where([data-sonner-toast]) :where([data-disabled="true"]){cursor:not-allowed}:where([data-sonner-toast]):hover :where([data-close-button]):hover{background:var(--gray2);border-color:var(--gray5)}:where([data-sonner-toast][data-swiping="true"]):before{content:"";position:absolute;left:-50%;right:-50%;height:100%;z-index:-1}:where([data-sonner-toast][data-y-position="top"][data-swiping="true"]):before{bottom:50%;transform:scaleY(3) translateY(50%)}:where([data-sonner-toast][data-y-position="bottom"][data-swiping="true"]):before{top:50%;transform:scaleY(3) translateY(-50%)}:where([data-sonner-toast][data-swiping="false"][data-removed="true"]):before{content:"";position:absolute;inset:0;transform:scaleY(2)}:where([data-sonner-toast]):after{content:"";position:absolute;left:0;height:calc(var(--gap) + 1px);bottom:100%;width:100%}:where([data-sonner-toast][data-mounted="true"]){--y: translateY(0);opacity:1}:where([data-sonner-toast][data-expanded="false"][data-front="false"]){--scale: var(--toasts-before) * .05 + 1;--y: translateY(calc(var(--lift-amount) * var(--toasts-before))) scale(calc(-1 * var(--scale)));height:var(--front-toast-height)}:where([data-sonner-toast])>*{transition:opacity .4s}:where([data-sonner-toast][data-expanded="false"][data-front="false"][data-styled="true"])>*{opacity:0}:where([data-sonner-toast][data-visible="false"]){opacity:0;pointer-events:none}:where([data-sonner-toast][data-mounted="true"][data-expanded="true"]){--y: translateY(calc(var(--lift) * var(--offset)));height:var(--initial-height)}:where([data-sonner-toast][data-removed="true"][data-front="true"][data-swipe-out="false"]){--y: translateY(calc(var(--lift) * -100%));opacity:0}:where([data-sonner-toast][data-removed="true"][data-front="false"][data-swipe-out="false"][data-expanded="true"]){--y: translateY(calc(var(--lift) * var(--offset) + var(--lift) * -100%));opacity:0}:where([data-sonner-toast][data-removed="true"][data-front="false"][data-swipe-out="false"][data-expanded="false"]){--y: translateY(40%);opacity:0;transition:transform .5s,opacity .2s}:where([data-sonner-toast][data-removed="true"][data-front="false"]):before{height:calc(var(--initial-height) + 20%)}[data-sonner-toast][data-swiping=true]{transform:var(--y) translateY(var(--swipe-amount-y, 0px)) translate(var(--swipe-amount-x, 0px));transition:none}[data-sonner-toast][data-swiped=true]{user-select:none}[data-sonner-toast][data-swipe-out=true][data-y-position=bottom],[data-sonner-toast][data-swipe-out=true][data-y-position=top]{animation-duration:.2s;animation-timing-function:ease-out;animation-fill-mode:forwards}[data-sonner-toast][data-swipe-out=true][data-swipe-direction=left]{animation-name:swipe-out-left}[data-sonner-toast][data-swipe-out=true][data-swipe-direction=right]{animation-name:swipe-out-right}[data-sonner-toast][data-swipe-out=true][data-swipe-direction=up]{animation-name:swipe-out-up}[data-sonner-toast][data-swipe-out=true][data-swipe-direction=down]{animation-name:swipe-out-down}@keyframes swipe-out-left{0%{transform:var(--y) translate(var(--swipe-amount-x));opacity:1}to{transform:var(--y) translate(calc(var(--swipe-amount-x) - 100%));opacity:0}}@keyframes swipe-out-right{0%{transform:var(--y) translate(var(--swipe-amount-x));opacity:1}to{transform:var(--y) translate(calc(var(--swipe-amount-x) + 100%));opacity:0}}@keyframes swipe-out-up{0%{transform:var(--y) translateY(var(--swipe-amount-y));opacity:1}to{transform:var(--y) translateY(calc(var(--swipe-amount-y) - 100%));opacity:0}}@keyframes swipe-out-down{0%{transform:var(--y) translateY(var(--swipe-amount-y));opacity:1}to{transform:var(--y) translateY(calc(var(--swipe-amount-y) + 100%));opacity:0}}@media (max-width: 600px){[data-sonner-toaster]{position:fixed;right:var(--mobile-offset-right);left:var(--mobile-offset-left);width:100%}[data-sonner-toaster][dir=rtl]{left:calc(var(--mobile-offset-left) * -1)}[data-sonner-toaster] [data-sonner-toast]{left:0;right:0;width:calc(100% - var(--mobile-offset-left) * 2)}[data-sonner-toaster][data-x-position=left]{left:var(--mobile-offset-left)}[data-sonner-toaster][data-y-position=bottom]{bottom:var(--mobile-offset-bottom)}[data-sonner-toaster][data-y-position=top]{top:var(--mobile-offset-top)}[data-sonner-toaster][data-x-position=center]{left:var(--mobile-offset-left);right:var(--mobile-offset-right);transform:none}}[data-sonner-toaster][data-theme=light]{--normal-bg: #fff;--normal-border: var(--gray4);--normal-text: var(--gray12);--success-bg: hsl(143, 85%, 96%);--success-border: hsl(145, 92%, 91%);--success-text: hsl(140, 100%, 27%);--info-bg: hsl(208, 100%, 97%);--info-border: hsl(221, 91%, 91%);--info-text: hsl(210, 92%, 45%);--warning-bg: hsl(49, 100%, 97%);--warning-border: hsl(49, 91%, 91%);--warning-text: hsl(31, 92%, 45%);--error-bg: hsl(359, 100%, 97%);--error-border: hsl(359, 100%, 94%);--error-text: hsl(360, 100%, 45%)}[data-sonner-toaster][data-theme=light] [data-sonner-toast][data-invert=true]{--normal-bg: #000;--normal-border: hsl(0, 0%, 20%);--normal-text: var(--gray1)}[data-sonner-toaster][data-theme=dark] [data-sonner-toast][data-invert=true]{--normal-bg: #fff;--normal-border: var(--gray3);--normal-text: var(--gray12)}[data-sonner-toaster][data-theme=dark]{--normal-bg: #000;--normal-bg-hover: hsl(0, 0%, 12%);--normal-border: hsl(0, 0%, 20%);--normal-border-hover: hsl(0, 0%, 25%);--normal-text: var(--gray1);--success-bg: hsl(150, 100%, 6%);--success-border: hsl(147, 100%, 12%);--success-text: hsl(150, 86%, 65%);--info-bg: hsl(215, 100%, 6%);--info-border: hsl(223, 100%, 12%);--info-text: hsl(216, 87%, 65%);--warning-bg: hsl(64, 100%, 6%);--warning-border: hsl(60, 100%, 12%);--warning-text: hsl(46, 87%, 65%);--error-bg: hsl(358, 76%, 10%);--error-border: hsl(357, 89%, 16%);--error-text: hsl(358, 100%, 81%)}[data-sonner-toaster][data-theme=dark] [data-sonner-toast] [data-close-button]{background:var(--normal-bg);border-color:var(--normal-border);color:var(--normal-text)}[data-sonner-toaster][data-theme=dark] [data-sonner-toast] [data-close-button]:hover{background:var(--normal-bg-hover);border-color:var(--normal-border-hover)}[data-rich-colors=true][data-sonner-toast][data-type=success],[data-rich-colors=true][data-sonner-toast][data-type=success] [data-close-button]{background:var(--success-bg);border-color:var(--success-border);color:var(--success-text)}[data-rich-colors=true][data-sonner-toast][data-type=info],[data-rich-colors=true][data-sonner-toast][data-type=info] [data-close-button]{background:var(--info-bg);border-color:var(--info-border);color:var(--info-text)}[data-rich-colors=true][data-sonner-toast][data-type=warning],[data-rich-colors=true][data-sonner-toast][data-type=warning] [data-close-button]{background:var(--warning-bg);border-color:var(--warning-border);color:var(--warning-text)}[data-rich-colors=true][data-sonner-toast][data-type=error],[data-rich-colors=true][data-sonner-toast][data-type=error] [data-close-button]{background:var(--error-bg);border-color:var(--error-border);color:var(--error-text)}.sonner-loading-wrapper{--size: 16px;height:var(--size);width:var(--size);position:absolute;inset:0;z-index:10}.sonner-loading-wrapper[data-visible=false]{transform-origin:center;animation:sonner-fade-out .2s ease forwards}.sonner-spinner{position:relative;top:50%;left:50%;height:var(--size);width:var(--size)}.sonner-loading-bar{animation:sonner-spin 1.2s linear infinite;background:var(--gray11);border-radius:6px;height:8%;left:-10%;position:absolute;top:-3.9%;width:24%}.sonner-loading-bar:nth-child(1){animation-delay:-1.2s;transform:rotate(.0001deg) translate(146%)}.sonner-loading-bar:nth-child(2){animation-delay:-1.1s;transform:rotate(30deg) translate(146%)}.sonner-loading-bar:nth-child(3){animation-delay:-1s;transform:rotate(60deg) translate(146%)}.sonner-loading-bar:nth-child(4){animation-delay:-.9s;transform:rotate(90deg) translate(146%)}.sonner-loading-bar:nth-child(5){animation-delay:-.8s;transform:rotate(120deg) translate(146%)}.sonner-loading-bar:nth-child(6){animation-delay:-.7s;transform:rotate(150deg) translate(146%)}.sonner-loading-bar:nth-child(7){animation-delay:-.6s;transform:rotate(180deg) translate(146%)}.sonner-loading-bar:nth-child(8){animation-delay:-.5s;transform:rotate(210deg) translate(146%)}.sonner-loading-bar:nth-child(9){animation-delay:-.4s;transform:rotate(240deg) translate(146%)}.sonner-loading-bar:nth-child(10){animation-delay:-.3s;transform:rotate(270deg) translate(146%)}.sonner-loading-bar:nth-child(11){animation-delay:-.2s;transform:rotate(300deg) translate(146%)}.sonner-loading-bar:nth-child(12){animation-delay:-.1s;transform:rotate(330deg) translate(146%)}@keyframes sonner-fade-in{0%{opacity:0;transform:scale(.8)}to{opacity:1;transform:scale(1)}}@keyframes sonner-fade-out{0%{opacity:1;transform:scale(1)}to{opacity:0;transform:scale(.8)}}@keyframes sonner-spin{0%{opacity:1}to{opacity:.15}}@media (prefers-reduced-motion){[data-sonner-toast],[data-sonner-toast]>*,.sonner-loading-bar{transition:none!important;animation:none!important}}.sonner-loader{position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);transform-origin:center;transition:opacity .2s,transform .2s}.sonner-loader[data-visible=false]{opacity:0;transform:scale(.8) translate(-50%,-50%)}
`);function Tc(t){return t.label!==void 0}var YP=3,QP="32px",JP="16px",F1=4e3,ZP=356,eD=14,tD=20,nD=200;function ar(...t){return t.filter(Boolean).join(" ")}function rD(t){let[e,n]=t.split("-"),r=[];return e&&r.push(e),n&&r.push(n),r}var oD=t=>{var e,n,r,o,i,a,s,u,l,c,d;let{invert:f,toast:h,unstyled:v,interacting:p,setHeights:m,visibleToasts:g,heights:y,index:w,toasts:x,expanded:b,removeToast:_,defaultRichColors:E,closeButton:C,style:R,cancelButtonStyle:S,actionButtonStyle:P,className:A="",descriptionClassName:B="",duration:M,position:j,gap:W,loadingIcon:U,expandByDefault:D,classNames:F,icons:$,closeButtonAriaLabel:q="Close toast",pauseWhenPageIsHidden:K}=t,[Q,Z]=J.useState(null),[ue,fe]=J.useState(null),[oe,xe]=J.useState(!1),[ye,Be]=J.useState(!1),[me,Ae]=J.useState(!1),[Ce,Ue]=J.useState(!1),[ze,je]=J.useState(!1),[ln,jt]=J.useState(0),[ft,to]=J.useState(0),Zt=J.useRef(h.duration||M||F1),er=J.useRef(null),Nt=J.useRef(null),No=w===0,tr=w+1<=g,Wt=h.type,Cn=h.dismissible!==!1,$n=h.className||"",yu=h.descriptionClassName||"",Ma=J.useMemo(()=>y.findIndex(we=>we.toastId===h.id)||0,[y,h.id]),gh=J.useMemo(()=>{var we;return(we=h.closeButton)!=null?we:C},[h.closeButton,C]),sc=J.useMemo(()=>h.duration||M||F1,[h.duration,M]),ji=J.useRef(0),kr=J.useRef(0),La=J.useRef(0),Ba=J.useRef(null),[IR,AR]=j.split("-"),p0=J.useMemo(()=>y.reduce((we,We,Je)=>Je>=Ma?we:we+We.height,0),[y,Ma]),v0=UP(),PR=h.invert||f,yh=Wt==="loading";kr.current=J.useMemo(()=>Ma*W+p0,[Ma,p0]),J.useEffect(()=>{Zt.current=sc},[sc]),J.useEffect(()=>{xe(!0)},[]),J.useEffect(()=>{let we=Nt.current;if(we){let We=we.getBoundingClientRect().height;return to(We),m(Je=>[{toastId:h.id,height:We,position:h.position},...Je]),()=>m(Je=>Je.filter(nr=>nr.toastId!==h.id))}},[m,h.id]),J.useLayoutEffect(()=>{if(!oe)return;let we=Nt.current,We=we.style.height;we.style.height="auto";let Je=we.getBoundingClientRect().height;we.style.height=We,to(Je),m(nr=>nr.find(rr=>rr.toastId===h.id)?nr.map(rr=>rr.toastId===h.id?{...rr,height:Je}:rr):[{toastId:h.id,height:Je,position:h.position},...nr])},[oe,h.title,h.description,m,h.id]);let Oo=J.useCallback(()=>{Be(!0),jt(kr.current),m(we=>we.filter(We=>We.toastId!==h.id)),setTimeout(()=>{_(h)},nD)},[h,_,m,kr]);J.useEffect(()=>{if(h.promise&&Wt==="loading"||h.duration===1/0||h.type==="loading")return;let we;return b||p||K&&v0?(()=>{if(La.current<ji.current){let We=new Date().getTime()-ji.current;Zt.current=Zt.current-We}La.current=new Date().getTime()})():Zt.current!==1/0&&(ji.current=new Date().getTime(),we=setTimeout(()=>{var We;(We=h.onAutoClose)==null||We.call(h,h),Oo()},Zt.current)),()=>clearTimeout(we)},[b,p,h,Wt,K,v0,Oo]),J.useEffect(()=>{h.delete&&Oo()},[Oo,h.delete]);function DR(){var we,We,Je;return $!=null&&$.loading?J.createElement("div",{className:ar(F==null?void 0:F.loader,(we=h==null?void 0:h.classNames)==null?void 0:we.loader,"sonner-loader"),"data-visible":Wt==="loading"},$.loading):U?J.createElement("div",{className:ar(F==null?void 0:F.loader,(We=h==null?void 0:h.classNames)==null?void 0:We.loader,"sonner-loader"),"data-visible":Wt==="loading"},U):J.createElement(MP,{className:ar(F==null?void 0:F.loader,(Je=h==null?void 0:h.classNames)==null?void 0:Je.loader),visible:Wt==="loading"})}return J.createElement("li",{tabIndex:0,ref:Nt,className:ar(A,$n,F==null?void 0:F.toast,(e=h==null?void 0:h.classNames)==null?void 0:e.toast,F==null?void 0:F.default,F==null?void 0:F[Wt],(n=h==null?void 0:h.classNames)==null?void 0:n[Wt]),"data-sonner-toast":"","data-rich-colors":(r=h.richColors)!=null?r:E,"data-styled":!(h.jsx||h.unstyled||v),"data-mounted":oe,"data-promise":!!h.promise,"data-swiped":ze,"data-removed":ye,"data-visible":tr,"data-y-position":IR,"data-x-position":AR,"data-index":w,"data-front":No,"data-swiping":me,"data-dismissible":Cn,"data-type":Wt,"data-invert":PR,"data-swipe-out":Ce,"data-swipe-direction":ue,"data-expanded":!!(b||D&&oe),style:{"--index":w,"--toasts-before":w,"--z-index":x.length-w,"--offset":`${ye?ln:kr.current}px`,"--initial-height":D?"auto":`${ft}px`,...R,...h.style},onDragEnd:()=>{Ae(!1),Z(null),Ba.current=null},onPointerDown:we=>{yh||!Cn||(er.current=new Date,jt(kr.current),we.target.setPointerCapture(we.pointerId),we.target.tagName!=="BUTTON"&&(Ae(!0),Ba.current={x:we.clientX,y:we.clientY}))},onPointerUp:()=>{var we,We,Je,nr;if(Ce||!Cn)return;Ba.current=null;let rr=Number(((we=Nt.current)==null?void 0:we.style.getPropertyValue("--swipe-amount-x").replace("px",""))||0),Fo=Number(((We=Nt.current)==null?void 0:We.style.getPropertyValue("--swipe-amount-y").replace("px",""))||0),Wi=new Date().getTime()-((Je=er.current)==null?void 0:Je.getTime()),or=Q==="x"?rr:Fo,Mo=Math.abs(or)/Wi;if(Math.abs(or)>=tD||Mo>.11){jt(kr.current),(nr=h.onDismiss)==null||nr.call(h,h),fe(Q==="x"?rr>0?"right":"left":Fo>0?"down":"up"),Oo(),Ue(!0),je(!1);return}Ae(!1),Z(null)},onPointerMove:we=>{var We,Je,nr,rr;if(!Ba.current||!Cn||((We=window.getSelection())==null?void 0:We.toString().length)>0)return;let Fo=we.clientY-Ba.current.y,Wi=we.clientX-Ba.current.x,or=(Je=t.swipeDirections)!=null?Je:rD(j);!Q&&(Math.abs(Wi)>1||Math.abs(Fo)>1)&&Z(Math.abs(Wi)>Math.abs(Fo)?"x":"y");let Mo={x:0,y:0};Q==="y"?(or.includes("top")||or.includes("bottom"))&&(or.includes("top")&&Fo<0||or.includes("bottom")&&Fo>0)&&(Mo.y=Fo):Q==="x"&&(or.includes("left")||or.includes("right"))&&(or.includes("left")&&Wi<0||or.includes("right")&&Wi>0)&&(Mo.x=Wi),(Math.abs(Mo.x)>0||Math.abs(Mo.y)>0)&&je(!0),(nr=Nt.current)==null||nr.style.setProperty("--swipe-amount-x",`${Mo.x}px`),(rr=Nt.current)==null||rr.style.setProperty("--swipe-amount-y",`${Mo.y}px`)}},gh&&!h.jsx?J.createElement("button",{"aria-label":q,"data-disabled":yh,"data-close-button":!0,onClick:yh||!Cn?()=>{}:()=>{var we;Oo(),(we=h.onDismiss)==null||we.call(h,h)},className:ar(F==null?void 0:F.closeButton,(o=h==null?void 0:h.classNames)==null?void 0:o.closeButton)},(i=$==null?void 0:$.close)!=null?i:WP):null,h.jsx||k.isValidElement(h.title)?h.jsx?h.jsx:typeof h.title=="function"?h.title():h.title:J.createElement(J.Fragment,null,Wt||h.icon||h.promise?J.createElement("div",{"data-icon":"",className:ar(F==null?void 0:F.icon,(a=h==null?void 0:h.classNames)==null?void 0:a.icon)},h.promise||h.type==="loading"&&!h.icon?h.icon||DR():null,h.type!=="loading"?h.icon||($==null?void 0:$[Wt])||OP(Wt):null):null,J.createElement("div",{"data-content":"",className:ar(F==null?void 0:F.content,(s=h==null?void 0:h.classNames)==null?void 0:s.content)},J.createElement("div",{"data-title":"",className:ar(F==null?void 0:F.title,(u=h==null?void 0:h.classNames)==null?void 0:u.title)},typeof h.title=="function"?h.title():h.title),h.description?J.createElement("div",{"data-description":"",className:ar(B,yu,F==null?void 0:F.description,(l=h==null?void 0:h.classNames)==null?void 0:l.description)},typeof h.description=="function"?h.description():h.description):null),k.isValidElement(h.cancel)?h.cancel:h.cancel&&Tc(h.cancel)?J.createElement("button",{"data-button":!0,"data-cancel":!0,style:h.cancelButtonStyle||S,onClick:we=>{var We,Je;Tc(h.cancel)&&Cn&&((Je=(We=h.cancel).onClick)==null||Je.call(We,we),Oo())},className:ar(F==null?void 0:F.cancelButton,(c=h==null?void 0:h.classNames)==null?void 0:c.cancelButton)},h.cancel.label):null,k.isValidElement(h.action)?h.action:h.action&&Tc(h.action)?J.createElement("button",{"data-button":!0,"data-action":!0,style:h.actionButtonStyle||P,onClick:we=>{var We,Je;Tc(h.action)&&((Je=(We=h.action).onClick)==null||Je.call(We,we),!we.defaultPrevented&&Oo())},className:ar(F==null?void 0:F.actionButton,(d=h==null?void 0:h.classNames)==null?void 0:d.actionButton)},h.action.label):null))};function M1(){if(typeof window>"u"||typeof document>"u")return"ltr";let t=document.documentElement.getAttribute("dir");return t==="auto"||!t?window.getComputedStyle(document.documentElement).direction:t}function iD(t,e){let n={};return[t,e].forEach((r,o)=>{let i=o===1,a=i?"--mobile-offset":"--offset",s=i?JP:QP;function u(l){["top","right","bottom","left"].forEach(c=>{n[`${a}-${c}`]=typeof l=="number"?`${l}px`:l})}typeof r=="number"||typeof r=="string"?u(r):typeof r=="object"?["top","right","bottom","left"].forEach(l=>{r[l]===void 0?n[`${a}-${l}`]=s:n[`${a}-${l}`]=typeof r[l]=="number"?`${r[l]}px`:r[l]}):u(s)}),n}var _V=k.forwardRef(function(t,e){let{invert:n,position:r="bottom-right",hotkey:o=["altKey","KeyT"],expand:i,closeButton:a,className:s,offset:u,mobileOffset:l,theme:c="light",richColors:d,duration:f,style:h,visibleToasts:v=YP,toastOptions:p,dir:m=M1(),gap:g=eD,loadingIcon:y,icons:w,containerAriaLabel:x="Notifications",pauseWhenPageIsHidden:b}=t,[_,E]=J.useState([]),C=J.useMemo(()=>Array.from(new Set([r].concat(_.filter(K=>K.position).map(K=>K.position)))),[_,r]),[R,S]=J.useState([]),[P,A]=J.useState(!1),[B,M]=J.useState(!1),[j,W]=J.useState(c!=="system"?c:typeof window<"u"&&window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light"),U=J.useRef(null),D=o.join("+").replace(/Key/g,"").replace(/Digit/g,""),F=J.useRef(null),$=J.useRef(!1),q=J.useCallback(K=>{E(Q=>{var Z;return(Z=Q.find(ue=>ue.id===K.id))!=null&&Z.delete||fn.dismiss(K.id),Q.filter(({id:ue})=>ue!==K.id)})},[]);return J.useEffect(()=>fn.subscribe(K=>{if(K.dismiss){E(Q=>Q.map(Z=>Z.id===K.id?{...Z,delete:!0}:Z));return}setTimeout(()=>{u_.flushSync(()=>{E(Q=>{let Z=Q.findIndex(ue=>ue.id===K.id);return Z!==-1?[...Q.slice(0,Z),{...Q[Z],...K},...Q.slice(Z+1)]:[K,...Q]})})})}),[]),J.useEffect(()=>{if(c!=="system"){W(c);return}if(c==="system"&&(window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches?W("dark"):W("light")),typeof window>"u")return;let K=window.matchMedia("(prefers-color-scheme: dark)");try{K.addEventListener("change",({matches:Q})=>{W(Q?"dark":"light")})}catch{K.addListener(({matches:Z})=>{try{W(Z?"dark":"light")}catch(ue){console.error(ue)}})}},[c]),J.useEffect(()=>{_.length<=1&&A(!1)},[_]),J.useEffect(()=>{let K=Q=>{var Z,ue;o.every(fe=>Q[fe]||Q.code===fe)&&(A(!0),(Z=U.current)==null||Z.focus()),Q.code==="Escape"&&(document.activeElement===U.current||(ue=U.current)!=null&&ue.contains(document.activeElement))&&A(!1)};return document.addEventListener("keydown",K),()=>document.removeEventListener("keydown",K)},[o]),J.useEffect(()=>{if(U.current)return()=>{F.current&&(F.current.focus({preventScroll:!0}),F.current=null,$.current=!1)}},[U.current]),J.createElement("section",{ref:e,"aria-label":`${x} ${D}`,tabIndex:-1,"aria-live":"polite","aria-relevant":"additions text","aria-atomic":"false",suppressHydrationWarning:!0},C.map((K,Q)=>{var Z;let[ue,fe]=K.split("-");return _.length?J.createElement("ol",{key:K,dir:m==="auto"?M1():m,tabIndex:-1,ref:U,className:s,"data-sonner-toaster":!0,"data-theme":j,"data-y-position":ue,"data-lifted":P&&_.length>1&&!i,"data-x-position":fe,style:{"--front-toast-height":`${((Z=R[0])==null?void 0:Z.height)||0}px`,"--width":`${ZP}px`,"--gap":`${g}px`,...h,...iD(u,l)},onBlur:oe=>{$.current&&!oe.currentTarget.contains(oe.relatedTarget)&&($.current=!1,F.current&&(F.current.focus({preventScroll:!0}),F.current=null))},onFocus:oe=>{oe.target instanceof HTMLElement&&oe.target.dataset.dismissible==="false"||$.current||($.current=!0,F.current=oe.relatedTarget)},onMouseEnter:()=>A(!0),onMouseMove:()=>A(!0),onMouseLeave:()=>{B||A(!1)},onDragEnd:()=>A(!1),onPointerDown:oe=>{oe.target instanceof HTMLElement&&oe.target.dataset.dismissible==="false"||M(!0)},onPointerUp:()=>M(!1)},_.filter(oe=>!oe.position&&Q===0||oe.position===K).map((oe,xe)=>{var ye,Be;return J.createElement(oD,{key:oe.id,icons:w,index:xe,toast:oe,defaultRichColors:d,duration:(ye=p==null?void 0:p.duration)!=null?ye:f,className:p==null?void 0:p.className,descriptionClassName:p==null?void 0:p.descriptionClassName,invert:n,visibleToasts:v,closeButton:(Be=p==null?void 0:p.closeButton)!=null?Be:a,interacting:B,position:K,style:p==null?void 0:p.style,unstyled:p==null?void 0:p.unstyled,classNames:p==null?void 0:p.classNames,cancelButtonStyle:p==null?void 0:p.cancelButtonStyle,actionButtonStyle:p==null?void 0:p.actionButtonStyle,removeToast:q,toasts:_.filter(me=>me.position==oe.position),heights:R.filter(me=>me.position==oe.position),setHeights:S,expandByDefault:i,gap:g,loadingIcon:y,expanded:P,pauseWhenPageIsHidden:b,swipeDirections:t.swipeDirections})})):null}))}),aD=Hm[" useId ".trim().toString()]||(()=>{}),sD=0;function Xu(t){const[e,n]=k.useState(aD());return _o(()=>{t||n(r=>r??String(sD++))},[t]),t||(e?`radix-${e}`:"")}const uD=["top","right","bottom","left"],Ri=Math.min,Rn=Math.max,jd=Math.round,Ic=Math.floor,Vr=t=>({x:t,y:t}),lD={left:"right",right:"left",bottom:"top",top:"bottom"},cD={start:"end",end:"start"};function $v(t,e,n){return Rn(t,Ri(e,n))}function Eo(t,e){return typeof t=="function"?t(e):t}function Co(t){return t.split("-")[0]}function cu(t){return t.split("-")[1]}function Wg(t){return t==="x"?"y":"x"}function Ug(t){return t==="y"?"height":"width"}const dD=new Set(["top","bottom"]);function jr(t){return dD.has(Co(t))?"y":"x"}function zg(t){return Wg(jr(t))}function fD(t,e,n){n===void 0&&(n=!1);const r=cu(t),o=zg(t),i=Ug(o);let a=o==="x"?r===(n?"end":"start")?"right":"left":r==="start"?"bottom":"top";return e.reference[i]>e.floating[i]&&(a=Wd(a)),[a,Wd(a)]}function hD(t){const e=Wd(t);return[jv(t),e,jv(e)]}function jv(t){return t.replace(/start|end/g,e=>cD[e])}const L1=["left","right"],B1=["right","left"],pD=["top","bottom"],vD=["bottom","top"];function mD(t,e,n){switch(t){case"top":case"bottom":return n?e?B1:L1:e?L1:B1;case"left":case"right":return e?pD:vD;default:return[]}}function gD(t,e,n,r){const o=cu(t);let i=mD(Co(t),n==="start",r);return o&&(i=i.map(a=>a+"-"+o),e&&(i=i.concat(i.map(jv)))),i}function Wd(t){return t.replace(/left|right|bottom|top/g,e=>lD[e])}function yD(t){return{top:0,right:0,bottom:0,left:0,...t}}function L_(t){return typeof t!="number"?yD(t):{top:t,right:t,bottom:t,left:t}}function Ud(t){const{x:e,y:n,width:r,height:o}=t;return{width:r,height:o,top:n,left:e,right:e+r,bottom:n+o,x:e,y:n}}function $1(t,e,n){let{reference:r,floating:o}=t;const i=jr(e),a=zg(e),s=Ug(a),u=Co(e),l=i==="y",c=r.x+r.width/2-o.width/2,d=r.y+r.height/2-o.height/2,f=r[s]/2-o[s]/2;let h;switch(u){case"top":h={x:c,y:r.y-o.height};break;case"bottom":h={x:c,y:r.y+r.height};break;case"right":h={x:r.x+r.width,y:d};break;case"left":h={x:r.x-o.width,y:d};break;default:h={x:r.x,y:r.y}}switch(cu(e)){case"start":h[a]-=f*(n&&l?-1:1);break;case"end":h[a]+=f*(n&&l?-1:1);break}return h}const wD=async(t,e,n)=>{const{placement:r="bottom",strategy:o="absolute",middleware:i=[],platform:a}=n,s=i.filter(Boolean),u=await(a.isRTL==null?void 0:a.isRTL(e));let l=await a.getElementRects({reference:t,floating:e,strategy:o}),{x:c,y:d}=$1(l,r,u),f=r,h={},v=0;for(let p=0;p<s.length;p++){const{name:m,fn:g}=s[p],{x:y,y:w,data:x,reset:b}=await g({x:c,y:d,initialPlacement:r,placement:f,strategy:o,middlewareData:h,rects:l,platform:a,elements:{reference:t,floating:e}});c=y??c,d=w??d,h={...h,[m]:{...h[m],...x}},b&&v<=50&&(v++,typeof b=="object"&&(b.placement&&(f=b.placement),b.rects&&(l=b.rects===!0?await a.getElementRects({reference:t,floating:e,strategy:o}):b.rects),{x:c,y:d}=$1(l,f,u)),p=-1)}return{x:c,y:d,placement:f,strategy:o,middlewareData:h}};async function xl(t,e){var n;e===void 0&&(e={});const{x:r,y:o,platform:i,rects:a,elements:s,strategy:u}=t,{boundary:l="clippingAncestors",rootBoundary:c="viewport",elementContext:d="floating",altBoundary:f=!1,padding:h=0}=Eo(e,t),v=L_(h),m=s[f?d==="floating"?"reference":"floating":d],g=Ud(await i.getClippingRect({element:(n=await(i.isElement==null?void 0:i.isElement(m)))==null||n?m:m.contextElement||await(i.getDocumentElement==null?void 0:i.getDocumentElement(s.floating)),boundary:l,rootBoundary:c,strategy:u})),y=d==="floating"?{x:r,y:o,width:a.floating.width,height:a.floating.height}:a.reference,w=await(i.getOffsetParent==null?void 0:i.getOffsetParent(s.floating)),x=await(i.isElement==null?void 0:i.isElement(w))?await(i.getScale==null?void 0:i.getScale(w))||{x:1,y:1}:{x:1,y:1},b=Ud(i.convertOffsetParentRelativeRectToViewportRelativeRect?await i.convertOffsetParentRelativeRectToViewportRelativeRect({elements:s,rect:y,offsetParent:w,strategy:u}):y);return{top:(g.top-b.top+v.top)/x.y,bottom:(b.bottom-g.bottom+v.bottom)/x.y,left:(g.left-b.left+v.left)/x.x,right:(b.right-g.right+v.right)/x.x}}const xD=t=>({name:"arrow",options:t,async fn(e){const{x:n,y:r,placement:o,rects:i,platform:a,elements:s,middlewareData:u}=e,{element:l,padding:c=0}=Eo(t,e)||{};if(l==null)return{};const d=L_(c),f={x:n,y:r},h=zg(o),v=Ug(h),p=await a.getDimensions(l),m=h==="y",g=m?"top":"left",y=m?"bottom":"right",w=m?"clientHeight":"clientWidth",x=i.reference[v]+i.reference[h]-f[h]-i.floating[v],b=f[h]-i.reference[h],_=await(a.getOffsetParent==null?void 0:a.getOffsetParent(l));let E=_?_[w]:0;(!E||!await(a.isElement==null?void 0:a.isElement(_)))&&(E=s.floating[w]||i.floating[v]);const C=x/2-b/2,R=E/2-p[v]/2-1,S=Ri(d[g],R),P=Ri(d[y],R),A=S,B=E-p[v]-P,M=E/2-p[v]/2+C,j=$v(A,M,B),W=!u.arrow&&cu(o)!=null&&M!==j&&i.reference[v]/2-(M<A?S:P)-p[v]/2<0,U=W?M<A?M-A:M-B:0;return{[h]:f[h]+U,data:{[h]:j,centerOffset:M-j-U,...W&&{alignmentOffset:U}},reset:W}}}),bD=function(t){return t===void 0&&(t={}),{name:"flip",options:t,async fn(e){var n,r;const{placement:o,middlewareData:i,rects:a,initialPlacement:s,platform:u,elements:l}=e,{mainAxis:c=!0,crossAxis:d=!0,fallbackPlacements:f,fallbackStrategy:h="bestFit",fallbackAxisSideDirection:v="none",flipAlignment:p=!0,...m}=Eo(t,e);if((n=i.arrow)!=null&&n.alignmentOffset)return{};const g=Co(o),y=jr(s),w=Co(s)===s,x=await(u.isRTL==null?void 0:u.isRTL(l.floating)),b=f||(w||!p?[Wd(s)]:hD(s)),_=v!=="none";!f&&_&&b.push(...gD(s,p,v,x));const E=[s,...b],C=await xl(e,m),R=[];let S=((r=i.flip)==null?void 0:r.overflows)||[];if(c&&R.push(C[g]),d){const M=fD(o,a,x);R.push(C[M[0]],C[M[1]])}if(S=[...S,{placement:o,overflows:R}],!R.every(M=>M<=0)){var P,A;const M=(((P=i.flip)==null?void 0:P.index)||0)+1,j=E[M];if(j&&(!(d==="alignment"?y!==jr(j):!1)||S.every(D=>D.overflows[0]>0&&jr(D.placement)===y)))return{data:{index:M,overflows:S},reset:{placement:j}};let W=(A=S.filter(U=>U.overflows[0]<=0).sort((U,D)=>U.overflows[1]-D.overflows[1])[0])==null?void 0:A.placement;if(!W)switch(h){case"bestFit":{var B;const U=(B=S.filter(D=>{if(_){const F=jr(D.placement);return F===y||F==="y"}return!0}).map(D=>[D.placement,D.overflows.filter(F=>F>0).reduce((F,$)=>F+$,0)]).sort((D,F)=>D[1]-F[1])[0])==null?void 0:B[0];U&&(W=U);break}case"initialPlacement":W=s;break}if(o!==W)return{reset:{placement:W}}}return{}}}};function j1(t,e){return{top:t.top-e.height,right:t.right-e.width,bottom:t.bottom-e.height,left:t.left-e.width}}function W1(t){return uD.some(e=>t[e]>=0)}const _D=function(t){return t===void 0&&(t={}),{name:"hide",options:t,async fn(e){const{rects:n}=e,{strategy:r="referenceHidden",...o}=Eo(t,e);switch(r){case"referenceHidden":{const i=await xl(e,{...o,elementContext:"reference"}),a=j1(i,n.reference);return{data:{referenceHiddenOffsets:a,referenceHidden:W1(a)}}}case"escaped":{const i=await xl(e,{...o,altBoundary:!0}),a=j1(i,n.floating);return{data:{escapedOffsets:a,escaped:W1(a)}}}default:return{}}}}},B_=new Set(["left","top"]);async function ED(t,e){const{placement:n,platform:r,elements:o}=t,i=await(r.isRTL==null?void 0:r.isRTL(o.floating)),a=Co(n),s=cu(n),u=jr(n)==="y",l=B_.has(a)?-1:1,c=i&&u?-1:1,d=Eo(e,t);let{mainAxis:f,crossAxis:h,alignmentAxis:v}=typeof d=="number"?{mainAxis:d,crossAxis:0,alignmentAxis:null}:{mainAxis:d.mainAxis||0,crossAxis:d.crossAxis||0,alignmentAxis:d.alignmentAxis};return s&&typeof v=="number"&&(h=s==="end"?v*-1:v),u?{x:h*c,y:f*l}:{x:f*l,y:h*c}}const CD=function(t){return t===void 0&&(t=0),{name:"offset",options:t,async fn(e){var n,r;const{x:o,y:i,placement:a,middlewareData:s}=e,u=await ED(e,t);return a===((n=s.offset)==null?void 0:n.placement)&&(r=s.arrow)!=null&&r.alignmentOffset?{}:{x:o+u.x,y:i+u.y,data:{...u,placement:a}}}}},SD=function(t){return t===void 0&&(t={}),{name:"shift",options:t,async fn(e){const{x:n,y:r,placement:o}=e,{mainAxis:i=!0,crossAxis:a=!1,limiter:s={fn:m=>{let{x:g,y}=m;return{x:g,y}}},...u}=Eo(t,e),l={x:n,y:r},c=await xl(e,u),d=jr(Co(o)),f=Wg(d);let h=l[f],v=l[d];if(i){const m=f==="y"?"top":"left",g=f==="y"?"bottom":"right",y=h+c[m],w=h-c[g];h=$v(y,h,w)}if(a){const m=d==="y"?"top":"left",g=d==="y"?"bottom":"right",y=v+c[m],w=v-c[g];v=$v(y,v,w)}const p=s.fn({...e,[f]:h,[d]:v});return{...p,data:{x:p.x-n,y:p.y-r,enabled:{[f]:i,[d]:a}}}}}},kD=function(t){return t===void 0&&(t={}),{options:t,fn(e){const{x:n,y:r,placement:o,rects:i,middlewareData:a}=e,{offset:s=0,mainAxis:u=!0,crossAxis:l=!0}=Eo(t,e),c={x:n,y:r},d=jr(o),f=Wg(d);let h=c[f],v=c[d];const p=Eo(s,e),m=typeof p=="number"?{mainAxis:p,crossAxis:0}:{mainAxis:0,crossAxis:0,...p};if(u){const w=f==="y"?"height":"width",x=i.reference[f]-i.floating[w]+m.mainAxis,b=i.reference[f]+i.reference[w]-m.mainAxis;h<x?h=x:h>b&&(h=b)}if(l){var g,y;const w=f==="y"?"width":"height",x=B_.has(Co(o)),b=i.reference[d]-i.floating[w]+(x&&((g=a.offset)==null?void 0:g[d])||0)+(x?0:m.crossAxis),_=i.reference[d]+i.reference[w]+(x?0:((y=a.offset)==null?void 0:y[d])||0)-(x?m.crossAxis:0);v<b?v=b:v>_&&(v=_)}return{[f]:h,[d]:v}}}},RD=function(t){return t===void 0&&(t={}),{name:"size",options:t,async fn(e){var n,r;const{placement:o,rects:i,platform:a,elements:s}=e,{apply:u=()=>{},...l}=Eo(t,e),c=await xl(e,l),d=Co(o),f=cu(o),h=jr(o)==="y",{width:v,height:p}=i.floating;let m,g;d==="top"||d==="bottom"?(m=d,g=f===(await(a.isRTL==null?void 0:a.isRTL(s.floating))?"start":"end")?"left":"right"):(g=d,m=f==="end"?"top":"bottom");const y=p-c.top-c.bottom,w=v-c.left-c.right,x=Ri(p-c[m],y),b=Ri(v-c[g],w),_=!e.middlewareData.shift;let E=x,C=b;if((n=e.middlewareData.shift)!=null&&n.enabled.x&&(C=w),(r=e.middlewareData.shift)!=null&&r.enabled.y&&(E=y),_&&!f){const S=Rn(c.left,0),P=Rn(c.right,0),A=Rn(c.top,0),B=Rn(c.bottom,0);h?C=v-2*(S!==0||P!==0?S+P:Rn(c.left,c.right)):E=p-2*(A!==0||B!==0?A+B:Rn(c.top,c.bottom))}await u({...e,availableWidth:C,availableHeight:E});const R=await a.getDimensions(s.floating);return v!==R.width||p!==R.height?{reset:{rects:!0}}:{}}}};function Wf(){return typeof window<"u"}function du(t){return $_(t)?(t.nodeName||"").toLowerCase():"#document"}function On(t){var e;return(t==null||(e=t.ownerDocument)==null?void 0:e.defaultView)||window}function Yr(t){var e;return(e=($_(t)?t.ownerDocument:t.document)||window.document)==null?void 0:e.documentElement}function $_(t){return Wf()?t instanceof Node||t instanceof On(t).Node:!1}function br(t){return Wf()?t instanceof Element||t instanceof On(t).Element:!1}function Kr(t){return Wf()?t instanceof HTMLElement||t instanceof On(t).HTMLElement:!1}function U1(t){return!Wf()||typeof ShadowRoot>"u"?!1:t instanceof ShadowRoot||t instanceof On(t).ShadowRoot}const TD=new Set(["inline","contents"]);function Vl(t){const{overflow:e,overflowX:n,overflowY:r,display:o}=_r(t);return/auto|scroll|overlay|hidden|clip/.test(e+r+n)&&!TD.has(o)}const ID=new Set(["table","td","th"]);function AD(t){return ID.has(du(t))}const PD=[":popover-open",":modal"];function Uf(t){return PD.some(e=>{try{return t.matches(e)}catch{return!1}})}const DD=["transform","translate","scale","rotate","perspective"],ND=["transform","translate","scale","rotate","perspective","filter"],OD=["paint","layout","strict","content"];function Vg(t){const e=Hg(),n=br(t)?_r(t):t;return DD.some(r=>n[r]?n[r]!=="none":!1)||(n.containerType?n.containerType!=="normal":!1)||!e&&(n.backdropFilter?n.backdropFilter!=="none":!1)||!e&&(n.filter?n.filter!=="none":!1)||ND.some(r=>(n.willChange||"").includes(r))||OD.some(r=>(n.contain||"").includes(r))}function FD(t){let e=Ti(t);for(;Kr(e)&&!Zs(e);){if(Vg(e))return e;if(Uf(e))return null;e=Ti(e)}return null}function Hg(){return typeof CSS>"u"||!CSS.supports?!1:CSS.supports("-webkit-backdrop-filter","none")}const MD=new Set(["html","body","#document"]);function Zs(t){return MD.has(du(t))}function _r(t){return On(t).getComputedStyle(t)}function zf(t){return br(t)?{scrollLeft:t.scrollLeft,scrollTop:t.scrollTop}:{scrollLeft:t.scrollX,scrollTop:t.scrollY}}function Ti(t){if(du(t)==="html")return t;const e=t.assignedSlot||t.parentNode||U1(t)&&t.host||Yr(t);return U1(e)?e.host:e}function j_(t){const e=Ti(t);return Zs(e)?t.ownerDocument?t.ownerDocument.body:t.body:Kr(e)&&Vl(e)?e:j_(e)}function bl(t,e,n){var r;e===void 0&&(e=[]),n===void 0&&(n=!0);const o=j_(t),i=o===((r=t.ownerDocument)==null?void 0:r.body),a=On(o);if(i){const s=Wv(a);return e.concat(a,a.visualViewport||[],Vl(o)?o:[],s&&n?bl(s):[])}return e.concat(o,bl(o,[],n))}function Wv(t){return t.parent&&Object.getPrototypeOf(t.parent)?t.frameElement:null}function W_(t){const e=_r(t);let n=parseFloat(e.width)||0,r=parseFloat(e.height)||0;const o=Kr(t),i=o?t.offsetWidth:n,a=o?t.offsetHeight:r,s=jd(n)!==i||jd(r)!==a;return s&&(n=i,r=a),{width:n,height:r,$:s}}function Gg(t){return br(t)?t:t.contextElement}function Es(t){const e=Gg(t);if(!Kr(e))return Vr(1);const n=e.getBoundingClientRect(),{width:r,height:o,$:i}=W_(e);let a=(i?jd(n.width):n.width)/r,s=(i?jd(n.height):n.height)/o;return(!a||!Number.isFinite(a))&&(a=1),(!s||!Number.isFinite(s))&&(s=1),{x:a,y:s}}const LD=Vr(0);function U_(t){const e=On(t);return!Hg()||!e.visualViewport?LD:{x:e.visualViewport.offsetLeft,y:e.visualViewport.offsetTop}}function BD(t,e,n){return e===void 0&&(e=!1),!n||e&&n!==On(t)?!1:e}function xa(t,e,n,r){e===void 0&&(e=!1),n===void 0&&(n=!1);const o=t.getBoundingClientRect(),i=Gg(t);let a=Vr(1);e&&(r?br(r)&&(a=Es(r)):a=Es(t));const s=BD(i,n,r)?U_(i):Vr(0);let u=(o.left+s.x)/a.x,l=(o.top+s.y)/a.y,c=o.width/a.x,d=o.height/a.y;if(i){const f=On(i),h=r&&br(r)?On(r):r;let v=f,p=Wv(v);for(;p&&r&&h!==v;){const m=Es(p),g=p.getBoundingClientRect(),y=_r(p),w=g.left+(p.clientLeft+parseFloat(y.paddingLeft))*m.x,x=g.top+(p.clientTop+parseFloat(y.paddingTop))*m.y;u*=m.x,l*=m.y,c*=m.x,d*=m.y,u+=w,l+=x,v=On(p),p=Wv(v)}}return Ud({width:c,height:d,x:u,y:l})}function qg(t,e){const n=zf(t).scrollLeft;return e?e.left+n:xa(Yr(t)).left+n}function z_(t,e,n){n===void 0&&(n=!1);const r=t.getBoundingClientRect(),o=r.left+e.scrollLeft-(n?0:qg(t,r)),i=r.top+e.scrollTop;return{x:o,y:i}}function $D(t){let{elements:e,rect:n,offsetParent:r,strategy:o}=t;const i=o==="fixed",a=Yr(r),s=e?Uf(e.floating):!1;if(r===a||s&&i)return n;let u={scrollLeft:0,scrollTop:0},l=Vr(1);const c=Vr(0),d=Kr(r);if((d||!d&&!i)&&((du(r)!=="body"||Vl(a))&&(u=zf(r)),Kr(r))){const h=xa(r);l=Es(r),c.x=h.x+r.clientLeft,c.y=h.y+r.clientTop}const f=a&&!d&&!i?z_(a,u,!0):Vr(0);return{width:n.width*l.x,height:n.height*l.y,x:n.x*l.x-u.scrollLeft*l.x+c.x+f.x,y:n.y*l.y-u.scrollTop*l.y+c.y+f.y}}function jD(t){return Array.from(t.getClientRects())}function WD(t){const e=Yr(t),n=zf(t),r=t.ownerDocument.body,o=Rn(e.scrollWidth,e.clientWidth,r.scrollWidth,r.clientWidth),i=Rn(e.scrollHeight,e.clientHeight,r.scrollHeight,r.clientHeight);let a=-n.scrollLeft+qg(t);const s=-n.scrollTop;return _r(r).direction==="rtl"&&(a+=Rn(e.clientWidth,r.clientWidth)-o),{width:o,height:i,x:a,y:s}}function UD(t,e){const n=On(t),r=Yr(t),o=n.visualViewport;let i=r.clientWidth,a=r.clientHeight,s=0,u=0;if(o){i=o.width,a=o.height;const l=Hg();(!l||l&&e==="fixed")&&(s=o.offsetLeft,u=o.offsetTop)}return{width:i,height:a,x:s,y:u}}const zD=new Set(["absolute","fixed"]);function VD(t,e){const n=xa(t,!0,e==="fixed"),r=n.top+t.clientTop,o=n.left+t.clientLeft,i=Kr(t)?Es(t):Vr(1),a=t.clientWidth*i.x,s=t.clientHeight*i.y,u=o*i.x,l=r*i.y;return{width:a,height:s,x:u,y:l}}function z1(t,e,n){let r;if(e==="viewport")r=UD(t,n);else if(e==="document")r=WD(Yr(t));else if(br(e))r=VD(e,n);else{const o=U_(t);r={x:e.x-o.x,y:e.y-o.y,width:e.width,height:e.height}}return Ud(r)}function V_(t,e){const n=Ti(t);return n===e||!br(n)||Zs(n)?!1:_r(n).position==="fixed"||V_(n,e)}function HD(t,e){const n=e.get(t);if(n)return n;let r=bl(t,[],!1).filter(s=>br(s)&&du(s)!=="body"),o=null;const i=_r(t).position==="fixed";let a=i?Ti(t):t;for(;br(a)&&!Zs(a);){const s=_r(a),u=Vg(a);!u&&s.position==="fixed"&&(o=null),(i?!u&&!o:!u&&s.position==="static"&&!!o&&zD.has(o.position)||Vl(a)&&!u&&V_(t,a))?r=r.filter(c=>c!==a):o=s,a=Ti(a)}return e.set(t,r),r}function GD(t){let{element:e,boundary:n,rootBoundary:r,strategy:o}=t;const a=[...n==="clippingAncestors"?Uf(e)?[]:HD(e,this._c):[].concat(n),r],s=a[0],u=a.reduce((l,c)=>{const d=z1(e,c,o);return l.top=Rn(d.top,l.top),l.right=Ri(d.right,l.right),l.bottom=Ri(d.bottom,l.bottom),l.left=Rn(d.left,l.left),l},z1(e,s,o));return{width:u.right-u.left,height:u.bottom-u.top,x:u.left,y:u.top}}function qD(t){const{width:e,height:n}=W_(t);return{width:e,height:n}}function KD(t,e,n){const r=Kr(e),o=Yr(e),i=n==="fixed",a=xa(t,!0,i,e);let s={scrollLeft:0,scrollTop:0};const u=Vr(0);function l(){u.x=qg(o)}if(r||!r&&!i)if((du(e)!=="body"||Vl(o))&&(s=zf(e)),r){const h=xa(e,!0,i,e);u.x=h.x+e.clientLeft,u.y=h.y+e.clientTop}else o&&l();i&&!r&&o&&l();const c=o&&!r&&!i?z_(o,s):Vr(0),d=a.left+s.scrollLeft-u.x-c.x,f=a.top+s.scrollTop-u.y-c.y;return{x:d,y:f,width:a.width,height:a.height}}function Kh(t){return _r(t).position==="static"}function V1(t,e){if(!Kr(t)||_r(t).position==="fixed")return null;if(e)return e(t);let n=t.offsetParent;return Yr(t)===n&&(n=n.ownerDocument.body),n}function H_(t,e){const n=On(t);if(Uf(t))return n;if(!Kr(t)){let o=Ti(t);for(;o&&!Zs(o);){if(br(o)&&!Kh(o))return o;o=Ti(o)}return n}let r=V1(t,e);for(;r&&AD(r)&&Kh(r);)r=V1(r,e);return r&&Zs(r)&&Kh(r)&&!Vg(r)?n:r||FD(t)||n}const XD=async function(t){const e=this.getOffsetParent||H_,n=this.getDimensions,r=await n(t.floating);return{reference:KD(t.reference,await e(t.floating),t.strategy),floating:{x:0,y:0,width:r.width,height:r.height}}};function YD(t){return _r(t).direction==="rtl"}const QD={convertOffsetParentRelativeRectToViewportRelativeRect:$D,getDocumentElement:Yr,getClippingRect:GD,getOffsetParent:H_,getElementRects:XD,getClientRects:jD,getDimensions:qD,getScale:Es,isElement:br,isRTL:YD};function G_(t,e){return t.x===e.x&&t.y===e.y&&t.width===e.width&&t.height===e.height}function JD(t,e){let n=null,r;const o=Yr(t);function i(){var s;clearTimeout(r),(s=n)==null||s.disconnect(),n=null}function a(s,u){s===void 0&&(s=!1),u===void 0&&(u=1),i();const l=t.getBoundingClientRect(),{left:c,top:d,width:f,height:h}=l;if(s||e(),!f||!h)return;const v=Ic(d),p=Ic(o.clientWidth-(c+f)),m=Ic(o.clientHeight-(d+h)),g=Ic(c),w={rootMargin:-v+"px "+-p+"px "+-m+"px "+-g+"px",threshold:Rn(0,Ri(1,u))||1};let x=!0;function b(_){const E=_[0].intersectionRatio;if(E!==u){if(!x)return a();E?a(!1,E):r=setTimeout(()=>{a(!1,1e-7)},1e3)}E===1&&!G_(l,t.getBoundingClientRect())&&a(),x=!1}try{n=new IntersectionObserver(b,{...w,root:o.ownerDocument})}catch{n=new IntersectionObserver(b,w)}n.observe(t)}return a(!0),i}function ZD(t,e,n,r){r===void 0&&(r={});const{ancestorScroll:o=!0,ancestorResize:i=!0,elementResize:a=typeof ResizeObserver=="function",layoutShift:s=typeof IntersectionObserver=="function",animationFrame:u=!1}=r,l=Gg(t),c=o||i?[...l?bl(l):[],...bl(e)]:[];c.forEach(g=>{o&&g.addEventListener("scroll",n,{passive:!0}),i&&g.addEventListener("resize",n)});const d=l&&s?JD(l,n):null;let f=-1,h=null;a&&(h=new ResizeObserver(g=>{let[y]=g;y&&y.target===l&&h&&(h.unobserve(e),cancelAnimationFrame(f),f=requestAnimationFrame(()=>{var w;(w=h)==null||w.observe(e)})),n()}),l&&!u&&h.observe(l),h.observe(e));let v,p=u?xa(t):null;u&&m();function m(){const g=xa(t);p&&!G_(p,g)&&n(),p=g,v=requestAnimationFrame(m)}return n(),()=>{var g;c.forEach(y=>{o&&y.removeEventListener("scroll",n),i&&y.removeEventListener("resize",n)}),d==null||d(),(g=h)==null||g.disconnect(),h=null,u&&cancelAnimationFrame(v)}}const eN=CD,tN=SD,nN=bD,rN=RD,oN=_D,H1=xD,iN=kD,aN=(t,e,n)=>{const r=new Map,o={platform:QD,...n},i={...o.platform,_c:r};return wD(t,e,{...o,platform:i})};var sN=typeof document<"u",uN=function(){},dd=sN?k.useLayoutEffect:uN;function zd(t,e){if(t===e)return!0;if(typeof t!=typeof e)return!1;if(typeof t=="function"&&t.toString()===e.toString())return!0;let n,r,o;if(t&&e&&typeof t=="object"){if(Array.isArray(t)){if(n=t.length,n!==e.length)return!1;for(r=n;r--!==0;)if(!zd(t[r],e[r]))return!1;return!0}if(o=Object.keys(t),n=o.length,n!==Object.keys(e).length)return!1;for(r=n;r--!==0;)if(!{}.hasOwnProperty.call(e,o[r]))return!1;for(r=n;r--!==0;){const i=o[r];if(!(i==="_owner"&&t.$$typeof)&&!zd(t[i],e[i]))return!1}return!0}return t!==t&&e!==e}function q_(t){return typeof window>"u"?1:(t.ownerDocument.defaultView||window).devicePixelRatio||1}function G1(t,e){const n=q_(t);return Math.round(e*n)/n}function Xh(t){const e=k.useRef(t);return dd(()=>{e.current=t}),e}function lN(t){t===void 0&&(t={});const{placement:e="bottom",strategy:n="absolute",middleware:r=[],platform:o,elements:{reference:i,floating:a}={},transform:s=!0,whileElementsMounted:u,open:l}=t,[c,d]=k.useState({x:0,y:0,strategy:n,placement:e,middlewareData:{},isPositioned:!1}),[f,h]=k.useState(r);zd(f,r)||h(r);const[v,p]=k.useState(null),[m,g]=k.useState(null),y=k.useCallback(D=>{D!==_.current&&(_.current=D,p(D))},[]),w=k.useCallback(D=>{D!==E.current&&(E.current=D,g(D))},[]),x=i||v,b=a||m,_=k.useRef(null),E=k.useRef(null),C=k.useRef(c),R=u!=null,S=Xh(u),P=Xh(o),A=Xh(l),B=k.useCallback(()=>{if(!_.current||!E.current)return;const D={placement:e,strategy:n,middleware:f};P.current&&(D.platform=P.current),aN(_.current,E.current,D).then(F=>{const $={...F,isPositioned:A.current!==!1};M.current&&!zd(C.current,$)&&(C.current=$,Ul.flushSync(()=>{d($)}))})},[f,e,n,P,A]);dd(()=>{l===!1&&C.current.isPositioned&&(C.current.isPositioned=!1,d(D=>({...D,isPositioned:!1})))},[l]);const M=k.useRef(!1);dd(()=>(M.current=!0,()=>{M.current=!1}),[]),dd(()=>{if(x&&(_.current=x),b&&(E.current=b),x&&b){if(S.current)return S.current(x,b,B);B()}},[x,b,B,S,R]);const j=k.useMemo(()=>({reference:_,floating:E,setReference:y,setFloating:w}),[y,w]),W=k.useMemo(()=>({reference:x,floating:b}),[x,b]),U=k.useMemo(()=>{const D={position:n,left:0,top:0};if(!W.floating)return D;const F=G1(W.floating,c.x),$=G1(W.floating,c.y);return s?{...D,transform:"translate("+F+"px, "+$+"px)",...q_(W.floating)>=1.5&&{willChange:"transform"}}:{position:n,left:F,top:$}},[n,s,W.floating,c.x,c.y]);return k.useMemo(()=>({...c,update:B,refs:j,elements:W,floatingStyles:U}),[c,B,j,W,U])}const cN=t=>{function e(n){return{}.hasOwnProperty.call(n,"current")}return{name:"arrow",options:t,fn(n){const{element:r,padding:o}=typeof t=="function"?t(n):t;return r&&e(r)?r.current!=null?H1({element:r.current,padding:o}).fn(n):{}:r?H1({element:r,padding:o}).fn(n):{}}}},dN=(t,e)=>({...eN(t),options:[t,e]}),fN=(t,e)=>({...tN(t),options:[t,e]}),hN=(t,e)=>({...iN(t),options:[t,e]}),pN=(t,e)=>({...nN(t),options:[t,e]}),vN=(t,e)=>({...rN(t),options:[t,e]}),mN=(t,e)=>({...oN(t),options:[t,e]}),gN=(t,e)=>({...cN(t),options:[t,e]});var yN="Arrow",K_=k.forwardRef((t,e)=>{const{children:n,width:r=10,height:o=5,...i}=t;return G.jsx(Ve.svg,{...i,ref:e,width:r,height:o,viewBox:"0 0 30 10",preserveAspectRatio:"none",children:t.asChild?n:G.jsx("polygon",{points:"0,0 30,0 15,10"})})});K_.displayName=yN;var wN=K_;function xN(t){const[e,n]=k.useState(void 0);return _o(()=>{if(t){n({width:t.offsetWidth,height:t.offsetHeight});const r=new ResizeObserver(o=>{if(!Array.isArray(o)||!o.length)return;const i=o[0];let a,s;if("borderBoxSize"in i){const u=i.borderBoxSize,l=Array.isArray(u)?u[0]:u;a=l.inlineSize,s=l.blockSize}else a=t.offsetWidth,s=t.offsetHeight;n({width:a,height:s})});return r.observe(t,{box:"border-box"}),()=>r.unobserve(t)}else n(void 0)},[t]),e}var X_="Popper",[Y_,Q_]=Oi(X_),[EV,J_]=Y_(X_),Z_="PopperAnchor",eE=k.forwardRef((t,e)=>{const{__scopePopper:n,virtualRef:r,...o}=t,i=J_(Z_,n),a=k.useRef(null),s=Pt(e,a);return k.useEffect(()=>{i.onAnchorChange((r==null?void 0:r.current)||a.current)}),r?null:G.jsx(Ve.div,{...o,ref:s})});eE.displayName=Z_;var Kg="PopperContent",[bN,_N]=Y_(Kg),tE=k.forwardRef((t,e)=>{var oe,xe,ye,Be,me,Ae;const{__scopePopper:n,side:r="bottom",sideOffset:o=0,align:i="center",alignOffset:a=0,arrowPadding:s=0,avoidCollisions:u=!0,collisionBoundary:l=[],collisionPadding:c=0,sticky:d="partial",hideWhenDetached:f=!1,updatePositionStrategy:h="optimized",onPlaced:v,...p}=t,m=J_(Kg,n),[g,y]=k.useState(null),w=Pt(e,Ce=>y(Ce)),[x,b]=k.useState(null),_=xN(x),E=(_==null?void 0:_.width)??0,C=(_==null?void 0:_.height)??0,R=r+(i!=="center"?"-"+i:""),S=typeof c=="number"?c:{top:0,right:0,bottom:0,left:0,...c},P=Array.isArray(l)?l:[l],A=P.length>0,B={padding:S,boundary:P.filter(CN),altBoundary:A},{refs:M,floatingStyles:j,placement:W,isPositioned:U,middlewareData:D}=lN({strategy:"fixed",placement:R,whileElementsMounted:(...Ce)=>ZD(...Ce,{animationFrame:h==="always"}),elements:{reference:m.anchor},middleware:[dN({mainAxis:o+C,alignmentAxis:a}),u&&fN({mainAxis:!0,crossAxis:!1,limiter:d==="partial"?hN():void 0,...B}),u&&pN({...B}),vN({...B,apply:({elements:Ce,rects:Ue,availableWidth:ze,availableHeight:je})=>{const{width:ln,height:jt}=Ue.reference,ft=Ce.floating.style;ft.setProperty("--radix-popper-available-width",`${ze}px`),ft.setProperty("--radix-popper-available-height",`${je}px`),ft.setProperty("--radix-popper-anchor-width",`${ln}px`),ft.setProperty("--radix-popper-anchor-height",`${jt}px`)}}),x&&gN({element:x,padding:s}),SN({arrowWidth:E,arrowHeight:C}),f&&mN({strategy:"referenceHidden",...B})]}),[F,$]=oE(W),q=xr(v);_o(()=>{U&&(q==null||q())},[U,q]);const K=(oe=D.arrow)==null?void 0:oe.x,Q=(xe=D.arrow)==null?void 0:xe.y,Z=((ye=D.arrow)==null?void 0:ye.centerOffset)!==0,[ue,fe]=k.useState();return _o(()=>{g&&fe(window.getComputedStyle(g).zIndex)},[g]),G.jsx("div",{ref:M.setFloating,"data-radix-popper-content-wrapper":"",style:{...j,transform:U?j.transform:"translate(0, -200%)",minWidth:"max-content",zIndex:ue,"--radix-popper-transform-origin":[(Be=D.transformOrigin)==null?void 0:Be.x,(me=D.transformOrigin)==null?void 0:me.y].join(" "),...((Ae=D.hide)==null?void 0:Ae.referenceHidden)&&{visibility:"hidden",pointerEvents:"none"}},dir:t.dir,children:G.jsx(bN,{scope:n,placedSide:F,onArrowChange:b,arrowX:K,arrowY:Q,shouldHideArrow:Z,children:G.jsx(Ve.div,{"data-side":F,"data-align":$,...p,ref:w,style:{...p.style,animation:U?void 0:"none"}})})})});tE.displayName=Kg;var nE="PopperArrow",EN={top:"bottom",right:"left",bottom:"top",left:"right"},rE=k.forwardRef(function(e,n){const{__scopePopper:r,...o}=e,i=_N(nE,r),a=EN[i.placedSide];return G.jsx("span",{ref:i.onArrowChange,style:{position:"absolute",left:i.arrowX,top:i.arrowY,[a]:0,transformOrigin:{top:"",right:"0 0",bottom:"center 0",left:"100% 0"}[i.placedSide],transform:{top:"translateY(100%)",right:"translateY(50%) rotate(90deg) translateX(-50%)",bottom:"rotate(180deg)",left:"translateY(50%) rotate(-90deg) translateX(50%)"}[i.placedSide],visibility:i.shouldHideArrow?"hidden":void 0},children:G.jsx(wN,{...o,ref:n,style:{...o.style,display:"block"}})})});rE.displayName=nE;function CN(t){return t!==null}var SN=t=>({name:"transformOrigin",options:t,fn(e){var m,g,y;const{placement:n,rects:r,middlewareData:o}=e,a=((m=o.arrow)==null?void 0:m.centerOffset)!==0,s=a?0:t.arrowWidth,u=a?0:t.arrowHeight,[l,c]=oE(n),d={start:"0%",center:"50%",end:"100%"}[c],f=(((g=o.arrow)==null?void 0:g.x)??0)+s/2,h=(((y=o.arrow)==null?void 0:y.y)??0)+u/2;let v="",p="";return l==="bottom"?(v=a?d:`${f}px`,p=`${-u}px`):l==="top"?(v=a?d:`${f}px`,p=`${r.floating.height+u}px`):l==="right"?(v=`${-u}px`,p=a?d:`${h}px`):l==="left"&&(v=`${r.floating.width+u}px`,p=a?d:`${h}px`),{data:{x:v,y:p}}}});function oE(t){const[e,n="center"]=t.split("-");return[e,n]}var kN=eE,RN=tE,TN=rE,[Vf,CV]=Oi("Tooltip",[Q_]),Xg=Q_(),iE="TooltipProvider",IN=700,q1="tooltip.open",[AN,aE]=Vf(iE),sE=t=>{const{__scopeTooltip:e,delayDuration:n=IN,skipDelayDuration:r=300,disableHoverableContent:o=!1,children:i}=t,a=k.useRef(!0),s=k.useRef(!1),u=k.useRef(0);return k.useEffect(()=>{const l=u.current;return()=>window.clearTimeout(l)},[]),G.jsx(AN,{scope:e,isOpenDelayedRef:a,delayDuration:n,onOpen:k.useCallback(()=>{window.clearTimeout(u.current),a.current=!1},[]),onClose:k.useCallback(()=>{window.clearTimeout(u.current),u.current=window.setTimeout(()=>a.current=!0,r)},[r]),isPointerInTransitRef:s,onPointerInTransitChange:k.useCallback(l=>{s.current=l},[]),disableHoverableContent:o,children:i})};sE.displayName=iE;var uE="Tooltip",[SV,Hf]=Vf(uE),Uv="TooltipTrigger",PN=k.forwardRef((t,e)=>{const{__scopeTooltip:n,...r}=t,o=Hf(Uv,n),i=aE(Uv,n),a=Xg(n),s=k.useRef(null),u=Pt(e,s,o.onTriggerChange),l=k.useRef(!1),c=k.useRef(!1),d=k.useCallback(()=>l.current=!1,[]);return k.useEffect(()=>()=>document.removeEventListener("pointerup",d),[d]),G.jsx(kN,{asChild:!0,...a,children:G.jsx(Ve.button,{"aria-describedby":o.open?o.contentId:void 0,"data-state":o.stateAttribute,...r,ref:u,onPointerMove:De(t.onPointerMove,f=>{f.pointerType!=="touch"&&!c.current&&!i.isPointerInTransitRef.current&&(o.onTriggerEnter(),c.current=!0)}),onPointerLeave:De(t.onPointerLeave,()=>{o.onTriggerLeave(),c.current=!1}),onPointerDown:De(t.onPointerDown,()=>{o.open&&o.onClose(),l.current=!0,document.addEventListener("pointerup",d,{once:!0})}),onFocus:De(t.onFocus,()=>{l.current||o.onOpen()}),onBlur:De(t.onBlur,o.onClose),onClick:De(t.onClick,o.onClose)})})});PN.displayName=Uv;var DN="TooltipPortal",[kV,NN]=Vf(DN,{forceMount:void 0}),eu="TooltipContent",lE=k.forwardRef((t,e)=>{const n=NN(eu,t.__scopeTooltip),{forceMount:r=n.forceMount,side:o="top",...i}=t,a=Hf(eu,t.__scopeTooltip);return G.jsx(Ta,{present:r||a.open,children:a.disableHoverableContent?G.jsx(cE,{side:o,...i,ref:e}):G.jsx(ON,{side:o,...i,ref:e})})}),ON=k.forwardRef((t,e)=>{const n=Hf(eu,t.__scopeTooltip),r=aE(eu,t.__scopeTooltip),o=k.useRef(null),i=Pt(e,o),[a,s]=k.useState(null),{trigger:u,onClose:l}=n,c=o.current,{onPointerInTransitChange:d}=r,f=k.useCallback(()=>{s(null),d(!1)},[d]),h=k.useCallback((v,p)=>{const m=v.currentTarget,g={x:v.clientX,y:v.clientY},y=$N(g,m.getBoundingClientRect()),w=jN(g,y),x=WN(p.getBoundingClientRect()),b=zN([...w,...x]);s(b),d(!0)},[d]);return k.useEffect(()=>()=>f(),[f]),k.useEffect(()=>{if(u&&c){const v=m=>h(m,c),p=m=>h(m,u);return u.addEventListener("pointerleave",v),c.addEventListener("pointerleave",p),()=>{u.removeEventListener("pointerleave",v),c.removeEventListener("pointerleave",p)}}},[u,c,h,f]),k.useEffect(()=>{if(a){const v=p=>{const m=p.target,g={x:p.clientX,y:p.clientY},y=(u==null?void 0:u.contains(m))||(c==null?void 0:c.contains(m)),w=!UN(g,a);y?f():w&&(f(),l())};return document.addEventListener("pointermove",v),()=>document.removeEventListener("pointermove",v)}},[u,c,a,l,f]),G.jsx(cE,{...t,ref:i})}),[FN,MN]=Vf(uE,{isInside:!1}),LN=d_("TooltipContent"),cE=k.forwardRef((t,e)=>{const{__scopeTooltip:n,children:r,"aria-label":o,onEscapeKeyDown:i,onPointerDownOutside:a,...s}=t,u=Hf(eu,n),l=Xg(n),{onClose:c}=u;return k.useEffect(()=>(document.addEventListener(q1,c),()=>document.removeEventListener(q1,c)),[c]),k.useEffect(()=>{if(u.trigger){const d=f=>{const h=f.target;h!=null&&h.contains(u.trigger)&&c()};return window.addEventListener("scroll",d,{capture:!0}),()=>window.removeEventListener("scroll",d,{capture:!0})}},[u.trigger,c]),G.jsx(Lf,{asChild:!0,disableOutsidePointerEvents:!1,onEscapeKeyDown:i,onPointerDownOutside:a,onFocusOutside:d=>d.preventDefault(),onDismiss:c,children:G.jsxs(RN,{"data-state":u.stateAttribute,...l,...s,ref:e,style:{...s.style,"--radix-tooltip-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-tooltip-content-available-width":"var(--radix-popper-available-width)","--radix-tooltip-content-available-height":"var(--radix-popper-available-height)","--radix-tooltip-trigger-width":"var(--radix-popper-anchor-width)","--radix-tooltip-trigger-height":"var(--radix-popper-anchor-height)"},children:[G.jsx(LN,{children:r}),G.jsx(FN,{scope:n,isInside:!0,children:G.jsx(DA,{id:u.contentId,role:"tooltip",children:o||r})})]})})});lE.displayName=eu;var dE="TooltipArrow",BN=k.forwardRef((t,e)=>{const{__scopeTooltip:n,...r}=t,o=Xg(n);return MN(dE,n).isInside?null:G.jsx(TN,{...o,...r,ref:e})});BN.displayName=dE;function $N(t,e){const n=Math.abs(e.top-t.y),r=Math.abs(e.bottom-t.y),o=Math.abs(e.right-t.x),i=Math.abs(e.left-t.x);switch(Math.min(n,r,o,i)){case i:return"left";case o:return"right";case n:return"top";case r:return"bottom";default:throw new Error("unreachable")}}function jN(t,e,n=5){const r=[];switch(e){case"top":r.push({x:t.x-n,y:t.y+n},{x:t.x+n,y:t.y+n});break;case"bottom":r.push({x:t.x-n,y:t.y-n},{x:t.x+n,y:t.y-n});break;case"left":r.push({x:t.x+n,y:t.y-n},{x:t.x+n,y:t.y+n});break;case"right":r.push({x:t.x-n,y:t.y-n},{x:t.x-n,y:t.y+n});break}return r}function WN(t){const{top:e,right:n,bottom:r,left:o}=t;return[{x:o,y:e},{x:n,y:e},{x:n,y:r},{x:o,y:r}]}function UN(t,e){const{x:n,y:r}=t;let o=!1;for(let i=0,a=e.length-1;i<e.length;a=i++){const s=e[i],u=e[a],l=s.x,c=s.y,d=u.x,f=u.y;c>r!=f>r&&n<(d-l)*(r-c)/(f-c)+l&&(o=!o)}return o}function zN(t){const e=t.slice();return e.sort((n,r)=>n.x<r.x?-1:n.x>r.x?1:n.y<r.y?-1:n.y>r.y?1:0),VN(e)}function VN(t){if(t.length<=1)return t.slice();const e=[];for(let r=0;r<t.length;r++){const o=t[r];for(;e.length>=2;){const i=e[e.length-1],a=e[e.length-2];if((i.x-a.x)*(o.y-a.y)>=(i.y-a.y)*(o.x-a.x))e.pop();else break}e.push(o)}e.pop();const n=[];for(let r=t.length-1;r>=0;r--){const o=t[r];for(;n.length>=2;){const i=n[n.length-1],a=n[n.length-2];if((i.x-a.x)*(o.y-a.y)>=(i.y-a.y)*(o.x-a.x))n.pop();else break}n.push(o)}return n.pop(),e.length===1&&n.length===1&&e[0].x===n[0].x&&e[0].y===n[0].y?e:e.concat(n)}var RV=sE,TV=lE,fu=class{constructor(){this.listeners=new Set,this.subscribe=this.subscribe.bind(this)}subscribe(t){return this.listeners.add(t),this.onSubscribe(),()=>{this.listeners.delete(t),this.onUnsubscribe()}}hasListeners(){return this.listeners.size>0}onSubscribe(){}onUnsubscribe(){}},ba=typeof window>"u"||"Deno"in globalThis;function on(){}function HN(t,e){return typeof t=="function"?t(e):t}function zv(t){return typeof t=="number"&&t>=0&&t!==1/0}function fE(t,e){return Math.max(t+(e||0)-Date.now(),0)}function xi(t,e){return typeof t=="function"?t(e):t}function Wn(t,e){return typeof t=="function"?t(e):t}function K1(t,e){const{type:n="all",exact:r,fetchStatus:o,predicate:i,queryKey:a,stale:s}=t;if(a){if(r){if(e.queryHash!==Yg(a,e.options))return!1}else if(!_l(e.queryKey,a))return!1}if(n!=="all"){const u=e.isActive();if(n==="active"&&!u||n==="inactive"&&u)return!1}return!(typeof s=="boolean"&&e.isStale()!==s||o&&o!==e.state.fetchStatus||i&&!i(e))}function X1(t,e){const{exact:n,status:r,predicate:o,mutationKey:i}=t;if(i){if(!e.options.mutationKey)return!1;if(n){if(_a(e.options.mutationKey)!==_a(i))return!1}else if(!_l(e.options.mutationKey,i))return!1}return!(r&&e.state.status!==r||o&&!o(e))}function Yg(t,e){return((e==null?void 0:e.queryKeyHashFn)||_a)(t)}function _a(t){return JSON.stringify(t,(e,n)=>Vv(n)?Object.keys(n).sort().reduce((r,o)=>(r[o]=n[o],r),{}):n)}function _l(t,e){return t===e?!0:typeof t!=typeof e?!1:t&&e&&typeof t=="object"&&typeof e=="object"?Object.keys(e).every(n=>_l(t[n],e[n])):!1}function hE(t,e){if(t===e)return t;const n=Y1(t)&&Y1(e);if(n||Vv(t)&&Vv(e)){const r=n?t:Object.keys(t),o=r.length,i=n?e:Object.keys(e),a=i.length,s=n?[]:{},u=new Set(r);let l=0;for(let c=0;c<a;c++){const d=n?c:i[c];(!n&&u.has(d)||n)&&t[d]===void 0&&e[d]===void 0?(s[d]=void 0,l++):(s[d]=hE(t[d],e[d]),s[d]===t[d]&&t[d]!==void 0&&l++)}return o===a&&l===o?t:s}return e}function Vd(t,e){if(!e||Object.keys(t).length!==Object.keys(e).length)return!1;for(const n in t)if(t[n]!==e[n])return!1;return!0}function Y1(t){return Array.isArray(t)&&t.length===Object.keys(t).length}function Vv(t){if(!Q1(t))return!1;const e=t.constructor;if(e===void 0)return!0;const n=e.prototype;return!(!Q1(n)||!n.hasOwnProperty("isPrototypeOf")||Object.getPrototypeOf(t)!==Object.prototype)}function Q1(t){return Object.prototype.toString.call(t)==="[object Object]"}function GN(t){return new Promise(e=>{setTimeout(e,t)})}function Hv(t,e,n){return typeof n.structuralSharing=="function"?n.structuralSharing(t,e):n.structuralSharing!==!1?hE(t,e):e}function qN(t,e,n=0){const r=[...t,e];return n&&r.length>n?r.slice(1):r}function KN(t,e,n=0){const r=[e,...t];return n&&r.length>n?r.slice(0,-1):r}var Qg=Symbol();function pE(t,e){return!t.queryFn&&(e!=null&&e.initialPromise)?()=>e.initialPromise:!t.queryFn||t.queryFn===Qg?()=>Promise.reject(new Error(`Missing queryFn: '${t.queryHash}'`)):t.queryFn}function vE(t,e){return typeof t=="function"?t(...e):!!t}var ra,Qo,Os,$x,XN=($x=class extends fu{constructor(){super();he(this,ra);he(this,Qo);he(this,Os);te(this,Os,e=>{if(!ba&&window.addEventListener){const n=()=>e();return window.addEventListener("visibilitychange",n,!1),()=>{window.removeEventListener("visibilitychange",n)}}})}onSubscribe(){N(this,Qo)||this.setEventListener(N(this,Os))}onUnsubscribe(){var e;this.hasListeners()||((e=N(this,Qo))==null||e.call(this),te(this,Qo,void 0))}setEventListener(e){var n;te(this,Os,e),(n=N(this,Qo))==null||n.call(this),te(this,Qo,e(r=>{typeof r=="boolean"?this.setFocused(r):this.onFocus()}))}setFocused(e){N(this,ra)!==e&&(te(this,ra,e),this.onFocus())}onFocus(){const e=this.isFocused();this.listeners.forEach(n=>{n(e)})}isFocused(){var e;return typeof N(this,ra)=="boolean"?N(this,ra):((e=globalThis.document)==null?void 0:e.visibilityState)!=="hidden"}},ra=new WeakMap,Qo=new WeakMap,Os=new WeakMap,$x),Jg=new XN,Fs,Jo,Ms,jx,YN=(jx=class extends fu{constructor(){super();he(this,Fs,!0);he(this,Jo);he(this,Ms);te(this,Ms,e=>{if(!ba&&window.addEventListener){const n=()=>e(!0),r=()=>e(!1);return window.addEventListener("online",n,!1),window.addEventListener("offline",r,!1),()=>{window.removeEventListener("online",n),window.removeEventListener("offline",r)}}})}onSubscribe(){N(this,Jo)||this.setEventListener(N(this,Ms))}onUnsubscribe(){var e;this.hasListeners()||((e=N(this,Jo))==null||e.call(this),te(this,Jo,void 0))}setEventListener(e){var n;te(this,Ms,e),(n=N(this,Jo))==null||n.call(this),te(this,Jo,e(this.setOnline.bind(this)))}setOnline(e){N(this,Fs)!==e&&(te(this,Fs,e),this.listeners.forEach(r=>{r(e)}))}isOnline(){return N(this,Fs)}},Fs=new WeakMap,Jo=new WeakMap,Ms=new WeakMap,jx),Hd=new YN;function Gv(){let t,e;const n=new Promise((o,i)=>{t=o,e=i});n.status="pending",n.catch(()=>{});function r(o){Object.assign(n,o),delete n.resolve,delete n.reject}return n.resolve=o=>{r({status:"fulfilled",value:o}),t(o)},n.reject=o=>{r({status:"rejected",reason:o}),e(o)},n}function QN(t){return Math.min(1e3*2**t,3e4)}function mE(t){return(t??"online")==="online"?Hd.isOnline():!0}var gE=class extends Error{constructor(t){super("CancelledError"),this.revert=t==null?void 0:t.revert,this.silent=t==null?void 0:t.silent}};function Yh(t){return t instanceof gE}function yE(t){let e=!1,n=0,r=!1,o;const i=Gv(),a=p=>{var m;r||(f(new gE(p)),(m=t.abort)==null||m.call(t))},s=()=>{e=!0},u=()=>{e=!1},l=()=>Jg.isFocused()&&(t.networkMode==="always"||Hd.isOnline())&&t.canRun(),c=()=>mE(t.networkMode)&&t.canRun(),d=p=>{var m;r||(r=!0,(m=t.onSuccess)==null||m.call(t,p),o==null||o(),i.resolve(p))},f=p=>{var m;r||(r=!0,(m=t.onError)==null||m.call(t,p),o==null||o(),i.reject(p))},h=()=>new Promise(p=>{var m;o=g=>{(r||l())&&p(g)},(m=t.onPause)==null||m.call(t)}).then(()=>{var p;o=void 0,r||(p=t.onContinue)==null||p.call(t)}),v=()=>{if(r)return;let p;const m=n===0?t.initialPromise:void 0;try{p=m??t.fn()}catch(g){p=Promise.reject(g)}Promise.resolve(p).then(d).catch(g=>{var _;if(r)return;const y=t.retry??(ba?0:3),w=t.retryDelay??QN,x=typeof w=="function"?w(n,g):w,b=y===!0||typeof y=="number"&&n<y||typeof y=="function"&&y(n,g);if(e||!b){f(g);return}n++,(_=t.onFail)==null||_.call(t,n,g),GN(x).then(()=>l()?void 0:h()).then(()=>{e?f(g):v()})})};return{promise:i,cancel:a,continue:()=>(o==null||o(),i),cancelRetry:s,continueRetry:u,canStart:c,start:()=>(c()?v():h().then(v),i)}}var JN=t=>setTimeout(t,0);function ZN(){let t=[],e=0,n=s=>{s()},r=s=>{s()},o=JN;const i=s=>{e?t.push(s):o(()=>{n(s)})},a=()=>{const s=t;t=[],s.length&&o(()=>{r(()=>{s.forEach(u=>{n(u)})})})};return{batch:s=>{let u;e++;try{u=s()}finally{e--,e||a()}return u},batchCalls:s=>(...u)=>{i(()=>{s(...u)})},schedule:i,setNotifyFunction:s=>{n=s},setBatchNotifyFunction:s=>{r=s},setScheduler:s=>{o=s}}}var xt=ZN(),oa,Wx,wE=(Wx=class{constructor(){he(this,oa)}destroy(){this.clearGcTimeout()}scheduleGc(){this.clearGcTimeout(),zv(this.gcTime)&&te(this,oa,setTimeout(()=>{this.optionalRemove()},this.gcTime))}updateGcTime(t){this.gcTime=Math.max(this.gcTime||0,t??(ba?1/0:5*60*1e3))}clearGcTimeout(){N(this,oa)&&(clearTimeout(N(this,oa)),te(this,oa,void 0))}},oa=new WeakMap,Wx),Ls,ia,jn,aa,Vt,Nl,sa,lr,oo,Ux,eO=(Ux=class extends wE{constructor(e){super();he(this,lr);he(this,Ls);he(this,ia);he(this,jn);he(this,aa);he(this,Vt);he(this,Nl);he(this,sa);te(this,sa,!1),te(this,Nl,e.defaultOptions),this.setOptions(e.options),this.observers=[],te(this,aa,e.client),te(this,jn,N(this,aa).getQueryCache()),this.queryKey=e.queryKey,this.queryHash=e.queryHash,te(this,Ls,tO(this.options)),this.state=e.state??N(this,Ls),this.scheduleGc()}get meta(){return this.options.meta}get promise(){var e;return(e=N(this,Vt))==null?void 0:e.promise}setOptions(e){this.options={...N(this,Nl),...e},this.updateGcTime(this.options.gcTime)}optionalRemove(){!this.observers.length&&this.state.fetchStatus==="idle"&&N(this,jn).remove(this)}setData(e,n){const r=Hv(this.state.data,e,this.options);return Se(this,lr,oo).call(this,{data:r,type:"success",dataUpdatedAt:n==null?void 0:n.updatedAt,manual:n==null?void 0:n.manual}),r}setState(e,n){Se(this,lr,oo).call(this,{type:"setState",state:e,setStateOptions:n})}cancel(e){var r,o;const n=(r=N(this,Vt))==null?void 0:r.promise;return(o=N(this,Vt))==null||o.cancel(e),n?n.then(on).catch(on):Promise.resolve()}destroy(){super.destroy(),this.cancel({silent:!0})}reset(){this.destroy(),this.setState(N(this,Ls))}isActive(){return this.observers.some(e=>Wn(e.options.enabled,this)!==!1)}isDisabled(){return this.getObserversCount()>0?!this.isActive():this.options.queryFn===Qg||this.state.dataUpdateCount+this.state.errorUpdateCount===0}isStatic(){return this.getObserversCount()>0?this.observers.some(e=>xi(e.options.staleTime,this)==="static"):!1}isStale(){return this.getObserversCount()>0?this.observers.some(e=>e.getCurrentResult().isStale):this.state.data===void 0||this.state.isInvalidated}isStaleByTime(e=0){return this.state.data===void 0?!0:e==="static"?!1:this.state.isInvalidated?!0:!fE(this.state.dataUpdatedAt,e)}onFocus(){var n;const e=this.observers.find(r=>r.shouldFetchOnWindowFocus());e==null||e.refetch({cancelRefetch:!1}),(n=N(this,Vt))==null||n.continue()}onOnline(){var n;const e=this.observers.find(r=>r.shouldFetchOnReconnect());e==null||e.refetch({cancelRefetch:!1}),(n=N(this,Vt))==null||n.continue()}addObserver(e){this.observers.includes(e)||(this.observers.push(e),this.clearGcTimeout(),N(this,jn).notify({type:"observerAdded",query:this,observer:e}))}removeObserver(e){this.observers.includes(e)&&(this.observers=this.observers.filter(n=>n!==e),this.observers.length||(N(this,Vt)&&(N(this,sa)?N(this,Vt).cancel({revert:!0}):N(this,Vt).cancelRetry()),this.scheduleGc()),N(this,jn).notify({type:"observerRemoved",query:this,observer:e}))}getObserversCount(){return this.observers.length}invalidate(){this.state.isInvalidated||Se(this,lr,oo).call(this,{type:"invalidate"})}fetch(e,n){var l,c,d;if(this.state.fetchStatus!=="idle"){if(this.state.data!==void 0&&(n!=null&&n.cancelRefetch))this.cancel({silent:!0});else if(N(this,Vt))return N(this,Vt).continueRetry(),N(this,Vt).promise}if(e&&this.setOptions(e),!this.options.queryFn){const f=this.observers.find(h=>h.options.queryFn);f&&this.setOptions(f.options)}const r=new AbortController,o=f=>{Object.defineProperty(f,"signal",{enumerable:!0,get:()=>(te(this,sa,!0),r.signal)})},i=()=>{const f=pE(this.options,n),v=(()=>{const p={client:N(this,aa),queryKey:this.queryKey,meta:this.meta};return o(p),p})();return te(this,sa,!1),this.options.persister?this.options.persister(f,v,this):f(v)},s=(()=>{const f={fetchOptions:n,options:this.options,queryKey:this.queryKey,client:N(this,aa),state:this.state,fetchFn:i};return o(f),f})();(l=this.options.behavior)==null||l.onFetch(s,this),te(this,ia,this.state),(this.state.fetchStatus==="idle"||this.state.fetchMeta!==((c=s.fetchOptions)==null?void 0:c.meta))&&Se(this,lr,oo).call(this,{type:"fetch",meta:(d=s.fetchOptions)==null?void 0:d.meta});const u=f=>{var h,v,p,m;Yh(f)&&f.silent||Se(this,lr,oo).call(this,{type:"error",error:f}),Yh(f)||((v=(h=N(this,jn).config).onError)==null||v.call(h,f,this),(m=(p=N(this,jn).config).onSettled)==null||m.call(p,this.state.data,f,this)),this.scheduleGc()};return te(this,Vt,yE({initialPromise:n==null?void 0:n.initialPromise,fn:s.fetchFn,abort:r.abort.bind(r),onSuccess:f=>{var h,v,p,m;if(f===void 0){u(new Error(`${this.queryHash} data is undefined`));return}try{this.setData(f)}catch(g){u(g);return}(v=(h=N(this,jn).config).onSuccess)==null||v.call(h,f,this),(m=(p=N(this,jn).config).onSettled)==null||m.call(p,f,this.state.error,this),this.scheduleGc()},onError:u,onFail:(f,h)=>{Se(this,lr,oo).call(this,{type:"failed",failureCount:f,error:h})},onPause:()=>{Se(this,lr,oo).call(this,{type:"pause"})},onContinue:()=>{Se(this,lr,oo).call(this,{type:"continue"})},retry:s.options.retry,retryDelay:s.options.retryDelay,networkMode:s.options.networkMode,canRun:()=>!0})),N(this,Vt).start()}},Ls=new WeakMap,ia=new WeakMap,jn=new WeakMap,aa=new WeakMap,Vt=new WeakMap,Nl=new WeakMap,sa=new WeakMap,lr=new WeakSet,oo=function(e){const n=r=>{switch(e.type){case"failed":return{...r,fetchFailureCount:e.failureCount,fetchFailureReason:e.error};case"pause":return{...r,fetchStatus:"paused"};case"continue":return{...r,fetchStatus:"fetching"};case"fetch":return{...r,...xE(r.data,this.options),fetchMeta:e.meta??null};case"success":return te(this,ia,void 0),{...r,data:e.data,dataUpdateCount:r.dataUpdateCount+1,dataUpdatedAt:e.dataUpdatedAt??Date.now(),error:null,isInvalidated:!1,status:"success",...!e.manual&&{fetchStatus:"idle",fetchFailureCount:0,fetchFailureReason:null}};case"error":const o=e.error;return Yh(o)&&o.revert&&N(this,ia)?{...N(this,ia),fetchStatus:"idle"}:{...r,error:o,errorUpdateCount:r.errorUpdateCount+1,errorUpdatedAt:Date.now(),fetchFailureCount:r.fetchFailureCount+1,fetchFailureReason:o,fetchStatus:"idle",status:"error"};case"invalidate":return{...r,isInvalidated:!0};case"setState":return{...r,...e.state}}};this.state=n(this.state),xt.batch(()=>{this.observers.forEach(r=>{r.onQueryUpdate()}),N(this,jn).notify({query:this,type:"updated",action:e})})},Ux);function xE(t,e){return{fetchFailureCount:0,fetchFailureReason:null,fetchStatus:mE(e.networkMode)?"fetching":"paused",...t===void 0&&{error:null,status:"pending"}}}function tO(t){const e=typeof t.initialData=="function"?t.initialData():t.initialData,n=e!==void 0,r=n?typeof t.initialDataUpdatedAt=="function"?t.initialDataUpdatedAt():t.initialDataUpdatedAt:0;return{data:e,dataUpdateCount:0,dataUpdatedAt:n?r??Date.now():0,error:null,errorUpdateCount:0,errorUpdatedAt:0,fetchFailureCount:0,fetchFailureReason:null,fetchMeta:null,isInvalidated:!1,status:n?"success":"pending",fetchStatus:"idle"}}var Dr,zx,nO=(zx=class extends fu{constructor(e={}){super();he(this,Dr);this.config=e,te(this,Dr,new Map)}build(e,n,r){const o=n.queryKey,i=n.queryHash??Yg(o,n);let a=this.get(i);return a||(a=new eO({client:e,queryKey:o,queryHash:i,options:e.defaultQueryOptions(n),state:r,defaultOptions:e.getQueryDefaults(o)}),this.add(a)),a}add(e){N(this,Dr).has(e.queryHash)||(N(this,Dr).set(e.queryHash,e),this.notify({type:"added",query:e}))}remove(e){const n=N(this,Dr).get(e.queryHash);n&&(e.destroy(),n===e&&N(this,Dr).delete(e.queryHash),this.notify({type:"removed",query:e}))}clear(){xt.batch(()=>{this.getAll().forEach(e=>{this.remove(e)})})}get(e){return N(this,Dr).get(e)}getAll(){return[...N(this,Dr).values()]}find(e){const n={exact:!0,...e};return this.getAll().find(r=>K1(n,r))}findAll(e={}){const n=this.getAll();return Object.keys(e).length>0?n.filter(r=>K1(e,r)):n}notify(e){xt.batch(()=>{this.listeners.forEach(n=>{n(e)})})}onFocus(){xt.batch(()=>{this.getAll().forEach(e=>{e.onFocus()})})}onOnline(){xt.batch(()=>{this.getAll().forEach(e=>{e.onOnline()})})}},Dr=new WeakMap,zx),Nr,tn,ua,Or,zo,Vx,rO=(Vx=class extends wE{constructor(e){super();he(this,Or);he(this,Nr);he(this,tn);he(this,ua);this.mutationId=e.mutationId,te(this,tn,e.mutationCache),te(this,Nr,[]),this.state=e.state||bE(),this.setOptions(e.options),this.scheduleGc()}setOptions(e){this.options=e,this.updateGcTime(this.options.gcTime)}get meta(){return this.options.meta}addObserver(e){N(this,Nr).includes(e)||(N(this,Nr).push(e),this.clearGcTimeout(),N(this,tn).notify({type:"observerAdded",mutation:this,observer:e}))}removeObserver(e){te(this,Nr,N(this,Nr).filter(n=>n!==e)),this.scheduleGc(),N(this,tn).notify({type:"observerRemoved",mutation:this,observer:e})}optionalRemove(){N(this,Nr).length||(this.state.status==="pending"?this.scheduleGc():N(this,tn).remove(this))}continue(){var e;return((e=N(this,ua))==null?void 0:e.continue())??this.execute(this.state.variables)}async execute(e){var i,a,s,u,l,c,d,f,h,v,p,m,g,y,w,x,b,_,E,C;const n=()=>{Se(this,Or,zo).call(this,{type:"continue"})};te(this,ua,yE({fn:()=>this.options.mutationFn?this.options.mutationFn(e):Promise.reject(new Error("No mutationFn found")),onFail:(R,S)=>{Se(this,Or,zo).call(this,{type:"failed",failureCount:R,error:S})},onPause:()=>{Se(this,Or,zo).call(this,{type:"pause"})},onContinue:n,retry:this.options.retry??0,retryDelay:this.options.retryDelay,networkMode:this.options.networkMode,canRun:()=>N(this,tn).canRun(this)}));const r=this.state.status==="pending",o=!N(this,ua).canStart();try{if(r)n();else{Se(this,Or,zo).call(this,{type:"pending",variables:e,isPaused:o}),await((a=(i=N(this,tn).config).onMutate)==null?void 0:a.call(i,e,this));const S=await((u=(s=this.options).onMutate)==null?void 0:u.call(s,e));S!==this.state.context&&Se(this,Or,zo).call(this,{type:"pending",context:S,variables:e,isPaused:o})}const R=await N(this,ua).start();return await((c=(l=N(this,tn).config).onSuccess)==null?void 0:c.call(l,R,e,this.state.context,this)),await((f=(d=this.options).onSuccess)==null?void 0:f.call(d,R,e,this.state.context)),await((v=(h=N(this,tn).config).onSettled)==null?void 0:v.call(h,R,null,this.state.variables,this.state.context,this)),await((m=(p=this.options).onSettled)==null?void 0:m.call(p,R,null,e,this.state.context)),Se(this,Or,zo).call(this,{type:"success",data:R}),R}catch(R){try{throw await((y=(g=N(this,tn).config).onError)==null?void 0:y.call(g,R,e,this.state.context,this)),await((x=(w=this.options).onError)==null?void 0:x.call(w,R,e,this.state.context)),await((_=(b=N(this,tn).config).onSettled)==null?void 0:_.call(b,void 0,R,this.state.variables,this.state.context,this)),await((C=(E=this.options).onSettled)==null?void 0:C.call(E,void 0,R,e,this.state.context)),R}finally{Se(this,Or,zo).call(this,{type:"error",error:R})}}finally{N(this,tn).runNext(this)}}},Nr=new WeakMap,tn=new WeakMap,ua=new WeakMap,Or=new WeakSet,zo=function(e){const n=r=>{switch(e.type){case"failed":return{...r,failureCount:e.failureCount,failureReason:e.error};case"pause":return{...r,isPaused:!0};case"continue":return{...r,isPaused:!1};case"pending":return{...r,context:e.context,data:void 0,failureCount:0,failureReason:null,error:null,isPaused:e.isPaused,status:"pending",variables:e.variables,submittedAt:Date.now()};case"success":return{...r,data:e.data,failureCount:0,failureReason:null,error:null,status:"success",isPaused:!1};case"error":return{...r,data:void 0,error:e.error,failureCount:r.failureCount+1,failureReason:e.error,isPaused:!1,status:"error"}}};this.state=n(this.state),xt.batch(()=>{N(this,Nr).forEach(r=>{r.onMutationUpdate(e)}),N(this,tn).notify({mutation:this,type:"updated",action:e})})},Vx);function bE(){return{context:void 0,data:void 0,error:null,failureCount:0,failureReason:null,isPaused:!1,status:"idle",variables:void 0,submittedAt:0}}var co,cr,Ol,Hx,oO=(Hx=class extends fu{constructor(e={}){super();he(this,co);he(this,cr);he(this,Ol);this.config=e,te(this,co,new Set),te(this,cr,new Map),te(this,Ol,0)}build(e,n,r){const o=new rO({mutationCache:this,mutationId:++uc(this,Ol)._,options:e.defaultMutationOptions(n),state:r});return this.add(o),o}add(e){N(this,co).add(e);const n=Ac(e);if(typeof n=="string"){const r=N(this,cr).get(n);r?r.push(e):N(this,cr).set(n,[e])}this.notify({type:"added",mutation:e})}remove(e){if(N(this,co).delete(e)){const n=Ac(e);if(typeof n=="string"){const r=N(this,cr).get(n);if(r)if(r.length>1){const o=r.indexOf(e);o!==-1&&r.splice(o,1)}else r[0]===e&&N(this,cr).delete(n)}}this.notify({type:"removed",mutation:e})}canRun(e){const n=Ac(e);if(typeof n=="string"){const r=N(this,cr).get(n),o=r==null?void 0:r.find(i=>i.state.status==="pending");return!o||o===e}else return!0}runNext(e){var r;const n=Ac(e);if(typeof n=="string"){const o=(r=N(this,cr).get(n))==null?void 0:r.find(i=>i!==e&&i.state.isPaused);return(o==null?void 0:o.continue())??Promise.resolve()}else return Promise.resolve()}clear(){xt.batch(()=>{N(this,co).forEach(e=>{this.notify({type:"removed",mutation:e})}),N(this,co).clear(),N(this,cr).clear()})}getAll(){return Array.from(N(this,co))}find(e){const n={exact:!0,...e};return this.getAll().find(r=>X1(n,r))}findAll(e={}){return this.getAll().filter(n=>X1(e,n))}notify(e){xt.batch(()=>{this.listeners.forEach(n=>{n(e)})})}resumePausedMutations(){const e=this.getAll().filter(n=>n.state.isPaused);return xt.batch(()=>Promise.all(e.map(n=>n.continue().catch(on))))}},co=new WeakMap,cr=new WeakMap,Ol=new WeakMap,Hx);function Ac(t){var e;return(e=t.options.scope)==null?void 0:e.id}function J1(t){return{onFetch:(e,n)=>{var c,d,f,h,v;const r=e.options,o=(f=(d=(c=e.fetchOptions)==null?void 0:c.meta)==null?void 0:d.fetchMore)==null?void 0:f.direction,i=((h=e.state.data)==null?void 0:h.pages)||[],a=((v=e.state.data)==null?void 0:v.pageParams)||[];let s={pages:[],pageParams:[]},u=0;const l=async()=>{let p=!1;const m=w=>{Object.defineProperty(w,"signal",{enumerable:!0,get:()=>(e.signal.aborted?p=!0:e.signal.addEventListener("abort",()=>{p=!0}),e.signal)})},g=pE(e.options,e.fetchOptions),y=async(w,x,b)=>{if(p)return Promise.reject();if(x==null&&w.pages.length)return Promise.resolve(w);const E=(()=>{const P={client:e.client,queryKey:e.queryKey,pageParam:x,direction:b?"backward":"forward",meta:e.options.meta};return m(P),P})(),C=await g(E),{maxPages:R}=e.options,S=b?KN:qN;return{pages:S(w.pages,C,R),pageParams:S(w.pageParams,x,R)}};if(o&&i.length){const w=o==="backward",x=w?iO:Z1,b={pages:i,pageParams:a},_=x(r,b);s=await y(b,_,w)}else{const w=t??i.length;do{const x=u===0?a[0]??r.initialPageParam:Z1(r,s);if(u>0&&x==null)break;s=await y(s,x),u++}while(u<w)}return s};e.options.persister?e.fetchFn=()=>{var p,m;return(m=(p=e.options).persister)==null?void 0:m.call(p,l,{client:e.client,queryKey:e.queryKey,meta:e.options.meta,signal:e.signal},n)}:e.fetchFn=l}}}function Z1(t,{pages:e,pageParams:n}){const r=e.length-1;return e.length>0?t.getNextPageParam(e[r],e,n[r],n):void 0}function iO(t,{pages:e,pageParams:n}){var r;return e.length>0?(r=t.getPreviousPageParam)==null?void 0:r.call(t,e[0],e,n[0],n):void 0}var ut,Zo,ei,Bs,$s,ti,js,Ws,Gx,IV=(Gx=class{constructor(t={}){he(this,ut);he(this,Zo);he(this,ei);he(this,Bs);he(this,$s);he(this,ti);he(this,js);he(this,Ws);te(this,ut,t.queryCache||new nO),te(this,Zo,t.mutationCache||new oO),te(this,ei,t.defaultOptions||{}),te(this,Bs,new Map),te(this,$s,new Map),te(this,ti,0)}mount(){uc(this,ti)._++,N(this,ti)===1&&(te(this,js,Jg.subscribe(async t=>{t&&(await this.resumePausedMutations(),N(this,ut).onFocus())})),te(this,Ws,Hd.subscribe(async t=>{t&&(await this.resumePausedMutations(),N(this,ut).onOnline())})))}unmount(){var t,e;uc(this,ti)._--,N(this,ti)===0&&((t=N(this,js))==null||t.call(this),te(this,js,void 0),(e=N(this,Ws))==null||e.call(this),te(this,Ws,void 0))}isFetching(t){return N(this,ut).findAll({...t,fetchStatus:"fetching"}).length}isMutating(t){return N(this,Zo).findAll({...t,status:"pending"}).length}getQueryData(t){var n;const e=this.defaultQueryOptions({queryKey:t});return(n=N(this,ut).get(e.queryHash))==null?void 0:n.state.data}ensureQueryData(t){const e=this.defaultQueryOptions(t),n=N(this,ut).build(this,e),r=n.state.data;return r===void 0?this.fetchQuery(t):(t.revalidateIfStale&&n.isStaleByTime(xi(e.staleTime,n))&&this.prefetchQuery(e),Promise.resolve(r))}getQueriesData(t){return N(this,ut).findAll(t).map(({queryKey:e,state:n})=>{const r=n.data;return[e,r]})}setQueryData(t,e,n){const r=this.defaultQueryOptions({queryKey:t}),o=N(this,ut).get(r.queryHash),i=o==null?void 0:o.state.data,a=HN(e,i);if(a!==void 0)return N(this,ut).build(this,r).setData(a,{...n,manual:!0})}setQueriesData(t,e,n){return xt.batch(()=>N(this,ut).findAll(t).map(({queryKey:r})=>[r,this.setQueryData(r,e,n)]))}getQueryState(t){var n;const e=this.defaultQueryOptions({queryKey:t});return(n=N(this,ut).get(e.queryHash))==null?void 0:n.state}removeQueries(t){const e=N(this,ut);xt.batch(()=>{e.findAll(t).forEach(n=>{e.remove(n)})})}resetQueries(t,e){const n=N(this,ut);return xt.batch(()=>(n.findAll(t).forEach(r=>{r.reset()}),this.refetchQueries({type:"active",...t},e)))}cancelQueries(t,e={}){const n={revert:!0,...e},r=xt.batch(()=>N(this,ut).findAll(t).map(o=>o.cancel(n)));return Promise.all(r).then(on).catch(on)}invalidateQueries(t,e={}){return xt.batch(()=>(N(this,ut).findAll(t).forEach(n=>{n.invalidate()}),(t==null?void 0:t.refetchType)==="none"?Promise.resolve():this.refetchQueries({...t,type:(t==null?void 0:t.refetchType)??(t==null?void 0:t.type)??"active"},e)))}refetchQueries(t,e={}){const n={...e,cancelRefetch:e.cancelRefetch??!0},r=xt.batch(()=>N(this,ut).findAll(t).filter(o=>!o.isDisabled()&&!o.isStatic()).map(o=>{let i=o.fetch(void 0,n);return n.throwOnError||(i=i.catch(on)),o.state.fetchStatus==="paused"?Promise.resolve():i}));return Promise.all(r).then(on)}fetchQuery(t){const e=this.defaultQueryOptions(t);e.retry===void 0&&(e.retry=!1);const n=N(this,ut).build(this,e);return n.isStaleByTime(xi(e.staleTime,n))?n.fetch(e):Promise.resolve(n.state.data)}prefetchQuery(t){return this.fetchQuery(t).then(on).catch(on)}fetchInfiniteQuery(t){return t.behavior=J1(t.pages),this.fetchQuery(t)}prefetchInfiniteQuery(t){return this.fetchInfiniteQuery(t).then(on).catch(on)}ensureInfiniteQueryData(t){return t.behavior=J1(t.pages),this.ensureQueryData(t)}resumePausedMutations(){return Hd.isOnline()?N(this,Zo).resumePausedMutations():Promise.resolve()}getQueryCache(){return N(this,ut)}getMutationCache(){return N(this,Zo)}getDefaultOptions(){return N(this,ei)}setDefaultOptions(t){te(this,ei,t)}setQueryDefaults(t,e){N(this,Bs).set(_a(t),{queryKey:t,defaultOptions:e})}getQueryDefaults(t){const e=[...N(this,Bs).values()],n={};return e.forEach(r=>{_l(t,r.queryKey)&&Object.assign(n,r.defaultOptions)}),n}setMutationDefaults(t,e){N(this,$s).set(_a(t),{mutationKey:t,defaultOptions:e})}getMutationDefaults(t){const e=[...N(this,$s).values()],n={};return e.forEach(r=>{_l(t,r.mutationKey)&&Object.assign(n,r.defaultOptions)}),n}defaultQueryOptions(t){if(t._defaulted)return t;const e={...N(this,ei).queries,...this.getQueryDefaults(t.queryKey),...t,_defaulted:!0};return e.queryHash||(e.queryHash=Yg(e.queryKey,e)),e.refetchOnReconnect===void 0&&(e.refetchOnReconnect=e.networkMode!=="always"),e.throwOnError===void 0&&(e.throwOnError=!!e.suspense),!e.networkMode&&e.persister&&(e.networkMode="offlineFirst"),e.queryFn===Qg&&(e.enabled=!1),e}defaultMutationOptions(t){return t!=null&&t._defaulted?t:{...N(this,ei).mutations,...(t==null?void 0:t.mutationKey)&&this.getMutationDefaults(t.mutationKey),...t,_defaulted:!0}}clear(){N(this,ut).clear(),N(this,Zo).clear()}},ut=new WeakMap,Zo=new WeakMap,ei=new WeakMap,Bs=new WeakMap,$s=new WeakMap,ti=new WeakMap,js=new WeakMap,Ws=new WeakMap,Gx),cn,Pe,Fl,nn,la,Us,ni,ri,Ml,zs,Vs,ca,da,oi,Hs,Me,Bu,qv,Kv,Xv,Yv,Qv,Jv,Zv,_E,qx,aO=(qx=class extends fu{constructor(e,n){super();he(this,Me);he(this,cn);he(this,Pe);he(this,Fl);he(this,nn);he(this,la);he(this,Us);he(this,ni);he(this,ri);he(this,Ml);he(this,zs);he(this,Vs);he(this,ca);he(this,da);he(this,oi);he(this,Hs,new Set);this.options=n,te(this,cn,e),te(this,ri,null),te(this,ni,Gv()),this.options.experimental_prefetchInRender||N(this,ni).reject(new Error("experimental_prefetchInRender feature flag is not enabled")),this.bindMethods(),this.setOptions(n)}bindMethods(){this.refetch=this.refetch.bind(this)}onSubscribe(){this.listeners.size===1&&(N(this,Pe).addObserver(this),ew(N(this,Pe),this.options)?Se(this,Me,Bu).call(this):this.updateResult(),Se(this,Me,Yv).call(this))}onUnsubscribe(){this.hasListeners()||this.destroy()}shouldFetchOnReconnect(){return em(N(this,Pe),this.options,this.options.refetchOnReconnect)}shouldFetchOnWindowFocus(){return em(N(this,Pe),this.options,this.options.refetchOnWindowFocus)}destroy(){this.listeners=new Set,Se(this,Me,Qv).call(this),Se(this,Me,Jv).call(this),N(this,Pe).removeObserver(this)}setOptions(e){const n=this.options,r=N(this,Pe);if(this.options=N(this,cn).defaultQueryOptions(e),this.options.enabled!==void 0&&typeof this.options.enabled!="boolean"&&typeof this.options.enabled!="function"&&typeof Wn(this.options.enabled,N(this,Pe))!="boolean")throw new Error("Expected enabled to be a boolean or a callback that returns a boolean");Se(this,Me,Zv).call(this),N(this,Pe).setOptions(this.options),n._defaulted&&!Vd(this.options,n)&&N(this,cn).getQueryCache().notify({type:"observerOptionsUpdated",query:N(this,Pe),observer:this});const o=this.hasListeners();o&&tw(N(this,Pe),r,this.options,n)&&Se(this,Me,Bu).call(this),this.updateResult(),o&&(N(this,Pe)!==r||Wn(this.options.enabled,N(this,Pe))!==Wn(n.enabled,N(this,Pe))||xi(this.options.staleTime,N(this,Pe))!==xi(n.staleTime,N(this,Pe)))&&Se(this,Me,qv).call(this);const i=Se(this,Me,Kv).call(this);o&&(N(this,Pe)!==r||Wn(this.options.enabled,N(this,Pe))!==Wn(n.enabled,N(this,Pe))||i!==N(this,oi))&&Se(this,Me,Xv).call(this,i)}getOptimisticResult(e){const n=N(this,cn).getQueryCache().build(N(this,cn),e),r=this.createResult(n,e);return uO(this,r)&&(te(this,nn,r),te(this,Us,this.options),te(this,la,N(this,Pe).state)),r}getCurrentResult(){return N(this,nn)}trackResult(e,n){return new Proxy(e,{get:(r,o)=>(this.trackProp(o),n==null||n(o),Reflect.get(r,o))})}trackProp(e){N(this,Hs).add(e)}getCurrentQuery(){return N(this,Pe)}refetch({...e}={}){return this.fetch({...e})}fetchOptimistic(e){const n=N(this,cn).defaultQueryOptions(e),r=N(this,cn).getQueryCache().build(N(this,cn),n);return r.fetch().then(()=>this.createResult(r,n))}fetch(e){return Se(this,Me,Bu).call(this,{...e,cancelRefetch:e.cancelRefetch??!0}).then(()=>(this.updateResult(),N(this,nn)))}createResult(e,n){var R;const r=N(this,Pe),o=this.options,i=N(this,nn),a=N(this,la),s=N(this,Us),l=e!==r?e.state:N(this,Fl),{state:c}=e;let d={...c},f=!1,h;if(n._optimisticResults){const S=this.hasListeners(),P=!S&&ew(e,n),A=S&&tw(e,r,n,o);(P||A)&&(d={...d,...xE(c.data,e.options)}),n._optimisticResults==="isRestoring"&&(d.fetchStatus="idle")}let{error:v,errorUpdatedAt:p,status:m}=d;h=d.data;let g=!1;if(n.placeholderData!==void 0&&h===void 0&&m==="pending"){let S;i!=null&&i.isPlaceholderData&&n.placeholderData===(s==null?void 0:s.placeholderData)?(S=i.data,g=!0):S=typeof n.placeholderData=="function"?n.placeholderData((R=N(this,Vs))==null?void 0:R.state.data,N(this,Vs)):n.placeholderData,S!==void 0&&(m="success",h=Hv(i==null?void 0:i.data,S,n),f=!0)}if(n.select&&h!==void 0&&!g)if(i&&h===(a==null?void 0:a.data)&&n.select===N(this,Ml))h=N(this,zs);else try{te(this,Ml,n.select),h=n.select(h),h=Hv(i==null?void 0:i.data,h,n),te(this,zs,h),te(this,ri,null)}catch(S){te(this,ri,S)}N(this,ri)&&(v=N(this,ri),h=N(this,zs),p=Date.now(),m="error");const y=d.fetchStatus==="fetching",w=m==="pending",x=m==="error",b=w&&y,_=h!==void 0,C={status:m,fetchStatus:d.fetchStatus,isPending:w,isSuccess:m==="success",isError:x,isInitialLoading:b,isLoading:b,data:h,dataUpdatedAt:d.dataUpdatedAt,error:v,errorUpdatedAt:p,failureCount:d.fetchFailureCount,failureReason:d.fetchFailureReason,errorUpdateCount:d.errorUpdateCount,isFetched:d.dataUpdateCount>0||d.errorUpdateCount>0,isFetchedAfterMount:d.dataUpdateCount>l.dataUpdateCount||d.errorUpdateCount>l.errorUpdateCount,isFetching:y,isRefetching:y&&!w,isLoadingError:x&&!_,isPaused:d.fetchStatus==="paused",isPlaceholderData:f,isRefetchError:x&&_,isStale:Zg(e,n),refetch:this.refetch,promise:N(this,ni),isEnabled:Wn(n.enabled,e)!==!1};if(this.options.experimental_prefetchInRender){const S=B=>{C.status==="error"?B.reject(C.error):C.data!==void 0&&B.resolve(C.data)},P=()=>{const B=te(this,ni,C.promise=Gv());S(B)},A=N(this,ni);switch(A.status){case"pending":e.queryHash===r.queryHash&&S(A);break;case"fulfilled":(C.status==="error"||C.data!==A.value)&&P();break;case"rejected":(C.status!=="error"||C.error!==A.reason)&&P();break}}return C}updateResult(){const e=N(this,nn),n=this.createResult(N(this,Pe),this.options);if(te(this,la,N(this,Pe).state),te(this,Us,this.options),N(this,la).data!==void 0&&te(this,Vs,N(this,Pe)),Vd(n,e))return;te(this,nn,n);const r=()=>{if(!e)return!0;const{notifyOnChangeProps:o}=this.options,i=typeof o=="function"?o():o;if(i==="all"||!i&&!N(this,Hs).size)return!0;const a=new Set(i??N(this,Hs));return this.options.throwOnError&&a.add("error"),Object.keys(N(this,nn)).some(s=>{const u=s;return N(this,nn)[u]!==e[u]&&a.has(u)})};Se(this,Me,_E).call(this,{listeners:r()})}onQueryUpdate(){this.updateResult(),this.hasListeners()&&Se(this,Me,Yv).call(this)}},cn=new WeakMap,Pe=new WeakMap,Fl=new WeakMap,nn=new WeakMap,la=new WeakMap,Us=new WeakMap,ni=new WeakMap,ri=new WeakMap,Ml=new WeakMap,zs=new WeakMap,Vs=new WeakMap,ca=new WeakMap,da=new WeakMap,oi=new WeakMap,Hs=new WeakMap,Me=new WeakSet,Bu=function(e){Se(this,Me,Zv).call(this);let n=N(this,Pe).fetch(this.options,e);return e!=null&&e.throwOnError||(n=n.catch(on)),n},qv=function(){Se(this,Me,Qv).call(this);const e=xi(this.options.staleTime,N(this,Pe));if(ba||N(this,nn).isStale||!zv(e))return;const r=fE(N(this,nn).dataUpdatedAt,e)+1;te(this,ca,setTimeout(()=>{N(this,nn).isStale||this.updateResult()},r))},Kv=function(){return(typeof this.options.refetchInterval=="function"?this.options.refetchInterval(N(this,Pe)):this.options.refetchInterval)??!1},Xv=function(e){Se(this,Me,Jv).call(this),te(this,oi,e),!(ba||Wn(this.options.enabled,N(this,Pe))===!1||!zv(N(this,oi))||N(this,oi)===0)&&te(this,da,setInterval(()=>{(this.options.refetchIntervalInBackground||Jg.isFocused())&&Se(this,Me,Bu).call(this)},N(this,oi)))},Yv=function(){Se(this,Me,qv).call(this),Se(this,Me,Xv).call(this,Se(this,Me,Kv).call(this))},Qv=function(){N(this,ca)&&(clearTimeout(N(this,ca)),te(this,ca,void 0))},Jv=function(){N(this,da)&&(clearInterval(N(this,da)),te(this,da,void 0))},Zv=function(){const e=N(this,cn).getQueryCache().build(N(this,cn),this.options);if(e===N(this,Pe))return;const n=N(this,Pe);te(this,Pe,e),te(this,Fl,e.state),this.hasListeners()&&(n==null||n.removeObserver(this),e.addObserver(this))},_E=function(e){xt.batch(()=>{e.listeners&&this.listeners.forEach(n=>{n(N(this,nn))}),N(this,cn).getQueryCache().notify({query:N(this,Pe),type:"observerResultsUpdated"})})},qx);function sO(t,e){return Wn(e.enabled,t)!==!1&&t.state.data===void 0&&!(t.state.status==="error"&&e.retryOnMount===!1)}function ew(t,e){return sO(t,e)||t.state.data!==void 0&&em(t,e,e.refetchOnMount)}function em(t,e,n){if(Wn(e.enabled,t)!==!1&&xi(e.staleTime,t)!=="static"){const r=typeof n=="function"?n(t):n;return r==="always"||r!==!1&&Zg(t,e)}return!1}function tw(t,e,n,r){return(t!==e||Wn(r.enabled,t)===!1)&&(!n.suspense||t.state.status!=="error")&&Zg(t,n)}function Zg(t,e){return Wn(e.enabled,t)!==!1&&t.isStaleByTime(xi(e.staleTime,t))}function uO(t,e){return!Vd(t.getCurrentResult(),e)}var ii,ai,dn,fo,go,fd,tm,Kx,lO=(Kx=class extends fu{constructor(n,r){super();he(this,go);he(this,ii);he(this,ai);he(this,dn);he(this,fo);te(this,ii,n),this.setOptions(r),this.bindMethods(),Se(this,go,fd).call(this)}bindMethods(){this.mutate=this.mutate.bind(this),this.reset=this.reset.bind(this)}setOptions(n){var o;const r=this.options;this.options=N(this,ii).defaultMutationOptions(n),Vd(this.options,r)||N(this,ii).getMutationCache().notify({type:"observerOptionsUpdated",mutation:N(this,dn),observer:this}),r!=null&&r.mutationKey&&this.options.mutationKey&&_a(r.mutationKey)!==_a(this.options.mutationKey)?this.reset():((o=N(this,dn))==null?void 0:o.state.status)==="pending"&&N(this,dn).setOptions(this.options)}onUnsubscribe(){var n;this.hasListeners()||(n=N(this,dn))==null||n.removeObserver(this)}onMutationUpdate(n){Se(this,go,fd).call(this),Se(this,go,tm).call(this,n)}getCurrentResult(){return N(this,ai)}reset(){var n;(n=N(this,dn))==null||n.removeObserver(this),te(this,dn,void 0),Se(this,go,fd).call(this),Se(this,go,tm).call(this)}mutate(n,r){var o;return te(this,fo,r),(o=N(this,dn))==null||o.removeObserver(this),te(this,dn,N(this,ii).getMutationCache().build(N(this,ii),this.options)),N(this,dn).addObserver(this),N(this,dn).execute(n)}},ii=new WeakMap,ai=new WeakMap,dn=new WeakMap,fo=new WeakMap,go=new WeakSet,fd=function(){var r;const n=((r=N(this,dn))==null?void 0:r.state)??bE();te(this,ai,{...n,isPending:n.status==="pending",isSuccess:n.status==="success",isError:n.status==="error",isIdle:n.status==="idle",mutate:this.mutate,reset:this.reset})},tm=function(n){xt.batch(()=>{var r,o,i,a,s,u,l,c;if(N(this,fo)&&this.hasListeners()){const d=N(this,ai).variables,f=N(this,ai).context;(n==null?void 0:n.type)==="success"?((o=(r=N(this,fo)).onSuccess)==null||o.call(r,n.data,d,f),(a=(i=N(this,fo)).onSettled)==null||a.call(i,n.data,null,d,f)):(n==null?void 0:n.type)==="error"&&((u=(s=N(this,fo)).onError)==null||u.call(s,n.error,d,f),(c=(l=N(this,fo)).onSettled)==null||c.call(l,void 0,n.error,d,f))}this.listeners.forEach(d=>{d(N(this,ai))})})},Kx),EE=k.createContext(void 0),CE=t=>{const e=k.useContext(EE);if(!e)throw new Error("No QueryClient set, use QueryClientProvider to set one");return e},PV=({client:t,children:e})=>(k.useEffect(()=>(t.mount(),()=>{t.unmount()}),[t]),G.jsx(EE.Provider,{value:t,children:e})),SE=k.createContext(!1),cO=()=>k.useContext(SE);SE.Provider;function dO(){let t=!1;return{clearReset:()=>{t=!1},reset:()=>{t=!0},isReset:()=>t}}var fO=k.createContext(dO()),hO=()=>k.useContext(fO),pO=(t,e)=>{(t.suspense||t.throwOnError||t.experimental_prefetchInRender)&&(e.isReset()||(t.retryOnMount=!1))},vO=t=>{k.useEffect(()=>{t.clearReset()},[t])},mO=({result:t,errorResetBoundary:e,throwOnError:n,query:r,suspense:o})=>t.isError&&!e.isReset()&&!t.isFetching&&r&&(o&&t.data===void 0||vE(n,[t.error,r])),gO=t=>{if(t.suspense){const e=r=>r==="static"?r:Math.max(r??1e3,1e3),n=t.staleTime;t.staleTime=typeof n=="function"?(...r)=>e(n(...r)):e(n),typeof t.gcTime=="number"&&(t.gcTime=Math.max(t.gcTime,1e3))}},yO=(t,e)=>t.isLoading&&t.isFetching&&!e,wO=(t,e)=>(t==null?void 0:t.suspense)&&e.isPending,nw=(t,e,n)=>e.fetchOptimistic(t).catch(()=>{n.clearReset()});function xO(t,e,n){var d,f,h,v,p;const r=cO(),o=hO(),i=CE(),a=i.defaultQueryOptions(t);(f=(d=i.getDefaultOptions().queries)==null?void 0:d._experimental_beforeQuery)==null||f.call(d,a),a._optimisticResults=r?"isRestoring":"optimistic",gO(a),pO(a,o),vO(o);const s=!i.getQueryCache().get(a.queryHash),[u]=k.useState(()=>new e(i,a)),l=u.getOptimisticResult(a),c=!r&&t.subscribed!==!1;if(k.useSyncExternalStore(k.useCallback(m=>{const g=c?u.subscribe(xt.batchCalls(m)):on;return u.updateResult(),g},[u,c]),()=>u.getCurrentResult(),()=>u.getCurrentResult()),k.useEffect(()=>{u.setOptions(a)},[a,u]),wO(a,l))throw nw(a,u,o);if(mO({result:l,errorResetBoundary:o,throwOnError:a.throwOnError,query:i.getQueryCache().get(a.queryHash),suspense:a.suspense}))throw l.error;if((v=(h=i.getDefaultOptions().queries)==null?void 0:h._experimental_afterQuery)==null||v.call(h,a,l),a.experimental_prefetchInRender&&!ba&&yO(l,r)){const m=s?nw(a,u,o):(p=i.getQueryCache().get(a.queryHash))==null?void 0:p.promise;m==null||m.catch(on).finally(()=>{u.updateResult()})}return a.notifyOnChangeProps?l:u.trackResult(l)}function DV(t,e){return xO(t,aO)}function NV(t,e){const n=CE(),[r]=k.useState(()=>new lO(n,t));k.useEffect(()=>{r.setOptions(t)},[r,t]);const o=k.useSyncExternalStore(k.useCallback(a=>r.subscribe(xt.batchCalls(a)),[r]),()=>r.getCurrentResult(),()=>r.getCurrentResult()),i=k.useCallback((a,s)=>{r.mutate(a,s).catch(on)},[r]);if(o.error&&vE(r.options.throwOnError,[o.error]))throw o.error;return{...o,mutate:i,mutateAsync:o.mutate}}/**
 * @remix-run/router v1.23.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function El(){return El=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},El.apply(this,arguments)}var li;(function(t){t.Pop="POP",t.Push="PUSH",t.Replace="REPLACE"})(li||(li={}));const rw="popstate";function bO(t){t===void 0&&(t={});function e(r,o){let{pathname:i,search:a,hash:s}=r.location;return nm("",{pathname:i,search:a,hash:s},o.state&&o.state.usr||null,o.state&&o.state.key||"default")}function n(r,o){return typeof o=="string"?o:Gd(o)}return EO(e,n,null,t)}function vt(t,e){if(t===!1||t===null||typeof t>"u")throw new Error(e)}function kE(t,e){if(!t){typeof console<"u"&&console.warn(e);try{throw new Error(e)}catch{}}}function _O(){return Math.random().toString(36).substr(2,8)}function ow(t,e){return{usr:t.state,key:t.key,idx:e}}function nm(t,e,n,r){return n===void 0&&(n=null),El({pathname:typeof t=="string"?t:t.pathname,search:"",hash:""},typeof e=="string"?hu(e):e,{state:n,key:e&&e.key||r||_O()})}function Gd(t){let{pathname:e="/",search:n="",hash:r=""}=t;return n&&n!=="?"&&(e+=n.charAt(0)==="?"?n:"?"+n),r&&r!=="#"&&(e+=r.charAt(0)==="#"?r:"#"+r),e}function hu(t){let e={};if(t){let n=t.indexOf("#");n>=0&&(e.hash=t.substr(n),t=t.substr(0,n));let r=t.indexOf("?");r>=0&&(e.search=t.substr(r),t=t.substr(0,r)),t&&(e.pathname=t)}return e}function EO(t,e,n,r){r===void 0&&(r={});let{window:o=document.defaultView,v5Compat:i=!1}=r,a=o.history,s=li.Pop,u=null,l=c();l==null&&(l=0,a.replaceState(El({},a.state,{idx:l}),""));function c(){return(a.state||{idx:null}).idx}function d(){s=li.Pop;let m=c(),g=m==null?null:m-l;l=m,u&&u({action:s,location:p.location,delta:g})}function f(m,g){s=li.Push;let y=nm(p.location,m,g);l=c()+1;let w=ow(y,l),x=p.createHref(y);try{a.pushState(w,"",x)}catch(b){if(b instanceof DOMException&&b.name==="DataCloneError")throw b;o.location.assign(x)}i&&u&&u({action:s,location:p.location,delta:1})}function h(m,g){s=li.Replace;let y=nm(p.location,m,g);l=c();let w=ow(y,l),x=p.createHref(y);a.replaceState(w,"",x),i&&u&&u({action:s,location:p.location,delta:0})}function v(m){let g=o.location.origin!=="null"?o.location.origin:o.location.href,y=typeof m=="string"?m:Gd(m);return y=y.replace(/ $/,"%20"),vt(g,"No window.location.(origin|href) available to create URL for href: "+y),new URL(y,g)}let p={get action(){return s},get location(){return t(o,a)},listen(m){if(u)throw new Error("A history only accepts one active listener");return o.addEventListener(rw,d),u=m,()=>{o.removeEventListener(rw,d),u=null}},createHref(m){return e(o,m)},createURL:v,encodeLocation(m){let g=v(m);return{pathname:g.pathname,search:g.search,hash:g.hash}},push:f,replace:h,go(m){return a.go(m)}};return p}var iw;(function(t){t.data="data",t.deferred="deferred",t.redirect="redirect",t.error="error"})(iw||(iw={}));function CO(t,e,n){return n===void 0&&(n="/"),SO(t,e,n,!1)}function SO(t,e,n,r){let o=typeof e=="string"?hu(e):e,i=ey(o.pathname||"/",n);if(i==null)return null;let a=RE(t);kO(a);let s=null;for(let u=0;s==null&&u<a.length;++u){let l=LO(i);s=FO(a[u],l,r)}return s}function RE(t,e,n,r){e===void 0&&(e=[]),n===void 0&&(n=[]),r===void 0&&(r="");let o=(i,a,s)=>{let u={relativePath:s===void 0?i.path||"":s,caseSensitive:i.caseSensitive===!0,childrenIndex:a,route:i};u.relativePath.startsWith("/")&&(vt(u.relativePath.startsWith(r),'Absolute route path "'+u.relativePath+'" nested under path '+('"'+r+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),u.relativePath=u.relativePath.slice(r.length));let l=bi([r,u.relativePath]),c=n.concat(u);i.children&&i.children.length>0&&(vt(i.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+l+'".')),RE(i.children,e,c,l)),!(i.path==null&&!i.index)&&e.push({path:l,score:NO(l,i.index),routesMeta:c})};return t.forEach((i,a)=>{var s;if(i.path===""||!((s=i.path)!=null&&s.includes("?")))o(i,a);else for(let u of TE(i.path))o(i,a,u)}),e}function TE(t){let e=t.split("/");if(e.length===0)return[];let[n,...r]=e,o=n.endsWith("?"),i=n.replace(/\?$/,"");if(r.length===0)return o?[i,""]:[i];let a=TE(r.join("/")),s=[];return s.push(...a.map(u=>u===""?i:[i,u].join("/"))),o&&s.push(...a),s.map(u=>t.startsWith("/")&&u===""?"/":u)}function kO(t){t.sort((e,n)=>e.score!==n.score?n.score-e.score:OO(e.routesMeta.map(r=>r.childrenIndex),n.routesMeta.map(r=>r.childrenIndex)))}const RO=/^:[\w-]+$/,TO=3,IO=2,AO=1,PO=10,DO=-2,aw=t=>t==="*";function NO(t,e){let n=t.split("/"),r=n.length;return n.some(aw)&&(r+=DO),e&&(r+=IO),n.filter(o=>!aw(o)).reduce((o,i)=>o+(RO.test(i)?TO:i===""?AO:PO),r)}function OO(t,e){return t.length===e.length&&t.slice(0,-1).every((r,o)=>r===e[o])?t[t.length-1]-e[e.length-1]:0}function FO(t,e,n){let{routesMeta:r}=t,o={},i="/",a=[];for(let s=0;s<r.length;++s){let u=r[s],l=s===r.length-1,c=i==="/"?e:e.slice(i.length)||"/",d=sw({path:u.relativePath,caseSensitive:u.caseSensitive,end:l},c),f=u.route;if(!d&&l&&n&&!r[r.length-1].route.index&&(d=sw({path:u.relativePath,caseSensitive:u.caseSensitive,end:!1},c)),!d)return null;Object.assign(o,d.params),a.push({params:o,pathname:bi([i,d.pathname]),pathnameBase:WO(bi([i,d.pathnameBase])),route:f}),d.pathnameBase!=="/"&&(i=bi([i,d.pathnameBase]))}return a}function sw(t,e){typeof t=="string"&&(t={path:t,caseSensitive:!1,end:!0});let[n,r]=MO(t.path,t.caseSensitive,t.end),o=e.match(n);if(!o)return null;let i=o[0],a=i.replace(/(.)\/+$/,"$1"),s=o.slice(1);return{params:r.reduce((l,c,d)=>{let{paramName:f,isOptional:h}=c;if(f==="*"){let p=s[d]||"";a=i.slice(0,i.length-p.length).replace(/(.)\/+$/,"$1")}const v=s[d];return h&&!v?l[f]=void 0:l[f]=(v||"").replace(/%2F/g,"/"),l},{}),pathname:i,pathnameBase:a,pattern:t}}function MO(t,e,n){e===void 0&&(e=!1),n===void 0&&(n=!0),kE(t==="*"||!t.endsWith("*")||t.endsWith("/*"),'Route path "'+t+'" will be treated as if it were '+('"'+t.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+t.replace(/\*$/,"/*")+'".'));let r=[],o="^"+t.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(a,s,u)=>(r.push({paramName:s,isOptional:u!=null}),u?"/?([^\\/]+)?":"/([^\\/]+)"));return t.endsWith("*")?(r.push({paramName:"*"}),o+=t==="*"||t==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):n?o+="\\/*$":t!==""&&t!=="/"&&(o+="(?:(?=\\/|$))"),[new RegExp(o,e?void 0:"i"),r]}function LO(t){try{return t.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(e){return kE(!1,'The URL path "'+t+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+e+").")),t}}function ey(t,e){if(e==="/")return t;if(!t.toLowerCase().startsWith(e.toLowerCase()))return null;let n=e.endsWith("/")?e.length-1:e.length,r=t.charAt(n);return r&&r!=="/"?null:t.slice(n)||"/"}function BO(t,e){e===void 0&&(e="/");let{pathname:n,search:r="",hash:o=""}=typeof t=="string"?hu(t):t;return{pathname:n?n.startsWith("/")?n:$O(n,e):e,search:UO(r),hash:zO(o)}}function $O(t,e){let n=e.replace(/\/+$/,"").split("/");return t.split("/").forEach(o=>{o===".."?n.length>1&&n.pop():o!=="."&&n.push(o)}),n.length>1?n.join("/"):"/"}function Qh(t,e,n,r){return"Cannot include a '"+t+"' character in a manually specified "+("`to."+e+"` field ["+JSON.stringify(r)+"].  Please separate it out to the ")+("`to."+n+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function jO(t){return t.filter((e,n)=>n===0||e.route.path&&e.route.path.length>0)}function IE(t,e){let n=jO(t);return e?n.map((r,o)=>o===n.length-1?r.pathname:r.pathnameBase):n.map(r=>r.pathnameBase)}function AE(t,e,n,r){r===void 0&&(r=!1);let o;typeof t=="string"?o=hu(t):(o=El({},t),vt(!o.pathname||!o.pathname.includes("?"),Qh("?","pathname","search",o)),vt(!o.pathname||!o.pathname.includes("#"),Qh("#","pathname","hash",o)),vt(!o.search||!o.search.includes("#"),Qh("#","search","hash",o)));let i=t===""||o.pathname==="",a=i?"/":o.pathname,s;if(a==null)s=n;else{let d=e.length-1;if(!r&&a.startsWith("..")){let f=a.split("/");for(;f[0]==="..";)f.shift(),d-=1;o.pathname=f.join("/")}s=d>=0?e[d]:"/"}let u=BO(o,s),l=a&&a!=="/"&&a.endsWith("/"),c=(i||a===".")&&n.endsWith("/");return!u.pathname.endsWith("/")&&(l||c)&&(u.pathname+="/"),u}const bi=t=>t.join("/").replace(/\/\/+/g,"/"),WO=t=>t.replace(/\/+$/,"").replace(/^\/*/,"/"),UO=t=>!t||t==="?"?"":t.startsWith("?")?t:"?"+t,zO=t=>!t||t==="#"?"":t.startsWith("#")?t:"#"+t;function VO(t){return t!=null&&typeof t.status=="number"&&typeof t.statusText=="string"&&typeof t.internal=="boolean"&&"data"in t}const PE=["post","put","patch","delete"];new Set(PE);const HO=["get",...PE];new Set(HO);/**
 * React Router v6.30.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Cl(){return Cl=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},Cl.apply(this,arguments)}const ty=k.createContext(null),GO=k.createContext(null),Ia=k.createContext(null),Gf=k.createContext(null),Fi=k.createContext({outlet:null,matches:[],isDataRoute:!1}),DE=k.createContext(null);function qO(t,e){let{relative:n}=e===void 0?{}:e;Hl()||vt(!1);let{basename:r,navigator:o}=k.useContext(Ia),{hash:i,pathname:a,search:s}=OE(t,{relative:n}),u=a;return r!=="/"&&(u=a==="/"?r:bi([r,a])),o.createHref({pathname:u,search:s,hash:i})}function Hl(){return k.useContext(Gf)!=null}function qf(){return Hl()||vt(!1),k.useContext(Gf).location}function NE(t){k.useContext(Ia).static||k.useLayoutEffect(t)}function KO(){let{isDataRoute:t}=k.useContext(Fi);return t?sF():XO()}function XO(){Hl()||vt(!1);let t=k.useContext(ty),{basename:e,future:n,navigator:r}=k.useContext(Ia),{matches:o}=k.useContext(Fi),{pathname:i}=qf(),a=JSON.stringify(IE(o,n.v7_relativeSplatPath)),s=k.useRef(!1);return NE(()=>{s.current=!0}),k.useCallback(function(l,c){if(c===void 0&&(c={}),!s.current)return;if(typeof l=="number"){r.go(l);return}let d=AE(l,JSON.parse(a),i,c.relative==="path");t==null&&e!=="/"&&(d.pathname=d.pathname==="/"?e:bi([e,d.pathname])),(c.replace?r.replace:r.push)(d,c.state,c)},[e,r,a,i,t])}function OV(){let{matches:t}=k.useContext(Fi),e=t[t.length-1];return e?e.params:{}}function OE(t,e){let{relative:n}=e===void 0?{}:e,{future:r}=k.useContext(Ia),{matches:o}=k.useContext(Fi),{pathname:i}=qf(),a=JSON.stringify(IE(o,r.v7_relativeSplatPath));return k.useMemo(()=>AE(t,JSON.parse(a),i,n==="path"),[t,a,i,n])}function YO(t,e){return QO(t,e)}function QO(t,e,n,r){Hl()||vt(!1);let{navigator:o}=k.useContext(Ia),{matches:i}=k.useContext(Fi),a=i[i.length-1],s=a?a.params:{};a&&a.pathname;let u=a?a.pathnameBase:"/";a&&a.route;let l=qf(),c;if(e){var d;let m=typeof e=="string"?hu(e):e;u==="/"||(d=m.pathname)!=null&&d.startsWith(u)||vt(!1),c=m}else c=l;let f=c.pathname||"/",h=f;if(u!=="/"){let m=u.replace(/^\//,"").split("/");h="/"+f.replace(/^\//,"").split("/").slice(m.length).join("/")}let v=CO(t,{pathname:h}),p=nF(v&&v.map(m=>Object.assign({},m,{params:Object.assign({},s,m.params),pathname:bi([u,o.encodeLocation?o.encodeLocation(m.pathname).pathname:m.pathname]),pathnameBase:m.pathnameBase==="/"?u:bi([u,o.encodeLocation?o.encodeLocation(m.pathnameBase).pathname:m.pathnameBase])})),i,n,r);return e&&p?k.createElement(Gf.Provider,{value:{location:Cl({pathname:"/",search:"",hash:"",state:null,key:"default"},c),navigationType:li.Pop}},p):p}function JO(){let t=aF(),e=VO(t)?t.status+" "+t.statusText:t instanceof Error?t.message:JSON.stringify(t),n=t instanceof Error?t.stack:null,o={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"};return k.createElement(k.Fragment,null,k.createElement("h2",null,"Unexpected Application Error!"),k.createElement("h3",{style:{fontStyle:"italic"}},e),n?k.createElement("pre",{style:o},n):null,null)}const ZO=k.createElement(JO,null);class eF extends k.Component{constructor(e){super(e),this.state={location:e.location,revalidation:e.revalidation,error:e.error}}static getDerivedStateFromError(e){return{error:e}}static getDerivedStateFromProps(e,n){return n.location!==e.location||n.revalidation!=="idle"&&e.revalidation==="idle"?{error:e.error,location:e.location,revalidation:e.revalidation}:{error:e.error!==void 0?e.error:n.error,location:n.location,revalidation:e.revalidation||n.revalidation}}componentDidCatch(e,n){console.error("React Router caught the following error during render",e,n)}render(){return this.state.error!==void 0?k.createElement(Fi.Provider,{value:this.props.routeContext},k.createElement(DE.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function tF(t){let{routeContext:e,match:n,children:r}=t,o=k.useContext(ty);return o&&o.static&&o.staticContext&&(n.route.errorElement||n.route.ErrorBoundary)&&(o.staticContext._deepestRenderedBoundaryId=n.route.id),k.createElement(Fi.Provider,{value:e},r)}function nF(t,e,n,r){var o;if(e===void 0&&(e=[]),n===void 0&&(n=null),r===void 0&&(r=null),t==null){var i;if(!n)return null;if(n.errors)t=n.matches;else if((i=r)!=null&&i.v7_partialHydration&&e.length===0&&!n.initialized&&n.matches.length>0)t=n.matches;else return null}let a=t,s=(o=n)==null?void 0:o.errors;if(s!=null){let c=a.findIndex(d=>d.route.id&&(s==null?void 0:s[d.route.id])!==void 0);c>=0||vt(!1),a=a.slice(0,Math.min(a.length,c+1))}let u=!1,l=-1;if(n&&r&&r.v7_partialHydration)for(let c=0;c<a.length;c++){let d=a[c];if((d.route.HydrateFallback||d.route.hydrateFallbackElement)&&(l=c),d.route.id){let{loaderData:f,errors:h}=n,v=d.route.loader&&f[d.route.id]===void 0&&(!h||h[d.route.id]===void 0);if(d.route.lazy||v){u=!0,l>=0?a=a.slice(0,l+1):a=[a[0]];break}}}return a.reduceRight((c,d,f)=>{let h,v=!1,p=null,m=null;n&&(h=s&&d.route.id?s[d.route.id]:void 0,p=d.route.errorElement||ZO,u&&(l<0&&f===0?(v=!0,m=null):l===f&&(v=!0,m=d.route.hydrateFallbackElement||null)));let g=e.concat(a.slice(0,f+1)),y=()=>{let w;return h?w=p:v?w=m:d.route.Component?w=k.createElement(d.route.Component,null):d.route.element?w=d.route.element:w=c,k.createElement(tF,{match:d,routeContext:{outlet:c,matches:g,isDataRoute:n!=null},children:w})};return n&&(d.route.ErrorBoundary||d.route.errorElement||f===0)?k.createElement(eF,{location:n.location,revalidation:n.revalidation,component:p,error:h,children:y(),routeContext:{outlet:null,matches:g,isDataRoute:!0}}):y()},null)}var FE=function(t){return t.UseBlocker="useBlocker",t.UseRevalidator="useRevalidator",t.UseNavigateStable="useNavigate",t}(FE||{}),qd=function(t){return t.UseBlocker="useBlocker",t.UseLoaderData="useLoaderData",t.UseActionData="useActionData",t.UseRouteError="useRouteError",t.UseNavigation="useNavigation",t.UseRouteLoaderData="useRouteLoaderData",t.UseMatches="useMatches",t.UseRevalidator="useRevalidator",t.UseNavigateStable="useNavigate",t.UseRouteId="useRouteId",t}(qd||{});function rF(t){let e=k.useContext(ty);return e||vt(!1),e}function oF(t){let e=k.useContext(GO);return e||vt(!1),e}function iF(t){let e=k.useContext(Fi);return e||vt(!1),e}function ME(t){let e=iF(),n=e.matches[e.matches.length-1];return n.route.id||vt(!1),n.route.id}function aF(){var t;let e=k.useContext(DE),n=oF(qd.UseRouteError),r=ME(qd.UseRouteError);return e!==void 0?e:(t=n.errors)==null?void 0:t[r]}function sF(){let{router:t}=rF(FE.UseNavigateStable),e=ME(qd.UseNavigateStable),n=k.useRef(!1);return NE(()=>{n.current=!0}),k.useCallback(function(o,i){i===void 0&&(i={}),n.current&&(typeof o=="number"?t.navigate(o):t.navigate(o,Cl({fromRouteId:e},i)))},[t,e])}function uF(t,e){t==null||t.v7_startTransition,t==null||t.v7_relativeSplatPath}function lF(t){vt(!1)}function cF(t){let{basename:e="/",children:n=null,location:r,navigationType:o=li.Pop,navigator:i,static:a=!1,future:s}=t;Hl()&&vt(!1);let u=e.replace(/^\/*/,"/"),l=k.useMemo(()=>({basename:u,navigator:i,static:a,future:Cl({v7_relativeSplatPath:!1},s)}),[u,s,i,a]);typeof r=="string"&&(r=hu(r));let{pathname:c="/",search:d="",hash:f="",state:h=null,key:v="default"}=r,p=k.useMemo(()=>{let m=ey(c,u);return m==null?null:{location:{pathname:m,search:d,hash:f,state:h,key:v},navigationType:o}},[u,c,d,f,h,v,o]);return p==null?null:k.createElement(Ia.Provider,{value:l},k.createElement(Gf.Provider,{children:n,value:p}))}function FV(t){let{children:e,location:n}=t;return YO(rm(e),n)}new Promise(()=>{});function rm(t,e){e===void 0&&(e=[]);let n=[];return k.Children.forEach(t,(r,o)=>{if(!k.isValidElement(r))return;let i=[...e,o];if(r.type===k.Fragment){n.push.apply(n,rm(r.props.children,i));return}r.type!==lF&&vt(!1),!r.props.index||!r.props.children||vt(!1);let a={id:r.props.id||i.join("-"),caseSensitive:r.props.caseSensitive,element:r.props.element,Component:r.props.Component,index:r.props.index,path:r.props.path,loader:r.props.loader,action:r.props.action,errorElement:r.props.errorElement,ErrorBoundary:r.props.ErrorBoundary,hasErrorBoundary:r.props.ErrorBoundary!=null||r.props.errorElement!=null,shouldRevalidate:r.props.shouldRevalidate,handle:r.props.handle,lazy:r.props.lazy};r.props.children&&(a.children=rm(r.props.children,i)),n.push(a)}),n}/**
 * React Router DOM v6.30.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function om(){return om=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},om.apply(this,arguments)}function dF(t,e){if(t==null)return{};var n={},r=Object.keys(t),o,i;for(i=0;i<r.length;i++)o=r[i],!(e.indexOf(o)>=0)&&(n[o]=t[o]);return n}function fF(t){return!!(t.metaKey||t.altKey||t.ctrlKey||t.shiftKey)}function hF(t,e){return t.button===0&&(!e||e==="_self")&&!fF(t)}const pF=["onClick","relative","reloadDocument","replace","state","target","to","preventScrollReset","viewTransition"],vF="6";try{window.__reactRouterVersion=vF}catch{}const mF="startTransition",uw=Hm[mF];function MV(t){let{basename:e,children:n,future:r,window:o}=t,i=k.useRef();i.current==null&&(i.current=bO({window:o,v5Compat:!0}));let a=i.current,[s,u]=k.useState({action:a.action,location:a.location}),{v7_startTransition:l}=r||{},c=k.useCallback(d=>{l&&uw?uw(()=>u(d)):u(d)},[u,l]);return k.useLayoutEffect(()=>a.listen(c),[a,c]),k.useEffect(()=>uF(r),[r]),k.createElement(cF,{basename:e,children:n,location:s.location,navigationType:s.action,navigator:a,future:r})}const gF=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",yF=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,LV=k.forwardRef(function(e,n){let{onClick:r,relative:o,reloadDocument:i,replace:a,state:s,target:u,to:l,preventScrollReset:c,viewTransition:d}=e,f=dF(e,pF),{basename:h}=k.useContext(Ia),v,p=!1;if(typeof l=="string"&&yF.test(l)&&(v=l,gF))try{let w=new URL(window.location.href),x=l.startsWith("//")?new URL(w.protocol+l):new URL(l),b=ey(x.pathname,h);x.origin===w.origin&&b!=null?l=b+x.search+x.hash:p=!0}catch{}let m=qO(l,{relative:o}),g=wF(l,{replace:a,state:s,target:u,preventScrollReset:c,relative:o,viewTransition:d});function y(w){r&&r(w),w.defaultPrevented||g(w)}return k.createElement("a",om({},f,{href:v||m,onClick:p||i?r:y,ref:n,target:u}))});var lw;(function(t){t.UseScrollRestoration="useScrollRestoration",t.UseSubmit="useSubmit",t.UseSubmitFetcher="useSubmitFetcher",t.UseFetcher="useFetcher",t.useViewTransitionState="useViewTransitionState"})(lw||(lw={}));var cw;(function(t){t.UseFetcher="useFetcher",t.UseFetchers="useFetchers",t.UseScrollRestoration="useScrollRestoration"})(cw||(cw={}));function wF(t,e){let{target:n,replace:r,state:o,preventScrollReset:i,relative:a,viewTransition:s}=e===void 0?{}:e,u=KO(),l=qf(),c=OE(t,{relative:a});return k.useCallback(d=>{if(hF(d,n)){d.preventDefault();let f=r!==void 0?r:Gd(l)===Gd(c);u(t,{replace:f,state:o,preventScrollReset:i,relative:a,viewTransition:s})}},[l,u,c,r,o,n,t,i,a,s])}const xF="modulepreload",bF=function(t){return"/"+t},dw={},Gl=function(e,n,r){let o=Promise.resolve();if(n&&n.length>0){document.getElementsByTagName("link");const a=document.querySelector("meta[property=csp-nonce]"),s=(a==null?void 0:a.nonce)||(a==null?void 0:a.getAttribute("nonce"));o=Promise.allSettled(n.map(u=>{if(u=bF(u),u in dw)return;dw[u]=!0;const l=u.endsWith(".css"),c=l?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${u}"]${c}`))return;const d=document.createElement("link");if(d.rel=l?"stylesheet":xF,l||(d.as="script"),d.crossOrigin="",d.href=u,s&&d.setAttribute("nonce",s),document.head.appendChild(d),l)return new Promise((f,h)=>{d.addEventListener("load",f),d.addEventListener("error",()=>h(new Error(`Unable to preload CSS for ${u}`)))})}))}function i(a){const s=new Event("vite:preloadError",{cancelable:!0});if(s.payload=a,window.dispatchEvent(s),!s.defaultPrevented)throw a}return o.then(a=>{for(const s of a||[])s.status==="rejected"&&i(s.reason);return e().catch(i)})},_F=t=>{let e;return t?e=t:typeof fetch>"u"?e=(...n)=>Gl(async()=>{const{default:r}=await Promise.resolve().then(()=>pu);return{default:r}},void 0).then(({default:r})=>r(...n)):e=fetch,(...n)=>e(...n)};class ny extends Error{constructor(e,n="FunctionsError",r){super(e),this.name=n,this.context=r}}class EF extends ny{constructor(e){super("Failed to send a request to the Edge Function","FunctionsFetchError",e)}}class fw extends ny{constructor(e){super("Relay Error invoking the Edge Function","FunctionsRelayError",e)}}class hw extends ny{constructor(e){super("Edge Function returned a non-2xx status code","FunctionsHttpError",e)}}var im;(function(t){t.Any="any",t.ApNortheast1="ap-northeast-1",t.ApNortheast2="ap-northeast-2",t.ApSouth1="ap-south-1",t.ApSoutheast1="ap-southeast-1",t.ApSoutheast2="ap-southeast-2",t.CaCentral1="ca-central-1",t.EuCentral1="eu-central-1",t.EuWest1="eu-west-1",t.EuWest2="eu-west-2",t.EuWest3="eu-west-3",t.SaEast1="sa-east-1",t.UsEast1="us-east-1",t.UsWest1="us-west-1",t.UsWest2="us-west-2"})(im||(im={}));var CF=function(t,e,n,r){function o(i){return i instanceof n?i:new n(function(a){a(i)})}return new(n||(n=Promise))(function(i,a){function s(c){try{l(r.next(c))}catch(d){a(d)}}function u(c){try{l(r.throw(c))}catch(d){a(d)}}function l(c){c.done?i(c.value):o(c.value).then(s,u)}l((r=r.apply(t,e||[])).next())})};class SF{constructor(e,{headers:n={},customFetch:r,region:o=im.Any}={}){this.url=e,this.headers=n,this.region=o,this.fetch=_F(r)}setAuth(e){this.headers.Authorization=`Bearer ${e}`}invoke(e,n={}){var r;return CF(this,void 0,void 0,function*(){try{const{headers:o,method:i,body:a}=n;let s={},{region:u}=n;u||(u=this.region);const l=new URL(`${this.url}/${e}`);u&&u!=="any"&&(s["x-region"]=u,l.searchParams.set("forceFunctionRegion",u));let c;a&&(o&&!Object.prototype.hasOwnProperty.call(o,"Content-Type")||!o)&&(typeof Blob<"u"&&a instanceof Blob||a instanceof ArrayBuffer?(s["Content-Type"]="application/octet-stream",c=a):typeof a=="string"?(s["Content-Type"]="text/plain",c=a):typeof FormData<"u"&&a instanceof FormData?c=a:(s["Content-Type"]="application/json",c=JSON.stringify(a)));const d=yield this.fetch(l.toString(),{method:i||"POST",headers:Object.assign(Object.assign(Object.assign({},s),this.headers),o),body:c}).catch(p=>{throw new EF(p)}),f=d.headers.get("x-relay-error");if(f&&f==="true")throw new fw(d);if(!d.ok)throw new hw(d);let h=((r=d.headers.get("Content-Type"))!==null&&r!==void 0?r:"text/plain").split(";")[0].trim(),v;return h==="application/json"?v=yield d.json():h==="application/octet-stream"?v=yield d.blob():h==="text/event-stream"?v=d:h==="multipart/form-data"?v=yield d.formData():v=yield d.text(),{data:v,error:null,response:d}}catch(o){return{data:null,error:o,response:o instanceof hw||o instanceof fw?o.context:void 0}}})}}var pn={},ry={},Kf={},ql={},Xf={},Yf={},kF=function(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("unable to locate global object")},tu=kF();const RF=tu.fetch,LE=tu.fetch.bind(tu),BE=tu.Headers,TF=tu.Request,IF=tu.Response,pu=Object.freeze(Object.defineProperty({__proto__:null,Headers:BE,Request:TF,Response:IF,default:LE,fetch:RF},Symbol.toStringTag,{value:"Module"})),AF=OR(pu);var Qf={};Object.defineProperty(Qf,"__esModule",{value:!0});let PF=class extends Error{constructor(e){super(e.message),this.name="PostgrestError",this.details=e.details,this.hint=e.hint,this.code=e.code}};Qf.default=PF;var $E=Yn&&Yn.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(Yf,"__esModule",{value:!0});const DF=$E(AF),NF=$E(Qf);let OF=class{constructor(e){var n,r;this.shouldThrowOnError=!1,this.method=e.method,this.url=e.url,this.headers=new Headers(e.headers),this.schema=e.schema,this.body=e.body,this.shouldThrowOnError=(n=e.shouldThrowOnError)!==null&&n!==void 0?n:!1,this.signal=e.signal,this.isMaybeSingle=(r=e.isMaybeSingle)!==null&&r!==void 0?r:!1,e.fetch?this.fetch=e.fetch:typeof fetch>"u"?this.fetch=DF.default:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}setHeader(e,n){return this.headers=new Headers(this.headers),this.headers.set(e,n),this}then(e,n){this.schema===void 0||(["GET","HEAD"].includes(this.method)?this.headers.set("Accept-Profile",this.schema):this.headers.set("Content-Profile",this.schema)),this.method!=="GET"&&this.method!=="HEAD"&&this.headers.set("Content-Type","application/json");const r=this.fetch;let o=r(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(async i=>{var a,s,u,l;let c=null,d=null,f=null,h=i.status,v=i.statusText;if(i.ok){if(this.method!=="HEAD"){const y=await i.text();y===""||(this.headers.get("Accept")==="text/csv"||this.headers.get("Accept")&&(!((a=this.headers.get("Accept"))===null||a===void 0)&&a.includes("application/vnd.pgrst.plan+text"))?d=y:d=JSON.parse(y))}const m=(s=this.headers.get("Prefer"))===null||s===void 0?void 0:s.match(/count=(exact|planned|estimated)/),g=(u=i.headers.get("content-range"))===null||u===void 0?void 0:u.split("/");m&&g&&g.length>1&&(f=parseInt(g[1])),this.isMaybeSingle&&this.method==="GET"&&Array.isArray(d)&&(d.length>1?(c={code:"PGRST116",details:`Results contain ${d.length} rows, application/vnd.pgrst.object+json requires 1 row`,hint:null,message:"JSON object requested, multiple (or no) rows returned"},d=null,f=null,h=406,v="Not Acceptable"):d.length===1?d=d[0]:d=null)}else{const m=await i.text();try{c=JSON.parse(m),Array.isArray(c)&&i.status===404&&(d=[],c=null,h=200,v="OK")}catch{i.status===404&&m===""?(h=204,v="No Content"):c={message:m}}if(c&&this.isMaybeSingle&&(!((l=c==null?void 0:c.details)===null||l===void 0)&&l.includes("0 rows"))&&(c=null,h=200,v="OK"),c&&this.shouldThrowOnError)throw new NF.default(c)}return{error:c,data:d,count:f,status:h,statusText:v}});return this.shouldThrowOnError||(o=o.catch(i=>{var a,s,u;return{error:{message:`${(a=i==null?void 0:i.name)!==null&&a!==void 0?a:"FetchError"}: ${i==null?void 0:i.message}`,details:`${(s=i==null?void 0:i.stack)!==null&&s!==void 0?s:""}`,hint:"",code:`${(u=i==null?void 0:i.code)!==null&&u!==void 0?u:""}`},data:null,count:null,status:0,statusText:""}})),o.then(e,n)}returns(){return this}overrideTypes(){return this}};Yf.default=OF;var FF=Yn&&Yn.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(Xf,"__esModule",{value:!0});const MF=FF(Yf);let LF=class extends MF.default{select(e){let n=!1;const r=(e??"*").split("").map(o=>/\s/.test(o)&&!n?"":(o==='"'&&(n=!n),o)).join("");return this.url.searchParams.set("select",r),this.headers.append("Prefer","return=representation"),this}order(e,{ascending:n=!0,nullsFirst:r,foreignTable:o,referencedTable:i=o}={}){const a=i?`${i}.order`:"order",s=this.url.searchParams.get(a);return this.url.searchParams.set(a,`${s?`${s},`:""}${e}.${n?"asc":"desc"}${r===void 0?"":r?".nullsfirst":".nullslast"}`),this}limit(e,{foreignTable:n,referencedTable:r=n}={}){const o=typeof r>"u"?"limit":`${r}.limit`;return this.url.searchParams.set(o,`${e}`),this}range(e,n,{foreignTable:r,referencedTable:o=r}={}){const i=typeof o>"u"?"offset":`${o}.offset`,a=typeof o>"u"?"limit":`${o}.limit`;return this.url.searchParams.set(i,`${e}`),this.url.searchParams.set(a,`${n-e+1}`),this}abortSignal(e){return this.signal=e,this}single(){return this.headers.set("Accept","application/vnd.pgrst.object+json"),this}maybeSingle(){return this.method==="GET"?this.headers.set("Accept","application/json"):this.headers.set("Accept","application/vnd.pgrst.object+json"),this.isMaybeSingle=!0,this}csv(){return this.headers.set("Accept","text/csv"),this}geojson(){return this.headers.set("Accept","application/geo+json"),this}explain({analyze:e=!1,verbose:n=!1,settings:r=!1,buffers:o=!1,wal:i=!1,format:a="text"}={}){var s;const u=[e?"analyze":null,n?"verbose":null,r?"settings":null,o?"buffers":null,i?"wal":null].filter(Boolean).join("|"),l=(s=this.headers.get("Accept"))!==null&&s!==void 0?s:"application/json";return this.headers.set("Accept",`application/vnd.pgrst.plan+${a}; for="${l}"; options=${u};`),a==="json"?this:this}rollback(){return this.headers.append("Prefer","tx=rollback"),this}returns(){return this}maxAffected(e){return this.headers.append("Prefer","handling=strict"),this.headers.append("Prefer",`max-affected=${e}`),this}};Xf.default=LF;var BF=Yn&&Yn.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(ql,"__esModule",{value:!0});const $F=BF(Xf);let jF=class extends $F.default{eq(e,n){return this.url.searchParams.append(e,`eq.${n}`),this}neq(e,n){return this.url.searchParams.append(e,`neq.${n}`),this}gt(e,n){return this.url.searchParams.append(e,`gt.${n}`),this}gte(e,n){return this.url.searchParams.append(e,`gte.${n}`),this}lt(e,n){return this.url.searchParams.append(e,`lt.${n}`),this}lte(e,n){return this.url.searchParams.append(e,`lte.${n}`),this}like(e,n){return this.url.searchParams.append(e,`like.${n}`),this}likeAllOf(e,n){return this.url.searchParams.append(e,`like(all).{${n.join(",")}}`),this}likeAnyOf(e,n){return this.url.searchParams.append(e,`like(any).{${n.join(",")}}`),this}ilike(e,n){return this.url.searchParams.append(e,`ilike.${n}`),this}ilikeAllOf(e,n){return this.url.searchParams.append(e,`ilike(all).{${n.join(",")}}`),this}ilikeAnyOf(e,n){return this.url.searchParams.append(e,`ilike(any).{${n.join(",")}}`),this}is(e,n){return this.url.searchParams.append(e,`is.${n}`),this}in(e,n){const r=Array.from(new Set(n)).map(o=>typeof o=="string"&&new RegExp("[,()]").test(o)?`"${o}"`:`${o}`).join(",");return this.url.searchParams.append(e,`in.(${r})`),this}contains(e,n){return typeof n=="string"?this.url.searchParams.append(e,`cs.${n}`):Array.isArray(n)?this.url.searchParams.append(e,`cs.{${n.join(",")}}`):this.url.searchParams.append(e,`cs.${JSON.stringify(n)}`),this}containedBy(e,n){return typeof n=="string"?this.url.searchParams.append(e,`cd.${n}`):Array.isArray(n)?this.url.searchParams.append(e,`cd.{${n.join(",")}}`):this.url.searchParams.append(e,`cd.${JSON.stringify(n)}`),this}rangeGt(e,n){return this.url.searchParams.append(e,`sr.${n}`),this}rangeGte(e,n){return this.url.searchParams.append(e,`nxl.${n}`),this}rangeLt(e,n){return this.url.searchParams.append(e,`sl.${n}`),this}rangeLte(e,n){return this.url.searchParams.append(e,`nxr.${n}`),this}rangeAdjacent(e,n){return this.url.searchParams.append(e,`adj.${n}`),this}overlaps(e,n){return typeof n=="string"?this.url.searchParams.append(e,`ov.${n}`):this.url.searchParams.append(e,`ov.{${n.join(",")}}`),this}textSearch(e,n,{config:r,type:o}={}){let i="";o==="plain"?i="pl":o==="phrase"?i="ph":o==="websearch"&&(i="w");const a=r===void 0?"":`(${r})`;return this.url.searchParams.append(e,`${i}fts${a}.${n}`),this}match(e){return Object.entries(e).forEach(([n,r])=>{this.url.searchParams.append(n,`eq.${r}`)}),this}not(e,n,r){return this.url.searchParams.append(e,`not.${n}.${r}`),this}or(e,{foreignTable:n,referencedTable:r=n}={}){const o=r?`${r}.or`:"or";return this.url.searchParams.append(o,`(${e})`),this}filter(e,n,r){return this.url.searchParams.append(e,`${n}.${r}`),this}};ql.default=jF;var WF=Yn&&Yn.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(Kf,"__esModule",{value:!0});const Iu=WF(ql);let UF=class{constructor(e,{headers:n={},schema:r,fetch:o}){this.url=e,this.headers=new Headers(n),this.schema=r,this.fetch=o}select(e,{head:n=!1,count:r}={}){const o=n?"HEAD":"GET";let i=!1;const a=(e??"*").split("").map(s=>/\s/.test(s)&&!i?"":(s==='"'&&(i=!i),s)).join("");return this.url.searchParams.set("select",a),r&&this.headers.append("Prefer",`count=${r}`),new Iu.default({method:o,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch})}insert(e,{count:n,defaultToNull:r=!0}={}){var o;const i="POST";if(n&&this.headers.append("Prefer",`count=${n}`),r||this.headers.append("Prefer","missing=default"),Array.isArray(e)){const a=e.reduce((s,u)=>s.concat(Object.keys(u)),[]);if(a.length>0){const s=[...new Set(a)].map(u=>`"${u}"`);this.url.searchParams.set("columns",s.join(","))}}return new Iu.default({method:i,url:this.url,headers:this.headers,schema:this.schema,body:e,fetch:(o=this.fetch)!==null&&o!==void 0?o:fetch})}upsert(e,{onConflict:n,ignoreDuplicates:r=!1,count:o,defaultToNull:i=!0}={}){var a;const s="POST";if(this.headers.append("Prefer",`resolution=${r?"ignore":"merge"}-duplicates`),n!==void 0&&this.url.searchParams.set("on_conflict",n),o&&this.headers.append("Prefer",`count=${o}`),i||this.headers.append("Prefer","missing=default"),Array.isArray(e)){const u=e.reduce((l,c)=>l.concat(Object.keys(c)),[]);if(u.length>0){const l=[...new Set(u)].map(c=>`"${c}"`);this.url.searchParams.set("columns",l.join(","))}}return new Iu.default({method:s,url:this.url,headers:this.headers,schema:this.schema,body:e,fetch:(a=this.fetch)!==null&&a!==void 0?a:fetch})}update(e,{count:n}={}){var r;const o="PATCH";return n&&this.headers.append("Prefer",`count=${n}`),new Iu.default({method:o,url:this.url,headers:this.headers,schema:this.schema,body:e,fetch:(r=this.fetch)!==null&&r!==void 0?r:fetch})}delete({count:e}={}){var n;const r="DELETE";return e&&this.headers.append("Prefer",`count=${e}`),new Iu.default({method:r,url:this.url,headers:this.headers,schema:this.schema,fetch:(n=this.fetch)!==null&&n!==void 0?n:fetch})}};Kf.default=UF;var jE=Yn&&Yn.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(ry,"__esModule",{value:!0});const zF=jE(Kf),VF=jE(ql);let HF=class WE{constructor(e,{headers:n={},schema:r,fetch:o}={}){this.url=e,this.headers=new Headers(n),this.schemaName=r,this.fetch=o}from(e){const n=new URL(`${this.url}/${e}`);return new zF.default(n,{headers:new Headers(this.headers),schema:this.schemaName,fetch:this.fetch})}schema(e){return new WE(this.url,{headers:this.headers,schema:e,fetch:this.fetch})}rpc(e,n={},{head:r=!1,get:o=!1,count:i}={}){var a;let s;const u=new URL(`${this.url}/rpc/${e}`);let l;r||o?(s=r?"HEAD":"GET",Object.entries(n).filter(([d,f])=>f!==void 0).map(([d,f])=>[d,Array.isArray(f)?`{${f.join(",")}}`:`${f}`]).forEach(([d,f])=>{u.searchParams.append(d,f)})):(s="POST",l=n);const c=new Headers(this.headers);return i&&c.set("Prefer",`count=${i}`),new VF.default({method:s,url:u,headers:c,schema:this.schemaName,body:l,fetch:(a=this.fetch)!==null&&a!==void 0?a:fetch})}};ry.default=HF;var vu=Yn&&Yn.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(pn,"__esModule",{value:!0});pn.PostgrestError=pn.PostgrestBuilder=pn.PostgrestTransformBuilder=pn.PostgrestFilterBuilder=pn.PostgrestQueryBuilder=pn.PostgrestClient=void 0;const UE=vu(ry);pn.PostgrestClient=UE.default;const zE=vu(Kf);pn.PostgrestQueryBuilder=zE.default;const VE=vu(ql);pn.PostgrestFilterBuilder=VE.default;const HE=vu(Xf);pn.PostgrestTransformBuilder=HE.default;const GE=vu(Yf);pn.PostgrestBuilder=GE.default;const qE=vu(Qf);pn.PostgrestError=qE.default;var GF=pn.default={PostgrestClient:UE.default,PostgrestQueryBuilder:zE.default,PostgrestFilterBuilder:VE.default,PostgrestTransformBuilder:HE.default,PostgrestBuilder:GE.default,PostgrestError:qE.default};const{PostgrestClient:qF,PostgrestQueryBuilder:zV,PostgrestFilterBuilder:VV,PostgrestTransformBuilder:HV,PostgrestBuilder:GV,PostgrestError:qV}=GF;class KF{static detectEnvironment(){var e;if(typeof WebSocket<"u")return{type:"native",constructor:WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocket<"u")return{type:"native",constructor:globalThis.WebSocket};if(typeof global<"u"&&typeof global.WebSocket<"u")return{type:"native",constructor:global.WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocketPair<"u"&&typeof globalThis.WebSocket>"u")return{type:"cloudflare",error:"Cloudflare Workers detected. WebSocket clients are not supported in Cloudflare Workers.",workaround:"Use Cloudflare Workers WebSocket API for server-side WebSocket handling, or deploy to a different runtime."};if(typeof globalThis<"u"&&globalThis.EdgeRuntime||typeof navigator<"u"&&(!((e=navigator.userAgent)===null||e===void 0)&&e.includes("Vercel-Edge")))return{type:"unsupported",error:"Edge runtime detected (Vercel Edge/Netlify Edge). WebSockets are not supported in edge functions.",workaround:"Use serverless functions or a different deployment target for WebSocket functionality."};if(typeof process<"u"){const n=process.versions;if(n&&n.node){const r=n.node,o=parseInt(r.replace(/^v/,"").split(".")[0]);return o>=22?typeof globalThis.WebSocket<"u"?{type:"native",constructor:globalThis.WebSocket}:{type:"unsupported",error:`Node.js ${o} detected but native WebSocket not found.`,workaround:"Provide a WebSocket implementation via the transport option."}:{type:"unsupported",error:`Node.js ${o} detected without native WebSocket support.`,workaround:`For Node.js < 22, install "ws" package and provide it via the transport option:
import ws from "ws"
new RealtimeClient(url, { transport: ws })`}}}return{type:"unsupported",error:"Unknown JavaScript runtime without WebSocket support.",workaround:"Ensure you're running in a supported environment (browser, Node.js, Deno) or provide a custom WebSocket implementation."}}static getWebSocketConstructor(){const e=this.detectEnvironment();if(e.constructor)return e.constructor;let n=e.error||"WebSocket not supported in this environment.";throw e.workaround&&(n+=`

Suggested solution: ${e.workaround}`),new Error(n)}static createWebSocket(e,n){const r=this.getWebSocketConstructor();return new r(e,n)}static isWebSocketSupported(){try{const e=this.detectEnvironment();return e.type==="native"||e.type==="ws"}catch{return!1}}}const XF="2.15.5",YF=`realtime-js/${XF}`,QF="1.0.0",am=1e4,JF=1e3,ZF=100;var Yu;(function(t){t[t.connecting=0]="connecting",t[t.open=1]="open",t[t.closing=2]="closing",t[t.closed=3]="closed"})(Yu||(Yu={}));var mt;(function(t){t.closed="closed",t.errored="errored",t.joined="joined",t.joining="joining",t.leaving="leaving"})(mt||(mt={}));var fr;(function(t){t.close="phx_close",t.error="phx_error",t.join="phx_join",t.reply="phx_reply",t.leave="phx_leave",t.access_token="access_token"})(fr||(fr={}));var sm;(function(t){t.websocket="websocket"})(sm||(sm={}));var Yi;(function(t){t.Connecting="connecting",t.Open="open",t.Closing="closing",t.Closed="closed"})(Yi||(Yi={}));class eM{constructor(){this.HEADER_LENGTH=1}decode(e,n){return e.constructor===ArrayBuffer?n(this._binaryDecode(e)):n(typeof e=="string"?JSON.parse(e):{})}_binaryDecode(e){const n=new DataView(e),r=new TextDecoder;return this._decodeBroadcast(e,n,r)}_decodeBroadcast(e,n,r){const o=n.getUint8(1),i=n.getUint8(2);let a=this.HEADER_LENGTH+2;const s=r.decode(e.slice(a,a+o));a=a+o;const u=r.decode(e.slice(a,a+i));a=a+i;const l=JSON.parse(r.decode(e.slice(a,e.byteLength)));return{ref:null,topic:s,event:u,payload:l}}}class KE{constructor(e,n){this.callback=e,this.timerCalc=n,this.timer=void 0,this.tries=0,this.callback=e,this.timerCalc=n}reset(){this.tries=0,clearTimeout(this.timer),this.timer=void 0}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}}var He;(function(t){t.abstime="abstime",t.bool="bool",t.date="date",t.daterange="daterange",t.float4="float4",t.float8="float8",t.int2="int2",t.int4="int4",t.int4range="int4range",t.int8="int8",t.int8range="int8range",t.json="json",t.jsonb="jsonb",t.money="money",t.numeric="numeric",t.oid="oid",t.reltime="reltime",t.text="text",t.time="time",t.timestamp="timestamp",t.timestamptz="timestamptz",t.timetz="timetz",t.tsrange="tsrange",t.tstzrange="tstzrange"})(He||(He={}));const pw=(t,e,n={})=>{var r;const o=(r=n.skipTypes)!==null&&r!==void 0?r:[];return Object.keys(e).reduce((i,a)=>(i[a]=tM(a,t,e,o),i),{})},tM=(t,e,n,r)=>{const o=e.find(s=>s.name===t),i=o==null?void 0:o.type,a=n[t];return i&&!r.includes(i)?XE(i,a):um(a)},XE=(t,e)=>{if(t.charAt(0)==="_"){const n=t.slice(1,t.length);return iM(e,n)}switch(t){case He.bool:return nM(e);case He.float4:case He.float8:case He.int2:case He.int4:case He.int8:case He.numeric:case He.oid:return rM(e);case He.json:case He.jsonb:return oM(e);case He.timestamp:return aM(e);case He.abstime:case He.date:case He.daterange:case He.int4range:case He.int8range:case He.money:case He.reltime:case He.text:case He.time:case He.timestamptz:case He.timetz:case He.tsrange:case He.tstzrange:return um(e);default:return um(e)}},um=t=>t,nM=t=>{switch(t){case"t":return!0;case"f":return!1;default:return t}},rM=t=>{if(typeof t=="string"){const e=parseFloat(t);if(!Number.isNaN(e))return e}return t},oM=t=>{if(typeof t=="string")try{return JSON.parse(t)}catch(e){return console.log(`JSON parse error: ${e}`),t}return t},iM=(t,e)=>{if(typeof t!="string")return t;const n=t.length-1,r=t[n];if(t[0]==="{"&&r==="}"){let i;const a=t.slice(1,n);try{i=JSON.parse("["+a+"]")}catch{i=a?a.split(","):[]}return i.map(s=>XE(e,s))}return t},aM=t=>typeof t=="string"?t.replace(" ","T"):t,YE=t=>{let e=t;return e=e.replace(/^ws/i,"http"),e=e.replace(/(\/socket\/websocket|\/socket|\/websocket)\/?$/i,""),e.replace(/\/+$/,"")+"/api/broadcast"};class Jh{constructor(e,n,r={},o=am){this.channel=e,this.event=n,this.payload=r,this.timeout=o,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(e){this.timeout=e,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(e){this.payload=Object.assign(Object.assign({},this.payload),e)}receive(e,n){var r;return this._hasReceived(e)&&n((r=this.receivedResp)===null||r===void 0?void 0:r.response),this.recHooks.push({status:e,callback:n}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref);const e=n=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=n,this._matchReceive(n)};this.channel._on(this.refEvent,{},e),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout)}trigger(e,n){this.refEvent&&this.channel._trigger(this.refEvent,{status:e,response:n})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:e,response:n}){this.recHooks.filter(r=>r.status===e).forEach(r=>r.callback(n))}_hasReceived(e){return this.receivedResp&&this.receivedResp.status===e}}var vw;(function(t){t.SYNC="sync",t.JOIN="join",t.LEAVE="leave"})(vw||(vw={}));class Qu{constructor(e,n){this.channel=e,this.state={},this.pendingDiffs=[],this.joinRef=null,this.enabled=!1,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};const r=(n==null?void 0:n.events)||{state:"presence_state",diff:"presence_diff"};this.channel._on(r.state,{},o=>{const{onJoin:i,onLeave:a,onSync:s}=this.caller;this.joinRef=this.channel._joinRef(),this.state=Qu.syncState(this.state,o,i,a),this.pendingDiffs.forEach(u=>{this.state=Qu.syncDiff(this.state,u,i,a)}),this.pendingDiffs=[],s()}),this.channel._on(r.diff,{},o=>{const{onJoin:i,onLeave:a,onSync:s}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(o):(this.state=Qu.syncDiff(this.state,o,i,a),s())}),this.onJoin((o,i,a)=>{this.channel._trigger("presence",{event:"join",key:o,currentPresences:i,newPresences:a})}),this.onLeave((o,i,a)=>{this.channel._trigger("presence",{event:"leave",key:o,currentPresences:i,leftPresences:a})}),this.onSync(()=>{this.channel._trigger("presence",{event:"sync"})})}static syncState(e,n,r,o){const i=this.cloneDeep(e),a=this.transformState(n),s={},u={};return this.map(i,(l,c)=>{a[l]||(u[l]=c)}),this.map(a,(l,c)=>{const d=i[l];if(d){const f=c.map(m=>m.presence_ref),h=d.map(m=>m.presence_ref),v=c.filter(m=>h.indexOf(m.presence_ref)<0),p=d.filter(m=>f.indexOf(m.presence_ref)<0);v.length>0&&(s[l]=v),p.length>0&&(u[l]=p)}else s[l]=c}),this.syncDiff(i,{joins:s,leaves:u},r,o)}static syncDiff(e,n,r,o){const{joins:i,leaves:a}={joins:this.transformState(n.joins),leaves:this.transformState(n.leaves)};return r||(r=()=>{}),o||(o=()=>{}),this.map(i,(s,u)=>{var l;const c=(l=e[s])!==null&&l!==void 0?l:[];if(e[s]=this.cloneDeep(u),c.length>0){const d=e[s].map(h=>h.presence_ref),f=c.filter(h=>d.indexOf(h.presence_ref)<0);e[s].unshift(...f)}r(s,c,u)}),this.map(a,(s,u)=>{let l=e[s];if(!l)return;const c=u.map(d=>d.presence_ref);l=l.filter(d=>c.indexOf(d.presence_ref)<0),e[s]=l,o(s,l,u),l.length===0&&delete e[s]}),e}static map(e,n){return Object.getOwnPropertyNames(e).map(r=>n(r,e[r]))}static transformState(e){return e=this.cloneDeep(e),Object.getOwnPropertyNames(e).reduce((n,r)=>{const o=e[r];return"metas"in o?n[r]=o.metas.map(i=>(i.presence_ref=i.phx_ref,delete i.phx_ref,delete i.phx_ref_prev,i)):n[r]=o,n},{})}static cloneDeep(e){return JSON.parse(JSON.stringify(e))}onJoin(e){this.caller.onJoin=e}onLeave(e){this.caller.onLeave=e}onSync(e){this.caller.onSync=e}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}}var mw;(function(t){t.ALL="*",t.INSERT="INSERT",t.UPDATE="UPDATE",t.DELETE="DELETE"})(mw||(mw={}));var Ju;(function(t){t.BROADCAST="broadcast",t.PRESENCE="presence",t.POSTGRES_CHANGES="postgres_changes",t.SYSTEM="system"})(Ju||(Ju={}));var uo;(function(t){t.SUBSCRIBED="SUBSCRIBED",t.TIMED_OUT="TIMED_OUT",t.CLOSED="CLOSED",t.CHANNEL_ERROR="CHANNEL_ERROR"})(uo||(uo={}));class oy{constructor(e,n={config:{}},r){this.topic=e,this.params=n,this.socket=r,this.bindings={},this.state=mt.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=e.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:"",enabled:!1},private:!1},n.config),this.timeout=this.socket.timeout,this.joinPush=new Jh(this,fr.join,this.params,this.timeout),this.rejoinTimer=new KE(()=>this._rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=mt.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(o=>o.send()),this.pushBuffer=[]}),this._onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this._joinRef()}`),this.state=mt.closed,this.socket._remove(this)}),this._onError(o=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,o),this.state=mt.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{this._isJoining()&&(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=mt.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("error",o=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,o),this.state=mt.errored,this.rejoinTimer.scheduleTimeout())}),this._on(fr.reply,{},(o,i)=>{this._trigger(this._replyEventName(i),o)}),this.presence=new Qu(this),this.broadcastEndpointURL=YE(this.socket.endPoint),this.private=this.params.config.private||!1}subscribe(e,n=this.timeout){var r,o,i;if(this.socket.isConnected()||this.socket.connect(),this.state==mt.closed){const{config:{broadcast:a,presence:s,private:u}}=this.params,l=(o=(r=this.bindings.postgres_changes)===null||r===void 0?void 0:r.map(h=>h.filter))!==null&&o!==void 0?o:[],c=!!this.bindings[Ju.PRESENCE]&&this.bindings[Ju.PRESENCE].length>0||((i=this.params.config.presence)===null||i===void 0?void 0:i.enabled)===!0,d={},f={broadcast:a,presence:Object.assign(Object.assign({},s),{enabled:c}),postgres_changes:l,private:u};this.socket.accessTokenValue&&(d.access_token=this.socket.accessTokenValue),this._onError(h=>e==null?void 0:e(uo.CHANNEL_ERROR,h)),this._onClose(()=>e==null?void 0:e(uo.CLOSED)),this.updateJoinPayload(Object.assign({config:f},d)),this.joinedOnce=!0,this._rejoin(n),this.joinPush.receive("ok",async({postgres_changes:h})=>{var v;if(this.socket.setAuth(),h===void 0){e==null||e(uo.SUBSCRIBED);return}else{const p=this.bindings.postgres_changes,m=(v=p==null?void 0:p.length)!==null&&v!==void 0?v:0,g=[];for(let y=0;y<m;y++){const w=p[y],{filter:{event:x,schema:b,table:_,filter:E}}=w,C=h&&h[y];if(C&&C.event===x&&C.schema===b&&C.table===_&&C.filter===E)g.push(Object.assign(Object.assign({},w),{id:C.id}));else{this.unsubscribe(),this.state=mt.errored,e==null||e(uo.CHANNEL_ERROR,new Error("mismatch between server and client bindings for postgres changes"));return}}this.bindings.postgres_changes=g,e&&e(uo.SUBSCRIBED);return}}).receive("error",h=>{this.state=mt.errored,e==null||e(uo.CHANNEL_ERROR,new Error(JSON.stringify(Object.values(h).join(", ")||"error")))}).receive("timeout",()=>{e==null||e(uo.TIMED_OUT)})}return this}presenceState(){return this.presence.state}async track(e,n={}){return await this.send({type:"presence",event:"track",payload:e},n.timeout||this.timeout)}async untrack(e={}){return await this.send({type:"presence",event:"untrack"},e)}on(e,n,r){return this.state===mt.joined&&e===Ju.PRESENCE&&(this.socket.log("channel",`resubscribe to ${this.topic} due to change in presence callbacks on joined channel`),this.unsubscribe().then(()=>this.subscribe())),this._on(e,n,r)}async send(e,n={}){var r,o;if(!this._canPush()&&e.type==="broadcast"){const{event:i,payload:a}=e,u={method:"POST",headers:{Authorization:this.socket.accessTokenValue?`Bearer ${this.socket.accessTokenValue}`:"",apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"},body:JSON.stringify({messages:[{topic:this.subTopic,event:i,payload:a,private:this.private}]})};try{const l=await this._fetchWithTimeout(this.broadcastEndpointURL,u,(r=n.timeout)!==null&&r!==void 0?r:this.timeout);return await((o=l.body)===null||o===void 0?void 0:o.cancel()),l.ok?"ok":"error"}catch(l){return l.name==="AbortError"?"timed out":"error"}}else return new Promise(i=>{var a,s,u;const l=this._push(e.type,e,n.timeout||this.timeout);e.type==="broadcast"&&!(!((u=(s=(a=this.params)===null||a===void 0?void 0:a.config)===null||s===void 0?void 0:s.broadcast)===null||u===void 0)&&u.ack)&&i("ok"),l.receive("ok",()=>i("ok")),l.receive("error",()=>i("error")),l.receive("timeout",()=>i("timed out"))})}updateJoinPayload(e){this.joinPush.updatePayload(e)}unsubscribe(e=this.timeout){this.state=mt.leaving;const n=()=>{this.socket.log("channel",`leave ${this.topic}`),this._trigger(fr.close,"leave",this._joinRef())};this.joinPush.destroy();let r=null;return new Promise(o=>{r=new Jh(this,fr.leave,{},e),r.receive("ok",()=>{n(),o("ok")}).receive("timeout",()=>{n(),o("timed out")}).receive("error",()=>{o("error")}),r.send(),this._canPush()||r.trigger("ok",{})}).finally(()=>{r==null||r.destroy()})}teardown(){this.pushBuffer.forEach(e=>e.destroy()),this.pushBuffer=[],this.rejoinTimer.reset(),this.joinPush.destroy(),this.state=mt.closed,this.bindings={}}async _fetchWithTimeout(e,n,r){const o=new AbortController,i=setTimeout(()=>o.abort(),r),a=await this.socket.fetch(e,Object.assign(Object.assign({},n),{signal:o.signal}));return clearTimeout(i),a}_push(e,n,r=this.timeout){if(!this.joinedOnce)throw`tried to push '${e}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let o=new Jh(this,e,n,r);return this._canPush()?o.send():this._addToPushBuffer(o),o}_addToPushBuffer(e){if(e.startTimeout(),this.pushBuffer.push(e),this.pushBuffer.length>ZF){const n=this.pushBuffer.shift();n&&(n.destroy(),this.socket.log("channel",`discarded push due to buffer overflow: ${n.event}`,n.payload))}}_onMessage(e,n,r){return n}_isMember(e){return this.topic===e}_joinRef(){return this.joinPush.ref}_trigger(e,n,r){var o,i;const a=e.toLocaleLowerCase(),{close:s,error:u,leave:l,join:c}=fr;if(r&&[s,u,l,c].indexOf(a)>=0&&r!==this._joinRef())return;let f=this._onMessage(a,n,r);if(n&&!f)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(a)?(o=this.bindings.postgres_changes)===null||o===void 0||o.filter(h=>{var v,p,m;return((v=h.filter)===null||v===void 0?void 0:v.event)==="*"||((m=(p=h.filter)===null||p===void 0?void 0:p.event)===null||m===void 0?void 0:m.toLocaleLowerCase())===a}).map(h=>h.callback(f,r)):(i=this.bindings[a])===null||i===void 0||i.filter(h=>{var v,p,m,g,y,w;if(["broadcast","presence","postgres_changes"].includes(a))if("id"in h){const x=h.id,b=(v=h.filter)===null||v===void 0?void 0:v.event;return x&&((p=n.ids)===null||p===void 0?void 0:p.includes(x))&&(b==="*"||(b==null?void 0:b.toLocaleLowerCase())===((m=n.data)===null||m===void 0?void 0:m.type.toLocaleLowerCase()))}else{const x=(y=(g=h==null?void 0:h.filter)===null||g===void 0?void 0:g.event)===null||y===void 0?void 0:y.toLocaleLowerCase();return x==="*"||x===((w=n==null?void 0:n.event)===null||w===void 0?void 0:w.toLocaleLowerCase())}else return h.type.toLocaleLowerCase()===a}).map(h=>{if(typeof f=="object"&&"ids"in f){const v=f.data,{schema:p,table:m,commit_timestamp:g,type:y,errors:w}=v;f=Object.assign(Object.assign({},{schema:p,table:m,commit_timestamp:g,eventType:y,new:{},old:{},errors:w}),this._getPayloadRecords(v))}h.callback(f,r)})}_isClosed(){return this.state===mt.closed}_isJoined(){return this.state===mt.joined}_isJoining(){return this.state===mt.joining}_isLeaving(){return this.state===mt.leaving}_replyEventName(e){return`chan_reply_${e}`}_on(e,n,r){const o=e.toLocaleLowerCase(),i={type:o,filter:n,callback:r};return this.bindings[o]?this.bindings[o].push(i):this.bindings[o]=[i],this}_off(e,n){const r=e.toLocaleLowerCase();return this.bindings[r]&&(this.bindings[r]=this.bindings[r].filter(o=>{var i;return!(((i=o.type)===null||i===void 0?void 0:i.toLocaleLowerCase())===r&&oy.isEqual(o.filter,n))})),this}static isEqual(e,n){if(Object.keys(e).length!==Object.keys(n).length)return!1;for(const r in e)if(e[r]!==n[r])return!1;return!0}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(e){this._on(fr.close,{},e)}_onError(e){this._on(fr.error,{},n=>e(n))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(e=this.timeout){this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=mt.joining,this.joinPush.resend(e))}_getPayloadRecords(e){const n={new:{},old:{}};return(e.type==="INSERT"||e.type==="UPDATE")&&(n.new=pw(e.columns,e.record)),(e.type==="UPDATE"||e.type==="DELETE")&&(n.old=pw(e.columns,e.old_record)),n}}const Zh=()=>{},Pc={HEARTBEAT_INTERVAL:25e3,RECONNECT_DELAY:10,HEARTBEAT_TIMEOUT_FALLBACK:100},sM=[1e3,2e3,5e3,1e4],uM=1e4,lM=`
  addEventListener("message", (e) => {
    if (e.data.event === "start") {
      setInterval(() => postMessage({ event: "keepAlive" }), e.data.interval);
    }
  });`;class cM{constructor(e,n){var r;if(this.accessTokenValue=null,this.apiKey=null,this.channels=new Array,this.endPoint="",this.httpEndpoint="",this.headers={},this.params={},this.timeout=am,this.transport=null,this.heartbeatIntervalMs=Pc.HEARTBEAT_INTERVAL,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.heartbeatCallback=Zh,this.ref=0,this.reconnectTimer=null,this.logger=Zh,this.conn=null,this.sendBuffer=[],this.serializer=new eM,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.accessToken=null,this._connectionState="disconnected",this._wasManualDisconnect=!1,this._authPromise=null,this._resolveFetch=o=>{let i;return o?i=o:typeof fetch>"u"?i=(...a)=>Gl(async()=>{const{default:s}=await Promise.resolve().then(()=>pu);return{default:s}},void 0).then(({default:s})=>s(...a)).catch(s=>{throw new Error(`Failed to load @supabase/node-fetch: ${s.message}. This is required for HTTP requests in Node.js environments without native fetch.`)}):i=fetch,(...a)=>i(...a)},!(!((r=n==null?void 0:n.params)===null||r===void 0)&&r.apikey))throw new Error("API key is required to connect to Realtime");this.apiKey=n.params.apikey,this.endPoint=`${e}/${sm.websocket}`,this.httpEndpoint=YE(e),this._initializeOptions(n),this._setupReconnectionTimer(),this.fetch=this._resolveFetch(n==null?void 0:n.fetch)}connect(){if(!(this.isConnecting()||this.isDisconnecting()||this.conn!==null&&this.isConnected())){if(this._setConnectionState("connecting"),this._setAuthSafely("connect"),this.transport)this.conn=new this.transport(this.endpointURL());else try{this.conn=KF.createWebSocket(this.endpointURL())}catch(e){this._setConnectionState("disconnected");const n=e.message;throw n.includes("Node.js")?new Error(`${n}

To use Realtime in Node.js, you need to provide a WebSocket implementation:

Option 1: Use Node.js 22+ which has native WebSocket support
Option 2: Install and provide the "ws" package:

  npm install ws

  import ws from "ws"
  const client = new RealtimeClient(url, {
    ...options,
    transport: ws
  })`):new Error(`WebSocket not available: ${n}`)}this._setupConnectionHandlers()}}endpointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:QF}))}disconnect(e,n){if(!this.isDisconnecting())if(this._setConnectionState("disconnecting",!0),this.conn){const r=setTimeout(()=>{this._setConnectionState("disconnected")},100);this.conn.onclose=()=>{clearTimeout(r),this._setConnectionState("disconnected")},e?this.conn.close(e,n??""):this.conn.close(),this._teardownConnection()}else this._setConnectionState("disconnected")}getChannels(){return this.channels}async removeChannel(e){const n=await e.unsubscribe();return this.channels.length===0&&this.disconnect(),n}async removeAllChannels(){const e=await Promise.all(this.channels.map(n=>n.unsubscribe()));return this.channels=[],this.disconnect(),e}log(e,n,r){this.logger(e,n,r)}connectionState(){switch(this.conn&&this.conn.readyState){case Yu.connecting:return Yi.Connecting;case Yu.open:return Yi.Open;case Yu.closing:return Yi.Closing;default:return Yi.Closed}}isConnected(){return this.connectionState()===Yi.Open}isConnecting(){return this._connectionState==="connecting"}isDisconnecting(){return this._connectionState==="disconnecting"}channel(e,n={config:{}}){const r=`realtime:${e}`,o=this.getChannels().find(i=>i.topic===r);if(o)return o;{const i=new oy(`realtime:${e}`,n,this);return this.channels.push(i),i}}push(e){const{topic:n,event:r,payload:o,ref:i}=e,a=()=>{this.encode(e,s=>{var u;(u=this.conn)===null||u===void 0||u.send(s)})};this.log("push",`${n} ${r} (${i})`,o),this.isConnected()?a():this.sendBuffer.push(a)}async setAuth(e=null){this._authPromise=this._performAuth(e);try{await this._authPromise}finally{this._authPromise=null}}async sendHeartbeat(){var e;if(!this.isConnected()){try{this.heartbeatCallback("disconnected")}catch(n){this.log("error","error in heartbeat callback",n)}return}if(this.pendingHeartbeatRef){this.pendingHeartbeatRef=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection");try{this.heartbeatCallback("timeout")}catch(n){this.log("error","error in heartbeat callback",n)}this._wasManualDisconnect=!1,(e=this.conn)===null||e===void 0||e.close(JF,"heartbeat timeout"),setTimeout(()=>{var n;this.isConnected()||(n=this.reconnectTimer)===null||n===void 0||n.scheduleTimeout()},Pc.HEARTBEAT_TIMEOUT_FALLBACK);return}this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef});try{this.heartbeatCallback("sent")}catch(n){this.log("error","error in heartbeat callback",n)}this._setAuthSafely("heartbeat")}onHeartbeat(e){this.heartbeatCallback=e}flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(e=>e()),this.sendBuffer=[])}_makeRef(){let e=this.ref+1;return e===this.ref?this.ref=0:this.ref=e,this.ref.toString()}_leaveOpenTopic(e){let n=this.channels.find(r=>r.topic===e&&(r._isJoined()||r._isJoining()));n&&(this.log("transport",`leaving duplicate topic "${e}"`),n.unsubscribe())}_remove(e){this.channels=this.channels.filter(n=>n.topic!==e.topic)}_onConnMessage(e){this.decode(e.data,n=>{if(n.topic==="phoenix"&&n.event==="phx_reply")try{this.heartbeatCallback(n.payload.status==="ok"?"ok":"error")}catch(l){this.log("error","error in heartbeat callback",l)}n.ref&&n.ref===this.pendingHeartbeatRef&&(this.pendingHeartbeatRef=null);const{topic:r,event:o,payload:i,ref:a}=n,s=a?`(${a})`:"",u=i.status||"";this.log("receive",`${u} ${r} ${o} ${s}`.trim(),i),this.channels.filter(l=>l._isMember(r)).forEach(l=>l._trigger(o,i,a)),this._triggerStateCallbacks("message",n)})}_clearTimer(e){var n;e==="heartbeat"&&this.heartbeatTimer?(clearInterval(this.heartbeatTimer),this.heartbeatTimer=void 0):e==="reconnect"&&((n=this.reconnectTimer)===null||n===void 0||n.reset())}_clearAllTimers(){this._clearTimer("heartbeat"),this._clearTimer("reconnect")}_setupConnectionHandlers(){this.conn&&("binaryType"in this.conn&&(this.conn.binaryType="arraybuffer"),this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=e=>this._onConnError(e),this.conn.onmessage=e=>this._onConnMessage(e),this.conn.onclose=e=>this._onConnClose(e))}_teardownConnection(){this.conn&&(this.conn.onopen=null,this.conn.onerror=null,this.conn.onmessage=null,this.conn.onclose=null,this.conn=null),this._clearAllTimers(),this.channels.forEach(e=>e.teardown())}_onConnOpen(){this._setConnectionState("connected"),this.log("transport",`connected to ${this.endpointURL()}`),this.flushSendBuffer(),this._clearTimer("reconnect"),this.worker?this.workerRef||this._startWorkerHeartbeat():this._startHeartbeat(),this._triggerStateCallbacks("open")}_startHeartbeat(){this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this.sendHeartbeat(),this.heartbeatIntervalMs)}_startWorkerHeartbeat(){this.workerUrl?this.log("worker",`starting worker for from ${this.workerUrl}`):this.log("worker","starting default worker");const e=this._workerObjectUrl(this.workerUrl);this.workerRef=new Worker(e),this.workerRef.onerror=n=>{this.log("worker","worker error",n.message),this.workerRef.terminate()},this.workerRef.onmessage=n=>{n.data.event==="keepAlive"&&this.sendHeartbeat()},this.workerRef.postMessage({event:"start",interval:this.heartbeatIntervalMs})}_onConnClose(e){var n;this._setConnectionState("disconnected"),this.log("transport","close",e),this._triggerChanError(),this._clearTimer("heartbeat"),this._wasManualDisconnect||(n=this.reconnectTimer)===null||n===void 0||n.scheduleTimeout(),this._triggerStateCallbacks("close",e)}_onConnError(e){this._setConnectionState("disconnected"),this.log("transport",`${e}`),this._triggerChanError(),this._triggerStateCallbacks("error",e)}_triggerChanError(){this.channels.forEach(e=>e._trigger(fr.error))}_appendParams(e,n){if(Object.keys(n).length===0)return e;const r=e.match(/\?/)?"&":"?",o=new URLSearchParams(n);return`${e}${r}${o}`}_workerObjectUrl(e){let n;if(e)n=e;else{const r=new Blob([lM],{type:"application/javascript"});n=URL.createObjectURL(r)}return n}_setConnectionState(e,n=!1){this._connectionState=e,e==="connecting"?this._wasManualDisconnect=!1:e==="disconnecting"&&(this._wasManualDisconnect=n)}async _performAuth(e=null){let n;e?n=e:this.accessToken?n=await this.accessToken():n=this.accessTokenValue,this.accessTokenValue!=n&&(this.accessTokenValue=n,this.channels.forEach(r=>{const o={access_token:n,version:YF};n&&r.updateJoinPayload(o),r.joinedOnce&&r._isJoined()&&r._push(fr.access_token,{access_token:n})}))}async _waitForAuthIfNeeded(){this._authPromise&&await this._authPromise}_setAuthSafely(e="general"){this.setAuth().catch(n=>{this.log("error",`error setting auth in ${e}`,n)})}_triggerStateCallbacks(e,n){try{this.stateChangeCallbacks[e].forEach(r=>{try{r(n)}catch(o){this.log("error",`error in ${e} callback`,o)}})}catch(r){this.log("error",`error triggering ${e} callbacks`,r)}}_setupReconnectionTimer(){this.reconnectTimer=new KE(async()=>{setTimeout(async()=>{await this._waitForAuthIfNeeded(),this.isConnected()||this.connect()},Pc.RECONNECT_DELAY)},this.reconnectAfterMs)}_initializeOptions(e){var n,r,o,i,a,s,u,l,c;if(this.transport=(n=e==null?void 0:e.transport)!==null&&n!==void 0?n:null,this.timeout=(r=e==null?void 0:e.timeout)!==null&&r!==void 0?r:am,this.heartbeatIntervalMs=(o=e==null?void 0:e.heartbeatIntervalMs)!==null&&o!==void 0?o:Pc.HEARTBEAT_INTERVAL,this.worker=(i=e==null?void 0:e.worker)!==null&&i!==void 0?i:!1,this.accessToken=(a=e==null?void 0:e.accessToken)!==null&&a!==void 0?a:null,this.heartbeatCallback=(s=e==null?void 0:e.heartbeatCallback)!==null&&s!==void 0?s:Zh,e!=null&&e.params&&(this.params=e.params),e!=null&&e.logger&&(this.logger=e.logger),(e!=null&&e.logLevel||e!=null&&e.log_level)&&(this.logLevel=e.logLevel||e.log_level,this.params=Object.assign(Object.assign({},this.params),{log_level:this.logLevel})),this.reconnectAfterMs=(u=e==null?void 0:e.reconnectAfterMs)!==null&&u!==void 0?u:d=>sM[d-1]||uM,this.encode=(l=e==null?void 0:e.encode)!==null&&l!==void 0?l:(d,f)=>f(JSON.stringify(d)),this.decode=(c=e==null?void 0:e.decode)!==null&&c!==void 0?c:this.serializer.decode.bind(this.serializer),this.worker){if(typeof window<"u"&&!window.Worker)throw new Error("Web Worker is not supported");this.workerUrl=e==null?void 0:e.workerUrl}}}class iy extends Error{constructor(e){super(e),this.__isStorageError=!0,this.name="StorageError"}}function yt(t){return typeof t=="object"&&t!==null&&"__isStorageError"in t}class dM extends iy{constructor(e,n,r){super(e),this.name="StorageApiError",this.status=n,this.statusCode=r}toJSON(){return{name:this.name,message:this.message,status:this.status,statusCode:this.statusCode}}}class lm extends iy{constructor(e,n){super(e),this.name="StorageUnknownError",this.originalError=n}}var fM=function(t,e,n,r){function o(i){return i instanceof n?i:new n(function(a){a(i)})}return new(n||(n=Promise))(function(i,a){function s(c){try{l(r.next(c))}catch(d){a(d)}}function u(c){try{l(r.throw(c))}catch(d){a(d)}}function l(c){c.done?i(c.value):o(c.value).then(s,u)}l((r=r.apply(t,e||[])).next())})};const QE=t=>{let e;return t?e=t:typeof fetch>"u"?e=(...n)=>Gl(async()=>{const{default:r}=await Promise.resolve().then(()=>pu);return{default:r}},void 0).then(({default:r})=>r(...n)):e=fetch,(...n)=>e(...n)},hM=()=>fM(void 0,void 0,void 0,function*(){return typeof Response>"u"?(yield Gl(()=>Promise.resolve().then(()=>pu),void 0)).Response:Response}),cm=t=>{if(Array.isArray(t))return t.map(n=>cm(n));if(typeof t=="function"||t!==Object(t))return t;const e={};return Object.entries(t).forEach(([n,r])=>{const o=n.replace(/([-_][a-z])/gi,i=>i.toUpperCase().replace(/[-_]/g,""));e[o]=cm(r)}),e},pM=t=>{if(typeof t!="object"||t===null)return!1;const e=Object.getPrototypeOf(t);return(e===null||e===Object.prototype||Object.getPrototypeOf(e)===null)&&!(Symbol.toStringTag in t)&&!(Symbol.iterator in t)};var Aa=function(t,e,n,r){function o(i){return i instanceof n?i:new n(function(a){a(i)})}return new(n||(n=Promise))(function(i,a){function s(c){try{l(r.next(c))}catch(d){a(d)}}function u(c){try{l(r.throw(c))}catch(d){a(d)}}function l(c){c.done?i(c.value):o(c.value).then(s,u)}l((r=r.apply(t,e||[])).next())})};const ep=t=>t.msg||t.message||t.error_description||t.error||JSON.stringify(t),vM=(t,e,n)=>Aa(void 0,void 0,void 0,function*(){const r=yield hM();t instanceof r&&!(n!=null&&n.noResolveJson)?t.json().then(o=>{const i=t.status||500,a=(o==null?void 0:o.statusCode)||i+"";e(new dM(ep(o),i,a))}).catch(o=>{e(new lm(ep(o),o))}):e(new lm(ep(t),t))}),mM=(t,e,n,r)=>{const o={method:t,headers:(e==null?void 0:e.headers)||{}};return t==="GET"||!r?o:(pM(r)?(o.headers=Object.assign({"Content-Type":"application/json"},e==null?void 0:e.headers),o.body=JSON.stringify(r)):o.body=r,e!=null&&e.duplex&&(o.duplex=e.duplex),Object.assign(Object.assign({},o),n))};function Kl(t,e,n,r,o,i){return Aa(this,void 0,void 0,function*(){return new Promise((a,s)=>{t(n,mM(e,r,o,i)).then(u=>{if(!u.ok)throw u;return r!=null&&r.noResolveJson?u:u.json()}).then(u=>a(u)).catch(u=>vM(u,s,r))})})}function Kd(t,e,n,r){return Aa(this,void 0,void 0,function*(){return Kl(t,"GET",e,n,r)})}function Ar(t,e,n,r,o){return Aa(this,void 0,void 0,function*(){return Kl(t,"POST",e,r,o,n)})}function dm(t,e,n,r,o){return Aa(this,void 0,void 0,function*(){return Kl(t,"PUT",e,r,o,n)})}function gM(t,e,n,r){return Aa(this,void 0,void 0,function*(){return Kl(t,"HEAD",e,Object.assign(Object.assign({},n),{noResolveJson:!0}),r)})}function JE(t,e,n,r,o){return Aa(this,void 0,void 0,function*(){return Kl(t,"DELETE",e,r,o,n)})}var en=function(t,e,n,r){function o(i){return i instanceof n?i:new n(function(a){a(i)})}return new(n||(n=Promise))(function(i,a){function s(c){try{l(r.next(c))}catch(d){a(d)}}function u(c){try{l(r.throw(c))}catch(d){a(d)}}function l(c){c.done?i(c.value):o(c.value).then(s,u)}l((r=r.apply(t,e||[])).next())})};const yM={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},gw={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};class wM{constructor(e,n={},r,o){this.shouldThrowOnError=!1,this.url=e,this.headers=n,this.bucketId=r,this.fetch=QE(o)}throwOnError(){return this.shouldThrowOnError=!0,this}uploadOrUpdate(e,n,r,o){return en(this,void 0,void 0,function*(){try{let i;const a=Object.assign(Object.assign({},gw),o);let s=Object.assign(Object.assign({},this.headers),e==="POST"&&{"x-upsert":String(a.upsert)});const u=a.metadata;typeof Blob<"u"&&r instanceof Blob?(i=new FormData,i.append("cacheControl",a.cacheControl),u&&i.append("metadata",this.encodeMetadata(u)),i.append("",r)):typeof FormData<"u"&&r instanceof FormData?(i=r,i.append("cacheControl",a.cacheControl),u&&i.append("metadata",this.encodeMetadata(u))):(i=r,s["cache-control"]=`max-age=${a.cacheControl}`,s["content-type"]=a.contentType,u&&(s["x-metadata"]=this.toBase64(this.encodeMetadata(u)))),o!=null&&o.headers&&(s=Object.assign(Object.assign({},s),o.headers));const l=this._removeEmptyFolders(n),c=this._getFinalPath(l),d=yield(e=="PUT"?dm:Ar)(this.fetch,`${this.url}/object/${c}`,i,Object.assign({headers:s},a!=null&&a.duplex?{duplex:a.duplex}:{}));return{data:{path:l,id:d.Id,fullPath:d.Key},error:null}}catch(i){if(this.shouldThrowOnError)throw i;if(yt(i))return{data:null,error:i};throw i}})}upload(e,n,r){return en(this,void 0,void 0,function*(){return this.uploadOrUpdate("POST",e,n,r)})}uploadToSignedUrl(e,n,r,o){return en(this,void 0,void 0,function*(){const i=this._removeEmptyFolders(e),a=this._getFinalPath(i),s=new URL(this.url+`/object/upload/sign/${a}`);s.searchParams.set("token",n);try{let u;const l=Object.assign({upsert:gw.upsert},o),c=Object.assign(Object.assign({},this.headers),{"x-upsert":String(l.upsert)});typeof Blob<"u"&&r instanceof Blob?(u=new FormData,u.append("cacheControl",l.cacheControl),u.append("",r)):typeof FormData<"u"&&r instanceof FormData?(u=r,u.append("cacheControl",l.cacheControl)):(u=r,c["cache-control"]=`max-age=${l.cacheControl}`,c["content-type"]=l.contentType);const d=yield dm(this.fetch,s.toString(),u,{headers:c});return{data:{path:i,fullPath:d.Key},error:null}}catch(u){if(this.shouldThrowOnError)throw u;if(yt(u))return{data:null,error:u};throw u}})}createSignedUploadUrl(e,n){return en(this,void 0,void 0,function*(){try{let r=this._getFinalPath(e);const o=Object.assign({},this.headers);n!=null&&n.upsert&&(o["x-upsert"]="true");const i=yield Ar(this.fetch,`${this.url}/object/upload/sign/${r}`,{},{headers:o}),a=new URL(this.url+i.url),s=a.searchParams.get("token");if(!s)throw new iy("No token returned by API");return{data:{signedUrl:a.toString(),path:e,token:s},error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(yt(r))return{data:null,error:r};throw r}})}update(e,n,r){return en(this,void 0,void 0,function*(){return this.uploadOrUpdate("PUT",e,n,r)})}move(e,n,r){return en(this,void 0,void 0,function*(){try{return{data:yield Ar(this.fetch,`${this.url}/object/move`,{bucketId:this.bucketId,sourceKey:e,destinationKey:n,destinationBucket:r==null?void 0:r.destinationBucket},{headers:this.headers}),error:null}}catch(o){if(this.shouldThrowOnError)throw o;if(yt(o))return{data:null,error:o};throw o}})}copy(e,n,r){return en(this,void 0,void 0,function*(){try{return{data:{path:(yield Ar(this.fetch,`${this.url}/object/copy`,{bucketId:this.bucketId,sourceKey:e,destinationKey:n,destinationBucket:r==null?void 0:r.destinationBucket},{headers:this.headers})).Key},error:null}}catch(o){if(this.shouldThrowOnError)throw o;if(yt(o))return{data:null,error:o};throw o}})}createSignedUrl(e,n,r){return en(this,void 0,void 0,function*(){try{let o=this._getFinalPath(e),i=yield Ar(this.fetch,`${this.url}/object/sign/${o}`,Object.assign({expiresIn:n},r!=null&&r.transform?{transform:r.transform}:{}),{headers:this.headers});const a=r!=null&&r.download?`&download=${r.download===!0?"":r.download}`:"";return i={signedUrl:encodeURI(`${this.url}${i.signedURL}${a}`)},{data:i,error:null}}catch(o){if(this.shouldThrowOnError)throw o;if(yt(o))return{data:null,error:o};throw o}})}createSignedUrls(e,n,r){return en(this,void 0,void 0,function*(){try{const o=yield Ar(this.fetch,`${this.url}/object/sign/${this.bucketId}`,{expiresIn:n,paths:e},{headers:this.headers}),i=r!=null&&r.download?`&download=${r.download===!0?"":r.download}`:"";return{data:o.map(a=>Object.assign(Object.assign({},a),{signedUrl:a.signedURL?encodeURI(`${this.url}${a.signedURL}${i}`):null})),error:null}}catch(o){if(this.shouldThrowOnError)throw o;if(yt(o))return{data:null,error:o};throw o}})}download(e,n){return en(this,void 0,void 0,function*(){const o=typeof(n==null?void 0:n.transform)<"u"?"render/image/authenticated":"object",i=this.transformOptsToQueryString((n==null?void 0:n.transform)||{}),a=i?`?${i}`:"";try{const s=this._getFinalPath(e);return{data:yield(yield Kd(this.fetch,`${this.url}/${o}/${s}${a}`,{headers:this.headers,noResolveJson:!0})).blob(),error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(yt(s))return{data:null,error:s};throw s}})}info(e){return en(this,void 0,void 0,function*(){const n=this._getFinalPath(e);try{const r=yield Kd(this.fetch,`${this.url}/object/info/${n}`,{headers:this.headers});return{data:cm(r),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(yt(r))return{data:null,error:r};throw r}})}exists(e){return en(this,void 0,void 0,function*(){const n=this._getFinalPath(e);try{return yield gM(this.fetch,`${this.url}/object/${n}`,{headers:this.headers}),{data:!0,error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(yt(r)&&r instanceof lm){const o=r.originalError;if([400,404].includes(o==null?void 0:o.status))return{data:!1,error:r}}throw r}})}getPublicUrl(e,n){const r=this._getFinalPath(e),o=[],i=n!=null&&n.download?`download=${n.download===!0?"":n.download}`:"";i!==""&&o.push(i);const s=typeof(n==null?void 0:n.transform)<"u"?"render/image":"object",u=this.transformOptsToQueryString((n==null?void 0:n.transform)||{});u!==""&&o.push(u);let l=o.join("&");return l!==""&&(l=`?${l}`),{data:{publicUrl:encodeURI(`${this.url}/${s}/public/${r}${l}`)}}}remove(e){return en(this,void 0,void 0,function*(){try{return{data:yield JE(this.fetch,`${this.url}/object/${this.bucketId}`,{prefixes:e},{headers:this.headers}),error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(yt(n))return{data:null,error:n};throw n}})}list(e,n,r){return en(this,void 0,void 0,function*(){try{const o=Object.assign(Object.assign(Object.assign({},yM),n),{prefix:e||""});return{data:yield Ar(this.fetch,`${this.url}/object/list/${this.bucketId}`,o,{headers:this.headers},r),error:null}}catch(o){if(this.shouldThrowOnError)throw o;if(yt(o))return{data:null,error:o};throw o}})}listV2(e,n){return en(this,void 0,void 0,function*(){try{const r=Object.assign({},e);return{data:yield Ar(this.fetch,`${this.url}/object/list-v2/${this.bucketId}`,r,{headers:this.headers},n),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(yt(r))return{data:null,error:r};throw r}})}encodeMetadata(e){return JSON.stringify(e)}toBase64(e){return typeof Buffer<"u"?Buffer.from(e).toString("base64"):btoa(e)}_getFinalPath(e){return`${this.bucketId}/${e.replace(/^\/+/,"")}`}_removeEmptyFolders(e){return e.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(e){const n=[];return e.width&&n.push(`width=${e.width}`),e.height&&n.push(`height=${e.height}`),e.resize&&n.push(`resize=${e.resize}`),e.format&&n.push(`format=${e.format}`),e.quality&&n.push(`quality=${e.quality}`),n.join("&")}}const xM="2.12.0",bM={"X-Client-Info":`storage-js/${xM}`};var ja=function(t,e,n,r){function o(i){return i instanceof n?i:new n(function(a){a(i)})}return new(n||(n=Promise))(function(i,a){function s(c){try{l(r.next(c))}catch(d){a(d)}}function u(c){try{l(r.throw(c))}catch(d){a(d)}}function l(c){c.done?i(c.value):o(c.value).then(s,u)}l((r=r.apply(t,e||[])).next())})};class _M{constructor(e,n={},r,o){this.shouldThrowOnError=!1;const i=new URL(e);o!=null&&o.useNewHostname&&/supabase\.(co|in|red)$/.test(i.hostname)&&!i.hostname.includes("storage.supabase.")&&(i.hostname=i.hostname.replace("supabase.","storage.supabase.")),this.url=i.href,this.headers=Object.assign(Object.assign({},bM),n),this.fetch=QE(r)}throwOnError(){return this.shouldThrowOnError=!0,this}listBuckets(){return ja(this,void 0,void 0,function*(){try{return{data:yield Kd(this.fetch,`${this.url}/bucket`,{headers:this.headers}),error:null}}catch(e){if(this.shouldThrowOnError)throw e;if(yt(e))return{data:null,error:e};throw e}})}getBucket(e){return ja(this,void 0,void 0,function*(){try{return{data:yield Kd(this.fetch,`${this.url}/bucket/${e}`,{headers:this.headers}),error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(yt(n))return{data:null,error:n};throw n}})}createBucket(e,n={public:!1}){return ja(this,void 0,void 0,function*(){try{return{data:yield Ar(this.fetch,`${this.url}/bucket`,{id:e,name:e,type:n.type,public:n.public,file_size_limit:n.fileSizeLimit,allowed_mime_types:n.allowedMimeTypes},{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(yt(r))return{data:null,error:r};throw r}})}updateBucket(e,n){return ja(this,void 0,void 0,function*(){try{return{data:yield dm(this.fetch,`${this.url}/bucket/${e}`,{id:e,name:e,public:n.public,file_size_limit:n.fileSizeLimit,allowed_mime_types:n.allowedMimeTypes},{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(yt(r))return{data:null,error:r};throw r}})}emptyBucket(e){return ja(this,void 0,void 0,function*(){try{return{data:yield Ar(this.fetch,`${this.url}/bucket/${e}/empty`,{},{headers:this.headers}),error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(yt(n))return{data:null,error:n};throw n}})}deleteBucket(e){return ja(this,void 0,void 0,function*(){try{return{data:yield JE(this.fetch,`${this.url}/bucket/${e}`,{},{headers:this.headers}),error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(yt(n))return{data:null,error:n};throw n}})}}class EM extends _M{constructor(e,n={},r,o){super(e,n,r,o)}from(e){return new wM(this.url,this.headers,e,this.fetch)}}const CM="2.57.2";let $u="";typeof Deno<"u"?$u="deno":typeof document<"u"?$u="web":typeof navigator<"u"&&navigator.product==="ReactNative"?$u="react-native":$u="node";const SM={"X-Client-Info":`supabase-js-${$u}/${CM}`},kM={headers:SM},RM={schema:"public"},TM={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},IM={};var AM=function(t,e,n,r){function o(i){return i instanceof n?i:new n(function(a){a(i)})}return new(n||(n=Promise))(function(i,a){function s(c){try{l(r.next(c))}catch(d){a(d)}}function u(c){try{l(r.throw(c))}catch(d){a(d)}}function l(c){c.done?i(c.value):o(c.value).then(s,u)}l((r=r.apply(t,e||[])).next())})};const PM=t=>{let e;return t?e=t:typeof fetch>"u"?e=LE:e=fetch,(...n)=>e(...n)},DM=()=>typeof Headers>"u"?BE:Headers,NM=(t,e,n)=>{const r=PM(n),o=DM();return(i,a)=>AM(void 0,void 0,void 0,function*(){var s;const u=(s=yield e())!==null&&s!==void 0?s:t;let l=new o(a==null?void 0:a.headers);return l.has("apikey")||l.set("apikey",t),l.has("Authorization")||l.set("Authorization",`Bearer ${u}`),r(i,Object.assign(Object.assign({},a),{headers:l}))})};var OM=function(t,e,n,r){function o(i){return i instanceof n?i:new n(function(a){a(i)})}return new(n||(n=Promise))(function(i,a){function s(c){try{l(r.next(c))}catch(d){a(d)}}function u(c){try{l(r.throw(c))}catch(d){a(d)}}function l(c){c.done?i(c.value):o(c.value).then(s,u)}l((r=r.apply(t,e||[])).next())})};function FM(t){return t.endsWith("/")?t:t+"/"}function MM(t,e){var n,r;const{db:o,auth:i,realtime:a,global:s}=t,{db:u,auth:l,realtime:c,global:d}=e,f={db:Object.assign(Object.assign({},u),o),auth:Object.assign(Object.assign({},l),i),realtime:Object.assign(Object.assign({},c),a),storage:{},global:Object.assign(Object.assign(Object.assign({},d),s),{headers:Object.assign(Object.assign({},(n=d==null?void 0:d.headers)!==null&&n!==void 0?n:{}),(r=s==null?void 0:s.headers)!==null&&r!==void 0?r:{})}),accessToken:()=>OM(this,void 0,void 0,function*(){return""})};return t.accessToken?f.accessToken=t.accessToken:delete f.accessToken,f}const ZE="2.71.1",Ja=30*1e3,fm=3,tp=fm*Ja,LM="http://localhost:9999",BM="supabase.auth.token",$M={"X-Client-Info":`gotrue-js/${ZE}`},hm="X-Supabase-Api-Version",eC={"2024-01-01":{timestamp:Date.parse("2024-01-01T00:00:00.0Z"),name:"2024-01-01"}},jM=/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}$|[a-z0-9_-]{2}$)$/i,WM=10*60*1e3;class ay extends Error{constructor(e,n,r){super(e),this.__isAuthError=!0,this.name="AuthError",this.status=n,this.code=r}}function be(t){return typeof t=="object"&&t!==null&&"__isAuthError"in t}class UM extends ay{constructor(e,n,r){super(e,n,r),this.name="AuthApiError",this.status=n,this.code=r}}function zM(t){return be(t)&&t.name==="AuthApiError"}class tC extends ay{constructor(e,n){super(e),this.name="AuthUnknownError",this.originalError=n}}class Mi extends ay{constructor(e,n,r,o){super(e,r,o),this.name=n,this.status=r}}class Vo extends Mi{constructor(){super("Auth session missing!","AuthSessionMissingError",400,void 0)}}function VM(t){return be(t)&&t.name==="AuthSessionMissingError"}class Dc extends Mi{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500,void 0)}}class Nc extends Mi{constructor(e){super(e,"AuthInvalidCredentialsError",400,void 0)}}class Oc extends Mi{constructor(e,n=null){super(e,"AuthImplicitGrantRedirectError",500,void 0),this.details=null,this.details=n}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}function HM(t){return be(t)&&t.name==="AuthImplicitGrantRedirectError"}class yw extends Mi{constructor(e,n=null){super(e,"AuthPKCEGrantCodeExchangeError",500,void 0),this.details=null,this.details=n}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class pm extends Mi{constructor(e,n){super(e,"AuthRetryableFetchError",n,void 0)}}function np(t){return be(t)&&t.name==="AuthRetryableFetchError"}class ww extends Mi{constructor(e,n,r){super(e,"AuthWeakPasswordError",n,"weak_password"),this.reasons=r}}class vm extends Mi{constructor(e){super(e,"AuthInvalidJwtError",400,"invalid_jwt")}}const Xd="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_".split(""),xw=` 	
\r=`.split(""),GM=(()=>{const t=new Array(128);for(let e=0;e<t.length;e+=1)t[e]=-1;for(let e=0;e<xw.length;e+=1)t[xw[e].charCodeAt(0)]=-2;for(let e=0;e<Xd.length;e+=1)t[Xd[e].charCodeAt(0)]=e;return t})();function bw(t,e,n){if(t!==null)for(e.queue=e.queue<<8|t,e.queuedBits+=8;e.queuedBits>=6;){const r=e.queue>>e.queuedBits-6&63;n(Xd[r]),e.queuedBits-=6}else if(e.queuedBits>0)for(e.queue=e.queue<<6-e.queuedBits,e.queuedBits=6;e.queuedBits>=6;){const r=e.queue>>e.queuedBits-6&63;n(Xd[r]),e.queuedBits-=6}}function nC(t,e,n){const r=GM[t];if(r>-1)for(e.queue=e.queue<<6|r,e.queuedBits+=6;e.queuedBits>=8;)n(e.queue>>e.queuedBits-8&255),e.queuedBits-=8;else{if(r===-2)return;throw new Error(`Invalid Base64-URL character "${String.fromCharCode(t)}"`)}}function _w(t){const e=[],n=a=>{e.push(String.fromCodePoint(a))},r={utf8seq:0,codepoint:0},o={queue:0,queuedBits:0},i=a=>{XM(a,r,n)};for(let a=0;a<t.length;a+=1)nC(t.charCodeAt(a),o,i);return e.join("")}function qM(t,e){if(t<=127){e(t);return}else if(t<=2047){e(192|t>>6),e(128|t&63);return}else if(t<=65535){e(224|t>>12),e(128|t>>6&63),e(128|t&63);return}else if(t<=1114111){e(240|t>>18),e(128|t>>12&63),e(128|t>>6&63),e(128|t&63);return}throw new Error(`Unrecognized Unicode codepoint: ${t.toString(16)}`)}function KM(t,e){for(let n=0;n<t.length;n+=1){let r=t.charCodeAt(n);if(r>55295&&r<=56319){const o=(r-55296)*1024&65535;r=(t.charCodeAt(n+1)-56320&65535|o)+65536,n+=1}qM(r,e)}}function XM(t,e,n){if(e.utf8seq===0){if(t<=127){n(t);return}for(let r=1;r<6;r+=1)if(!(t>>7-r&1)){e.utf8seq=r;break}if(e.utf8seq===2)e.codepoint=t&31;else if(e.utf8seq===3)e.codepoint=t&15;else if(e.utf8seq===4)e.codepoint=t&7;else throw new Error("Invalid UTF-8 sequence");e.utf8seq-=1}else if(e.utf8seq>0){if(t<=127)throw new Error("Invalid UTF-8 sequence");e.codepoint=e.codepoint<<6|t&63,e.utf8seq-=1,e.utf8seq===0&&n(e.codepoint)}}function YM(t){const e=[],n={queue:0,queuedBits:0},r=o=>{e.push(o)};for(let o=0;o<t.length;o+=1)nC(t.charCodeAt(o),n,r);return new Uint8Array(e)}function QM(t){const e=[];return KM(t,n=>e.push(n)),new Uint8Array(e)}function JM(t){const e=[],n={queue:0,queuedBits:0},r=o=>{e.push(o)};return t.forEach(o=>bw(o,n,r)),bw(null,n,r),e.join("")}function ZM(t){return Math.round(Date.now()/1e3)+t}function e3(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(t){const e=Math.random()*16|0;return(t=="x"?e:e&3|8).toString(16)})}const sr=()=>typeof window<"u"&&typeof document<"u",Ui={tested:!1,writable:!1},rC=()=>{if(!sr())return!1;try{if(typeof globalThis.localStorage!="object")return!1}catch{return!1}if(Ui.tested)return Ui.writable;const t=`lswt-${Math.random()}${Math.random()}`;try{globalThis.localStorage.setItem(t,t),globalThis.localStorage.removeItem(t),Ui.tested=!0,Ui.writable=!0}catch{Ui.tested=!0,Ui.writable=!1}return Ui.writable};function t3(t){const e={},n=new URL(t);if(n.hash&&n.hash[0]==="#")try{new URLSearchParams(n.hash.substring(1)).forEach((o,i)=>{e[i]=o})}catch{}return n.searchParams.forEach((r,o)=>{e[o]=r}),e}const oC=t=>{let e;return t?e=t:typeof fetch>"u"?e=(...n)=>Gl(async()=>{const{default:r}=await Promise.resolve().then(()=>pu);return{default:r}},void 0).then(({default:r})=>r(...n)):e=fetch,(...n)=>e(...n)},n3=t=>typeof t=="object"&&t!==null&&"status"in t&&"ok"in t&&"json"in t&&typeof t.json=="function",Za=async(t,e,n)=>{await t.setItem(e,JSON.stringify(n))},zi=async(t,e)=>{const n=await t.getItem(e);if(!n)return null;try{return JSON.parse(n)}catch{return n}},jo=async(t,e)=>{await t.removeItem(e)};class Jf{constructor(){this.promise=new Jf.promiseConstructor((e,n)=>{this.resolve=e,this.reject=n})}}Jf.promiseConstructor=Promise;function rp(t){const e=t.split(".");if(e.length!==3)throw new vm("Invalid JWT structure");for(let r=0;r<e.length;r++)if(!jM.test(e[r]))throw new vm("JWT not in base64url format");return{header:JSON.parse(_w(e[0])),payload:JSON.parse(_w(e[1])),signature:YM(e[2]),raw:{header:e[0],payload:e[1]}}}async function r3(t){return await new Promise(e=>{setTimeout(()=>e(null),t)})}function o3(t,e){return new Promise((r,o)=>{(async()=>{for(let i=0;i<1/0;i++)try{const a=await t(i);if(!e(i,null,a)){r(a);return}}catch(a){if(!e(i,a)){o(a);return}}})()})}function i3(t){return("0"+t.toString(16)).substr(-2)}function a3(){const e=new Uint32Array(56);if(typeof crypto>"u"){const n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",r=n.length;let o="";for(let i=0;i<56;i++)o+=n.charAt(Math.floor(Math.random()*r));return o}return crypto.getRandomValues(e),Array.from(e,i3).join("")}async function s3(t){const n=new TextEncoder().encode(t),r=await crypto.subtle.digest("SHA-256",n),o=new Uint8Array(r);return Array.from(o).map(i=>String.fromCharCode(i)).join("")}async function u3(t){if(!(typeof crypto<"u"&&typeof crypto.subtle<"u"&&typeof TextEncoder<"u"))return console.warn("WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."),t;const n=await s3(t);return btoa(n).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}async function Wa(t,e,n=!1){const r=a3();let o=r;n&&(o+="/PASSWORD_RECOVERY"),await Za(t,`${e}-code-verifier`,o);const i=await u3(r);return[i,r===i?"plain":"s256"]}const l3=/^2[0-9]{3}-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-9]|3[0-1])$/i;function c3(t){const e=t.headers.get(hm);if(!e||!e.match(l3))return null;try{return new Date(`${e}T00:00:00.0Z`)}catch{return null}}function d3(t){if(!t)throw new Error("Missing exp claim");const e=Math.floor(Date.now()/1e3);if(t<=e)throw new Error("JWT has expired")}function f3(t){switch(t){case"RS256":return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}};case"ES256":return{name:"ECDSA",namedCurve:"P-256",hash:{name:"SHA-256"}};default:throw new Error("Invalid alg claim")}}const h3=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/;function Ua(t){if(!h3.test(t))throw new Error("@supabase/auth-js: Expected parameter to be UUID but is not")}function op(){const t={};return new Proxy(t,{get:(e,n)=>{if(n==="__isUserNotAvailableProxy")return!0;if(typeof n=="symbol"){const r=n.toString();if(r==="Symbol(Symbol.toPrimitive)"||r==="Symbol(Symbol.toStringTag)"||r==="Symbol(util.inspect.custom)")return}throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Accessing the "${n}" property of the session object is not supported. Please use getUser() instead.`)},set:(e,n)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Setting the "${n}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)},deleteProperty:(e,n)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Deleting the "${n}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)}})}function Ew(t){return JSON.parse(JSON.stringify(t))}var p3=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,r=Object.getOwnPropertySymbols(t);o<r.length;o++)e.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(t,r[o])&&(n[r[o]]=t[r[o]]);return n};const qi=t=>t.msg||t.message||t.error_description||t.error||JSON.stringify(t),v3=[502,503,504];async function Cw(t){var e;if(!n3(t))throw new pm(qi(t),0);if(v3.includes(t.status))throw new pm(qi(t),t.status);let n;try{n=await t.json()}catch(i){throw new tC(qi(i),i)}let r;const o=c3(t);if(o&&o.getTime()>=eC["2024-01-01"].timestamp&&typeof n=="object"&&n&&typeof n.code=="string"?r=n.code:typeof n=="object"&&n&&typeof n.error_code=="string"&&(r=n.error_code),r){if(r==="weak_password")throw new ww(qi(n),t.status,((e=n.weak_password)===null||e===void 0?void 0:e.reasons)||[]);if(r==="session_not_found")throw new Vo}else if(typeof n=="object"&&n&&typeof n.weak_password=="object"&&n.weak_password&&Array.isArray(n.weak_password.reasons)&&n.weak_password.reasons.length&&n.weak_password.reasons.reduce((i,a)=>i&&typeof a=="string",!0))throw new ww(qi(n),t.status,n.weak_password.reasons);throw new UM(qi(n),t.status||500,r)}const m3=(t,e,n,r)=>{const o={method:t,headers:(e==null?void 0:e.headers)||{}};return t==="GET"?o:(o.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},e==null?void 0:e.headers),o.body=JSON.stringify(r),Object.assign(Object.assign({},o),n))};async function Re(t,e,n,r){var o;const i=Object.assign({},r==null?void 0:r.headers);i[hm]||(i[hm]=eC["2024-01-01"].name),r!=null&&r.jwt&&(i.Authorization=`Bearer ${r.jwt}`);const a=(o=r==null?void 0:r.query)!==null&&o!==void 0?o:{};r!=null&&r.redirectTo&&(a.redirect_to=r.redirectTo);const s=Object.keys(a).length?"?"+new URLSearchParams(a).toString():"",u=await g3(t,e,n+s,{headers:i,noResolveJson:r==null?void 0:r.noResolveJson},{},r==null?void 0:r.body);return r!=null&&r.xform?r==null?void 0:r.xform(u):{data:Object.assign({},u),error:null}}async function g3(t,e,n,r,o,i){const a=m3(e,r,o,i);let s;try{s=await t(n,Object.assign({},a))}catch(u){throw console.error(u),new pm(qi(u),0)}if(s.ok||await Cw(s),r!=null&&r.noResolveJson)return s;try{return await s.json()}catch(u){await Cw(u)}}function io(t){var e;let n=null;b3(t)&&(n=Object.assign({},t),t.expires_at||(n.expires_at=ZM(t.expires_in)));const r=(e=t.user)!==null&&e!==void 0?e:t;return{data:{session:n,user:r},error:null}}function Sw(t){const e=io(t);return!e.error&&t.weak_password&&typeof t.weak_password=="object"&&Array.isArray(t.weak_password.reasons)&&t.weak_password.reasons.length&&t.weak_password.message&&typeof t.weak_password.message=="string"&&t.weak_password.reasons.reduce((n,r)=>n&&typeof r=="string",!0)&&(e.data.weak_password=t.weak_password),e}function Yo(t){var e;return{data:{user:(e=t.user)!==null&&e!==void 0?e:t},error:null}}function y3(t){return{data:t,error:null}}function w3(t){const{action_link:e,email_otp:n,hashed_token:r,redirect_to:o,verification_type:i}=t,a=p3(t,["action_link","email_otp","hashed_token","redirect_to","verification_type"]),s={action_link:e,email_otp:n,hashed_token:r,redirect_to:o,verification_type:i},u=Object.assign({},a);return{data:{properties:s,user:u},error:null}}function x3(t){return t}function b3(t){return t.access_token&&t.refresh_token&&t.expires_in}const ip=["global","local","others"];var _3=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,r=Object.getOwnPropertySymbols(t);o<r.length;o++)e.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(t,r[o])&&(n[r[o]]=t[r[o]]);return n};class E3{constructor({url:e="",headers:n={},fetch:r}){this.url=e,this.headers=n,this.fetch=oC(r),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)}}async signOut(e,n=ip[0]){if(ip.indexOf(n)<0)throw new Error(`@supabase/auth-js: Parameter scope must be one of ${ip.join(", ")}`);try{return await Re(this.fetch,"POST",`${this.url}/logout?scope=${n}`,{headers:this.headers,jwt:e,noResolveJson:!0}),{data:null,error:null}}catch(r){if(be(r))return{data:null,error:r};throw r}}async inviteUserByEmail(e,n={}){try{return await Re(this.fetch,"POST",`${this.url}/invite`,{body:{email:e,data:n.data},headers:this.headers,redirectTo:n.redirectTo,xform:Yo})}catch(r){if(be(r))return{data:{user:null},error:r};throw r}}async generateLink(e){try{const{options:n}=e,r=_3(e,["options"]),o=Object.assign(Object.assign({},r),n);return"newEmail"in r&&(o.new_email=r==null?void 0:r.newEmail,delete o.newEmail),await Re(this.fetch,"POST",`${this.url}/admin/generate_link`,{body:o,headers:this.headers,xform:w3,redirectTo:n==null?void 0:n.redirectTo})}catch(n){if(be(n))return{data:{properties:null,user:null},error:n};throw n}}async createUser(e){try{return await Re(this.fetch,"POST",`${this.url}/admin/users`,{body:e,headers:this.headers,xform:Yo})}catch(n){if(be(n))return{data:{user:null},error:n};throw n}}async listUsers(e){var n,r,o,i,a,s,u;try{const l={nextPage:null,lastPage:0,total:0},c=await Re(this.fetch,"GET",`${this.url}/admin/users`,{headers:this.headers,noResolveJson:!0,query:{page:(r=(n=e==null?void 0:e.page)===null||n===void 0?void 0:n.toString())!==null&&r!==void 0?r:"",per_page:(i=(o=e==null?void 0:e.perPage)===null||o===void 0?void 0:o.toString())!==null&&i!==void 0?i:""},xform:x3});if(c.error)throw c.error;const d=await c.json(),f=(a=c.headers.get("x-total-count"))!==null&&a!==void 0?a:0,h=(u=(s=c.headers.get("link"))===null||s===void 0?void 0:s.split(","))!==null&&u!==void 0?u:[];return h.length>0&&(h.forEach(v=>{const p=parseInt(v.split(";")[0].split("=")[1].substring(0,1)),m=JSON.parse(v.split(";")[1].split("=")[1]);l[`${m}Page`]=p}),l.total=parseInt(f)),{data:Object.assign(Object.assign({},d),l),error:null}}catch(l){if(be(l))return{data:{users:[]},error:l};throw l}}async getUserById(e){Ua(e);try{return await Re(this.fetch,"GET",`${this.url}/admin/users/${e}`,{headers:this.headers,xform:Yo})}catch(n){if(be(n))return{data:{user:null},error:n};throw n}}async updateUserById(e,n){Ua(e);try{return await Re(this.fetch,"PUT",`${this.url}/admin/users/${e}`,{body:n,headers:this.headers,xform:Yo})}catch(r){if(be(r))return{data:{user:null},error:r};throw r}}async deleteUser(e,n=!1){Ua(e);try{return await Re(this.fetch,"DELETE",`${this.url}/admin/users/${e}`,{headers:this.headers,body:{should_soft_delete:n},xform:Yo})}catch(r){if(be(r))return{data:{user:null},error:r};throw r}}async _listFactors(e){Ua(e.userId);try{const{data:n,error:r}=await Re(this.fetch,"GET",`${this.url}/admin/users/${e.userId}/factors`,{headers:this.headers,xform:o=>({data:{factors:o},error:null})});return{data:n,error:r}}catch(n){if(be(n))return{data:null,error:n};throw n}}async _deleteFactor(e){Ua(e.userId),Ua(e.id);try{return{data:await Re(this.fetch,"DELETE",`${this.url}/admin/users/${e.userId}/factors/${e.id}`,{headers:this.headers}),error:null}}catch(n){if(be(n))return{data:null,error:n};throw n}}}function kw(t={}){return{getItem:e=>t[e]||null,setItem:(e,n)=>{t[e]=n},removeItem:e=>{delete t[e]}}}function C3(){if(typeof globalThis!="object")try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch{typeof self<"u"&&(self.globalThis=self)}}const za={debug:!!(globalThis&&rC()&&globalThis.localStorage&&globalThis.localStorage.getItem("supabase.gotrue-js.locks.debug")==="true")};class iC extends Error{constructor(e){super(e),this.isAcquireTimeout=!0}}class S3 extends iC{}async function k3(t,e,n){za.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquire lock",t,e);const r=new globalThis.AbortController;return e>0&&setTimeout(()=>{r.abort(),za.debug&&console.log("@supabase/gotrue-js: navigatorLock acquire timed out",t)},e),await Promise.resolve().then(()=>globalThis.navigator.locks.request(t,e===0?{mode:"exclusive",ifAvailable:!0}:{mode:"exclusive",signal:r.signal},async o=>{if(o){za.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquired",t,o.name);try{return await n()}finally{za.debug&&console.log("@supabase/gotrue-js: navigatorLock: released",t,o.name)}}else{if(e===0)throw za.debug&&console.log("@supabase/gotrue-js: navigatorLock: not immediately available",t),new S3(`Acquiring an exclusive Navigator LockManager lock "${t}" immediately failed`);if(za.debug)try{const i=await globalThis.navigator.locks.query();console.log("@supabase/gotrue-js: Navigator LockManager state",JSON.stringify(i,null,"  "))}catch(i){console.warn("@supabase/gotrue-js: Error when querying Navigator LockManager state",i)}return console.warn("@supabase/gotrue-js: Navigator LockManager returned a null lock when using #request without ifAvailable set to true, it appears this browser is not following the LockManager spec https://developer.mozilla.org/en-US/docs/Web/API/LockManager/request"),await n()}}))}C3();const R3={url:LM,storageKey:BM,autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:$M,flowType:"implicit",debug:!1,hasCustomAuthorizationHeader:!1};async function Rw(t,e,n){return await n()}const Va={};class Sl{constructor(e){var n,r;this.userStorage=null,this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.hasCustomAuthorizationHeader=!1,this.suppressGetSessionWarning=!1,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log,this.instanceID=Sl.nextInstanceID,Sl.nextInstanceID+=1,this.instanceID>0&&sr()&&console.warn("Multiple GoTrueClient instances detected in the same browser context. It is not an error, but this should be avoided as it may produce undefined behavior when used concurrently under the same storage key.");const o=Object.assign(Object.assign({},R3),e);if(this.logDebugMessages=!!o.debug,typeof o.debug=="function"&&(this.logger=o.debug),this.persistSession=o.persistSession,this.storageKey=o.storageKey,this.autoRefreshToken=o.autoRefreshToken,this.admin=new E3({url:o.url,headers:o.headers,fetch:o.fetch}),this.url=o.url,this.headers=o.headers,this.fetch=oC(o.fetch),this.lock=o.lock||Rw,this.detectSessionInUrl=o.detectSessionInUrl,this.flowType=o.flowType,this.hasCustomAuthorizationHeader=o.hasCustomAuthorizationHeader,o.lock?this.lock=o.lock:sr()&&(!((n=globalThis==null?void 0:globalThis.navigator)===null||n===void 0)&&n.locks)?this.lock=k3:this.lock=Rw,this.jwks||(this.jwks={keys:[]},this.jwks_cached_at=Number.MIN_SAFE_INTEGER),this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this)},this.persistSession?(o.storage?this.storage=o.storage:rC()?this.storage=globalThis.localStorage:(this.memoryStorage={},this.storage=kw(this.memoryStorage)),o.userStorage&&(this.userStorage=o.userStorage)):(this.memoryStorage={},this.storage=kw(this.memoryStorage)),sr()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(i){console.error("Failed to create a new BroadcastChannel, multi-tab state changes will not be available",i)}(r=this.broadcastChannel)===null||r===void 0||r.addEventListener("message",async i=>{this._debug("received broadcast notification from other tab or client",i),await this._notifyAllSubscribers(i.data.event,i.data.session,!1)})}this.initialize()}get jwks(){var e,n;return(n=(e=Va[this.storageKey])===null||e===void 0?void 0:e.jwks)!==null&&n!==void 0?n:{keys:[]}}set jwks(e){Va[this.storageKey]=Object.assign(Object.assign({},Va[this.storageKey]),{jwks:e})}get jwks_cached_at(){var e,n;return(n=(e=Va[this.storageKey])===null||e===void 0?void 0:e.cachedAt)!==null&&n!==void 0?n:Number.MIN_SAFE_INTEGER}set jwks_cached_at(e){Va[this.storageKey]=Object.assign(Object.assign({},Va[this.storageKey]),{cachedAt:e})}_debug(...e){return this.logDebugMessages&&this.logger(`GoTrueClient@${this.instanceID} (${ZE}) ${new Date().toISOString()}`,...e),this}async initialize(){return this.initializePromise?await this.initializePromise:(this.initializePromise=(async()=>await this._acquireLock(-1,async()=>await this._initialize()))(),await this.initializePromise)}async _initialize(){var e;try{const n=t3(window.location.href);let r="none";if(this._isImplicitGrantCallback(n)?r="implicit":await this._isPKCECallback(n)&&(r="pkce"),sr()&&this.detectSessionInUrl&&r!=="none"){const{data:o,error:i}=await this._getSessionFromURL(n,r);if(i){if(this._debug("#_initialize()","error detecting session from URL",i),HM(i)){const u=(e=i.details)===null||e===void 0?void 0:e.code;if(u==="identity_already_exists"||u==="identity_not_found"||u==="single_identity_not_deletable")return{error:i}}return await this._removeSession(),{error:i}}const{session:a,redirectType:s}=o;return this._debug("#_initialize()","detected session in URL",a,"redirect type",s),await this._saveSession(a),setTimeout(async()=>{s==="recovery"?await this._notifyAllSubscribers("PASSWORD_RECOVERY",a):await this._notifyAllSubscribers("SIGNED_IN",a)},0),{error:null}}return await this._recoverAndRefresh(),{error:null}}catch(n){return be(n)?{error:n}:{error:new tC("Unexpected error during initialization",n)}}finally{await this._handleVisibilityChange(),this._debug("#_initialize()","end")}}async signInAnonymously(e){var n,r,o;try{const i=await Re(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{data:(r=(n=e==null?void 0:e.options)===null||n===void 0?void 0:n.data)!==null&&r!==void 0?r:{},gotrue_meta_security:{captcha_token:(o=e==null?void 0:e.options)===null||o===void 0?void 0:o.captchaToken}},xform:io}),{data:a,error:s}=i;if(s||!a)return{data:{user:null,session:null},error:s};const u=a.session,l=a.user;return a.session&&(await this._saveSession(a.session),await this._notifyAllSubscribers("SIGNED_IN",u)),{data:{user:l,session:u},error:null}}catch(i){if(be(i))return{data:{user:null,session:null},error:i};throw i}}async signUp(e){var n,r,o;try{let i;if("email"in e){const{email:c,password:d,options:f}=e;let h=null,v=null;this.flowType==="pkce"&&([h,v]=await Wa(this.storage,this.storageKey)),i=await Re(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,redirectTo:f==null?void 0:f.emailRedirectTo,body:{email:c,password:d,data:(n=f==null?void 0:f.data)!==null&&n!==void 0?n:{},gotrue_meta_security:{captcha_token:f==null?void 0:f.captchaToken},code_challenge:h,code_challenge_method:v},xform:io})}else if("phone"in e){const{phone:c,password:d,options:f}=e;i=await Re(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{phone:c,password:d,data:(r=f==null?void 0:f.data)!==null&&r!==void 0?r:{},channel:(o=f==null?void 0:f.channel)!==null&&o!==void 0?o:"sms",gotrue_meta_security:{captcha_token:f==null?void 0:f.captchaToken}},xform:io})}else throw new Nc("You must provide either an email or phone number and a password");const{data:a,error:s}=i;if(s||!a)return{data:{user:null,session:null},error:s};const u=a.session,l=a.user;return a.session&&(await this._saveSession(a.session),await this._notifyAllSubscribers("SIGNED_IN",u)),{data:{user:l,session:u},error:null}}catch(i){if(be(i))return{data:{user:null,session:null},error:i};throw i}}async signInWithPassword(e){try{let n;if("email"in e){const{email:i,password:a,options:s}=e;n=await Re(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{email:i,password:a,gotrue_meta_security:{captcha_token:s==null?void 0:s.captchaToken}},xform:Sw})}else if("phone"in e){const{phone:i,password:a,options:s}=e;n=await Re(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{phone:i,password:a,gotrue_meta_security:{captcha_token:s==null?void 0:s.captchaToken}},xform:Sw})}else throw new Nc("You must provide either an email or phone number and a password");const{data:r,error:o}=n;return o?{data:{user:null,session:null},error:o}:!r||!r.session||!r.user?{data:{user:null,session:null},error:new Dc}:(r.session&&(await this._saveSession(r.session),await this._notifyAllSubscribers("SIGNED_IN",r.session)),{data:Object.assign({user:r.user,session:r.session},r.weak_password?{weakPassword:r.weak_password}:null),error:o})}catch(n){if(be(n))return{data:{user:null,session:null},error:n};throw n}}async signInWithOAuth(e){var n,r,o,i;return await this._handleProviderSignIn(e.provider,{redirectTo:(n=e.options)===null||n===void 0?void 0:n.redirectTo,scopes:(r=e.options)===null||r===void 0?void 0:r.scopes,queryParams:(o=e.options)===null||o===void 0?void 0:o.queryParams,skipBrowserRedirect:(i=e.options)===null||i===void 0?void 0:i.skipBrowserRedirect})}async exchangeCodeForSession(e){return await this.initializePromise,this._acquireLock(-1,async()=>this._exchangeCodeForSession(e))}async signInWithWeb3(e){const{chain:n}=e;if(n==="solana")return await this.signInWithSolana(e);throw new Error(`@supabase/auth-js: Unsupported chain "${n}"`)}async signInWithSolana(e){var n,r,o,i,a,s,u,l,c,d,f,h;let v,p;if("message"in e)v=e.message,p=e.signature;else{const{chain:m,wallet:g,statement:y,options:w}=e;let x;if(sr())if(typeof g=="object")x=g;else{const _=window;if("solana"in _&&typeof _.solana=="object"&&("signIn"in _.solana&&typeof _.solana.signIn=="function"||"signMessage"in _.solana&&typeof _.solana.signMessage=="function"))x=_.solana;else throw new Error("@supabase/auth-js: No compatible Solana wallet interface on the window object (window.solana) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'solana', wallet: resolvedUserWallet }) instead.")}else{if(typeof g!="object"||!(w!=null&&w.url))throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");x=g}const b=new URL((n=w==null?void 0:w.url)!==null&&n!==void 0?n:window.location.href);if("signIn"in x&&x.signIn){const _=await x.signIn(Object.assign(Object.assign(Object.assign({issuedAt:new Date().toISOString()},w==null?void 0:w.signInWithSolana),{version:"1",domain:b.host,uri:b.href}),y?{statement:y}:null));let E;if(Array.isArray(_)&&_[0]&&typeof _[0]=="object")E=_[0];else if(_&&typeof _=="object"&&"signedMessage"in _&&"signature"in _)E=_;else throw new Error("@supabase/auth-js: Wallet method signIn() returned unrecognized value");if("signedMessage"in E&&"signature"in E&&(typeof E.signedMessage=="string"||E.signedMessage instanceof Uint8Array)&&E.signature instanceof Uint8Array)v=typeof E.signedMessage=="string"?E.signedMessage:new TextDecoder().decode(E.signedMessage),p=E.signature;else throw new Error("@supabase/auth-js: Wallet method signIn() API returned object without signedMessage and signature fields")}else{if(!("signMessage"in x)||typeof x.signMessage!="function"||!("publicKey"in x)||typeof x!="object"||!x.publicKey||!("toBase58"in x.publicKey)||typeof x.publicKey.toBase58!="function")throw new Error("@supabase/auth-js: Wallet does not have a compatible signMessage() and publicKey.toBase58() API");v=[`${b.host} wants you to sign in with your Solana account:`,x.publicKey.toBase58(),...y?["",y,""]:[""],"Version: 1",`URI: ${b.href}`,`Issued At: ${(o=(r=w==null?void 0:w.signInWithSolana)===null||r===void 0?void 0:r.issuedAt)!==null&&o!==void 0?o:new Date().toISOString()}`,...!((i=w==null?void 0:w.signInWithSolana)===null||i===void 0)&&i.notBefore?[`Not Before: ${w.signInWithSolana.notBefore}`]:[],...!((a=w==null?void 0:w.signInWithSolana)===null||a===void 0)&&a.expirationTime?[`Expiration Time: ${w.signInWithSolana.expirationTime}`]:[],...!((s=w==null?void 0:w.signInWithSolana)===null||s===void 0)&&s.chainId?[`Chain ID: ${w.signInWithSolana.chainId}`]:[],...!((u=w==null?void 0:w.signInWithSolana)===null||u===void 0)&&u.nonce?[`Nonce: ${w.signInWithSolana.nonce}`]:[],...!((l=w==null?void 0:w.signInWithSolana)===null||l===void 0)&&l.requestId?[`Request ID: ${w.signInWithSolana.requestId}`]:[],...!((d=(c=w==null?void 0:w.signInWithSolana)===null||c===void 0?void 0:c.resources)===null||d===void 0)&&d.length?["Resources",...w.signInWithSolana.resources.map(E=>`- ${E}`)]:[]].join(`
`);const _=await x.signMessage(new TextEncoder().encode(v),"utf8");if(!_||!(_ instanceof Uint8Array))throw new Error("@supabase/auth-js: Wallet signMessage() API returned an recognized value");p=_}}try{const{data:m,error:g}=await Re(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"solana",message:v,signature:JM(p)},!((f=e.options)===null||f===void 0)&&f.captchaToken?{gotrue_meta_security:{captcha_token:(h=e.options)===null||h===void 0?void 0:h.captchaToken}}:null),xform:io});if(g)throw g;return!m||!m.session||!m.user?{data:{user:null,session:null},error:new Dc}:(m.session&&(await this._saveSession(m.session),await this._notifyAllSubscribers("SIGNED_IN",m.session)),{data:Object.assign({},m),error:g})}catch(m){if(be(m))return{data:{user:null,session:null},error:m};throw m}}async _exchangeCodeForSession(e){const n=await zi(this.storage,`${this.storageKey}-code-verifier`),[r,o]=(n??"").split("/");try{const{data:i,error:a}=await Re(this.fetch,"POST",`${this.url}/token?grant_type=pkce`,{headers:this.headers,body:{auth_code:e,code_verifier:r},xform:io});if(await jo(this.storage,`${this.storageKey}-code-verifier`),a)throw a;return!i||!i.session||!i.user?{data:{user:null,session:null,redirectType:null},error:new Dc}:(i.session&&(await this._saveSession(i.session),await this._notifyAllSubscribers("SIGNED_IN",i.session)),{data:Object.assign(Object.assign({},i),{redirectType:o??null}),error:a})}catch(i){if(be(i))return{data:{user:null,session:null,redirectType:null},error:i};throw i}}async signInWithIdToken(e){try{const{options:n,provider:r,token:o,access_token:i,nonce:a}=e,s=await Re(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,body:{provider:r,id_token:o,access_token:i,nonce:a,gotrue_meta_security:{captcha_token:n==null?void 0:n.captchaToken}},xform:io}),{data:u,error:l}=s;return l?{data:{user:null,session:null},error:l}:!u||!u.session||!u.user?{data:{user:null,session:null},error:new Dc}:(u.session&&(await this._saveSession(u.session),await this._notifyAllSubscribers("SIGNED_IN",u.session)),{data:u,error:l})}catch(n){if(be(n))return{data:{user:null,session:null},error:n};throw n}}async signInWithOtp(e){var n,r,o,i,a;try{if("email"in e){const{email:s,options:u}=e;let l=null,c=null;this.flowType==="pkce"&&([l,c]=await Wa(this.storage,this.storageKey));const{error:d}=await Re(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{email:s,data:(n=u==null?void 0:u.data)!==null&&n!==void 0?n:{},create_user:(r=u==null?void 0:u.shouldCreateUser)!==null&&r!==void 0?r:!0,gotrue_meta_security:{captcha_token:u==null?void 0:u.captchaToken},code_challenge:l,code_challenge_method:c},redirectTo:u==null?void 0:u.emailRedirectTo});return{data:{user:null,session:null},error:d}}if("phone"in e){const{phone:s,options:u}=e,{data:l,error:c}=await Re(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{phone:s,data:(o=u==null?void 0:u.data)!==null&&o!==void 0?o:{},create_user:(i=u==null?void 0:u.shouldCreateUser)!==null&&i!==void 0?i:!0,gotrue_meta_security:{captcha_token:u==null?void 0:u.captchaToken},channel:(a=u==null?void 0:u.channel)!==null&&a!==void 0?a:"sms"}});return{data:{user:null,session:null,messageId:l==null?void 0:l.message_id},error:c}}throw new Nc("You must provide either an email or phone number.")}catch(s){if(be(s))return{data:{user:null,session:null},error:s};throw s}}async verifyOtp(e){var n,r;try{let o,i;"options"in e&&(o=(n=e.options)===null||n===void 0?void 0:n.redirectTo,i=(r=e.options)===null||r===void 0?void 0:r.captchaToken);const{data:a,error:s}=await Re(this.fetch,"POST",`${this.url}/verify`,{headers:this.headers,body:Object.assign(Object.assign({},e),{gotrue_meta_security:{captcha_token:i}}),redirectTo:o,xform:io});if(s)throw s;if(!a)throw new Error("An error occurred on token verification.");const u=a.session,l=a.user;return u!=null&&u.access_token&&(await this._saveSession(u),await this._notifyAllSubscribers(e.type=="recovery"?"PASSWORD_RECOVERY":"SIGNED_IN",u)),{data:{user:l,session:u},error:null}}catch(o){if(be(o))return{data:{user:null,session:null},error:o};throw o}}async signInWithSSO(e){var n,r,o;try{let i=null,a=null;return this.flowType==="pkce"&&([i,a]=await Wa(this.storage,this.storageKey)),await Re(this.fetch,"POST",`${this.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in e?{provider_id:e.providerId}:null),"domain"in e?{domain:e.domain}:null),{redirect_to:(r=(n=e.options)===null||n===void 0?void 0:n.redirectTo)!==null&&r!==void 0?r:void 0}),!((o=e==null?void 0:e.options)===null||o===void 0)&&o.captchaToken?{gotrue_meta_security:{captcha_token:e.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:i,code_challenge_method:a}),headers:this.headers,xform:y3})}catch(i){if(be(i))return{data:null,error:i};throw i}}async reauthenticate(){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._reauthenticate())}async _reauthenticate(){try{return await this._useSession(async e=>{const{data:{session:n},error:r}=e;if(r)throw r;if(!n)throw new Vo;const{error:o}=await Re(this.fetch,"GET",`${this.url}/reauthenticate`,{headers:this.headers,jwt:n.access_token});return{data:{user:null,session:null},error:o}})}catch(e){if(be(e))return{data:{user:null,session:null},error:e};throw e}}async resend(e){try{const n=`${this.url}/resend`;if("email"in e){const{email:r,type:o,options:i}=e,{error:a}=await Re(this.fetch,"POST",n,{headers:this.headers,body:{email:r,type:o,gotrue_meta_security:{captcha_token:i==null?void 0:i.captchaToken}},redirectTo:i==null?void 0:i.emailRedirectTo});return{data:{user:null,session:null},error:a}}else if("phone"in e){const{phone:r,type:o,options:i}=e,{data:a,error:s}=await Re(this.fetch,"POST",n,{headers:this.headers,body:{phone:r,type:o,gotrue_meta_security:{captcha_token:i==null?void 0:i.captchaToken}}});return{data:{user:null,session:null,messageId:a==null?void 0:a.message_id},error:s}}throw new Nc("You must provide either an email or phone number and a type")}catch(n){if(be(n))return{data:{user:null,session:null},error:n};throw n}}async getSession(){return await this.initializePromise,await this._acquireLock(-1,async()=>this._useSession(async n=>n))}async _acquireLock(e,n){this._debug("#_acquireLock","begin",e);try{if(this.lockAcquired){const r=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),o=(async()=>(await r,await n()))();return this.pendingInLock.push((async()=>{try{await o}catch{}})()),o}return await this.lock(`lock:${this.storageKey}`,e,async()=>{this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;const r=n();for(this.pendingInLock.push((async()=>{try{await r}catch{}})()),await r;this.pendingInLock.length;){const o=[...this.pendingInLock];await Promise.all(o),this.pendingInLock.splice(0,o.length)}return await r}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}})}finally{this._debug("#_acquireLock","end")}}async _useSession(e){this._debug("#_useSession","begin");try{const n=await this.__loadSession();return await e(n)}finally{this._debug("#_useSession","end")}}async __loadSession(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",new Error().stack);try{let e=null;const n=await zi(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",n),n!==null&&(this._isValidSession(n)?e=n:(this._debug("#getSession()","session from storage is not valid"),await this._removeSession())),!e)return{data:{session:null},error:null};const r=e.expires_at?e.expires_at*1e3-Date.now()<tp:!1;if(this._debug("#__loadSession()",`session has${r?"":" not"} expired`,"expires_at",e.expires_at),!r){if(this.userStorage){const a=await zi(this.userStorage,this.storageKey+"-user");a!=null&&a.user?e.user=a.user:e.user=op()}if(this.storage.isServer&&e.user){let a=this.suppressGetSessionWarning;e=new Proxy(e,{get:(u,l,c)=>(!a&&l==="user"&&(console.warn("Using the user object as returned from supabase.auth.getSession() or from some supabase.auth.onAuthStateChange() events could be insecure! This value comes directly from the storage medium (usually cookies on the server) and may not be authentic. Use supabase.auth.getUser() instead which authenticates the data by contacting the Supabase Auth server."),a=!0,this.suppressGetSessionWarning=!0),Reflect.get(u,l,c))})}return{data:{session:e},error:null}}const{session:o,error:i}=await this._callRefreshToken(e.refresh_token);return i?{data:{session:null},error:i}:{data:{session:o},error:null}}finally{this._debug("#__loadSession()","end")}}async getUser(e){return e?await this._getUser(e):(await this.initializePromise,await this._acquireLock(-1,async()=>await this._getUser()))}async _getUser(e){try{return e?await Re(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:e,xform:Yo}):await this._useSession(async n=>{var r,o,i;const{data:a,error:s}=n;if(s)throw s;return!(!((r=a.session)===null||r===void 0)&&r.access_token)&&!this.hasCustomAuthorizationHeader?{data:{user:null},error:new Vo}:await Re(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:(i=(o=a.session)===null||o===void 0?void 0:o.access_token)!==null&&i!==void 0?i:void 0,xform:Yo})})}catch(n){if(be(n))return VM(n)&&(await this._removeSession(),await jo(this.storage,`${this.storageKey}-code-verifier`)),{data:{user:null},error:n};throw n}}async updateUser(e,n={}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._updateUser(e,n))}async _updateUser(e,n={}){try{return await this._useSession(async r=>{const{data:o,error:i}=r;if(i)throw i;if(!o.session)throw new Vo;const a=o.session;let s=null,u=null;this.flowType==="pkce"&&e.email!=null&&([s,u]=await Wa(this.storage,this.storageKey));const{data:l,error:c}=await Re(this.fetch,"PUT",`${this.url}/user`,{headers:this.headers,redirectTo:n==null?void 0:n.emailRedirectTo,body:Object.assign(Object.assign({},e),{code_challenge:s,code_challenge_method:u}),jwt:a.access_token,xform:Yo});if(c)throw c;return a.user=l.user,await this._saveSession(a),await this._notifyAllSubscribers("USER_UPDATED",a),{data:{user:a.user},error:null}})}catch(r){if(be(r))return{data:{user:null},error:r};throw r}}async setSession(e){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._setSession(e))}async _setSession(e){try{if(!e.access_token||!e.refresh_token)throw new Vo;const n=Date.now()/1e3;let r=n,o=!0,i=null;const{payload:a}=rp(e.access_token);if(a.exp&&(r=a.exp,o=r<=n),o){const{session:s,error:u}=await this._callRefreshToken(e.refresh_token);if(u)return{data:{user:null,session:null},error:u};if(!s)return{data:{user:null,session:null},error:null};i=s}else{const{data:s,error:u}=await this._getUser(e.access_token);if(u)throw u;i={access_token:e.access_token,refresh_token:e.refresh_token,user:s.user,token_type:"bearer",expires_in:r-n,expires_at:r},await this._saveSession(i),await this._notifyAllSubscribers("SIGNED_IN",i)}return{data:{user:i.user,session:i},error:null}}catch(n){if(be(n))return{data:{session:null,user:null},error:n};throw n}}async refreshSession(e){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._refreshSession(e))}async _refreshSession(e){try{return await this._useSession(async n=>{var r;if(!e){const{data:a,error:s}=n;if(s)throw s;e=(r=a.session)!==null&&r!==void 0?r:void 0}if(!(e!=null&&e.refresh_token))throw new Vo;const{session:o,error:i}=await this._callRefreshToken(e.refresh_token);return i?{data:{user:null,session:null},error:i}:o?{data:{user:o.user,session:o},error:null}:{data:{user:null,session:null},error:null}})}catch(n){if(be(n))return{data:{user:null,session:null},error:n};throw n}}async _getSessionFromURL(e,n){try{if(!sr())throw new Oc("No browser detected.");if(e.error||e.error_description||e.error_code)throw new Oc(e.error_description||"Error in URL with unspecified error_description",{error:e.error||"unspecified_error",code:e.error_code||"unspecified_code"});switch(n){case"implicit":if(this.flowType==="pkce")throw new yw("Not a valid PKCE flow url.");break;case"pkce":if(this.flowType==="implicit")throw new Oc("Not a valid implicit grant flow url.");break;default:}if(n==="pkce"){if(this._debug("#_initialize()","begin","is PKCE flow",!0),!e.code)throw new yw("No code detected.");const{data:y,error:w}=await this._exchangeCodeForSession(e.code);if(w)throw w;const x=new URL(window.location.href);return x.searchParams.delete("code"),window.history.replaceState(window.history.state,"",x.toString()),{data:{session:y.session,redirectType:null},error:null}}const{provider_token:r,provider_refresh_token:o,access_token:i,refresh_token:a,expires_in:s,expires_at:u,token_type:l}=e;if(!i||!s||!a||!l)throw new Oc("No session defined in URL");const c=Math.round(Date.now()/1e3),d=parseInt(s);let f=c+d;u&&(f=parseInt(u));const h=f-c;h*1e3<=Ja&&console.warn(`@supabase/gotrue-js: Session as retrieved from URL expires in ${h}s, should have been closer to ${d}s`);const v=f-d;c-v>=120?console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued over 120s ago, URL could be stale",v,f,c):c-v<0&&console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued in the future? Check the device clock for skew",v,f,c);const{data:p,error:m}=await this._getUser(i);if(m)throw m;const g={provider_token:r,provider_refresh_token:o,access_token:i,expires_in:d,expires_at:f,refresh_token:a,token_type:l,user:p.user};return window.location.hash="",this._debug("#_getSessionFromURL()","clearing window.location.hash"),{data:{session:g,redirectType:e.type},error:null}}catch(r){if(be(r))return{data:{session:null,redirectType:null},error:r};throw r}}_isImplicitGrantCallback(e){return!!(e.access_token||e.error_description)}async _isPKCECallback(e){const n=await zi(this.storage,`${this.storageKey}-code-verifier`);return!!(e.code&&n)}async signOut(e={scope:"global"}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._signOut(e))}async _signOut({scope:e}={scope:"global"}){return await this._useSession(async n=>{var r;const{data:o,error:i}=n;if(i)return{error:i};const a=(r=o.session)===null||r===void 0?void 0:r.access_token;if(a){const{error:s}=await this.admin.signOut(a,e);if(s&&!(zM(s)&&(s.status===404||s.status===401||s.status===403)))return{error:s}}return e!=="others"&&(await this._removeSession(),await jo(this.storage,`${this.storageKey}-code-verifier`)),{error:null}})}onAuthStateChange(e){const n=e3(),r={id:n,callback:e,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",n),this.stateChangeEmitters.delete(n)}};return this._debug("#onAuthStateChange()","registered callback with id",n),this.stateChangeEmitters.set(n,r),(async()=>(await this.initializePromise,await this._acquireLock(-1,async()=>{this._emitInitialSession(n)})))(),{data:{subscription:r}}}async _emitInitialSession(e){return await this._useSession(async n=>{var r,o;try{const{data:{session:i},error:a}=n;if(a)throw a;await((r=this.stateChangeEmitters.get(e))===null||r===void 0?void 0:r.callback("INITIAL_SESSION",i)),this._debug("INITIAL_SESSION","callback id",e,"session",i)}catch(i){await((o=this.stateChangeEmitters.get(e))===null||o===void 0?void 0:o.callback("INITIAL_SESSION",null)),this._debug("INITIAL_SESSION","callback id",e,"error",i),console.error(i)}})}async resetPasswordForEmail(e,n={}){let r=null,o=null;this.flowType==="pkce"&&([r,o]=await Wa(this.storage,this.storageKey,!0));try{return await Re(this.fetch,"POST",`${this.url}/recover`,{body:{email:e,code_challenge:r,code_challenge_method:o,gotrue_meta_security:{captcha_token:n.captchaToken}},headers:this.headers,redirectTo:n.redirectTo})}catch(i){if(be(i))return{data:null,error:i};throw i}}async getUserIdentities(){var e;try{const{data:n,error:r}=await this.getUser();if(r)throw r;return{data:{identities:(e=n.user.identities)!==null&&e!==void 0?e:[]},error:null}}catch(n){if(be(n))return{data:null,error:n};throw n}}async linkIdentity(e){var n;try{const{data:r,error:o}=await this._useSession(async i=>{var a,s,u,l,c;const{data:d,error:f}=i;if(f)throw f;const h=await this._getUrlForProvider(`${this.url}/user/identities/authorize`,e.provider,{redirectTo:(a=e.options)===null||a===void 0?void 0:a.redirectTo,scopes:(s=e.options)===null||s===void 0?void 0:s.scopes,queryParams:(u=e.options)===null||u===void 0?void 0:u.queryParams,skipBrowserRedirect:!0});return await Re(this.fetch,"GET",h,{headers:this.headers,jwt:(c=(l=d.session)===null||l===void 0?void 0:l.access_token)!==null&&c!==void 0?c:void 0})});if(o)throw o;return sr()&&!(!((n=e.options)===null||n===void 0)&&n.skipBrowserRedirect)&&window.location.assign(r==null?void 0:r.url),{data:{provider:e.provider,url:r==null?void 0:r.url},error:null}}catch(r){if(be(r))return{data:{provider:e.provider,url:null},error:r};throw r}}async unlinkIdentity(e){try{return await this._useSession(async n=>{var r,o;const{data:i,error:a}=n;if(a)throw a;return await Re(this.fetch,"DELETE",`${this.url}/user/identities/${e.identity_id}`,{headers:this.headers,jwt:(o=(r=i.session)===null||r===void 0?void 0:r.access_token)!==null&&o!==void 0?o:void 0})})}catch(n){if(be(n))return{data:null,error:n};throw n}}async _refreshAccessToken(e){const n=`#_refreshAccessToken(${e.substring(0,5)}...)`;this._debug(n,"begin");try{const r=Date.now();return await o3(async o=>(o>0&&await r3(200*Math.pow(2,o-1)),this._debug(n,"refreshing attempt",o),await Re(this.fetch,"POST",`${this.url}/token?grant_type=refresh_token`,{body:{refresh_token:e},headers:this.headers,xform:io})),(o,i)=>{const a=200*Math.pow(2,o);return i&&np(i)&&Date.now()+a-r<Ja})}catch(r){if(this._debug(n,"error",r),be(r))return{data:{session:null,user:null},error:r};throw r}finally{this._debug(n,"end")}}_isValidSession(e){return typeof e=="object"&&e!==null&&"access_token"in e&&"refresh_token"in e&&"expires_at"in e}async _handleProviderSignIn(e,n){const r=await this._getUrlForProvider(`${this.url}/authorize`,e,{redirectTo:n.redirectTo,scopes:n.scopes,queryParams:n.queryParams});return this._debug("#_handleProviderSignIn()","provider",e,"options",n,"url",r),sr()&&!n.skipBrowserRedirect&&window.location.assign(r),{data:{provider:e,url:r},error:null}}async _recoverAndRefresh(){var e,n;const r="#_recoverAndRefresh()";this._debug(r,"begin");try{const o=await zi(this.storage,this.storageKey);if(o&&this.userStorage){let a=await zi(this.userStorage,this.storageKey+"-user");!this.storage.isServer&&Object.is(this.storage,this.userStorage)&&!a&&(a={user:o.user},await Za(this.userStorage,this.storageKey+"-user",a)),o.user=(e=a==null?void 0:a.user)!==null&&e!==void 0?e:op()}else if(o&&!o.user&&!o.user){const a=await zi(this.storage,this.storageKey+"-user");a&&(a!=null&&a.user)?(o.user=a.user,await jo(this.storage,this.storageKey+"-user"),await Za(this.storage,this.storageKey,o)):o.user=op()}if(this._debug(r,"session from storage",o),!this._isValidSession(o)){this._debug(r,"session is not valid"),o!==null&&await this._removeSession();return}const i=((n=o.expires_at)!==null&&n!==void 0?n:1/0)*1e3-Date.now()<tp;if(this._debug(r,`session has${i?"":" not"} expired with margin of ${tp}s`),i){if(this.autoRefreshToken&&o.refresh_token){const{error:a}=await this._callRefreshToken(o.refresh_token);a&&(console.error(a),np(a)||(this._debug(r,"refresh failed with a non-retryable error, removing the session",a),await this._removeSession()))}}else if(o.user&&o.user.__isUserNotAvailableProxy===!0)try{const{data:a,error:s}=await this._getUser(o.access_token);!s&&(a!=null&&a.user)?(o.user=a.user,await this._saveSession(o),await this._notifyAllSubscribers("SIGNED_IN",o)):this._debug(r,"could not get user data, skipping SIGNED_IN notification")}catch(a){console.error("Error getting user data:",a),this._debug(r,"error getting user data, skipping SIGNED_IN notification",a)}else await this._notifyAllSubscribers("SIGNED_IN",o)}catch(o){this._debug(r,"error",o),console.error(o);return}finally{this._debug(r,"end")}}async _callRefreshToken(e){var n,r;if(!e)throw new Vo;if(this.refreshingDeferred)return this.refreshingDeferred.promise;const o=`#_callRefreshToken(${e.substring(0,5)}...)`;this._debug(o,"begin");try{this.refreshingDeferred=new Jf;const{data:i,error:a}=await this._refreshAccessToken(e);if(a)throw a;if(!i.session)throw new Vo;await this._saveSession(i.session),await this._notifyAllSubscribers("TOKEN_REFRESHED",i.session);const s={session:i.session,error:null};return this.refreshingDeferred.resolve(s),s}catch(i){if(this._debug(o,"error",i),be(i)){const a={session:null,error:i};return np(i)||await this._removeSession(),(n=this.refreshingDeferred)===null||n===void 0||n.resolve(a),a}throw(r=this.refreshingDeferred)===null||r===void 0||r.reject(i),i}finally{this.refreshingDeferred=null,this._debug(o,"end")}}async _notifyAllSubscribers(e,n,r=!0){const o=`#_notifyAllSubscribers(${e})`;this._debug(o,"begin",n,`broadcast = ${r}`);try{this.broadcastChannel&&r&&this.broadcastChannel.postMessage({event:e,session:n});const i=[],a=Array.from(this.stateChangeEmitters.values()).map(async s=>{try{await s.callback(e,n)}catch(u){i.push(u)}});if(await Promise.all(a),i.length>0){for(let s=0;s<i.length;s+=1)console.error(i[s]);throw i[0]}}finally{this._debug(o,"end")}}async _saveSession(e){this._debug("#_saveSession()",e),this.suppressGetSessionWarning=!0;const n=Object.assign({},e),r=n.user&&n.user.__isUserNotAvailableProxy===!0;if(this.userStorage){!r&&n.user&&await Za(this.userStorage,this.storageKey+"-user",{user:n.user});const o=Object.assign({},n);delete o.user;const i=Ew(o);await Za(this.storage,this.storageKey,i)}else{const o=Ew(n);await Za(this.storage,this.storageKey,o)}}async _removeSession(){this._debug("#_removeSession()"),await jo(this.storage,this.storageKey),await jo(this.storage,this.storageKey+"-code-verifier"),await jo(this.storage,this.storageKey+"-user"),this.userStorage&&await jo(this.userStorage,this.storageKey+"-user"),await this._notifyAllSubscribers("SIGNED_OUT",null)}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");const e=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{e&&sr()&&(window!=null&&window.removeEventListener)&&window.removeEventListener("visibilitychange",e)}catch(n){console.error("removing visibilitychange callback failed",n)}}async _startAutoRefresh(){await this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");const e=setInterval(()=>this._autoRefreshTokenTick(),Ja);this.autoRefreshTicker=e,e&&typeof e=="object"&&typeof e.unref=="function"?e.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(e),setTimeout(async()=>{await this.initializePromise,await this._autoRefreshTokenTick()},0)}async _stopAutoRefresh(){this._debug("#_stopAutoRefresh()");const e=this.autoRefreshTicker;this.autoRefreshTicker=null,e&&clearInterval(e)}async startAutoRefresh(){this._removeVisibilityChangedCallback(),await this._startAutoRefresh()}async stopAutoRefresh(){this._removeVisibilityChangedCallback(),await this._stopAutoRefresh()}async _autoRefreshTokenTick(){this._debug("#_autoRefreshTokenTick()","begin");try{await this._acquireLock(0,async()=>{try{const e=Date.now();try{return await this._useSession(async n=>{const{data:{session:r}}=n;if(!r||!r.refresh_token||!r.expires_at){this._debug("#_autoRefreshTokenTick()","no session");return}const o=Math.floor((r.expires_at*1e3-e)/Ja);this._debug("#_autoRefreshTokenTick()",`access token expires in ${o} ticks, a tick lasts ${Ja}ms, refresh threshold is ${fm} ticks`),o<=fm&&await this._callRefreshToken(r.refresh_token)})}catch(n){console.error("Auto refresh tick failed with error. This is likely a transient error.",n)}}finally{this._debug("#_autoRefreshTokenTick()","end")}})}catch(e){if(e.isAcquireTimeout||e instanceof iC)this._debug("auto refresh token tick lock not available");else throw e}}async _handleVisibilityChange(){if(this._debug("#_handleVisibilityChange()"),!sr()||!(window!=null&&window.addEventListener))return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=async()=>await this._onVisibilityChanged(!1),window==null||window.addEventListener("visibilitychange",this.visibilityChangedCallback),await this._onVisibilityChanged(!0)}catch(e){console.error("_handleVisibilityChange",e)}}async _onVisibilityChanged(e){const n=`#_onVisibilityChanged(${e})`;this._debug(n,"visibilityState",document.visibilityState),document.visibilityState==="visible"?(this.autoRefreshToken&&this._startAutoRefresh(),e||(await this.initializePromise,await this._acquireLock(-1,async()=>{if(document.visibilityState!=="visible"){this._debug(n,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting");return}await this._recoverAndRefresh()}))):document.visibilityState==="hidden"&&this.autoRefreshToken&&this._stopAutoRefresh()}async _getUrlForProvider(e,n,r){const o=[`provider=${encodeURIComponent(n)}`];if(r!=null&&r.redirectTo&&o.push(`redirect_to=${encodeURIComponent(r.redirectTo)}`),r!=null&&r.scopes&&o.push(`scopes=${encodeURIComponent(r.scopes)}`),this.flowType==="pkce"){const[i,a]=await Wa(this.storage,this.storageKey),s=new URLSearchParams({code_challenge:`${encodeURIComponent(i)}`,code_challenge_method:`${encodeURIComponent(a)}`});o.push(s.toString())}if(r!=null&&r.queryParams){const i=new URLSearchParams(r.queryParams);o.push(i.toString())}return r!=null&&r.skipBrowserRedirect&&o.push(`skip_http_redirect=${r.skipBrowserRedirect}`),`${e}?${o.join("&")}`}async _unenroll(e){try{return await this._useSession(async n=>{var r;const{data:o,error:i}=n;return i?{data:null,error:i}:await Re(this.fetch,"DELETE",`${this.url}/factors/${e.factorId}`,{headers:this.headers,jwt:(r=o==null?void 0:o.session)===null||r===void 0?void 0:r.access_token})})}catch(n){if(be(n))return{data:null,error:n};throw n}}async _enroll(e){try{return await this._useSession(async n=>{var r,o;const{data:i,error:a}=n;if(a)return{data:null,error:a};const s=Object.assign({friendly_name:e.friendlyName,factor_type:e.factorType},e.factorType==="phone"?{phone:e.phone}:{issuer:e.issuer}),{data:u,error:l}=await Re(this.fetch,"POST",`${this.url}/factors`,{body:s,headers:this.headers,jwt:(r=i==null?void 0:i.session)===null||r===void 0?void 0:r.access_token});return l?{data:null,error:l}:(e.factorType==="totp"&&(!((o=u==null?void 0:u.totp)===null||o===void 0)&&o.qr_code)&&(u.totp.qr_code=`data:image/svg+xml;utf-8,${u.totp.qr_code}`),{data:u,error:null})})}catch(n){if(be(n))return{data:null,error:n};throw n}}async _verify(e){return this._acquireLock(-1,async()=>{try{return await this._useSession(async n=>{var r;const{data:o,error:i}=n;if(i)return{data:null,error:i};const{data:a,error:s}=await Re(this.fetch,"POST",`${this.url}/factors/${e.factorId}/verify`,{body:{code:e.code,challenge_id:e.challengeId},headers:this.headers,jwt:(r=o==null?void 0:o.session)===null||r===void 0?void 0:r.access_token});return s?{data:null,error:s}:(await this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+a.expires_in},a)),await this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",a),{data:a,error:s})})}catch(n){if(be(n))return{data:null,error:n};throw n}})}async _challenge(e){return this._acquireLock(-1,async()=>{try{return await this._useSession(async n=>{var r;const{data:o,error:i}=n;return i?{data:null,error:i}:await Re(this.fetch,"POST",`${this.url}/factors/${e.factorId}/challenge`,{body:{channel:e.channel},headers:this.headers,jwt:(r=o==null?void 0:o.session)===null||r===void 0?void 0:r.access_token})})}catch(n){if(be(n))return{data:null,error:n};throw n}})}async _challengeAndVerify(e){const{data:n,error:r}=await this._challenge({factorId:e.factorId});return r?{data:null,error:r}:await this._verify({factorId:e.factorId,challengeId:n.id,code:e.code})}async _listFactors(){const{data:{user:e},error:n}=await this.getUser();if(n)return{data:null,error:n};const r=(e==null?void 0:e.factors)||[],o=r.filter(a=>a.factor_type==="totp"&&a.status==="verified"),i=r.filter(a=>a.factor_type==="phone"&&a.status==="verified");return{data:{all:r,totp:o,phone:i},error:null}}async _getAuthenticatorAssuranceLevel(){return this._acquireLock(-1,async()=>await this._useSession(async e=>{var n,r;const{data:{session:o},error:i}=e;if(i)return{data:null,error:i};if(!o)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};const{payload:a}=rp(o.access_token);let s=null;a.aal&&(s=a.aal);let u=s;((r=(n=o.user.factors)===null||n===void 0?void 0:n.filter(d=>d.status==="verified"))!==null&&r!==void 0?r:[]).length>0&&(u="aal2");const c=a.amr||[];return{data:{currentLevel:s,nextLevel:u,currentAuthenticationMethods:c},error:null}}))}async fetchJwk(e,n={keys:[]}){let r=n.keys.find(s=>s.kid===e);if(r)return r;const o=Date.now();if(r=this.jwks.keys.find(s=>s.kid===e),r&&this.jwks_cached_at+WM>o)return r;const{data:i,error:a}=await Re(this.fetch,"GET",`${this.url}/.well-known/jwks.json`,{headers:this.headers});if(a)throw a;return!i.keys||i.keys.length===0||(this.jwks=i,this.jwks_cached_at=o,r=i.keys.find(s=>s.kid===e),!r)?null:r}async getClaims(e,n={}){try{let r=e;if(!r){const{data:h,error:v}=await this.getSession();if(v||!h.session)return{data:null,error:v};r=h.session.access_token}const{header:o,payload:i,signature:a,raw:{header:s,payload:u}}=rp(r);n!=null&&n.allowExpired||d3(i.exp);const l=!o.alg||o.alg.startsWith("HS")||!o.kid||!("crypto"in globalThis&&"subtle"in globalThis.crypto)?null:await this.fetchJwk(o.kid,n!=null&&n.keys?{keys:n.keys}:n==null?void 0:n.jwks);if(!l){const{error:h}=await this.getUser(r);if(h)throw h;return{data:{claims:i,header:o,signature:a},error:null}}const c=f3(o.alg),d=await crypto.subtle.importKey("jwk",l,c,!0,["verify"]);if(!await crypto.subtle.verify(c,d,a,QM(`${s}.${u}`)))throw new vm("Invalid JWT signature");return{data:{claims:i,header:o,signature:a},error:null}}catch(r){if(be(r))return{data:null,error:r};throw r}}}Sl.nextInstanceID=0;const T3=Sl;class I3 extends T3{constructor(e){super(e)}}var A3=function(t,e,n,r){function o(i){return i instanceof n?i:new n(function(a){a(i)})}return new(n||(n=Promise))(function(i,a){function s(c){try{l(r.next(c))}catch(d){a(d)}}function u(c){try{l(r.throw(c))}catch(d){a(d)}}function l(c){c.done?i(c.value):o(c.value).then(s,u)}l((r=r.apply(t,e||[])).next())})};class P3{constructor(e,n,r){var o,i,a;if(this.supabaseUrl=e,this.supabaseKey=n,!e)throw new Error("supabaseUrl is required.");if(!n)throw new Error("supabaseKey is required.");const s=FM(e),u=new URL(s);this.realtimeUrl=new URL("realtime/v1",u),this.realtimeUrl.protocol=this.realtimeUrl.protocol.replace("http","ws"),this.authUrl=new URL("auth/v1",u),this.storageUrl=new URL("storage/v1",u),this.functionsUrl=new URL("functions/v1",u);const l=`sb-${u.hostname.split(".")[0]}-auth-token`,c={db:RM,realtime:IM,auth:Object.assign(Object.assign({},TM),{storageKey:l}),global:kM},d=MM(r??{},c);this.storageKey=(o=d.auth.storageKey)!==null&&o!==void 0?o:"",this.headers=(i=d.global.headers)!==null&&i!==void 0?i:{},d.accessToken?(this.accessToken=d.accessToken,this.auth=new Proxy({},{get:(f,h)=>{throw new Error(`@supabase/supabase-js: Supabase Client is configured with the accessToken option, accessing supabase.auth.${String(h)} is not possible`)}})):this.auth=this._initSupabaseAuthClient((a=d.auth)!==null&&a!==void 0?a:{},this.headers,d.global.fetch),this.fetch=NM(n,this._getAccessToken.bind(this),d.global.fetch),this.realtime=this._initRealtimeClient(Object.assign({headers:this.headers,accessToken:this._getAccessToken.bind(this)},d.realtime)),this.rest=new qF(new URL("rest/v1",u).href,{headers:this.headers,schema:d.db.schema,fetch:this.fetch}),this.storage=new EM(this.storageUrl.href,this.headers,this.fetch,r==null?void 0:r.storage),d.accessToken||this._listenForAuthEvents()}get functions(){return new SF(this.functionsUrl.href,{headers:this.headers,customFetch:this.fetch})}from(e){return this.rest.from(e)}schema(e){return this.rest.schema(e)}rpc(e,n={},r={}){return this.rest.rpc(e,n,r)}channel(e,n={config:{}}){return this.realtime.channel(e,n)}getChannels(){return this.realtime.getChannels()}removeChannel(e){return this.realtime.removeChannel(e)}removeAllChannels(){return this.realtime.removeAllChannels()}_getAccessToken(){var e,n;return A3(this,void 0,void 0,function*(){if(this.accessToken)return yield this.accessToken();const{data:r}=yield this.auth.getSession();return(n=(e=r.session)===null||e===void 0?void 0:e.access_token)!==null&&n!==void 0?n:this.supabaseKey})}_initSupabaseAuthClient({autoRefreshToken:e,persistSession:n,detectSessionInUrl:r,storage:o,userStorage:i,storageKey:a,flowType:s,lock:u,debug:l},c,d){const f={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new I3({url:this.authUrl.href,headers:Object.assign(Object.assign({},f),c),storageKey:a,autoRefreshToken:e,persistSession:n,detectSessionInUrl:r,storage:o,userStorage:i,flowType:s,lock:u,debug:l,fetch:d,hasCustomAuthorizationHeader:Object.keys(this.headers).some(h=>h.toLowerCase()==="authorization")})}_initRealtimeClient(e){return new cM(this.realtimeUrl.href,Object.assign(Object.assign({},e),{params:Object.assign({apikey:this.supabaseKey},e==null?void 0:e.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange((n,r)=>{this._handleTokenChanged(n,"CLIENT",r==null?void 0:r.access_token)})}_handleTokenChanged(e,n,r){(e==="TOKEN_REFRESHED"||e==="SIGNED_IN")&&this.changedAccessToken!==r?this.changedAccessToken=r:e==="SIGNED_OUT"&&(this.realtime.setAuth(),n=="STORAGE"&&this.auth.signOut(),this.changedAccessToken=void 0)}}const KV=(t,e,n)=>new P3(t,e,n);function D3(){if(typeof window<"u"||typeof process>"u")return!1;const t=process.version;if(t==null)return!1;const e=t.match(/^v(\d+)\./);return e?parseInt(e[1],10)<=18:!1}D3()&&console.warn("⚠️  Node.js 18 and below are deprecated and will no longer be supported in future versions of @supabase/supabase-js. Please upgrade to Node.js 20 or later. For more information, visit: https://github.com/orgs/supabase/discussions/37217");var ap="focusScope.autoFocusOnMount",sp="focusScope.autoFocusOnUnmount",Tw={bubbles:!1,cancelable:!0},N3="FocusScope",aC=k.forwardRef((t,e)=>{const{loop:n=!1,trapped:r=!1,onMountAutoFocus:o,onUnmountAutoFocus:i,...a}=t,[s,u]=k.useState(null),l=xr(o),c=xr(i),d=k.useRef(null),f=Pt(e,p=>u(p)),h=k.useRef({paused:!1,pause(){this.paused=!0},resume(){this.paused=!1}}).current;k.useEffect(()=>{if(r){let p=function(w){if(h.paused||!s)return;const x=w.target;s.contains(x)?d.current=x:Ho(d.current,{select:!0})},m=function(w){if(h.paused||!s)return;const x=w.relatedTarget;x!==null&&(s.contains(x)||Ho(d.current,{select:!0}))},g=function(w){if(document.activeElement===document.body)for(const b of w)b.removedNodes.length>0&&Ho(s)};document.addEventListener("focusin",p),document.addEventListener("focusout",m);const y=new MutationObserver(g);return s&&y.observe(s,{childList:!0,subtree:!0}),()=>{document.removeEventListener("focusin",p),document.removeEventListener("focusout",m),y.disconnect()}}},[r,s,h.paused]),k.useEffect(()=>{if(s){Aw.add(h);const p=document.activeElement;if(!s.contains(p)){const g=new CustomEvent(ap,Tw);s.addEventListener(ap,l),s.dispatchEvent(g),g.defaultPrevented||(O3($3(sC(s)),{select:!0}),document.activeElement===p&&Ho(s))}return()=>{s.removeEventListener(ap,l),setTimeout(()=>{const g=new CustomEvent(sp,Tw);s.addEventListener(sp,c),s.dispatchEvent(g),g.defaultPrevented||Ho(p??document.body,{select:!0}),s.removeEventListener(sp,c),Aw.remove(h)},0)}}},[s,l,c,h]);const v=k.useCallback(p=>{if(!n&&!r||h.paused)return;const m=p.key==="Tab"&&!p.altKey&&!p.ctrlKey&&!p.metaKey,g=document.activeElement;if(m&&g){const y=p.currentTarget,[w,x]=F3(y);w&&x?!p.shiftKey&&g===x?(p.preventDefault(),n&&Ho(w,{select:!0})):p.shiftKey&&g===w&&(p.preventDefault(),n&&Ho(x,{select:!0})):g===y&&p.preventDefault()}},[n,r,h.paused]);return G.jsx(Ve.div,{tabIndex:-1,...a,ref:f,onKeyDown:v})});aC.displayName=N3;function O3(t,{select:e=!1}={}){const n=document.activeElement;for(const r of t)if(Ho(r,{select:e}),document.activeElement!==n)return}function F3(t){const e=sC(t),n=Iw(e,t),r=Iw(e.reverse(),t);return[n,r]}function sC(t){const e=[],n=document.createTreeWalker(t,NodeFilter.SHOW_ELEMENT,{acceptNode:r=>{const o=r.tagName==="INPUT"&&r.type==="hidden";return r.disabled||r.hidden||o?NodeFilter.FILTER_SKIP:r.tabIndex>=0?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}});for(;n.nextNode();)e.push(n.currentNode);return e}function Iw(t,e){for(const n of t)if(!M3(n,{upTo:e}))return n}function M3(t,{upTo:e}){if(getComputedStyle(t).visibility==="hidden")return!0;for(;t;){if(e!==void 0&&t===e)return!1;if(getComputedStyle(t).display==="none")return!0;t=t.parentElement}return!1}function L3(t){return t instanceof HTMLInputElement&&"select"in t}function Ho(t,{select:e=!1}={}){if(t&&t.focus){const n=document.activeElement;t.focus({preventScroll:!0}),t!==n&&L3(t)&&e&&t.select()}}var Aw=B3();function B3(){let t=[];return{add(e){const n=t[0];e!==n&&(n==null||n.pause()),t=Pw(t,e),t.unshift(e)},remove(e){var n;t=Pw(t,e),(n=t[0])==null||n.resume()}}}function Pw(t,e){const n=[...t],r=n.indexOf(e);return r!==-1&&n.splice(r,1),n}function $3(t){return t.filter(e=>e.tagName!=="A")}var up=0;function j3(){k.useEffect(()=>{const t=document.querySelectorAll("[data-radix-focus-guard]");return document.body.insertAdjacentElement("afterbegin",t[0]??Dw()),document.body.insertAdjacentElement("beforeend",t[1]??Dw()),up++,()=>{up===1&&document.querySelectorAll("[data-radix-focus-guard]").forEach(e=>e.remove()),up--}},[])}function Dw(){const t=document.createElement("span");return t.setAttribute("data-radix-focus-guard",""),t.tabIndex=0,t.style.outline="none",t.style.opacity="0",t.style.position="fixed",t.style.pointerEvents="none",t}var Lr=function(){return Lr=Object.assign||function(e){for(var n,r=1,o=arguments.length;r<o;r++){n=arguments[r];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},Lr.apply(this,arguments)};function uC(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,r=Object.getOwnPropertySymbols(t);o<r.length;o++)e.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(t,r[o])&&(n[r[o]]=t[r[o]]);return n}function W3(t,e,n){if(n||arguments.length===2)for(var r=0,o=e.length,i;r<o;r++)(i||!(r in e))&&(i||(i=Array.prototype.slice.call(e,0,r)),i[r]=e[r]);return t.concat(i||Array.prototype.slice.call(e))}var hd="right-scroll-bar-position",pd="width-before-scroll-bar",U3="with-scroll-bars-hidden",z3="--removed-body-scroll-bar-size";function lp(t,e){return typeof t=="function"?t(e):t&&(t.current=e),t}function V3(t,e){var n=k.useState(function(){return{value:t,callback:e,facade:{get current(){return n.value},set current(r){var o=n.value;o!==r&&(n.value=r,n.callback(r,o))}}}})[0];return n.callback=e,n.facade}var H3=typeof window<"u"?k.useLayoutEffect:k.useEffect,Nw=new WeakMap;function G3(t,e){var n=V3(null,function(r){return t.forEach(function(o){return lp(o,r)})});return H3(function(){var r=Nw.get(n);if(r){var o=new Set(r),i=new Set(t),a=n.current;o.forEach(function(s){i.has(s)||lp(s,null)}),i.forEach(function(s){o.has(s)||lp(s,a)})}Nw.set(n,t)},[t]),n}function q3(t){return t}function K3(t,e){e===void 0&&(e=q3);var n=[],r=!1,o={read:function(){if(r)throw new Error("Sidecar: could not `read` from an `assigned` medium. `read` could be used only with `useMedium`.");return n.length?n[n.length-1]:t},useMedium:function(i){var a=e(i,r);return n.push(a),function(){n=n.filter(function(s){return s!==a})}},assignSyncMedium:function(i){for(r=!0;n.length;){var a=n;n=[],a.forEach(i)}n={push:function(s){return i(s)},filter:function(){return n}}},assignMedium:function(i){r=!0;var a=[];if(n.length){var s=n;n=[],s.forEach(i),a=n}var u=function(){var c=a;a=[],c.forEach(i)},l=function(){return Promise.resolve().then(u)};l(),n={push:function(c){a.push(c),l()},filter:function(c){return a=a.filter(c),n}}}};return o}function X3(t){t===void 0&&(t={});var e=K3(null);return e.options=Lr({async:!0,ssr:!1},t),e}var lC=function(t){var e=t.sideCar,n=uC(t,["sideCar"]);if(!e)throw new Error("Sidecar: please provide `sideCar` property to import the right car");var r=e.read();if(!r)throw new Error("Sidecar medium not found");return k.createElement(r,Lr({},n))};lC.isSideCarExport=!0;function Y3(t,e){return t.useMedium(e),lC}var cC=X3(),cp=function(){},Zf=k.forwardRef(function(t,e){var n=k.useRef(null),r=k.useState({onScrollCapture:cp,onWheelCapture:cp,onTouchMoveCapture:cp}),o=r[0],i=r[1],a=t.forwardProps,s=t.children,u=t.className,l=t.removeScrollBar,c=t.enabled,d=t.shards,f=t.sideCar,h=t.noRelative,v=t.noIsolation,p=t.inert,m=t.allowPinchZoom,g=t.as,y=g===void 0?"div":g,w=t.gapMode,x=uC(t,["forwardProps","children","className","removeScrollBar","enabled","shards","sideCar","noRelative","noIsolation","inert","allowPinchZoom","as","gapMode"]),b=f,_=G3([n,e]),E=Lr(Lr({},x),o);return k.createElement(k.Fragment,null,c&&k.createElement(b,{sideCar:cC,removeScrollBar:l,shards:d,noRelative:h,noIsolation:v,inert:p,setCallbacks:i,allowPinchZoom:!!m,lockRef:n,gapMode:w}),a?k.cloneElement(k.Children.only(s),Lr(Lr({},E),{ref:_})):k.createElement(y,Lr({},E,{className:u,ref:_}),s))});Zf.defaultProps={enabled:!0,removeScrollBar:!0,inert:!1};Zf.classNames={fullWidth:pd,zeroRight:hd};var Q3=function(){if(typeof __webpack_nonce__<"u")return __webpack_nonce__};function J3(){if(!document)return null;var t=document.createElement("style");t.type="text/css";var e=Q3();return e&&t.setAttribute("nonce",e),t}function Z3(t,e){t.styleSheet?t.styleSheet.cssText=e:t.appendChild(document.createTextNode(e))}function e4(t){var e=document.head||document.getElementsByTagName("head")[0];e.appendChild(t)}var t4=function(){var t=0,e=null;return{add:function(n){t==0&&(e=J3())&&(Z3(e,n),e4(e)),t++},remove:function(){t--,!t&&e&&(e.parentNode&&e.parentNode.removeChild(e),e=null)}}},n4=function(){var t=t4();return function(e,n){k.useEffect(function(){return t.add(e),function(){t.remove()}},[e&&n])}},dC=function(){var t=n4(),e=function(n){var r=n.styles,o=n.dynamic;return t(r,o),null};return e},r4={left:0,top:0,right:0,gap:0},dp=function(t){return parseInt(t||"",10)||0},o4=function(t){var e=window.getComputedStyle(document.body),n=e[t==="padding"?"paddingLeft":"marginLeft"],r=e[t==="padding"?"paddingTop":"marginTop"],o=e[t==="padding"?"paddingRight":"marginRight"];return[dp(n),dp(r),dp(o)]},i4=function(t){if(t===void 0&&(t="margin"),typeof window>"u")return r4;var e=o4(t),n=document.documentElement.clientWidth,r=window.innerWidth;return{left:e[0],top:e[1],right:e[2],gap:Math.max(0,r-n+e[2]-e[0])}},a4=dC(),Cs="data-scroll-locked",s4=function(t,e,n,r){var o=t.left,i=t.top,a=t.right,s=t.gap;return n===void 0&&(n="margin"),`
  .`.concat(U3,` {
   overflow: hidden `).concat(r,`;
   padding-right: `).concat(s,"px ").concat(r,`;
  }
  body[`).concat(Cs,`] {
    overflow: hidden `).concat(r,`;
    overscroll-behavior: contain;
    `).concat([e&&"position: relative ".concat(r,";"),n==="margin"&&`
    padding-left: `.concat(o,`px;
    padding-top: `).concat(i,`px;
    padding-right: `).concat(a,`px;
    margin-left:0;
    margin-top:0;
    margin-right: `).concat(s,"px ").concat(r,`;
    `),n==="padding"&&"padding-right: ".concat(s,"px ").concat(r,";")].filter(Boolean).join(""),`
  }
  
  .`).concat(hd,` {
    right: `).concat(s,"px ").concat(r,`;
  }
  
  .`).concat(pd,` {
    margin-right: `).concat(s,"px ").concat(r,`;
  }
  
  .`).concat(hd," .").concat(hd,` {
    right: 0 `).concat(r,`;
  }
  
  .`).concat(pd," .").concat(pd,` {
    margin-right: 0 `).concat(r,`;
  }
  
  body[`).concat(Cs,`] {
    `).concat(z3,": ").concat(s,`px;
  }
`)},Ow=function(){var t=parseInt(document.body.getAttribute(Cs)||"0",10);return isFinite(t)?t:0},u4=function(){k.useEffect(function(){return document.body.setAttribute(Cs,(Ow()+1).toString()),function(){var t=Ow()-1;t<=0?document.body.removeAttribute(Cs):document.body.setAttribute(Cs,t.toString())}},[])},l4=function(t){var e=t.noRelative,n=t.noImportant,r=t.gapMode,o=r===void 0?"margin":r;u4();var i=k.useMemo(function(){return i4(o)},[o]);return k.createElement(a4,{styles:s4(i,!e,o,n?"":"!important")})},mm=!1;if(typeof window<"u")try{var Fc=Object.defineProperty({},"passive",{get:function(){return mm=!0,!0}});window.addEventListener("test",Fc,Fc),window.removeEventListener("test",Fc,Fc)}catch{mm=!1}var Ha=mm?{passive:!1}:!1,c4=function(t){return t.tagName==="TEXTAREA"},fC=function(t,e){if(!(t instanceof Element))return!1;var n=window.getComputedStyle(t);return n[e]!=="hidden"&&!(n.overflowY===n.overflowX&&!c4(t)&&n[e]==="visible")},d4=function(t){return fC(t,"overflowY")},f4=function(t){return fC(t,"overflowX")},Fw=function(t,e){var n=e.ownerDocument,r=e;do{typeof ShadowRoot<"u"&&r instanceof ShadowRoot&&(r=r.host);var o=hC(t,r);if(o){var i=pC(t,r),a=i[1],s=i[2];if(a>s)return!0}r=r.parentNode}while(r&&r!==n.body);return!1},h4=function(t){var e=t.scrollTop,n=t.scrollHeight,r=t.clientHeight;return[e,n,r]},p4=function(t){var e=t.scrollLeft,n=t.scrollWidth,r=t.clientWidth;return[e,n,r]},hC=function(t,e){return t==="v"?d4(e):f4(e)},pC=function(t,e){return t==="v"?h4(e):p4(e)},v4=function(t,e){return t==="h"&&e==="rtl"?-1:1},m4=function(t,e,n,r,o){var i=v4(t,window.getComputedStyle(e).direction),a=i*r,s=n.target,u=e.contains(s),l=!1,c=a>0,d=0,f=0;do{if(!s)break;var h=pC(t,s),v=h[0],p=h[1],m=h[2],g=p-m-i*v;(v||g)&&hC(t,s)&&(d+=g,f+=v);var y=s.parentNode;s=y&&y.nodeType===Node.DOCUMENT_FRAGMENT_NODE?y.host:y}while(!u&&s!==document.body||u&&(e.contains(s)||e===s));return(c&&(Math.abs(d)<1||!o)||!c&&(Math.abs(f)<1||!o))&&(l=!0),l},Mc=function(t){return"changedTouches"in t?[t.changedTouches[0].clientX,t.changedTouches[0].clientY]:[0,0]},Mw=function(t){return[t.deltaX,t.deltaY]},Lw=function(t){return t&&"current"in t?t.current:t},g4=function(t,e){return t[0]===e[0]&&t[1]===e[1]},y4=function(t){return`
  .block-interactivity-`.concat(t,` {pointer-events: none;}
  .allow-interactivity-`).concat(t,` {pointer-events: all;}
`)},w4=0,Ga=[];function x4(t){var e=k.useRef([]),n=k.useRef([0,0]),r=k.useRef(),o=k.useState(w4++)[0],i=k.useState(dC)[0],a=k.useRef(t);k.useEffect(function(){a.current=t},[t]),k.useEffect(function(){if(t.inert){document.body.classList.add("block-interactivity-".concat(o));var p=W3([t.lockRef.current],(t.shards||[]).map(Lw),!0).filter(Boolean);return p.forEach(function(m){return m.classList.add("allow-interactivity-".concat(o))}),function(){document.body.classList.remove("block-interactivity-".concat(o)),p.forEach(function(m){return m.classList.remove("allow-interactivity-".concat(o))})}}},[t.inert,t.lockRef.current,t.shards]);var s=k.useCallback(function(p,m){if("touches"in p&&p.touches.length===2||p.type==="wheel"&&p.ctrlKey)return!a.current.allowPinchZoom;var g=Mc(p),y=n.current,w="deltaX"in p?p.deltaX:y[0]-g[0],x="deltaY"in p?p.deltaY:y[1]-g[1],b,_=p.target,E=Math.abs(w)>Math.abs(x)?"h":"v";if("touches"in p&&E==="h"&&_.type==="range")return!1;var C=Fw(E,_);if(!C)return!0;if(C?b=E:(b=E==="v"?"h":"v",C=Fw(E,_)),!C)return!1;if(!r.current&&"changedTouches"in p&&(w||x)&&(r.current=b),!b)return!0;var R=r.current||b;return m4(R,m,p,R==="h"?w:x,!0)},[]),u=k.useCallback(function(p){var m=p;if(!(!Ga.length||Ga[Ga.length-1]!==i)){var g="deltaY"in m?Mw(m):Mc(m),y=e.current.filter(function(b){return b.name===m.type&&(b.target===m.target||m.target===b.shadowParent)&&g4(b.delta,g)})[0];if(y&&y.should){m.cancelable&&m.preventDefault();return}if(!y){var w=(a.current.shards||[]).map(Lw).filter(Boolean).filter(function(b){return b.contains(m.target)}),x=w.length>0?s(m,w[0]):!a.current.noIsolation;x&&m.cancelable&&m.preventDefault()}}},[]),l=k.useCallback(function(p,m,g,y){var w={name:p,delta:m,target:g,should:y,shadowParent:b4(g)};e.current.push(w),setTimeout(function(){e.current=e.current.filter(function(x){return x!==w})},1)},[]),c=k.useCallback(function(p){n.current=Mc(p),r.current=void 0},[]),d=k.useCallback(function(p){l(p.type,Mw(p),p.target,s(p,t.lockRef.current))},[]),f=k.useCallback(function(p){l(p.type,Mc(p),p.target,s(p,t.lockRef.current))},[]);k.useEffect(function(){return Ga.push(i),t.setCallbacks({onScrollCapture:d,onWheelCapture:d,onTouchMoveCapture:f}),document.addEventListener("wheel",u,Ha),document.addEventListener("touchmove",u,Ha),document.addEventListener("touchstart",c,Ha),function(){Ga=Ga.filter(function(p){return p!==i}),document.removeEventListener("wheel",u,Ha),document.removeEventListener("touchmove",u,Ha),document.removeEventListener("touchstart",c,Ha)}},[]);var h=t.removeScrollBar,v=t.inert;return k.createElement(k.Fragment,null,v?k.createElement(i,{styles:y4(o)}):null,h?k.createElement(l4,{noRelative:t.noRelative,gapMode:t.gapMode}):null)}function b4(t){for(var e=null;t!==null;)t instanceof ShadowRoot&&(e=t.host,t=t.host),t=t.parentNode;return e}const _4=Y3(cC,x4);var vC=k.forwardRef(function(t,e){return k.createElement(Zf,Lr({},t,{ref:e,sideCar:_4}))});vC.classNames=Zf.classNames;var E4=function(t){if(typeof document>"u")return null;var e=Array.isArray(t)?t[0]:t;return e.ownerDocument.body},qa=new WeakMap,Lc=new WeakMap,Bc={},fp=0,mC=function(t){return t&&(t.host||mC(t.parentNode))},C4=function(t,e){return e.map(function(n){if(t.contains(n))return n;var r=mC(n);return r&&t.contains(r)?r:(console.error("aria-hidden",n,"in not contained inside",t,". Doing nothing"),null)}).filter(function(n){return!!n})},S4=function(t,e,n,r){var o=C4(e,Array.isArray(t)?t:[t]);Bc[n]||(Bc[n]=new WeakMap);var i=Bc[n],a=[],s=new Set,u=new Set(o),l=function(d){!d||s.has(d)||(s.add(d),l(d.parentNode))};o.forEach(l);var c=function(d){!d||u.has(d)||Array.prototype.forEach.call(d.children,function(f){if(s.has(f))c(f);else try{var h=f.getAttribute(r),v=h!==null&&h!=="false",p=(qa.get(f)||0)+1,m=(i.get(f)||0)+1;qa.set(f,p),i.set(f,m),a.push(f),p===1&&v&&Lc.set(f,!0),m===1&&f.setAttribute(n,"true"),v||f.setAttribute(r,"true")}catch(g){console.error("aria-hidden: cannot operate on ",f,g)}})};return c(e),s.clear(),fp++,function(){a.forEach(function(d){var f=qa.get(d)-1,h=i.get(d)-1;qa.set(d,f),i.set(d,h),f||(Lc.has(d)||d.removeAttribute(r),Lc.delete(d)),h||d.removeAttribute(n)}),fp--,fp||(qa=new WeakMap,qa=new WeakMap,Lc=new WeakMap,Bc={})}},k4=function(t,e,n){n===void 0&&(n="data-aria-hidden");var r=Array.from(Array.isArray(t)?t:[t]),o=E4(t);return o?(r.push.apply(r,Array.from(o.querySelectorAll("[aria-live]"))),S4(r,o,n,"aria-hidden")):function(){return null}},eh="Dialog",[gC,yC]=Oi(eh),[R4,Er]=gC(eh),wC=t=>{const{__scopeDialog:e,children:n,open:r,defaultOpen:o,onOpenChange:i,modal:a=!0}=t,s=k.useRef(null),u=k.useRef(null),[l,c]=Bf({prop:r,defaultProp:o??!1,onChange:i,caller:eh});return G.jsx(R4,{scope:e,triggerRef:s,contentRef:u,contentId:Xu(),titleId:Xu(),descriptionId:Xu(),open:l,onOpenChange:c,onOpenToggle:k.useCallback(()=>c(d=>!d),[c]),modal:a,children:n})};wC.displayName=eh;var xC="DialogTrigger",bC=k.forwardRef((t,e)=>{const{__scopeDialog:n,...r}=t,o=Er(xC,n),i=Pt(e,o.triggerRef);return G.jsx(Ve.button,{type:"button","aria-haspopup":"dialog","aria-expanded":o.open,"aria-controls":o.contentId,"data-state":ly(o.open),...r,ref:i,onClick:De(t.onClick,o.onOpenToggle)})});bC.displayName=xC;var sy="DialogPortal",[T4,_C]=gC(sy,{forceMount:void 0}),EC=t=>{const{__scopeDialog:e,forceMount:n,children:r,container:o}=t,i=Er(sy,e);return G.jsx(T4,{scope:e,forceMount:n,children:k.Children.map(r,a=>G.jsx(Ta,{present:n||i.open,children:G.jsx(Mg,{asChild:!0,container:o,children:a})}))})};EC.displayName=sy;var Yd="DialogOverlay",CC=k.forwardRef((t,e)=>{const n=_C(Yd,t.__scopeDialog),{forceMount:r=n.forceMount,...o}=t,i=Er(Yd,t.__scopeDialog);return i.modal?G.jsx(Ta,{present:r||i.open,children:G.jsx(A4,{...o,ref:e})}):null});CC.displayName=Yd;var I4=wl("DialogOverlay.RemoveScroll"),A4=k.forwardRef((t,e)=>{const{__scopeDialog:n,...r}=t,o=Er(Yd,n);return G.jsx(vC,{as:I4,allowPinchZoom:!0,shards:[o.contentRef],children:G.jsx(Ve.div,{"data-state":ly(o.open),...r,ref:e,style:{pointerEvents:"auto",...r.style}})})}),Ea="DialogContent",SC=k.forwardRef((t,e)=>{const n=_C(Ea,t.__scopeDialog),{forceMount:r=n.forceMount,...o}=t,i=Er(Ea,t.__scopeDialog);return G.jsx(Ta,{present:r||i.open,children:i.modal?G.jsx(P4,{...o,ref:e}):G.jsx(D4,{...o,ref:e})})});SC.displayName=Ea;var P4=k.forwardRef((t,e)=>{const n=Er(Ea,t.__scopeDialog),r=k.useRef(null),o=Pt(e,n.contentRef,r);return k.useEffect(()=>{const i=r.current;if(i)return k4(i)},[]),G.jsx(kC,{...t,ref:o,trapFocus:n.open,disableOutsidePointerEvents:!0,onCloseAutoFocus:De(t.onCloseAutoFocus,i=>{var a;i.preventDefault(),(a=n.triggerRef.current)==null||a.focus()}),onPointerDownOutside:De(t.onPointerDownOutside,i=>{const a=i.detail.originalEvent,s=a.button===0&&a.ctrlKey===!0;(a.button===2||s)&&i.preventDefault()}),onFocusOutside:De(t.onFocusOutside,i=>i.preventDefault())})}),D4=k.forwardRef((t,e)=>{const n=Er(Ea,t.__scopeDialog),r=k.useRef(!1),o=k.useRef(!1);return G.jsx(kC,{...t,ref:e,trapFocus:!1,disableOutsidePointerEvents:!1,onCloseAutoFocus:i=>{var a,s;(a=t.onCloseAutoFocus)==null||a.call(t,i),i.defaultPrevented||(r.current||(s=n.triggerRef.current)==null||s.focus(),i.preventDefault()),r.current=!1,o.current=!1},onInteractOutside:i=>{var u,l;(u=t.onInteractOutside)==null||u.call(t,i),i.defaultPrevented||(r.current=!0,i.detail.originalEvent.type==="pointerdown"&&(o.current=!0));const a=i.target;((l=n.triggerRef.current)==null?void 0:l.contains(a))&&i.preventDefault(),i.detail.originalEvent.type==="focusin"&&o.current&&i.preventDefault()}})}),kC=k.forwardRef((t,e)=>{const{__scopeDialog:n,trapFocus:r,onOpenAutoFocus:o,onCloseAutoFocus:i,...a}=t,s=Er(Ea,n),u=k.useRef(null),l=Pt(e,u);return j3(),G.jsxs(G.Fragment,{children:[G.jsx(aC,{asChild:!0,loop:!0,trapped:r,onMountAutoFocus:o,onUnmountAutoFocus:i,children:G.jsx(Lf,{role:"dialog",id:s.contentId,"aria-describedby":s.descriptionId,"aria-labelledby":s.titleId,"data-state":ly(s.open),...a,ref:l,onDismiss:()=>s.onOpenChange(!1)})}),G.jsxs(G.Fragment,{children:[G.jsx(O4,{titleId:s.titleId}),G.jsx(M4,{contentRef:u,descriptionId:s.descriptionId})]})]})}),uy="DialogTitle",RC=k.forwardRef((t,e)=>{const{__scopeDialog:n,...r}=t,o=Er(uy,n);return G.jsx(Ve.h2,{id:o.titleId,...r,ref:e})});RC.displayName=uy;var TC="DialogDescription",IC=k.forwardRef((t,e)=>{const{__scopeDialog:n,...r}=t,o=Er(TC,n);return G.jsx(Ve.p,{id:o.descriptionId,...r,ref:e})});IC.displayName=TC;var AC="DialogClose",PC=k.forwardRef((t,e)=>{const{__scopeDialog:n,...r}=t,o=Er(AC,n);return G.jsx(Ve.button,{type:"button",...r,ref:e,onClick:De(t.onClick,()=>o.onOpenChange(!1))})});PC.displayName=AC;function ly(t){return t?"open":"closed"}var DC="DialogTitleWarning",[N4,NC]=sA(DC,{contentName:Ea,titleName:uy,docsSlug:"dialog"}),O4=({titleId:t})=>{const e=NC(DC),n=`\`${e.contentName}\` requires a \`${e.titleName}\` for the component to be accessible for screen reader users.

If you want to hide the \`${e.titleName}\`, you can wrap it with our VisuallyHidden component.

For more information, see https://radix-ui.com/primitives/docs/components/${e.docsSlug}`;return k.useEffect(()=>{t&&(document.getElementById(t)||console.error(n))},[n,t]),null},F4="DialogDescriptionWarning",M4=({contentRef:t,descriptionId:e})=>{const r=`Warning: Missing \`Description\` or \`aria-describedby={undefined}\` for {${NC(F4).contentName}}.`;return k.useEffect(()=>{var i;const o=(i=t.current)==null?void 0:i.getAttribute("aria-describedby");e&&o&&(document.getElementById(e)||console.warn(r))},[r,t,e]),null},L4=wC,B4=bC,$4=EC,j4=CC,W4=SC,U4=RC,z4=IC,OC=PC,V4="Label",FC=k.forwardRef((t,e)=>G.jsx(Ve.label,{...t,ref:e,onMouseDown:n=>{var o;n.target.closest("button, input, select, textarea")||((o=t.onMouseDown)==null||o.call(t,n),!n.defaultPrevented&&n.detail>1&&n.preventDefault())}}));FC.displayName=V4;var XV=FC;/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var MC=function(t,e){return(MC=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,r){n.__proto__=r}||function(n,r){for(var o in r)r.hasOwnProperty(o)&&(n[o]=r[o])})(t,e)};function Cr(t,e){function n(){this.constructor=t}MC(t,e),t.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}function ie(t,e,n,r){return new(n||(n=Promise))(function(o,i){function a(l){try{u(r.next(l))}catch(c){i(c)}}function s(l){try{u(r.throw(l))}catch(c){i(c)}}function u(l){l.done?o(l.value):new n(function(c){c(l.value)}).then(a,s)}u((r=r.apply(t,[])).next())})}function ae(t,e){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},typeof Symbol=="function"&&(i[Symbol.iterator]=function(){return this}),i;function s(u){return function(l){return function(c){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(o=2&c[0]?r.return:c[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,c[1])).done)return o;switch(r=0,o&&(c=[2&c[0],o.value]),c[0]){case 0:case 1:o=c;break;case 4:return a.label++,{value:c[1],done:!1};case 5:a.label++,r=c[1],c=[0];continue;case 7:c=a.ops.pop(),a.trys.pop();continue;default:if(!(o=(o=a.trys).length>0&&o[o.length-1])&&(c[0]===6||c[0]===2)){a=0;continue}if(c[0]===3&&(!o||c[1]>o[0]&&c[1]<o[3])){a.label=c[1];break}if(c[0]===6&&a.label<o[1]){a.label=o[1],o=c;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(c);break}o[2]&&a.ops.pop(),a.trys.pop();continue}c=e.call(t,a)}catch(d){c=[6,d],r=0}finally{n=o=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}([u,l])}}}var H4=function(){function t(e){this.global=e,this.flags={},this.flagRegistry={},this.urlFlags={},this.populateURLFlags()}return t.prototype.setPlatform=function(e,n){this.platform!=null&&console.warn("Platform "+this.platformName+" has already been set. Overwriting the platform with "+n+"."),this.platformName=e,this.platform=n},t.prototype.registerFlag=function(e,n,r){if(this.flagRegistry[e]={evaluationFn:n,setHook:r},this.urlFlags[e]!=null){var o=this.urlFlags[e];console.warn("Setting feature override from URL "+e+": "+o+"."),this.set(e,o)}},t.prototype.get=function(e){return e in this.flags?this.flags[e]:(this.flags[e]=this.evaluateFlag(e),this.flags[e])},t.prototype.getNumber=function(e){return this.get(e)},t.prototype.getBool=function(e){return this.get(e)},t.prototype.getFlags=function(){return this.flags},Object.defineProperty(t.prototype,"features",{get:function(){return this.flags},enumerable:!0,configurable:!0}),t.prototype.set=function(e,n){if(this.flagRegistry[e]==null)throw new Error("Cannot set flag "+e+" as it has not been registered.");this.flags[e]=n,this.flagRegistry[e].setHook!=null&&this.flagRegistry[e].setHook(n)},t.prototype.evaluateFlag=function(e){if(this.flagRegistry[e]==null)throw new Error("Cannot evaluate flag '"+e+"': no evaluation function found.");return this.flagRegistry[e].evaluationFn()},t.prototype.setFlags=function(e){this.flags=Object.assign({},e)},t.prototype.reset=function(){this.flags={},this.urlFlags={},this.populateURLFlags()},t.prototype.populateURLFlags=function(){var e=this;if(this.global!==void 0&&this.global.location!==void 0&&this.global.location.search!==void 0){var n,r,o=(n=this.global.location.search,r={},n.replace(/[?&]([^=?&]+)(?:=([^&]*))?/g,function(i){for(var a=[],s=1;s<arguments.length;s++)a[s-1]=arguments[s];return G4(r,a[0],a[1]),a.join("=")}),r);"tfjsflags"in o&&o.tfjsflags.split(",").forEach(function(i){var a=i.split(":"),s=a[0],u=a[1];e.urlFlags[s]=function(l,c){if((c=c.toLowerCase())==="true"||c==="false")return c==="true";if(""+ +c===c)return+c;throw new Error("Could not parse value flag value "+c+" for flag "+l+".")}(s,u)})}},t}();function G4(t,e,n){t[decodeURIComponent(e)]=decodeURIComponent(n||"")}function H(){return LC}var LC=null,Qd=new Map,gm=new Map;function BC(t,e){var n=jC(t,e);return Qd.get(n)}function q4(t){return gm.get(t)}function Bw(t){for(var e=Qd.entries(),n=[];;){var r=e.next(),o=r.done,i=r.value;if(o)break;var a=i[0],s=i[1];a.split("_")[0]===t&&n.push(s)}return n}function $C(t){var e=t.kernelName,n=t.backendName,r=jC(e,n);if(Qd.has(r))throw new Error("The kernel '"+e+"' for backend '"+n+"' is already registered");Qd.set(r,t)}function K4(t){var e=t.kernelName;gm.has(e)&&console.warn("Overriding the gradient for '"+e+"'"),gm.set(e,t)}function jC(t,e){return e+"_"+t}function ym(t,e,n){return Math.max(t,Math.min(e,n))}function WC(t){return t%2==0?t:t+1}function X4(t){for(var e=0,n=0;n<t.length;n++)e+=t[n];return e}function I(t,e){if(!t)throw new Error(typeof e=="string"?e:e())}function Le(t,e,n){n===void 0&&(n=""),I(At(t,e),function(){return n+" Shapes "+t+" and "+e+" must match"})}function mu(t){I(t!=null,function(){return"The input to the tensor constructor must be a non-null value."})}function nu(t,e,n){if(e===void 0&&(e=[]),n===void 0&&(n=!1),e==null&&(e=[]),Array.isArray(t)||Hr(t)&&!n)for(var r=0;r<t.length;++r)nu(t[r],e,n);else e.push(t);return e}function se(t){if(t.length===0)return 1;for(var e=t[0],n=1;n<t.length;n++)e*=t[n];return e}function At(t,e){if(t===e)return!0;if(t==null||e==null||t.length!==e.length)return!1;for(var n=0;n<t.length;n++)if(t[n]!==e[n])return!1;return!0}function dt(t){return t%1==0}function Y4(t){if(Math.tanh!=null)return Math.tanh(t);if(t===1/0)return 1;if(t===-1/0)return-1;var e=Math.exp(2*t);return(e-1)/(e+1)}function wm(t){var e=Math.ceil(Math.sqrt(t));return[e,Math.ceil(t/e)]}function Ss(t,e){return e<=t.length?t:t+" ".repeat(e-t.length)}function $w(t,e,n){return e===void 0&&(e=function(r){return 0}),new Promise(function(r,o){var i=0,a=function(){if(t())r();else{i++;var s=e(i);n!=null&&i>=n?o():setTimeout(a,s)}};a()})}function Q4(t,e){for(var n=1,r=-1,o=0;o<t.length;++o)if(t[o]>=0)n*=t[o];else if(t[o]===-1){if(r!==-1)throw Error("Shapes can only have 1 implicit size. Found -1 at dim "+r+" and dim "+o);r=o}else if(t[o]<0)throw Error("Shapes can not be < 0. Found "+t[o]+" at dim "+o);if(r===-1){if(e>0&&e!==n)throw Error("Size("+e+") must match the product of shape "+t);return t}if(n===0)throw Error("Cannot infer the missing size in ["+t+"] when there are 0 elements");if(e%n!=0)throw Error("The implicit shape can't be a fractional number. Got "+e+" / "+n);var i=t.slice();return i[r]=e/n,i}function kt(t,e){var n=e.length;return I((t=t==null?e.map(function(r,o){return o}):[].concat(t)).every(function(r){return r>=-n&&r<n}),function(){return"All values in axis param must be in range [-"+n+", "+n+") but got axis "+t}),I(t.every(function(r){return dt(r)}),function(){return"All values in axis param must be integers but got axis "+t}),t.map(function(r){return r<0?n+r:r})}function Qi(t,e){for(var n=[],r=[],o=e!=null&&Array.isArray(e)&&e.length===0,i=e==null||o?null:kt(e,t).sort(),a=0,s=0;s<t.length;++s){if(i!=null){if(i[a]===s&&t[s]!==1)throw new Error("Can't squeeze axis "+s+" since its dim '"+t[s]+"' is not 1");(i[a]==null||i[a]>s)&&t[s]===1&&(n.push(t[s]),r.push(s)),i[a]<=s&&a++}t[s]!==1&&(n.push(t[s]),r.push(s))}return{newShape:n,keptDims:r}}function kl(t,e){var n=null;if(t==null||t==="float32")n=new Float32Array(e);else if(t==="int32")n=new Int32Array(e);else{if(t!=="bool")throw new Error("Unknown data type "+t);n=new Uint8Array(e)}return n}function Jd(t,e){var n=null;if(t==null||t==="float32")n=new Float32Array(e);else if(t==="int32")n=new Int32Array(e);else if(t==="bool")n=new Uint8Array(e);else{if(t!=="string")throw new Error("Unknown data type "+t);n=new Array(e)}return n}function J4(t,e){for(var n=0;n<t.length;n++){var r=t[n];if(isNaN(r)||!isFinite(r))throw Error("A tensor of type "+e+" being uploaded contains "+r+".")}}function Z4(t){return t==="bool"||t==="complex64"||t==="float32"||t==="int32"||t==="string"}function eL(t,e){return e!=="complex64"&&(e!=="float32"||t==="complex64")&&(e!=="int32"||t==="float32"||t==="complex64")&&(e!=="bool"||t!=="bool")}function Hr(t){return t instanceof Float32Array||t instanceof Int32Array||t instanceof Uint8Array}function UC(t){if(t==="float32"||t==="int32")return 4;if(t==="complex64")return 8;if(t==="bool")return 1;throw new Error("Unknown dtype "+t)}function tL(t){if(t==null)return 0;var e=0;return t.forEach(function(n){return e+=n.length}),e}function cy(t){return typeof t=="string"||t instanceof String}function nL(t){return typeof t=="boolean"}function rL(t){return typeof t=="number"}function Xl(t){return Array.isArray(t)?Xl(t[0]):t instanceof Float32Array?"float32":t instanceof Int32Array||t instanceof Uint8Array?"int32":rL(t)?"float32":cy(t)?"string":nL(t)?"bool":"float32"}function xm(t){return!!(t&&t.constructor&&t.call&&t.apply)}function bm(t,e){for(var n=e;n<t;++n)if(t%n==0)return n;return t}function Gr(t){var e=t.length;if(e<2)return[];var n=new Array(e-1);n[e-2]=t[e-1];for(var r=e-3;r>=0;--r)n[r]=n[r+1]*t[r+1];return n}function zC(t,e,n){if(e==="string")throw new Error("Cannot convert a string[] to a TypedArray");if(Array.isArray(t)&&(t=nu(t)),n&&J4(t,e),function(i,a){return i instanceof Float32Array&&a==="float32"||i instanceof Int32Array&&a==="int32"||i instanceof Uint8Array&&a==="bool"}(t,e))return t;if(e==null||e==="float32"||e==="complex64")return new Float32Array(t);if(e==="int32")return new Int32Array(t);if(e==="bool"){for(var r=new Uint8Array(t.length),o=0;o<r.length;++o)Math.round(t[o])!==0&&(r[o]=1);return r}throw new Error("Unknown data type "+e)}function jw(t,e){if(t.length===0)return e[0];var n=t.reduce(function(r,o){return r*o});if(n===0)return[];if(n!==e.length)throw new Error("["+t+"] does not match the input size.");return function r(o,i,a){var s=new Array;if(i.length===1)for(var u=i[0],l=0;l<u;l++)s[l]=a[o+l];else{u=i[0];var c=i.slice(1),d=c.reduce(function(f,h){return f*h});for(l=0;l<u;l++)s[l]=r(o+l*d,c,a)}return s}(0,t,e)}function VC(t,e){for(var n=Yl(t,e),r=0;r<n.length;r++)n[r]=1;return n}function Yl(t,e){if(e==null||e==="float32"||e==="complex64")return new Float32Array(t);if(e==="int32")return new Int32Array(t);if(e==="bool")return new Uint8Array(t);throw new Error("Unknown data type "+e)}function Fr(){return H().platform.now()}function HC(t){t.forEach(function(e){I(Number.isInteger(e)&&e>=0,function(){return"Tensor must have a shape comprised of positive integers but got shape ["+t+"]."})})}function oL(t,e){return e===void 0&&(e="utf-8"),e=e||"utf-8",H().platform.encode(t,e)}function Zd(t,e){return e===void 0&&(e="utf-8"),e=e||"utf-8",H().platform.decode(t,e)}function Ww(t,e,n){if(e===0)return 0;if(e===1)return t[0];for(var r=t[t.length-1],o=0;o<t.length-1;++o)r+=n[o]*t[o];return r}function iL(t,e,n){if(e===0)return[];if(e===1)return[t];for(var r=new Array(e),o=0;o<r.length-1;++o)r[o]=Math.floor(t/n[o]),t-=r[o]*n[o];return r[r.length-1]=t,r}var aL=function(){function t(e,n){this.backendTimer=e,this.logger=n,n==null&&(this.logger=new sL)}return t.prototype.profileKernel=function(e,n,r){var o,i=this,a=this.backendTimer.time(function(){o=r()});return o.forEach(function(s){s.data().then(function(u){(function(l,c,d){if(c!=="float32")return!1;for(var f=0;f<l.length;f++){var h=l[f];if(isNaN(h)||!isFinite(h))return console.warn("Found "+h+" in the result of '"+d+"'"),!0}})(u,s.dtype,e),a.then(function(l){var c="";l.getExtraProfileInfo!=null&&(c=l.getExtraProfileInfo()),i.logger.logKernelProfile(e,s,u,l.kernelMs,n,c)})})}),o},t}(),sL=function(){function t(){}return t.prototype.logKernelProfile=function(e,n,r,o,i,a){var s=typeof o=="number"?Ss(o+"ms",9):o.error,u=Ss(e,25),l=n.rank,c=n.size,d=Ss(n.shape.toString(),14),f="";for(var h in i){var v=i[h].shape||n.shape,p=v.length;f+=h+": "+p+"D "+(p>0?v:"")+" "}console.log("%c"+u+"	%c"+s+"	%c"+l+"D "+d+"	%c"+c+"	%c"+f+"	%c"+a,"font-weight:bold","color:red","color:blue","color: orange","color: green","color: steelblue")},t}(),Uw=20,Au=3,hp=7;function uL(t,e,n,r){var o=Gr(e),i=function(l,c,d,f){var h=se(c),v=f[f.length-1],p=new Array(v).fill(0),m=c.length,g=d==="complex64"?Du(l):l;if(m>1)for(var y=0;y<h/v;y++)for(var w=y*v,x=0;x<v;x++)p[x]=Math.max(p[x],Pu(g[w+x],0,d).length);return p}(t,e,n,o),a=e.length,s=function l(c,d,f,h,v,p){p===void 0&&(p=!0);var m=f==="complex64"?2:1,g=d[0],y=d.length;if(y===0)return f==="complex64"?[Pu(Du(c)[0],0,f)]:f==="bool"?[GC(c[0])]:[c[0].toString()];if(y===1){if(g>Uw){var w=Au*m,x=Array.from(c.slice(0,w)),b=Array.from(c.slice((g-Au)*m,g*m));return f==="complex64"&&(x=Du(x),b=Du(b)),["["+x.map(function(j,W){return Pu(j,v[W],f)}).join(", ")+", ..., "+b.map(function(j,W){return Pu(j,v[g-Au+W],f)}).join(", ")+"]"]}return["["+(f==="complex64"?Du(c):Array.from(c)).map(function(j,W){return Pu(j,v[W],f)}).join(", ")+"]"]}var _=d.slice(1),E=h.slice(1),C=h[0]*m,R=[];if(g>Uw){for(var S=0;S<Au;S++){var P=(A=S*C)+C;R.push.apply(R,l(c.slice(A,P),_,f,E,v,!1))}for(R.push("..."),S=g-Au;S<g;S++)P=(A=S*C)+C,R.push.apply(R,l(c.slice(A,P),_,f,E,v,S===g-1))}else for(S=0;S<g;S++){var A;P=(A=S*C)+C,R.push.apply(R,l(c.slice(A,P),_,f,E,v,S===g-1))}var B=y===2?",":"";for(R[0]="["+R[0]+B,S=1;S<R.length-1;S++)R[S]=" "+R[S]+B;var M=`,
`;for(S=2;S<y;S++)M+=`
`;return R[R.length-1]=" "+R[R.length-1]+"]"+(p?"":M),R}(t,e,n,o,i),u=["Tensor"];return r&&(u.push("  dtype: "+n),u.push("  rank: "+a),u.push("  shape: ["+e+"]"),u.push("  values:")),u.push(s.map(function(l){return"    "+l}).join(`
`)),u.join(`
`)}function Pu(t,e,n){return Ss(Array.isArray(t)?parseFloat(t[0].toFixed(hp))+" + "+parseFloat(t[1].toFixed(hp))+"j":cy(t)?"'"+t+"'":n==="bool"?GC(t):parseFloat(t.toFixed(hp)).toString(),e)}function GC(t){return t===0?"false":"true"}function Du(t){for(var e=[],n=0;n<t.length;n+=2)e.push([t[n],t[n+1]]);return e}var Rl=function(){function t(e,n,r){var o=this;if(this.dtype=n,this.shape=e.slice(),this.size=se(e),r!=null){var i=r.length;I(i===this.size,function(){return"Length of values '"+i+"' does not match the size inferred by the shape '"+o.size+"'."})}if(n==="complex64")throw new Error("complex64 dtype TensorBuffers are not supported. Please create a TensorBuffer for the real and imaginary parts separately and call tf.complex(real, imag).");this.values=r||Jd(n,this.size),this.strides=Gr(e)}return t.prototype.set=function(e){for(var n=this,r=[],o=1;o<arguments.length;o++)r[o-1]=arguments[o];r.length===0&&(r=[0]),I(r.length===this.rank,function(){return"The number of provided coordinates ("+r.length+") must match the rank ("+n.rank+")"});var i=this.locToIndex(r);this.values[i]=e},t.prototype.get=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];e.length===0&&(e=[0]);for(var r=0,o=0,i=e;o<i.length;o++){var a=i[o];if(a<0||a>=this.shape[r]){var s="Requested out of range element at "+e+".   Buffer shape="+this.shape;throw new Error(s)}r++}for(var u=e[e.length-1],l=0;l<e.length-1;++l)u+=this.strides[l]*e[l];return this.values[u]},t.prototype.locToIndex=function(e){if(this.rank===0)return 0;if(this.rank===1)return e[0];for(var n=e[e.length-1],r=0;r<e.length-1;++r)n+=this.strides[r]*e[r];return n},t.prototype.indexToLoc=function(e){if(this.rank===0)return[];if(this.rank===1)return[e];for(var n=new Array(this.shape.length),r=0;r<n.length-1;++r)n[r]=Math.floor(e/this.strides[r]),e-=n[r]*this.strides[r];return n[n.length-1]=e,n},Object.defineProperty(t.prototype,"rank",{get:function(){return this.shape.length},enumerable:!0,configurable:!0}),t.prototype.toTensor=function(){return Br().makeTensor(this.values,this.shape,this.dtype)},t}(),Br=null,V=null,qC=null,nt=function(){function t(e,n,r,o){this.kept=!1,this.isDisposedInternal=!1,this.shape=e.slice(),this.dtype=n||"float32",this.size=se(e),this.strides=Gr(e),this.dataId=r,this.id=o,this.rankType=this.rank<5?this.rank.toString():"higher"}return t.prototype.flatten=function(){return this.throwIfDisposed(),this.as1D()},t.prototype.asScalar=function(){return this.throwIfDisposed(),I(this.size===1,function(){return"The array must have only 1 element."}),this.reshape([])},t.prototype.as1D=function(){return this.throwIfDisposed(),this.reshape([this.size])},t.prototype.as2D=function(e,n){return this.throwIfDisposed(),this.reshape([e,n])},t.prototype.as3D=function(e,n,r){return this.throwIfDisposed(),this.reshape([e,n,r])},t.prototype.as4D=function(e,n,r,o){return this.throwIfDisposed(),this.reshape([e,n,r,o])},t.prototype.as5D=function(e,n,r,o,i){return this.throwIfDisposed(),this.reshape([e,n,r,o,i])},t.prototype.asType=function(e){return this.throwIfDisposed(),V.cast(this,e)},Object.defineProperty(t.prototype,"rank",{get:function(){return this.shape.length},enumerable:!0,configurable:!0}),t.prototype.buffer=function(){return ie(this,void 0,void 0,function(){var e;return ae(this,function(n){switch(n.label){case 0:return[4,this.data()];case 1:return e=n.sent(),[2,V.buffer(this.shape,this.dtype,e)]}})})},t.prototype.bufferSync=function(){return V.buffer(this.shape,this.dtype,this.dataSync())},t.prototype.array=function(){return ie(this,void 0,void 0,function(){var e;return ae(this,function(n){switch(n.label){case 0:return[4,this.data()];case 1:return e=n.sent(),[2,jw(this.shape,e)]}})})},t.prototype.arraySync=function(){return jw(this.shape,this.dataSync())},t.prototype.data=function(){return ie(this,void 0,void 0,function(){var e,n;return ae(this,function(r){switch(r.label){case 0:return this.throwIfDisposed(),e=Br().read(this.dataId),this.dtype!=="string"?[3,2]:[4,e];case 1:n=r.sent();try{return[2,n.map(function(o){return Zd(o)})]}catch{throw new Error("Failed to decode the string bytes into utf-8. To get the original bytes, call tensor.bytes().")}r.label=2;case 2:return[2,e]}})})},t.prototype.dataSync=function(){this.throwIfDisposed();var e=Br().readSync(this.dataId);if(this.dtype==="string")try{return e.map(function(n){return Zd(n)})}catch{throw new Error("Failed to decode the string bytes into utf-8. To get the original bytes, call tensor.bytes().")}return e},t.prototype.bytes=function(){return ie(this,void 0,void 0,function(){var e;return ae(this,function(n){switch(n.label){case 0:return this.throwIfDisposed(),[4,Br().read(this.dataId)];case 1:return e=n.sent(),this.dtype==="string"?[2,e]:[2,new Uint8Array(e.buffer)]}})})},t.prototype.dispose=function(){this.isDisposed||(Br().disposeTensor(this),this.isDisposedInternal=!0)},Object.defineProperty(t.prototype,"isDisposed",{get:function(){return this.isDisposedInternal},enumerable:!0,configurable:!0}),t.prototype.throwIfDisposed=function(){if(this.isDisposed)throw new Error("Tensor is disposed.")},t.prototype.toFloat=function(){return this.asType("float32")},t.prototype.toInt=function(){return this.asType("int32")},t.prototype.toBool=function(){return this.asType("bool")},t.prototype.print=function(e){return e===void 0&&(e=!1),V.print(this,e)},t.prototype.reshape=function(e){return this.throwIfDisposed(),V.reshape(this,e)},t.prototype.reshapeAs=function(e){return this.throwIfDisposed(),this.reshape(e.shape)},t.prototype.expandDims=function(e){return e===void 0&&(e=0),V.expandDims(this,e)},t.prototype.cumsum=function(e,n,r){return e===void 0&&(e=0),n===void 0&&(n=!1),r===void 0&&(r=!1),V.cumsum(this,e,n,r)},t.prototype.squeeze=function(e){return this.throwIfDisposed(),V.squeeze(this,e)},t.prototype.clone=function(){return this.throwIfDisposed(),V.clone(this)},t.prototype.oneHot=function(e,n,r){return this.throwIfDisposed(),V.oneHot(this,e,n,r)},t.prototype.toString=function(e){return e===void 0&&(e=!1),uL(this.dataSync(),this.shape,this.dtype,e)},t.prototype.tile=function(e){return this.throwIfDisposed(),V.tile(this,e)},t.prototype.gather=function(e,n){return n===void 0&&(n=0),this.throwIfDisposed(),V.gather(this,e,n)},t.prototype.matMul=function(e,n,r){return n===void 0&&(n=!1),r===void 0&&(r=!1),this.throwIfDisposed(),V.matMul(this,e,n,r)},t.prototype.dot=function(e){return this.throwIfDisposed(),V.dot(this,e)},t.prototype.norm=function(e,n,r){return e===void 0&&(e="euclidean"),n===void 0&&(n=null),r===void 0&&(r=!1),this.throwIfDisposed(),V.norm(this,e,n,r)},t.prototype.slice=function(e,n){return this.throwIfDisposed(),V.slice(this,e,n)},t.prototype.reverse=function(e){return this.throwIfDisposed(),V.reverse(this,e)},t.prototype.concat=function(e,n){return n===void 0&&(n=0),this.throwIfDisposed(),e instanceof t&&(e=[e]),V.concat([this].concat(e),n)},t.prototype.split=function(e,n){return n===void 0&&(n=0),this.throwIfDisposed(),V.split(this,e,n)},t.prototype.stack=function(e,n){return n===void 0&&(n=0),V.stack([this,e],n)},t.prototype.unstack=function(e){return e===void 0&&(e=0),V.unstack(this,e)},t.prototype.pad=function(e,n){return n===void 0&&(n=0),V.pad(this,e,n)},t.prototype.batchNormalization=function(e,n,r,o,i){return r===void 0&&(r=.001),qC("tf.batchNormalization() is going away. Use tf.batchNorm() instead, and note the positional argument change of scale, offset, and varianceEpsilon"),this.batchNorm(e,n,i,o,r)},t.prototype.batchNorm=function(e,n,r,o,i){return i===void 0&&(i=.001),this.throwIfDisposed(),V.batchNorm(this,e,n,r,o,i)},t.prototype.all=function(e,n){return e===void 0&&(e=null),n===void 0&&(n=!1),this.throwIfDisposed(),V.all(this,e,n)},t.prototype.any=function(e,n){return e===void 0&&(e=null),n===void 0&&(n=!1),this.throwIfDisposed(),V.any(this,e,n)},t.prototype.logSumExp=function(e,n){return e===void 0&&(e=null),n===void 0&&(n=!1),this.throwIfDisposed(),V.logSumExp(this,e,n)},t.prototype.sum=function(e,n){return e===void 0&&(e=null),n===void 0&&(n=!1),this.throwIfDisposed(),V.sum(this,e,n)},t.prototype.prod=function(e,n){return e===void 0&&(e=null),n===void 0&&(n=!1),this.throwIfDisposed(),V.prod(this,e,n)},t.prototype.mean=function(e,n){return e===void 0&&(e=null),n===void 0&&(n=!1),this.throwIfDisposed(),V.mean(this,e,n)},t.prototype.min=function(e,n){return e===void 0&&(e=null),n===void 0&&(n=!1),this.throwIfDisposed(),V.min(this,e,n)},t.prototype.max=function(e,n){return e===void 0&&(e=null),n===void 0&&(n=!1),this.throwIfDisposed(),V.max(this,e,n)},t.prototype.argMin=function(e){return e===void 0&&(e=null),this.throwIfDisposed(),V.argMin(this,e)},t.prototype.argMax=function(e){return e===void 0&&(e=null),this.throwIfDisposed(),V.argMax(this,e)},t.prototype.cast=function(e){return this.throwIfDisposed(),V.cast(this,e)},t.prototype.add=function(e){return this.throwIfDisposed(),V.add(this,e)},t.prototype.addStrict=function(e){return this.throwIfDisposed(),V.addStrict(this,e)},t.prototype.atan2=function(e){return this.throwIfDisposed(),V.atan2(this,e)},t.prototype.sub=function(e){return this.throwIfDisposed(),V.sub(this,e)},t.prototype.subStrict=function(e){return this.throwIfDisposed(),V.subStrict(this,e)},t.prototype.pow=function(e){return this.throwIfDisposed(),V.pow(this,e)},t.prototype.powStrict=function(e){return this.throwIfDisposed(),V.powStrict(this,e)},t.prototype.mul=function(e){return this.throwIfDisposed(),V.mul(this,e)},t.prototype.mulStrict=function(e){return this.throwIfDisposed(),V.mulStrict(this,e)},t.prototype.div=function(e){return this.throwIfDisposed(),V.div(this,e)},t.prototype.divNoNan=function(e){return this.throwIfDisposed(),V.divNoNan(this,e)},t.prototype.floorDiv=function(e){return this.throwIfDisposed(),V.floorDiv(this,e)},t.prototype.divStrict=function(e){return this.throwIfDisposed(),V.divStrict(this,e)},t.prototype.minimum=function(e){return this.throwIfDisposed(),V.minimum(this,e)},t.prototype.minimumStrict=function(e){return this.throwIfDisposed(),V.minimumStrict(this,e)},t.prototype.maximum=function(e){return this.throwIfDisposed(),V.maximum(this,e)},t.prototype.maximumStrict=function(e){return this.throwIfDisposed(),V.maximumStrict(this,e)},t.prototype.mod=function(e){return this.throwIfDisposed(),V.mod(this,e)},t.prototype.modStrict=function(e){return this.throwIfDisposed(),V.modStrict(this,e)},t.prototype.squaredDifferenceStrict=function(e){return this.throwIfDisposed(),V.squaredDifferenceStrict(this,e)},t.prototype.transpose=function(e){return this.throwIfDisposed(),V.transpose(this,e)},t.prototype.notEqual=function(e){return this.throwIfDisposed(),V.notEqual(this,e)},t.prototype.notEqualStrict=function(e){return this.throwIfDisposed(),V.notEqualStrict(this,e)},t.prototype.less=function(e){return this.throwIfDisposed(),V.less(this,e)},t.prototype.lessStrict=function(e){return this.throwIfDisposed(),V.lessStrict(this,e)},t.prototype.equal=function(e){return this.throwIfDisposed(),V.equal(this,e)},t.prototype.equalStrict=function(e){return this.throwIfDisposed(),V.equalStrict(this,e)},t.prototype.lessEqual=function(e){return this.throwIfDisposed(),V.lessEqual(this,e)},t.prototype.lessEqualStrict=function(e){return this.throwIfDisposed(),V.lessEqualStrict(this,e)},t.prototype.greater=function(e){return this.throwIfDisposed(),V.greater(this,e)},t.prototype.greaterStrict=function(e){return this.throwIfDisposed(),V.greaterStrict(this,e)},t.prototype.greaterEqual=function(e){return this.throwIfDisposed(),V.greaterEqual(this,e)},t.prototype.greaterEqualStrict=function(e){return this.throwIfDisposed(),V.greaterEqualStrict(this,e)},t.prototype.logicalAnd=function(e){return this.throwIfDisposed(),V.logicalAnd(this,e)},t.prototype.logicalOr=function(e){return this.throwIfDisposed(),V.logicalOr(this,e)},t.prototype.logicalNot=function(){return this.throwIfDisposed(),V.logicalNot(this)},t.prototype.logicalXor=function(e){return this.throwIfDisposed(),V.logicalXor(this,e)},t.prototype.where=function(e,n){return this.throwIfDisposed(),V.where(e,this,n)},t.prototype.neg=function(){return this.throwIfDisposed(),V.neg(this)},t.prototype.ceil=function(){return this.throwIfDisposed(),V.ceil(this)},t.prototype.floor=function(){return this.throwIfDisposed(),V.floor(this)},t.prototype.sign=function(){return this.throwIfDisposed(),V.sign(this)},t.prototype.isNaN=function(){return this.throwIfDisposed(),V.isNaN(this)},t.prototype.isInf=function(){return this.throwIfDisposed(),V.isInf(this)},t.prototype.isFinite=function(){return this.throwIfDisposed(),V.isFinite(this)},t.prototype.exp=function(){return this.throwIfDisposed(),V.exp(this)},t.prototype.expm1=function(){return this.throwIfDisposed(),V.expm1(this)},t.prototype.log=function(){return this.throwIfDisposed(),V.log(this)},t.prototype.log1p=function(){return this.throwIfDisposed(),V.log1p(this)},t.prototype.sqrt=function(){return this.throwIfDisposed(),V.sqrt(this)},t.prototype.rsqrt=function(){return this.throwIfDisposed(),V.rsqrt(this)},t.prototype.square=function(){return this.throwIfDisposed(),V.square(this)},t.prototype.reciprocal=function(){return this.throwIfDisposed(),V.reciprocal(this)},t.prototype.abs=function(){return this.throwIfDisposed(),V.abs(this)},t.prototype.clipByValue=function(e,n){return this.throwIfDisposed(),V.clipByValue(this,e,n)},t.prototype.relu=function(){return this.throwIfDisposed(),V.relu(this)},t.prototype.relu6=function(){return this.throwIfDisposed(),V.relu6(this)},t.prototype.elu=function(){return this.throwIfDisposed(),V.elu(this)},t.prototype.selu=function(){return this.throwIfDisposed(),V.selu(this)},t.prototype.leakyRelu=function(e){return e===void 0&&(e=.2),this.throwIfDisposed(),V.leakyRelu(this,e)},t.prototype.prelu=function(e){return this.throwIfDisposed(),V.prelu(this,e)},t.prototype.sigmoid=function(){return this.throwIfDisposed(),V.sigmoid(this)},t.prototype.logSigmoid=function(){return this.throwIfDisposed(),V.logSigmoid(this)},t.prototype.softplus=function(){return this.throwIfDisposed(),V.softplus(this)},t.prototype.zerosLike=function(){return this.throwIfDisposed(),V.zerosLike(this)},t.prototype.onesLike=function(){return this.throwIfDisposed(),V.onesLike(this)},t.prototype.sin=function(){return this.throwIfDisposed(),V.sin(this)},t.prototype.cos=function(){return this.throwIfDisposed(),V.cos(this)},t.prototype.tan=function(){return this.throwIfDisposed(),V.tan(this)},t.prototype.asin=function(){return this.throwIfDisposed(),V.asin(this)},t.prototype.acos=function(){return this.throwIfDisposed(),V.acos(this)},t.prototype.atan=function(){return this.throwIfDisposed(),V.atan(this)},t.prototype.sinh=function(){return this.throwIfDisposed(),V.sinh(this)},t.prototype.cosh=function(){return this.throwIfDisposed(),V.cosh(this)},t.prototype.tanh=function(){return this.throwIfDisposed(),V.tanh(this)},t.prototype.asinh=function(){return this.throwIfDisposed(),V.asinh(this)},t.prototype.acosh=function(){return this.throwIfDisposed(),V.acosh(this)},t.prototype.atanh=function(){return this.throwIfDisposed(),V.atanh(this)},t.prototype.erf=function(){return this.throwIfDisposed(),V.erf(this)},t.prototype.round=function(){return this.throwIfDisposed(),V.round(this)},t.prototype.step=function(e){return e===void 0&&(e=0),this.throwIfDisposed(),V.step(this,e)},t.prototype.softmax=function(e){return e===void 0&&(e=-1),this.throwIfDisposed(),V.softmax(this,e)},t.prototype.logSoftmax=function(e){return e===void 0&&(e=-1),this.throwIfDisposed(),V.logSoftmax(this,e)},t.prototype.resizeBilinear=function(e,n){return n===void 0&&(n=!1),this.throwIfDisposed(),V.image.resizeBilinear(this,e,n)},t.prototype.resizeNearestNeighbor=function(e,n){return n===void 0&&(n=!1),this.throwIfDisposed(),V.image.resizeNearestNeighbor(this,e,n)},t.prototype.conv1d=function(e,n,r,o,i,a){return o===void 0&&(o="NWC"),i===void 0&&(i=1),this.throwIfDisposed(),V.conv1d(this,e,n,r,o,i,a)},t.prototype.conv2d=function(e,n,r,o,i,a){return o===void 0&&(o="NHWC"),i===void 0&&(i=[1,1]),this.throwIfDisposed(),V.conv2d(this,e,n,r,o,i,a)},t.prototype.conv2dTranspose=function(e,n,r,o,i){return this.throwIfDisposed(),V.conv2dTranspose(this,e,n,r,o,i)},t.prototype.depthwiseConv2D=function(e,n,r,o,i,a){return o===void 0&&(o="NHWC"),i===void 0&&(i=[1,1]),this.throwIfDisposed(),V.depthwiseConv2d(this,e,n,r,o,i,a)},t.prototype.separableConv2d=function(e,n,r,o,i,a){return i===void 0&&(i=[1,1]),a===void 0&&(a="NHWC"),this.throwIfDisposed(),V.separableConv2d(this,e,n,r,o,i,a)},t.prototype.avgPool=function(e,n,r,o){return this.throwIfDisposed(),V.avgPool(this,e,n,r,o)},t.prototype.maxPool=function(e,n,r,o){return this.throwIfDisposed(),V.maxPool(this,e,n,r,o)},t.prototype.localResponseNormalization=function(e,n,r,o){return e===void 0&&(e=5),n===void 0&&(n=1),r===void 0&&(r=1),o===void 0&&(o=.5),V.localResponseNormalization(this,e,n,r,o)},t.prototype.pool=function(e,n,r,o,i){return this.throwIfDisposed(),V.pool(this,e,n,r,o,i)},t.prototype.variable=function(e,n,r){return e===void 0&&(e=!0),this.throwIfDisposed(),Br().makeVariable(this,e,n,r)},t.prototype.unsortedSegmentSum=function(e,n){return this.throwIfDisposed(),V.unsortedSegmentSum(this,e,n)},t.prototype.batchToSpaceND=function(e,n){return this.throwIfDisposed(),V.batchToSpaceND(this,e,n)},t.prototype.spaceToBatchND=function(e,n){return this.throwIfDisposed(),V.spaceToBatchND(this,e,n)},t.prototype.topk=function(e,n){return e===void 0&&(e=1),n===void 0&&(n=!0),this.throwIfDisposed(),V.topk(this,e,n)},t.prototype.stridedSlice=function(e,n,r,o,i,a,s,u){return o===void 0&&(o=0),i===void 0&&(i=0),a===void 0&&(a=0),s===void 0&&(s=0),u===void 0&&(u=0),this.throwIfDisposed(),V.stridedSlice(this,e,n,r,o,i,a,s,u)},t.prototype.depthToSpace=function(e,n){return this.throwIfDisposed(),V.depthToSpace(this,e,n)},t.prototype.fft=function(){return this.throwIfDisposed(),V.spectral.fft(this)},t.prototype.ifft=function(){return this.throwIfDisposed(),V.spectral.ifft(this)},t.prototype.rfft=function(){return this.throwIfDisposed(),V.spectral.rfft(this)},t.prototype.irfft=function(){return this.throwIfDisposed(),V.spectral.irfft(this)},t}();Object.defineProperty(nt,Symbol.hasInstance,{value:function(t){return!!t&&t.dataId!=null&&t.shape!=null&&t.dtype!=null}});var zw,_m,Em,Cm,Sm,ru=function(t){function e(n,r,o,i){var a=t.call(this,n.shape,n.dtype,n.dataId,i)||this;return a.trainable=r,a.name=o,a}return Cr(e,t),e.prototype.assign=function(n){if(n.dtype!==this.dtype)throw new Error("dtype of the new value ("+n.dtype+") and previous value ("+this.dtype+") must match");if(!At(n.shape,this.shape))throw new Error("shape of the new value ("+n.shape+") and previous value ("+this.shape+") must match");Br().disposeTensor(this),this.dataId=n.dataId,Br().incRef(this,null)},e.prototype.dispose=function(){Br().disposeVariable(this),this.isDisposedInternal=!0},e}(nt);Object.defineProperty(ru,Symbol.hasInstance,{value:function(t){return t instanceof nt&&t.assign!=null&&t.assign instanceof Function}}),function(t){t.R0="R0",t.R1="R1",t.R2="R2",t.R3="R3",t.R4="R4",t.R5="R5",t.R6="R6"}(zw||(zw={})),function(t){t.float32="float32",t.int32="int32",t.bool="int32",t.complex64="complex64"}(_m||(_m={})),function(t){t.float32="float32",t.int32="int32",t.bool="bool",t.complex64="complex64"}(Em||(Em={})),function(t){t.float32="float32",t.int32="float32",t.bool="float32",t.complex64="complex64"}(Cm||(Cm={})),function(t){t.float32="complex64",t.int32="complex64",t.bool="complex64",t.complex64="complex64"}(Sm||(Sm={}));var lL={float32:Cm,int32:_m,bool:Em,complex64:Sm};function Mt(t,e){if(t==="string"||e==="string"){if(t==="string"&&e==="string")return"string";throw new Error("Can not upcast "+t+" with "+e)}return lL[t][e]}function pp(t){return Mt(t,"int32")}function at(t,e){if(t.dtype===e.dtype)return[t,e];var n=Mt(t.dtype,e.dtype);return[t.cast(n),e.cast(n)]}function cL(t,e){I(t.dtype===e.dtype,function(){return"The dtypes of the first("+t.dtype+") and second("+e.dtype+") input must match"})}function KC(t){var e=[];return function n(r,o,i){if(r!=null){if(r instanceof nt)return void o.push(r);if(a=r,!(!Array.isArray(a)&&typeof a!="object")){var a,s=r;for(var u in s){var l=s[u];i.has(l)||(i.add(l),n(l,o,i))}}}}(t,e,new Set),e}var vp,Vw=function(){function t(){this.registeredVariables={},this.nextTapeNodeId=0,this.numBytes=0,this.numTensors=0,this.numStringTensors=0,this.numDataBuffers=0,this.gradientDepth=0,this.kernelDepth=0,this.scopeStack=[],this.numDataMovesStack=[],this.nextScopeId=0,this.tensorInfo=new WeakMap,this.profiling=!1,this.activeProfile={newBytes:0,newTensors:0,peakBytes:0,kernels:[],result:null}}return t.prototype.dispose=function(){for(var e in this.registeredVariables)this.registeredVariables[e].dispose()},t}(),dL=function(){function t(e){this.ENV=e,this.registry={},this.registryFactory={},this.pendingBackendInitId=0,this.state=new Vw}return t.prototype.ready=function(){return ie(this,void 0,void 0,function(){var e,n,r;return ae(this,function(o){switch(o.label){case 0:if(this.pendingBackendInit!=null)return[2,this.pendingBackendInit.then(function(){})];if(this.backendInstance!=null)return[2];e=this.getSortedBackends(),n=0,o.label=1;case 1:return n<e.length?(r=e[n],[4,this.initializeBackend(r).success]):[3,5];case 2:return o.sent()?[4,this.setBackend(r)]:[3,4];case 3:return o.sent(),[2];case 4:return n++,[3,1];case 5:throw new Error("Could not initialize any backends, all backend initializations failed.")}})})},Object.defineProperty(t.prototype,"backend",{get:function(){if(this.pendingBackendInit!=null)throw new Error("Backend '"+this.backendName+"' has not yet been initialized. Make sure to await tf.ready() or await tf.setBackend() before calling other methods");if(this.backendInstance==null){var e=this.initializeBackendsAndReturnBest(),n=e.name;if(e.asyncInit)throw new Error("The highest priority backend '"+n+"' has not yet been initialized. Make sure to await tf.ready() or await tf.setBackend() before calling other methods");this.setBackend(n)}return this.backendInstance},enumerable:!0,configurable:!0}),t.prototype.backendNames=function(){return Object.keys(this.registryFactory)},t.prototype.findBackend=function(e){return!(e in this.registry)&&(!(e in this.registryFactory)||this.initializeBackend(e).asyncInit)?null:this.registry[e]},t.prototype.findBackendFactory=function(e){return e in this.registryFactory?this.registryFactory[e].factory:null},t.prototype.registerBackend=function(e,n,r){return r===void 0&&(r=1),e in this.registryFactory?(console.warn(e+" backend was already registered. Reusing existing backend factory."),!1):(this.registryFactory[e]={factory:n,priority:r},!0)},t.prototype.setBackend=function(e){return ie(this,void 0,void 0,function(){var n,r,o;return ae(this,function(i){switch(i.label){case 0:if(this.registryFactory[e]==null)throw new Error("Backend name '"+e+"' not found in registry");return this.backendName=e,this.registry[e]!=null?[3,4]:(this.backendInstance=null,n=this.initializeBackend(e),r=n.success,n.asyncInit?[4,r]:[3,2]);case 1:return o=i.sent(),[3,3];case 2:o=r,i.label=3;case 3:if(!o)return[2,!1];i.label=4;case 4:return this.backendInstance=this.registry[e],this.setupRegisteredKernels(),this.profiler=new aL(this.backendInstance),[2,!0]}})})},t.prototype.setupRegisteredKernels=function(){var e=this;Bw(this.backendName).forEach(function(n){n.setupFunc!=null&&n.setupFunc(e.backendInstance)})},t.prototype.disposeRegisteredKernels=function(e){var n=this;Bw(e).forEach(function(r){r.disposeFunc!=null&&r.disposeFunc(n.registry[e])})},t.prototype.initializeBackend=function(e){var n=this,r=this.registryFactory[e];if(r==null)throw new Error("Cannot initialize backend "+e+", no registration found.");try{var o=r.factory();if(Promise.resolve(o)===o){var i=++this.pendingBackendInitId,a=o.then(function(s){return!(i<n.pendingBackendInitId)&&(n.registry[e]=s,n.pendingBackendInit=null,!0)}).catch(function(s){return!(i<n.pendingBackendInitId)&&(n.pendingBackendInit=null,console.warn("Initialization of backend "+e+" failed"),console.warn(s.stack||s.message),!1)});return this.pendingBackendInit=a,{success:a,asyncInit:!0}}return this.registry[e]=o,{success:!0,asyncInit:!1}}catch(s){return console.warn("Initialization of backend "+e+" failed"),console.warn(s.stack||s.message),{success:!1,asyncInit:!1}}},t.prototype.removeBackend=function(e){if(!(e in this.registryFactory))throw new Error(e+" backend not found in registry");this.backendName===e&&this.pendingBackendInit!=null&&this.pendingBackendInitId++,e in this.registry&&(this.disposeRegisteredKernels(e),this.registry[e].dispose(),delete this.registry[e]),delete this.registryFactory[e],this.backendName===e&&(this.pendingBackendInit=null,this.backendName=null,this.backendInstance=null)},t.prototype.getSortedBackends=function(){var e=this;if(Object.keys(this.registryFactory).length===0)throw new Error("No backend found in registry.");return Object.keys(this.registryFactory).sort(function(n,r){return e.registryFactory[r].priority-e.registryFactory[n].priority})},t.prototype.initializeBackendsAndReturnBest=function(){for(var e=this.getSortedBackends(),n=0;n<e.length;n++){var r=e[n],o=this.initializeBackend(r),i=o.success,a=o.asyncInit;if(a||i)return{name:r,asyncInit:a}}throw new Error("Could not initialize any backends, all backend initializations failed.")},t.prototype.moveData=function(e,n){var r=this.state.tensorInfo.get(n),o=r.backend,i=this.readSync(n);o.disposeData(n),r.backend=e,e.move(n,i,r.shape,r.dtype),this.shouldCheckForMemLeaks()&&this.state.numDataMovesStack[this.state.numDataMovesStack.length-1]++},t.prototype.tidy=function(e,n){var r,o=this,i=null;if(n==null){if(typeof e!="function")throw new Error("Please provide a function to tidy()");n=e}else{if(typeof e!="string"&&!(e instanceof String))throw new Error("When calling with two arguments, the first argument to tidy() must be a string");if(typeof n!="function")throw new Error("When calling with two arguments, the 2nd argument to tidy() must be a function");i=e}return this.scopedRun(function(){return o.startScope(i)},function(){return o.endScope(r)},function(){return(r=n())instanceof Promise&&console.error("Cannot return a Promise inside of tidy."),r})},t.prototype.scopedRun=function(e,n,r){e();try{var o=r();return n(),o}catch(i){throw n(),i}},t.prototype.nextTensorId=function(){return t.nextTensorId++},t.prototype.nextVariableId=function(){return t.nextVariableId++},t.prototype.clone=function(e){var n=this.makeTensorFromDataId(e.dataId,e.shape,e.dtype),r={x:e};return this.addTapeNode(this.state.activeScope.name,r,[n],function(o){return{x:function(){return o.toFloat()}}},[]),n},t.prototype.runKernel=function(e,n,r,o,i){return this.runKernelFunc(null,n,null,e,r,o,i)},t.prototype.shouldCheckForMemLeaks=function(){return this.ENV.getBool("IS_TEST")},t.prototype.checkKernelForMemLeak=function(e,n,r){var o=this.backend.numDataIds(),i=0;r.forEach(function(u){i+=u.dtype==="complex64"?3:1});var a=this.state.numDataMovesStack[this.state.numDataMovesStack.length-1],s=o-n-i-a;if(s>0)throw new Error("Backend '"+this.backendName+"' has an internal memory leak ("+s+" data ids) after running '"+e+"'")},t.prototype.runKernelFunc=function(e,n,r,o,i,a,s){var u,l=this;a===void 0&&(a=[]),s===void 0&&(s=[]);var c=[],d=this.isTapeOn();o==null&&(o=this.state.activeScope!=null?this.state.activeScope.name:"");var f,h=function(y){d&&(c=y.map(function(w){return l.keep(l.clone(w))}))},v=this.state.numBytes,p=this.state.numTensors;this.shouldCheckForMemLeaks()&&this.state.numDataMovesStack.push(0);var m,g=BC(o,this.backendName);return f=g!=null?function(){var y=l.backend.numDataIds();m=g.kernelFunc({inputs:n,attrs:i,backend:l.backend});var w=Array.isArray(m)?m:[m];l.shouldCheckForMemLeaks()&&l.checkKernelForMemLeak(o,y,w);var x=w.map(function(_){var E=_.dataId,C=_.shape,R=_.dtype;return l.makeTensorFromDataId(E,C,R)}),b=x.filter(function(_,E){return s[E]});return h((a||[]).slice().concat(b)),x}:function(){var y=l.backend.numDataIds();m=l.tidy(function(){return e(l.backend,h)});var w=Array.isArray(m)?m:[m];return l.shouldCheckForMemLeaks()&&l.checkKernelForMemLeak(o,y,w),w},this.scopedRun(function(){return l.state.kernelDepth++},function(){return l.state.kernelDepth--},function(){u=l.ENV.getBool("DEBUG")?l.profiler.profileKernel(o,n,function(){return f()}):f()}),d&&this.addTapeNode(o,n,u,r,c),this.state.profiling&&this.state.activeProfile.kernels.push({name:o,bytesAdded:this.state.numBytes-v,totalBytesSnapshot:this.state.numBytes,tensorsAdded:this.state.numTensors-p,totalTensorsSnapshot:this.state.numTensors,inputShapes:Object.keys(n).map(function(y){return n[y].shape}),outputShapes:u.map(function(y){return y.shape})}),Array.isArray(m)?u:u[0]},t.prototype.makeTensor=function(e,n,r,o){if(e==null)throw new Error("Values passed to engine.makeTensor() are null");r=r||"float32",o=o||this.backend;var i=e;r==="string"&&cy(e[0])&&(i=e.map(function(c){return oL(c)}));var a=o.write(i,n,r),s=new nt(n,r,a,this.nextTensorId());if(this.incRef(s,o),r==="string"){var u=this.state.tensorInfo.get(a),l=tL(i);this.state.numBytes+=l-u.bytes,u.bytes=l}return s},t.prototype.makeTensorFromDataId=function(e,n,r,o){var i=new nt(n,r=r||"float32",e,this.nextTensorId());return this.incRef(i,o),i},t.prototype.makeVariable=function(e,n,r,o){n===void 0&&(n=!0),r=r||this.nextVariableId().toString(),o!=null&&o!==e.dtype&&(e=e.asType(o));var i=new ru(e,n,r,this.nextTensorId());if(this.state.registeredVariables[i.name]!=null)throw new Error("Variable with name "+i.name+" was already registered");return this.state.registeredVariables[i.name]=i,this.incRef(i,this.backend),i},t.prototype.incRef=function(e,n){var r=this.state.tensorInfo.has(e.dataId)?this.state.tensorInfo.get(e.dataId).refCount:0;if(this.state.numTensors++,e.dtype==="string"&&this.state.numStringTensors++,r===0){this.state.numDataBuffers++;var o=0;e.dtype!=="complex64"&&e.dtype!=="string"&&(o=e.size*UC(e.dtype)),this.state.tensorInfo.set(e.dataId,{backend:n||this.backend,dtype:e.dtype,shape:e.shape,bytes:o,refCount:0}),this.state.numBytes+=o}this.state.tensorInfo.get(e.dataId).refCount++,e instanceof ru||this.track(e)},t.prototype.disposeTensor=function(e){if(this.state.tensorInfo.has(e.dataId)){this.state.numTensors--,e.dtype==="string"&&this.state.numStringTensors--;var n=this.state.tensorInfo.get(e.dataId);n.refCount<=1?(e.dtype!=="complex64"&&(this.state.numBytes-=n.bytes),this.state.numDataBuffers--,n.backend.disposeData(e.dataId),this.state.tensorInfo.delete(e.dataId)):this.state.tensorInfo.get(e.dataId).refCount--}},t.prototype.disposeVariables=function(){for(var e in this.state.registeredVariables){var n=this.state.registeredVariables[e];this.disposeVariable(n)}},t.prototype.disposeVariable=function(e){this.disposeTensor(e),this.state.registeredVariables[e.name]!=null&&delete this.state.registeredVariables[e.name]},t.prototype.memory=function(){var e=this.backend.memory();return e.numTensors=this.state.numTensors,e.numDataBuffers=this.state.numDataBuffers,e.numBytes=this.state.numBytes,this.state.numStringTensors>0&&(e.unreliable=!0,e.reasons==null&&(e.reasons=[]),e.reasons.push("Memory usage by string tensors is approximate (2 bytes per character)")),e},t.prototype.profile=function(e){return ie(this,void 0,void 0,function(){var n,r;return ae(this,function(o){return this.state.profiling=!0,n=this.state.numBytes,r=this.state.numTensors,this.state.activeProfile.kernels=[],this.state.activeProfile.result=e(),this.state.profiling=!1,this.state.activeProfile.peakBytes=Math.max.apply(Math,this.state.activeProfile.kernels.map(function(i){return i.totalBytesSnapshot})),this.state.activeProfile.newBytes=this.state.numBytes-n,this.state.activeProfile.newTensors=this.state.numTensors-r,[2,this.state.activeProfile]})})},t.prototype.isTapeOn=function(){return this.state.gradientDepth>0&&this.state.kernelDepth===0},t.prototype.addTapeNode=function(e,n,r,o,i){var a=this,s={id:this.state.nextTapeNodeId++,kernelName:e,inputs:n,outputs:r,saved:i},u=q4(e);u!=null&&(o=u.gradFunc),o!=null&&(s.gradient=function(l){return l=l.map(function(c,d){if(c==null){var f=r[d],h=Yl(f.size,f.dtype);return a.makeTensor(h,f.shape,f.dtype)}return c}),o(l.length>1?l:l[0],i)}),this.state.activeTape.push(s)},t.prototype.keep=function(e){return e.kept=!0,e},t.prototype.startTape=function(){this.state.gradientDepth===0&&(this.state.activeTape=[]),this.state.gradientDepth++},t.prototype.endTape=function(){this.state.gradientDepth--},t.prototype.startScope=function(e){var n={track:[],name:"unnamed scope",id:this.state.nextScopeId++};e&&(n.name=e),this.state.scopeStack.push(n),this.state.activeScope=n},t.prototype.endScope=function(e){for(var n=this,r=KC(e),o=new Set(r.map(function(u){return u.id})),i=0;i<this.state.activeScope.track.length;i++){var a=this.state.activeScope.track[i];a.kept||o.has(a.id)||a.dispose()}var s=this.state.scopeStack.pop();this.state.activeScope=this.state.scopeStack.length===0?null:this.state.scopeStack[this.state.scopeStack.length-1],r.forEach(function(u){u.kept||u.scopeId!==s.id||n.track(u)})},t.prototype.gradients=function(e,n,r,o){var i=this;if(o===void 0&&(o=!1),I(n.length>0,function(){return"gradients() received an empty list of xs."}),r!=null&&r.dtype!=="float32")throw new Error("dy must have 'float32' dtype, but has '"+r.dtype+"'");var a=this.scopedRun(function(){return i.startTape()},function(){return i.endTape()},function(){return i.tidy("forward",e)});I(a instanceof nt,function(){return"The result y returned by f() must be a tensor."});var s=function(u,l,c){for(var d={},f={},h=0;h<l.length;h++)d[l[h].id]=!0;for(h=0;h<u.length;h++){var v=(_=u[h]).inputs;for(var p in v){for(var m=v[p],g=!1,y=0;y<l.length;y++)if(d[m.id]){_.outputs.forEach(function(S){return d[S.id]=!0}),g=!0,f[_.id]=!0;break}if(g)break}}var w={};w[c.id]=!0;var x={};for(h=u.length-1;h>=0;h--)for(v=(_=u[h]).inputs,y=0;y<_.outputs.length;y++)if(w[_.outputs[y].id]){for(var p in v)w[v[p].id]=!0,x[_.id]=!0;break}var b=[];for(h=0;h<u.length;h++){var _;if(f[(_=u[h]).id]&&x[_.id]){var E={};for(var p in _.inputs){var C=_.inputs[p];d[C.id]&&(E[p]=C)}var R=Object.assign({},_);R.inputs=E,R.outputs=_.outputs,b.push(R)}}return b}(this.state.activeTape,n,a);if(!o&&s.length===0&&n.length>0)throw new Error("Cannot compute gradient of y=f(x) with respect to x. Make sure that the f you passed encloses all operations that lead from x to y.");return this.tidy("backward",function(){var u,l,c={};c[a.id]=r??(u=a.shape,l=VC(se(u),"float32"),L.makeTensor(l,u,"float32")),function(f,h,v){for(var p=function(g){var y=h[g],w=[];if(y.outputs.forEach(function(E){var C=f[E.id];C!=null?w.push(C):w.push(null)}),y.gradient==null)throw new Error("Cannot compute gradient: gradient function not found for "+y.kernelName+".");var x=y.gradient(w),b=function(E){if(!(E in x))throw new Error("Cannot backprop through input "+E+". Available gradients found: "+Object.keys(x)+".");var C=v(function(){return x[E]()});if(C.dtype!=="float32")throw new Error("Error in gradient for op "+y.kernelName+". The gradient of input "+E+" must have 'float32' dtype, but has '"+C.dtype+"'");var R=y.inputs[E];if(!At(C.shape,R.shape))throw new Error("Error in gradient for op "+y.kernelName+". The gradient of input '"+E+"' has shape '"+C.shape+"', which does not match the shape of the input '"+R.shape+"'");if(f[R.id]==null)f[R.id]=C;else{var S=f[R.id];f[R.id]=S.add(C),S.dispose()}};for(var _ in y.inputs)b(_)},m=h.length-1;m>=0;m--)p(m)}(c,s,function(f){return i.tidy(f)});var d=n.map(function(f){return c[f.id]});return i.state.gradientDepth===0&&(i.state.activeTape.forEach(function(f){for(var h=0,v=f.saved;h<v.length;h++)v[h].dispose()}),i.state.activeTape=null),{value:a,grads:d}})},t.prototype.customGrad=function(e){var n=this;return I(xm(e),function(){return"The f passed in customGrad(f) must be a function."}),function(){for(var r,o=[],i=0;i<arguments.length;i++)o[i]=arguments[i];I(o.every(function(s){return s instanceof nt}),function(){return"The args passed in customGrad(f)(x1, x2,...) must all be tensors"});var a={};return o.forEach(function(s,u){a[u]=s}),n.runKernelFunc(function(s,u){return I((r=e.apply(void 0,o.concat([u]))).value instanceof nt,function(){return"The function f passed in customGrad(f) must return an object where `obj.value` is a tensor"}),I(xm(r.gradFunc),function(){return"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function."}),r.value},a,function(s,u){var l=r.gradFunc(s,u),c=Array.isArray(l)?l:[l];I(c.length===o.length,function(){return"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function that returns the same number of tensors as inputs passed to f(...)."}),I(c.every(function(f){return f instanceof nt}),function(){return"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function that returns a list of only tensors."});var d={};return c.forEach(function(f,h){d[h]=function(){return f}}),d})}},t.prototype.readSync=function(e){return this.state.tensorInfo.get(e).backend.readSync(e)},t.prototype.read=function(e){return this.state.tensorInfo.get(e).backend.read(e)},t.prototype.time=function(e){return ie(this,void 0,void 0,function(){var n,r;return ae(this,function(o){switch(o.label){case 0:return n=Fr(),[4,this.backend.time(e)];case 1:return(r=o.sent()).wallMs=Fr()-n,[2,r]}})})},t.prototype.track=function(e){return this.state.activeScope!=null&&(e.scopeId=this.state.activeScope.id,this.state.activeScope.track.push(e)),e},Object.defineProperty(t.prototype,"registeredVariables",{get:function(){return this.state.registeredVariables},enumerable:!0,configurable:!0}),t.prototype.reset=function(){for(var e in this.pendingBackendInitId++,this.state.dispose(),this.ENV.reset(),this.state=new Vw,this.registry)this.disposeRegisteredKernels(e),this.registry[e].dispose(),delete this.registry[e];this.backendName=null,this.backendInstance=null,this.pendingBackendInit=null},t.nextTensorId=0,t.nextVariableId=0,t}(),L=function(){var t=function(){if(vp==null){var n=void 0;if(typeof window<"u")n=window;else if(typeof global<"u")n=global;else if(typeof process<"u")n=process;else{if(typeof self>"u")throw new Error("Could not find a global object");n=self}vp=n}return vp}();if(t._tfengine==null){var e=new H4(t);t._tfengine=new dL(e)}return function(n){LC=n}(t._tfengine.ENV),Br=function(){return t._tfengine},t._tfengine}();function XC(){return typeof window<"u"&&window.document!=null||typeof WorkerGlobalScope<"u"}var ro=H();ro.registerFlag("DEBUG",function(){return!1},function(t){t&&console.warn("Debugging mode is ON. The output of every math call will be downloaded to CPU and checked for NaNs. This significantly impacts performance.")}),ro.registerFlag("IS_BROWSER",function(){return XC()}),ro.registerFlag("IS_NODE",function(){return typeof process<"u"&&process.versions!==void 0&&process.versions.node!==void 0}),ro.registerFlag("IS_CHROME",function(){return typeof navigator<"u"&&navigator!=null&&navigator.userAgent!=null&&/Chrome/.test(navigator.userAgent)&&/Google Inc/.test(navigator.vendor)}),ro.registerFlag("PROD",function(){return!1}),ro.registerFlag("TENSORLIKE_CHECK_SHAPE_CONSISTENCY",function(){return ro.getBool("DEBUG")}),ro.registerFlag("DEPRECATION_WARNINGS_ENABLED",function(){return!0}),ro.registerFlag("IS_TEST",function(){return!1});var Tl,An,Tn,Ki={},mp={alpha:!1,antialias:!1,premultipliedAlpha:!1,preserveDrawingBuffer:!1,depth:!1,stencil:!1,failIfMajorPerformanceCaveat:!0};function fL(t,e){Ki[t]=e}function Qr(t){t in Ki||(Ki[t]=function(n){if(n!==1&&n!==2)throw new Error("Cannot get WebGL rendering context, WebGL is disabled.");var r=function(o){if(typeof OffscreenCanvas<"u"&&o===2)return new OffscreenCanvas(300,150);if(typeof document<"u")return document.createElement("canvas");throw new Error("Cannot create a canvas in this context")}(n);return r.addEventListener("webglcontextlost",function(o){o.preventDefault(),delete Ki[n]},!1),n===1?r.getContext("webgl",mp)||r.getContext("experimental-webgl",mp):r.getContext("webgl2",mp)}(t));var e=Ki[t];return e.isContextLost()?(delete Ki[t],Qr(t)):(e.disable(e.DEPTH_TEST),e.disable(e.STENCIL_TEST),e.disable(e.BLEND),e.disable(e.DITHER),e.disable(e.POLYGON_OFFSET_FILL),e.disable(e.SAMPLE_COVERAGE),e.enable(e.SCISSOR_TEST),e.enable(e.CULL_FACE),e.cullFace(e.BACK),Ki[t])}function th(t,e){return[e,t]}function Zu(t){var e=se(t);return wm(Math.ceil(e/4))}function Ql(t,e){return[Math.max(1,Math.ceil(e/2)),Math.max(1,Math.ceil(t/2))]}function dy(t,e){var n,r,o,i,a,s,u,l,c,d=t;return H().getNumber("WEBGL_VERSION")===2?(n=d.R32F,r=d.R16F,o=d.RGBA16F,i=d.RGBA32F,a=d.RED,s=4,u=1,l=d.HALF_FLOAT,c=d.FLOAT):(n=t.RGBA,r=t.RGBA,o=t.RGBA,i=d.RGBA,a=t.RGBA,s=4,u=4,l=e!=null?e.HALF_FLOAT_OES:null,c=t.FLOAT),{internalFormatFloat:n,internalFormatHalfFloat:r,internalFormatPackedHalfFloat:o,internalFormatPackedFloat:i,textureFormatFloat:a,downloadTextureFormat:t.RGBA,downloadUnpackNumChannels:s,defaultNumChannels:u,textureTypeHalfFloat:l,textureTypeFloat:c}}function le(t,e,n){var r=n();return e&&function(o){var i=o.getError();if(i!==o.NO_ERROR)throw new Error("WebGL Error: "+mL(o,i))}(t),r}(function(t){t[t.DENSE=0]="DENSE",t[t.SHARED_BATCH=1]="SHARED_BATCH"})(Tl||(Tl={})),function(t){t[t.RENDER=0]="RENDER",t[t.UPLOAD=1]="UPLOAD",t[t.PIXELS=2]="PIXELS",t[t.DOWNLOAD=3]="DOWNLOAD"}(An||(An={})),function(t){t[t.UNPACKED_FLOAT16=0]="UNPACKED_FLOAT16",t[t.UNPACKED_FLOAT32=1]="UNPACKED_FLOAT32",t[t.PACKED_4X1_UNSIGNED_BYTE=2]="PACKED_4X1_UNSIGNED_BYTE",t[t.PACKED_2X2_FLOAT32=3]="PACKED_2X2_FLOAT32",t[t.PACKED_2X2_FLOAT16=4]="PACKED_2X2_FLOAT16"}(Tn||(Tn={}));var hL=596e-10,pL=65504;function vL(t){return!!(H().getBool("WEBGL_RENDER_FLOAT32_ENABLED")||t===0||hL<Math.abs(t)&&Math.abs(t)<pL)}function mL(t,e){switch(e){case t.NO_ERROR:return"NO_ERROR";case t.INVALID_ENUM:return"INVALID_ENUM";case t.INVALID_VALUE:return"INVALID_VALUE";case t.INVALID_OPERATION:return"INVALID_OPERATION";case t.INVALID_FRAMEBUFFER_OPERATION:return"INVALID_FRAMEBUFFER_OPERATION";case t.OUT_OF_MEMORY:return"OUT_OF_MEMORY";case t.CONTEXT_LOST_WEBGL:return"CONTEXT_LOST_WEBGL";default:return"Unknown error code "+e}}function $c(t,e,n){return ko(t,e,function(){return t.getExtension(n)},'Extension "'+n+'" not supported on this browser.')}function gL(t,e,n){var r=ko(t,e,function(){return t.createShader(t.VERTEX_SHADER)},"Unable to create vertex WebGLShader.");if(le(t,e,function(){return t.shaderSource(r,n)}),le(t,e,function(){return t.compileShader(r)}),t.getShaderParameter(r,t.COMPILE_STATUS)===!1)throw console.log(t.getShaderInfoLog(r)),new Error("Failed to compile vertex shader.");return r}function yL(t,e,n){var r=ko(t,e,function(){return t.createShader(t.FRAGMENT_SHADER)},"Unable to create fragment WebGLShader.");if(le(t,e,function(){return t.shaderSource(r,n)}),le(t,e,function(){return t.compileShader(r)}),t.getShaderParameter(r,t.COMPILE_STATUS)===!1)throw function(o,i){var a=wL.exec(i);if(a==null)return console.log("Couldn't parse line number in error: "+i),void console.log(o);for(var s=+a[1],u=o.split(`
`),l=u.length.toString().length+2,c=u.map(function(m,g){return Ss((g+1).toString(),l)+m}),d=0,f=0;f<c.length;f++)d=Math.max(c[f].length,d);var h=c.slice(0,s-1),v=c.slice(s-1,s),p=c.slice(s);console.log(h.join(`
`)),console.log(i.split(`
`)[0]),console.log("%c "+Ss(v[0],d),"border:1px solid red; background-color:#e3d2d2; color:#a61717"),console.log(p.join(`
`))}(n,t.getShaderInfoLog(r)),new Error("Failed to compile fragment shader.");return r}var gp,yp,wL=/ERROR: [0-9]+:([0-9]+):/g;function xL(t,e){return ko(t,e,function(){return t.createProgram()},"Unable to create WebGLProgram.")}function bL(t,e,n){if(le(t,e,function(){return t.linkProgram(n)}),t.getProgramParameter(n,t.LINK_STATUS)===!1)throw console.log(t.getProgramInfoLog(n)),new Error("Failed to link vertex and fragment shaders.")}function wp(t,e,n){if(le(t,e,function(){return t.validateProgram(n)}),t.getProgramParameter(n,t.VALIDATE_STATUS)===!1)throw console.log(t.getProgramInfoLog(n)),new Error("Shader program validation failed.")}function _L(t,e,n){var r=ko(t,e,function(){return t.createBuffer()},"Unable to create WebGLBuffer");return le(t,e,function(){return t.bindBuffer(t.ARRAY_BUFFER,r)}),le(t,e,function(){return t.bufferData(t.ARRAY_BUFFER,n,t.STATIC_DRAW)}),r}function EL(t,e,n){var r=ko(t,e,function(){return t.createBuffer()},"Unable to create WebGLBuffer");return le(t,e,function(){return t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,r)}),le(t,e,function(){return t.bufferData(t.ELEMENT_ARRAY_BUFFER,n,t.STATIC_DRAW)}),r}function CL(t,e){return ko(t,e,function(){return t.createTexture()},"Unable to create WebGLTexture.")}function SL(t,e){var n=H().getNumber("WEBGL_MAX_TEXTURE_SIZE");if(t<=0||e<=0){var r="["+t+"x"+e+"]";throw new Error("Requested texture size "+r+" is invalid.")}if(t>n||e>n)throw r="["+t+"x"+e+"]",new Error("Requested texture size "+r+" greater than WebGL maximum on this browser / GPU "+("["+n+"x"+n+"]")+".")}function kL(t,e){return ko(t,e,function(){return t.createFramebuffer()},"Unable to create WebGLFramebuffer.")}function Hw(t,e,n,r,o,i,a,s){var u=t.getAttribLocation(n,r);return u!==-1&&(le(t,e,function(){return t.bindBuffer(t.ARRAY_BUFFER,o)}),le(t,e,function(){return t.vertexAttribPointer(u,i,t.FLOAT,!1,a,s)}),le(t,e,function(){return t.enableVertexAttribArray(u)}),!0)}function RL(t,e,n,r){DL(t,r),le(t,e,function(){return t.activeTexture(t.TEXTURE0+r)}),le(t,e,function(){return t.bindTexture(t.TEXTURE_2D,n)})}function TL(t,e,n,r){return ko(t,e,function(){return t.getUniformLocation(n,r)},'uniform "'+r+'" not present in program.')}function IL(t,e,n){return t.getUniformLocation(e,n)}function AL(t,e,n,r,o,i){le(t,e,function(){return RL(t,e,r,i)}),le(t,e,function(){return t.uniform1i(o,i)})}function xp(t,e,n,r){le(t,e,function(){return t.bindFramebuffer(t.FRAMEBUFFER,r)}),le(t,e,function(){return t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,n,0)})}function Gw(t,e,n){le(t,e,function(){return t.bindFramebuffer(t.FRAMEBUFFER,n)}),le(t,e,function(){return t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,null,0)})}function jc(t){var e=t.checkFramebufferStatus(t.FRAMEBUFFER);if(e!==t.FRAMEBUFFER_COMPLETE)throw new Error("Error binding framebuffer: "+PL(t,e))}function PL(t,e){switch(e){case t.FRAMEBUFFER_INCOMPLETE_ATTACHMENT:return"FRAMEBUFFER_INCOMPLETE_ATTACHMENT";case t.FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT:return"FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT";case t.FRAMEBUFFER_INCOMPLETE_DIMENSIONS:return"FRAMEBUFFER_INCOMPLETE_DIMENSIONS";case t.FRAMEBUFFER_UNSUPPORTED:return"FRAMEBUFFER_UNSUPPORTED";default:return"unknown error "+e}}function ko(t,e,n,r){var o=le(t,e,function(){return n()});if(o==null)throw new Error(r);return o}function DL(t,e){var n=t.MAX_COMBINED_TEXTURE_IMAGE_UNITS-1,r=e+t.TEXTURE0;if(r<t.TEXTURE0||r>n)throw new Error("textureUnit must be in "+("[gl.TEXTURE0, gl.TEXTURE"+n+"]")+".")}function ef(t,e){return e===void 0&&(e=2),se(t.slice(0,t.length-e))}function tf(t){if(t.length===0)throw Error("Cannot get rows and columns of an empty shape array.");return[t.length>1?t[t.length-2]:1,t[t.length-1]]}function bp(t){var e=[1,1,1];return t.length===0||t.length===1&&t[0]===1||(e=[ef(t)].concat(tf(t))),e}function NL(t,e){var n;e===void 0&&(e=!1);var r=H().getNumber("WEBGL_MAX_TEXTURE_SIZE");if(e&&(r*=2,(t=t.map(function(l,c){return c>=t.length-2?WC(t[c]):t[c]})).length===1&&(t=[2,t[0]])),t.length!==2){var o=Qi(t);t=o.newShape}var i=se(t);if(t.length<=1&&i<=r)return[1,i];if(t.length===2&&t[0]<=r&&t[1]<=r)return t;if(t.length===3&&t[0]*t[1]<=r&&t[2]<=r)return[t[0]*t[1],t[2]];if(t.length===3&&t[0]<=r&&t[1]*t[2]<=r)return[t[0],t[1]*t[2]];if(t.length===4&&t[0]*t[1]*t[2]<=r&&t[3]<=r)return[t[0]*t[1]*t[2],t[3]];if(t.length===4&&t[0]<=r&&t[1]*t[2]*t[3]<=r)return[t[0],t[1]*t[2]*t[3]];if(e){var a=ef(t),s=2,u=2;return t.length&&(s=(n=tf(t))[0],u=n[1]),wm(i=a*(s/2)*(u/2)).map(function(l){return 2*l})}return wm(i)}function Wc(t){return t%2==0}function Uc(t,e){if(At(t=t.slice(-2),e=e.slice(-2))||!t.length||!e.length||t[0]===0||t[1]===0||e[0]===0||e[1]===0)return!0;if(t.length!==e.length){var n=t.slice(-1)[0],r=e.slice(-1)[0];if(n===r||Wc(n)&&Wc(r)&&(t[0]===1||e[0]===1))return!0}return t[1]===e[1]&&Wc(t[0])&&Wc(e[0])}function OL(t){if(gp==null){var e=Qr(t);gp=e.getParameter(e.MAX_TEXTURE_SIZE)}return gp}function FL(t){if(yp==null){var e=Qr(t);yp=e.getParameter(e.MAX_TEXTURE_IMAGE_UNITS)}return Math.min(16,yp)}function ML(t){if(t===0)return 0;var e=Qr(t);return qn(e,"EXT_disjoint_timer_query_webgl2")&&t===2?2:qn(e,"EXT_disjoint_timer_query")?1:0}function qn(t,e){return t.getExtension(e)!=null}function qw(t){try{if(Qr(t)!=null)return!0}catch{return!1}return!1}function LL(t){if(t===0)return!1;var e=Qr(t);if(t===1){if(!qn(e,"OES_texture_float"))return!1}else if(!qn(e,"EXT_color_buffer_float"))return!1;return km(e)}function BL(t){if(t===0)return!1;var e=Qr(t);if(t!==1){if(qn(e,"EXT_color_buffer_float"))return km(e);if(qn(e,"EXT_color_buffer_half_float")){var n=e.getExtension("EXT_color_buffer_half_float");return function(r,o){var i=dy(r,o),a=r.createTexture();r.bindTexture(r.TEXTURE_2D,a),r.texImage2D(r.TEXTURE_2D,0,i.internalFormatHalfFloat,1,1,0,i.textureFormatFloat,i.textureTypeHalfFloat,null);var s=r.createFramebuffer();r.bindFramebuffer(r.FRAMEBUFFER,s),r.framebufferTexture2D(r.FRAMEBUFFER,r.COLOR_ATTACHMENT0,r.TEXTURE_2D,a,0);var u=r.checkFramebufferStatus(r.FRAMEBUFFER)===r.FRAMEBUFFER_COMPLETE;return r.bindTexture(r.TEXTURE_2D,null),r.bindFramebuffer(r.FRAMEBUFFER,null),r.deleteTexture(a),r.deleteFramebuffer(s),u}(e,n)}return!1}return!!qn(e,"OES_texture_float")&&!!qn(e,"WEBGL_color_buffer_float")&&km(e)}function km(t){var e=dy(t),n=t.createTexture();t.bindTexture(t.TEXTURE_2D,n),t.texImage2D(t.TEXTURE_2D,0,e.internalFormatFloat,1,1,0,e.textureFormatFloat,e.textureTypeFloat,null);var r=t.createFramebuffer();t.bindFramebuffer(t.FRAMEBUFFER,r),t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,n,0);var o=t.checkFramebufferStatus(t.FRAMEBUFFER)===t.FRAMEBUFFER_COMPLETE;return t.bindTexture(t.TEXTURE_2D,null),t.bindFramebuffer(t.FRAMEBUFFER,null),t.deleteTexture(n),t.deleteFramebuffer(r),o}function $L(t){return t===2&&Qr(t).fenceSync!=null}var pe=H();function YC(t){H().getBool("DEPRECATION_WARNINGS_ENABLED")&&console.warn(t+" You can disable deprecation warnings with tf.disableDeprecationWarnings().")}function ne(t,e){return L.tidy(t,e)}function bn(t){KC(t).forEach(function(e){return e.dispose()})}function jL(t){return L.keep(t)}function nf(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];H().getBool("IS_TEST")||console.warn.apply(console,t)}function Li(t,e){var n=t;if(Hr(t))return e==="string"?[]:[t.length];if(!Array.isArray(t))return[];for(var r=[];Array.isArray(n)||Hr(n)&&e!=="string";)r.push(n.length),n=n[0];return Array.isArray(t)&&H().getBool("TENSORLIKE_CHECK_SHAPE_CONSISTENCY")&&function o(i,a,s){if(s=s||[],!Array.isArray(i)&&!Hr(i))return void I(a.length===0,function(){return"Element arr["+s.join("][")+"] is a primitive, but should be an array/TypedArray of "+a[0]+" elements"});I(a.length>0,function(){return"Element arr["+s.join("][")+"] should be a primitive, but is an array of "+i.length+" elements"}),I(i.length===a[0],function(){return"Element arr["+s.join("][")+"] should have "+a[0]+" elements, but has "+i.length+" elements"});for(var u=a.slice(1),l=0;l<i.length;++l)o(i[l],u,s.concat(l))}(t,r,[]),r}function Kw(t,e,n,r){if(t!=null&&(t!=="numeric"&&t!==e||t==="numeric"&&e==="string"))throw new Error("Argument '"+n+"' passed to '"+r+"' must be "+t+" tensor, but got "+e+" tensor")}function T(t,e,n,r){if(r===void 0&&(r="numeric"),t instanceof nt)return Kw(r,t.dtype,e,n),t;var o=Xl(t);if(o!=="string"&&["bool","int32","float32"].indexOf(r)>=0&&(o=r),Kw(r,o,e,n),t==null||!Hr(t)&&!Array.isArray(t)&&typeof t!="number"&&typeof t!="boolean"&&typeof t!="string"){var i=t==null?"null":t.constructor.name;throw new Error("Argument '"+e+"' passed to '"+n+"' must be a Tensor or TensorLike, but got '"+i+"'")}var a=Li(t,o);Hr(t)||Array.isArray(t)||(t=[t]);var s=o!=="string"?zC(t,o,H().getBool("DEBUG")):nu(t,[],!0);return L.makeTensor(s,a,o)}function rf(t,e,n,r){if(r===void 0&&(r="numeric"),!Array.isArray(t))throw new Error("Argument "+e+" passed to "+n+" must be a `Tensor[]` or `TensorLike[]`");return t.map(function(o,i){return T(o,e+"["+i+"]",n)},r)}function QC(t,e){for(var n=0;n<t.length;++n)if(t[t.length-n-1]!==e-1-n)return!1;return!0}function WL(t,e,n){for(var r=t.length+e.length,o=[],i=0,a=0,s=0;s<r;s++)n.indexOf(s)===-1?o.push(t[i++]):o.push(e[a++]);return o}function Ht(t,e){for(var n=[],r=t.length,o=0;o<r;o++)e.indexOf(o)===-1&&n.push(t[o]);return[n,e.map(function(i){return t[i]})]}function _n(t,e){return WL(t,e.map(function(n){return 1}),e)}function kn(t,e,n){I(QC(e,n),function(){return t+" supports only inner-most axes for now. Got axes "+e+" and rank-"+n+" input."})}function Jr(t,e){if(QC(t,e))return null;for(var n=[],r=0;r<e;++r)t.indexOf(r)===-1&&n.push(r);return t.forEach(function(o){return n.push(o)}),n}function fy(t){return t.map(function(e,n){return[n,e]}).sort(function(e,n){return e[1]-n[1]}).map(function(e){return e[0]})}function Zr(t,e){for(var n=[],r=e-t;r<e;++r)n.push(r);return n}function UL(t,e){var n=t[0].length;t.forEach(function(o,i){I(o.length===n,function(){return"Error in concat"+n+"D: rank of tensors["+i+"] must be the same as the rank of the rest ("+n+")"})}),I(e>=0&&e<n,function(){return"Error in concat"+n+"D: axis must be between 0 and "+(n-1)+"."});var r=t[0];t.forEach(function(o,i){for(var a=0;a<n;a++)I(a===e||o[a]===r[a],function(){return"Error in concat"+n+"D: Shape of tensors["+i+"] ("+o+") does not match the shape of the rest ("+r+") along the non-concatenated axis "+i+"."})})}function ou(t,e){for(var n=t[0].slice(),r=1;r<t.length;r++)n[e]+=t[r][e];return n}function O(t){var e=Object.keys(t);if(e.length!==1)throw new Error("Please provide an object with a single key (operation name) mapping to a function. Got an object with "+e.length+" keys.");var n=e[0],r=t[n];n.endsWith("_")&&(n=n.substring(0,n.length-1));var o=function(){for(var i=[],a=0;a<arguments.length;a++)i[a]=arguments[a];L.startScope(n);try{var s=r.apply(void 0,i);return s instanceof Promise&&console.error("Cannot return a Promise inside of tidy."),L.endScope(s),s}catch(u){throw L.endScope(null),u}};return Object.defineProperty(o,"name",{value:n,configurable:!0}),o}pe.registerFlag("HAS_WEBGL",function(){return pe.getNumber("WEBGL_VERSION")>0}),pe.registerFlag("WEBGL_VERSION",function(){return qw(2)?2:qw(1)?1:0}),pe.registerFlag("WEBGL_BUFFER_SUPPORTED",function(){return pe.get("WEBGL_VERSION")===2}),pe.registerFlag("WEBGL_CPU_FORWARD",function(){return!0}),pe.registerFlag("WEBGL_FORCE_F16_TEXTURES",function(){return!1}),pe.registerFlag("WEBGL_PACK",function(){return pe.getBool("HAS_WEBGL")}),pe.registerFlag("WEBGL_PACK_NORMALIZATION",function(){return pe.getBool("WEBGL_PACK")}),pe.registerFlag("WEBGL_PACK_CLIP",function(){return pe.getBool("WEBGL_PACK")}),pe.registerFlag("WEBGL_PACK_DEPTHWISECONV",function(){return!1}),pe.registerFlag("WEBGL_PACK_BINARY_OPERATIONS",function(){return pe.getBool("WEBGL_PACK")}),pe.registerFlag("WEBGL_PACK_UNARY_OPERATIONS",function(){return pe.getBool("WEBGL_PACK")}),pe.registerFlag("WEBGL_PACK_ARRAY_OPERATIONS",function(){return pe.getBool("WEBGL_PACK")}),pe.registerFlag("WEBGL_PACK_IMAGE_OPERATIONS",function(){return pe.getBool("WEBGL_PACK")}),pe.registerFlag("WEBGL_PACK_REDUCE",function(){return pe.getBool("WEBGL_PACK")}),pe.registerFlag("WEBGL_LAZILY_UNPACK",function(){return pe.getBool("WEBGL_PACK")}),pe.registerFlag("WEBGL_CONV_IM2COL",function(){return pe.getBool("WEBGL_PACK")}),pe.registerFlag("WEBGL_MAX_TEXTURE_SIZE",function(){return OL(pe.getNumber("WEBGL_VERSION"))}),pe.registerFlag("WEBGL_MAX_TEXTURES_IN_SHADER",function(){return FL(pe.getNumber("WEBGL_VERSION"))}),pe.registerFlag("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION",function(){var t=pe.getNumber("WEBGL_VERSION");return t===0?0:ML(t)}),pe.registerFlag("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE",function(){return pe.getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")>0&&(t=navigator.userAgent||navigator.vendor||window.opera,!(/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(t)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(t.substr(0,4))));var t}),pe.registerFlag("WEBGL_RENDER_FLOAT32_CAPABLE",function(){return LL(pe.getNumber("WEBGL_VERSION"))}),pe.registerFlag("WEBGL_RENDER_FLOAT32_ENABLED",function(){return!pe.getBool("WEBGL_FORCE_F16_TEXTURES")&&pe.getBool("WEBGL_RENDER_FLOAT32_CAPABLE")}),pe.registerFlag("WEBGL_DOWNLOAD_FLOAT_ENABLED",function(){return BL(pe.getNumber("WEBGL_VERSION"))}),pe.registerFlag("WEBGL_FENCE_API_ENABLED",function(){return $L(pe.getNumber("WEBGL_VERSION"))}),pe.registerFlag("WEBGL_SIZE_UPLOAD_UNIFORM",function(){return pe.getBool("WEBGL_RENDER_FLOAT32_ENABLED")?4:0}),qC=YC;var Ft=O({complex_:function(t,e){var n=T(t,"real","complex"),r=T(e,"imag","complex");return Le(n.shape,r.shape,"real and imag shapes, "+n.shape+" and "+r.shape+", must match in call to tf.complex()."),L.runKernelFunc(function(o){return o.complex(n,r)},{$real:n,$imag:r})}}),Hn=O({real_:function(t){var e=T(t,"input","real");return L.runKernelFunc(function(n){return n.real(e)},{$input:e})}}),$r=O({imag_:function(t){var e=T(t,"input","imag");return L.runKernelFunc(function(n){return n.imag(e)},{$input:e})}});function Lt(t,e,n){return Bi(t,e,Li(t,n),n)}function Bi(t,e,n,r){if(r==null&&(r=Xl(t)),r==="complex64")throw new Error("Cannot construct a complex64 tensor directly. Please use tf.complex(real, imag).");if(!Hr(t)&&!Array.isArray(t)&&typeof t!="number"&&typeof t!="boolean"&&typeof t!="string")throw new Error("values passed to tensor(values) must be a number/boolean/string or an array of numbers/booleans/strings, or a TypedArray");if(e!=null){HC(e);var o=se(e),i=se(n);I(o===i,function(){return"Based on the provided shape, ["+e+"], the tensor should have "+o+" values but has "+i});for(var a=0;a<n.length;++a){var s=n[a],u=a!==n.length-1||s!==se(e.slice(a));I(n[a]===e[a]||!u,function(){return"Error creating a new Tensor. Inferred shape ("+n+") does not match the provided shape ("+e+"). "})}}return Hr(t)||Array.isArray(t)||(t=[t]),e=e||n,t=r!=="string"?zC(t,r,H().getBool("DEBUG")):nu(t,[],!0),L.makeTensor(t,e,r)}function ee(t,e){if((Hr(t)&&e!=="string"||Array.isArray(t))&&e!=="complex64")throw new Error("Error creating a new Scalar: value must be a primitive (number|boolean|string)");if(e==="string"&&Hr(t)&&!(t instanceof Uint8Array))throw new Error("When making a scalar from encoded string, the value must be `Uint8Array`.");return Bi(t,[],[],e)}function pt(t,e){mu(t);var n=Li(t,e);if(n.length!==1)throw new Error("tensor1d() requires values to be a flat/TypedArray");return Bi(t,null,n,e)}function _i(t,e,n){if(mu(t),e!=null&&e.length!==2)throw new Error("tensor2d() requires shape to have two numbers");var r=Li(t,n);if(r.length!==2&&r.length!==1)throw new Error("tensor2d() requires values to be number[][] or flat/TypedArray");if(r.length===1&&e==null)throw new Error("tensor2d() requires shape to be provided when `values` are a flat/TypedArray");return Bi(t,e,r,n)}function hy(t,e,n){if(mu(t),e!=null&&e.length!==3)throw new Error("tensor3d() requires shape to have three numbers");var r=Li(t,n);if(r.length!==3&&r.length!==1)throw new Error("tensor3d() requires values to be number[][][] or flat/TypedArray");if(r.length===1&&e==null)throw new Error("tensor3d() requires shape to be provided when `values` are a flat array");return Bi(t,e,r,n)}function vn(t,e,n){if(mu(t),e!=null&&e.length!==4)throw new Error("tensor4d() requires shape to have four numbers");var r=Li(t,n);if(r.length!==4&&r.length!==1)throw new Error("tensor4d() requires values to be number[][][][] or flat/TypedArray");if(r.length===1&&e==null)throw new Error("tensor4d() requires shape to be provided when `values` are a flat array");return Bi(t,e,r,n)}function zL(t,e,n){if(mu(t),e!=null&&e.length!==5)throw new Error("tensor5d() requires shape to have five numbers");var r=Li(t,n);if(r.length!==5&&r.length!==1)throw new Error("tensor5d() requires values to be number[][][][][] or flat/TypedArray");if(r.length===1&&e==null)throw new Error("tensor5d() requires shape to be provided when `values` are a flat array");return Bi(t,e,r,n)}function VL(t,e,n){if(mu(t),e!=null&&e.length!==6)throw new Error("tensor6d() requires shape to have six numbers");var r=Li(t,n);if(r.length!==6&&r.length!==1)throw new Error("tensor6d() requires values to be number[][][][][][] or flat/TypedArray");if(r.length===1&&e==null)throw new Error("tensor6d() requires shape to be provided when `values` are a flat array");return Bi(t,e=e||r,r,n)}function HL(t,e,n,r){return e===void 0&&(e=!0),L.makeVariable(t,e,n,r)}function gu(t,e){if(e===void 0&&(e="float32"),e==="complex64"){var n=gu(t,"float32"),r=Ye(t,"float32");return Ft(n,r)}var o=VC(se(t),e);return L.makeTensor(o,t,e)}function Ye(t,e){if(e===void 0&&(e="float32"),e==="complex64"){var n=Ye(t,"float32"),r=Ye(t,"float32");return Ft(n,r)}var o=Yl(se(t),e);return L.makeTensor(o,t,e)}function qr(t,e,n){return L.runKernelFunc(function(r){return r.fill(t,e,n)},{})}function GL(t,e,n){if(n<=0)throw new Error("The number of values should be positive.");return L.runKernelFunc(function(r){return r.linspace(t,e,n)},{})}function of(t,e,n,r){if(n===void 0&&(n=1),r===void 0&&(r="float32"),n===0)throw new Error("Cannot have a step of zero");if(t===e||t<e&&n<0||e<t&&n>1)return Ye([0],r);var o=Yl(Math.abs(Math.ceil((e-t)/n)),r);e<t&&n===1&&(n=-1),o[0]=t;for(var i=1;i<o.length;i++)o[i]=o[i-1]+n;return pt(o,r)}var JC=O({onesLike_:function(t){var e=T(t,"x","onesLike");if(e.dtype==="complex64"){var n=JC(Hn(e)),r=Ne($r(e));return Ft(n,r)}return L.runKernelFunc(function(o){return o.onesLike(e)},{$x:e},function(o,i){return{$x:function(){return Ne(o)}}})}}),Ne=O({zerosLike_:function(t){var e=T(t,"x","zerosLike");return L.runKernelFunc(function(n){return n.zerosLike(e)},{$x:e},function(n,r){return{$x:function(){return Ne(n)}}})}}),_t=O({concat_:function(t,e){e===void 0&&(e=0),I(t.length>=1,function(){return"Pass at least one tensor to concat"});var n=rf(t,"tensors","concat");n[0].dtype==="complex64"&&n.forEach(function(s){if(s.dtype!=="complex64")throw new Error(`Cannot concatenate complex64 tensors with a tensor
          with dtype `+s.dtype+". ")}),e=kt(e,n[0].shape)[0];var r=ou(n.map(function(s){return s.shape}),e);if(se(r)===0)return Lt([],r);if((n=n.filter(function(s){return s.size>0})).length===1)return n[0];var o=n.map(function(s){return s.shape});UL(o,e);var i=n,a={axis:e};return L.runKernelFunc(function(s){return s.concat(n,e)},i,function(s){var u=o.map(function(l){return l[e]});return py(s,u,e).map(function(l){return function(){return l}})},"Concat",a)}}),qL=O({concat1d_:function(t){return _t(t,0)}}),KL=O({concat2d_:function(t,e){return _t(t,e)}}),XL=O({concat3d_:function(t,e){return _t(t,e)}}),YL=O({concat4d_:function(t,e){return _t(t,e)}}),py=O({split_:function(t,e,n){n===void 0&&(n=0);var r,o=T(t,"x","split");return n=kt(n,o.shape)[0],typeof e=="number"?(I(o.shape[n]%e==0,function(){return"Number of splits must evenly divide the axis."}),r=new Array(e).fill(o.shape[n]/e)):(I(o.shape[n]===e.reduce(function(i,a){return i+a}),function(){return"The sum of sizes must match the size of the axis dimension."}),r=e),L.runKernelFunc(function(i){return i.split(o,r,n)},{$x:o},function(i){return{$x:function(){return _t(i,n)}}})}});function Pa(t,e){return t(e={exports:{}},e.exports),e.exports}var QL=Pa(function(t){(function(e,n,r){function o(s){var u,l=this,c=(u=4022871197,function(d){d=d.toString();for(var f=0;f<d.length;f++){var h=.02519603282416938*(u+=d.charCodeAt(f));h-=u=h>>>0,u=(h*=u)>>>0,u+=4294967296*(h-=u)}return 23283064365386963e-26*(u>>>0)});l.next=function(){var d=2091639*l.s0+23283064365386963e-26*l.c;return l.s0=l.s1,l.s1=l.s2,l.s2=d-(l.c=0|d)},l.c=1,l.s0=c(" "),l.s1=c(" "),l.s2=c(" "),l.s0-=c(s),l.s0<0&&(l.s0+=1),l.s1-=c(s),l.s1<0&&(l.s1+=1),l.s2-=c(s),l.s2<0&&(l.s2+=1),c=null}function i(s,u){return u.c=s.c,u.s0=s.s0,u.s1=s.s1,u.s2=s.s2,u}function a(s,u){var l=new o(s),c=u&&u.state,d=l.next;return d.int32=function(){return 4294967296*l.next()|0},d.double=function(){return d()+11102230246251565e-32*(2097152*d()|0)},d.quick=d,c&&(typeof c=="object"&&i(c,l),d.state=function(){return i(l,{})}),d}n&&n.exports?n.exports=a:this.alea=a})(0,t)}),JL=Pa(function(t){(function(e,n,r){function o(s){var u=this,l="";u.x=0,u.y=0,u.z=0,u.w=0,u.next=function(){var d=u.x^u.x<<11;return u.x=u.y,u.y=u.z,u.z=u.w,u.w^=u.w>>>19^d^d>>>8},s===(0|s)?u.x=s:l+=s;for(var c=0;c<l.length+64;c++)u.x^=0|l.charCodeAt(c),u.next()}function i(s,u){return u.x=s.x,u.y=s.y,u.z=s.z,u.w=s.w,u}function a(s,u){var l=new o(s),c=u&&u.state,d=function(){return(l.next()>>>0)/4294967296};return d.double=function(){do var f=((l.next()>>>11)+(l.next()>>>0)/4294967296)/2097152;while(f===0);return f},d.int32=l.next,d.quick=d,c&&(typeof c=="object"&&i(c,l),d.state=function(){return i(l,{})}),d}n&&n.exports?n.exports=a:this.xor128=a})(0,t)}),ZL=Pa(function(t){(function(e,n,r){function o(s){var u=this,l="";u.next=function(){var d=u.x^u.x>>>2;return u.x=u.y,u.y=u.z,u.z=u.w,u.w=u.v,(u.d=u.d+362437|0)+(u.v=u.v^u.v<<4^d^d<<1)|0},u.x=0,u.y=0,u.z=0,u.w=0,u.v=0,s===(0|s)?u.x=s:l+=s;for(var c=0;c<l.length+64;c++)u.x^=0|l.charCodeAt(c),c==l.length&&(u.d=u.x<<10^u.x>>>4),u.next()}function i(s,u){return u.x=s.x,u.y=s.y,u.z=s.z,u.w=s.w,u.v=s.v,u.d=s.d,u}function a(s,u){var l=new o(s),c=u&&u.state,d=function(){return(l.next()>>>0)/4294967296};return d.double=function(){do var f=((l.next()>>>11)+(l.next()>>>0)/4294967296)/2097152;while(f===0);return f},d.int32=l.next,d.quick=d,c&&(typeof c=="object"&&i(c,l),d.state=function(){return i(l,{})}),d}n&&n.exports?n.exports=a:this.xorwow=a})(0,t)}),eB=Pa(function(t){(function(e,n,r){function o(s){var u=this;u.next=function(){var l,c,d=u.x,f=u.i;return l=d[f],c=(l^=l>>>7)^l<<24,c^=(l=d[f+1&7])^l>>>10,c^=(l=d[f+3&7])^l>>>3,c^=(l=d[f+4&7])^l<<7,l=d[f+7&7],c^=(l^=l<<13)^l<<9,d[f]=c,u.i=f+1&7,c},function(l,c){var d,f=[];if(c===(0|c))f[0]=c;else for(c=""+c,d=0;d<c.length;++d)f[7&d]=f[7&d]<<15^c.charCodeAt(d)+f[d+1&7]<<13;for(;f.length<8;)f.push(0);for(d=0;d<8&&f[d]===0;++d);for(d==8?f[7]=-1:f[d],l.x=f,l.i=0,d=256;d>0;--d)l.next()}(u,s)}function i(s,u){return u.x=s.x.slice(),u.i=s.i,u}function a(s,u){s==null&&(s=+new Date);var l=new o(s),c=u&&u.state,d=function(){return(l.next()>>>0)/4294967296};return d.double=function(){do var f=((l.next()>>>11)+(l.next()>>>0)/4294967296)/2097152;while(f===0);return f},d.int32=l.next,d.quick=d,c&&(c.x&&i(c,l),d.state=function(){return i(l,{})}),d}n&&n.exports?n.exports=a:this.xorshift7=a})(0,t)}),tB=Pa(function(t){(function(e,n,r){function o(s){var u=this;u.next=function(){var l,c,d=u.w,f=u.X,h=u.i;return u.w=d=d+1640531527|0,c=f[h+34&127],l=f[h=h+1&127],c^=c<<13,l^=l<<17,c^=c>>>15,l^=l>>>12,c=f[h]=c^l,u.i=h,c+(d^d>>>16)|0},function(l,c){var d,f,h,v,p,m=[],g=128;for(c===(0|c)?(f=c,c=null):(c+="\0",f=0,g=Math.max(g,c.length)),h=0,v=-32;v<g;++v)c&&(f^=c.charCodeAt((v+32)%c.length)),v===0&&(p=f),f^=f<<10,f^=f>>>15,f^=f<<4,f^=f>>>13,v>=0&&(p=p+1640531527|0,h=(d=m[127&v]^=f+p)==0?h+1:0);for(h>=128&&(m[127&(c&&c.length||0)]=-1),h=127,v=512;v>0;--v)f=m[h+34&127],d=m[h=h+1&127],f^=f<<13,d^=d<<17,f^=f>>>15,d^=d>>>12,m[h]=f^d;l.w=p,l.X=m,l.i=h}(u,s)}function i(s,u){return u.i=s.i,u.w=s.w,u.X=s.X.slice(),u}function a(s,u){s==null&&(s=+new Date);var l=new o(s),c=u&&u.state,d=function(){return(l.next()>>>0)/4294967296};return d.double=function(){do var f=((l.next()>>>11)+(l.next()>>>0)/4294967296)/2097152;while(f===0);return f},d.int32=l.next,d.quick=d,c&&(c.X&&i(c,l),d.state=function(){return i(l,{})}),d}n&&n.exports?n.exports=a:this.xor4096=a})(0,t)}),nB=Pa(function(t){(function(e,n,r){function o(s){var u=this,l="";u.next=function(){var d=u.b,f=u.c,h=u.d,v=u.a;return d=d<<25^d>>>7^f,f=f-h|0,h=h<<24^h>>>8^v,v=v-d|0,u.b=d=d<<20^d>>>12^f,u.c=f=f-h|0,u.d=h<<16^f>>>16^v,u.a=v-d|0},u.a=0,u.b=0,u.c=-1640531527,u.d=1367130551,s===Math.floor(s)?(u.a=s/4294967296|0,u.b=0|s):l+=s;for(var c=0;c<l.length+20;c++)u.b^=0|l.charCodeAt(c),u.next()}function i(s,u){return u.a=s.a,u.b=s.b,u.c=s.c,u.d=s.d,u}function a(s,u){var l=new o(s),c=u&&u.state,d=function(){return(l.next()>>>0)/4294967296};return d.double=function(){do var f=((l.next()>>>11)+(l.next()>>>0)/4294967296)/2097152;while(f===0);return f},d.int32=l.next,d.quick=d,c&&(typeof c=="object"&&i(c,l),d.state=function(){return i(l,{})}),d}n&&n.exports?n.exports=a:this.tychei=a})(0,t)}),Xi=Pa(function(t){(function(e,n){var r,o=this,i=256,a=6,s="random",u=n.pow(i,a),l=n.pow(2,52),c=2*l,d=i-1;function f(g,y,w){var x=[],b=p(function C(R,S){var P,A=[],B=typeof R;if(S&&B=="object")for(P in R)try{A.push(C(R[P],S-1))}catch{}return A.length?A:B=="string"?R:R+"\0"}((y=y==1?{entropy:!0}:y||{}).entropy?[g,m(e)]:g??function(){try{var C;return r&&(C=r.randomBytes)?C=C(i):(C=new Uint8Array(i),(o.crypto||o.msCrypto).getRandomValues(C)),m(C)}catch{var R=o.navigator,S=R&&R.plugins;return[+new Date,o,S,o.screen,m(e)]}}(),3),x),_=new h(x),E=function(){for(var C=_.g(a),R=u,S=0;C<l;)C=(C+S)*i,R*=i,S=_.g(1);for(;C>=c;)C/=2,R/=2,S>>>=1;return(C+S)/R};return E.int32=function(){return 0|_.g(4)},E.quick=function(){return _.g(4)/4294967296},E.double=E,p(m(_.S),e),(y.pass||w||function(C,R,S,P){return P&&(P.S&&v(P,_),C.state=function(){return v(_,{})}),S?(n[s]=C,R):C})(E,b,"global"in y?y.global:this==n,y.state)}function h(g){var y,w=g.length,x=this,b=0,_=x.i=x.j=0,E=x.S=[];for(w||(g=[w++]);b<i;)E[b]=b++;for(b=0;b<i;b++)E[b]=E[_=d&_+g[b%w]+(y=E[b])],E[_]=y;(x.g=function(C){for(var R,S=0,P=x.i,A=x.j,B=x.S;C--;)R=B[P=d&P+1],S=S*i+B[d&(B[P]=B[A=d&A+R])+(B[A]=R)];return x.i=P,x.j=A,S})(i)}function v(g,y){return y.i=g.i,y.j=g.j,y.S=g.S.slice(),y}function p(g,y){for(var w,x=g+"",b=0;b<x.length;)y[d&b]=d&(w^=19*y[d&b])+x.charCodeAt(b++);return m(y)}function m(g){return String.fromCharCode.apply(0,g)}if(n["seed"+s]=f,p(n.random(),e),t.exports){t.exports=f;try{r=require("crypto")}catch{}}})([],Math)});Xi.alea=QL,Xi.xor128=JL,Xi.xorwow=ZL,Xi.xorshift7=eB,Xi.xor4096=tB,Xi.tychei=nB;var nh=Xi.alea,vy=function(){function t(e,n,r,o,i){this.mean=e,this.stdDev=n,this.dtype=r,this.nextVal=NaN,this.truncated=o,this.truncated&&(this.upper=this.mean+2*this.stdDev,this.lower=this.mean-2*this.stdDev);var a=i||Math.random();this.random=nh(a.toString())}return t.prototype.nextValue=function(){if(!isNaN(this.nextVal)){var e=this.nextVal;return this.nextVal=NaN,e}for(var n,r,o=!1;!o;){var i=void 0,a=void 0,s=void 0;do s=(i=2*this.random()-1)*i+(a=2*this.random()-1)*a;while(s>=1||s===0);var u=Math.sqrt(-2*Math.log(s)/s);n=this.mean+this.stdDev*i*u,r=this.mean+this.stdDev*a*u,this.truncated&&!this.isValidTruncated(n)||(o=!0)}return this.truncated&&!this.isValidTruncated(r)||(this.nextVal=this.convertValue(r)),this.convertValue(n)},t.prototype.convertValue=function(e){return this.dtype==null||this.dtype==="float32"?e:Math.round(e)},t.prototype.isValidTruncated=function(e){return e<=this.upper&&e>=this.lower},t}(),rB=function(){function t(e,n,r,o){this.alpha=e,this.beta=1/n,this.dtype=r;var i=o||Math.random();this.randu=nh(i.toString()),this.randn=new vy(0,1,r,!1,this.randu()),this.d=e<1?e+2/3:e-1/3,this.c=1/Math.sqrt(9*this.d)}return t.prototype.nextValue=function(){for(var e,n,r,o,i,a;;){do o=this.randn.nextValue(),a=1+this.c*o;while(a<=0);if(a*=a*a,n=1-.331*(e=o*o)*e,r=.5*e+this.d*(1-a+Math.log(a)),(i=this.randu())<n||Math.log(i)<r)break}return a=1/this.beta*this.d*a,this.alpha<1&&(a*=Math.pow(this.randu(),1/this.alpha)),this.convertValue(a)},t.prototype.convertValue=function(e){return this.dtype==="float32"?e:Math.round(e)},t}(),oB=function(){function t(e,n,r,o){var i=this;if(e===void 0&&(e=0),n===void 0&&(n=1),this.canReturnFloat=function(){return i.dtype==null||i.dtype==="float32"},this.min=e,this.range=n-e,this.dtype=r,o==null&&(o=Math.random()),typeof o=="number"&&(o=o.toString()),!this.canReturnFloat()&&this.range<=1)throw new Error("The difference between "+e+" - "+n+" <= 1 and dtype is not float");this.random=nh(o)}return t.prototype.convertValue=function(e){return this.canReturnFloat()?e:Math.round(e)},t.prototype.nextValue=function(){return this.convertValue(this.min+this.range*this.random())},t}();function ge(t,e,n){return e===void 0&&(e="float32"),e=e||"float32",HC(t),new Rl(t,e,n)}function iB(t,e){e===void 0&&(e=!1),console.log(t.toString(e))}var ZC=O({batchToSpaceND_:function(t,e,n){var r=T(t,"x","batchToSpaceND"),o=e.reduce(function(i,a){return i*a});return I(r.rank>=1+e.length,function(){return"input rank is "+r.rank+" but should be > than blockShape.length "+e.length}),I(n.length===e.length,function(){return"crops.length is "+n.length+" but should be equal to blockShape.length  "+e.length}),I(r.shape[0]%o==0,function(){return"input tensor batch is "+r.shape[0]+" but is not divisible by the product of the elements of blockShape "+e.join(" * ")+" === "+o}),L.runKernelFunc(function(i){return i.batchToSpaceND(r,e,n)},{$x:r},function(i){return{$x:function(){return i.spaceToBatchND(e,n)}}})}}),aB=O({broadcastTo_:function(t,e){var n=T(t,"broadcastTo","x"),r=n.shape;if(e.some(function(u){return!(u>0)||u%1!=0}))throw new Error("broadcastTo(): Invalid broadcast shape ["+e+"].");if(e.length<n.rank)throw new Error("broadcastTo(): shape.length="+e.length+" < input.rank="+n.rank+".");if(e.length>n.rank){for(var o=n.shape.slice();o.length<e.length;)o.unshift(1);n=n.reshape(o)}for(var i=Array.from(e),a=e.length-1;a>=0;a--)if(n.shape[a]===e[a])i[a]=1;else if(n.shape[a]!==1)throw new Error("broadcastTo(): ["+r+"] cannot be broadcast to ["+e+"].");var s=i.map(function(u,l){return u>1?l:-1}).filter(function(u){return u>=0});return s.length===0?n.clone():L.runKernelFunc(function(u){return u.tile(n,i)},{input:n},function(u){return{input:function(){return u.sum(s,!0)}}})}}),sB=O({cast_:function(t,e){var n=T(t,"x","cast");if(!Z4(e))throw new Error("Failed to cast to unknown dtype "+e);if(e==="string"&&n.dtype!=="string"||e!=="string"&&n.dtype==="string")throw new Error("Only strings can be casted to strings");var r={dtype:e};return L.runKernelFunc(function(o){return o.cast(n,e)},{x:n},function(o){return{x:function(){return o.clone()}}},"Cast",r)}}),uB=O({clone_:function(t){var e=T(t,"x","clone",null);return L.runKernelFunc(function(){return L.makeTensorFromDataId(e.dataId,e.shape,e.dtype)},{$x:e},function(n){return{$x:function(){return n.toFloat()}}})}}),lB=O({cumsum_:function(t,e,n,r){e===void 0&&(e=0),n===void 0&&(n=!1),r===void 0&&(r=!1);var o=T(t,"x","cumsum"),i=Jr([e|=0],o.rank),a=o;i!=null&&(a=o.transpose(i));var s=Zr(1,o.rank)[0],u=L.runKernelFunc(function(l){return l.cumsum(a,s,n,r)},{permutedX:a},function(l){return{permutedX:function(){return l.cumsum(e,n,!r)}}});return i!=null&&(u=u.transpose(i)),u}}),cB=O({depthToSpace_:function(t,e,n){n===void 0&&(n="NHWC");var r=T(t,"x","depthToSpace"),o=n==="NHWC"?r.shape[1]:r.shape[2],i=n==="NHWC"?r.shape[2]:r.shape[3],a=n==="NHWC"?r.shape[3]:r.shape[1];return I(o*e>=0,function(){return`Negative dimension size caused by overflow when multiplying
      `+o+" and "+e+`  for depthToSpace with input shape
      `+r.shape}),I(i*e>=0,function(){return`Negative dimension size caused by overflow when multiplying
      `+i+" and "+e+` for depthToSpace with input shape
          `+r.shape}),I(a%(e*e)==0,function(){return"Dimension size must be evenly divisible by "+e*e+" but is "+a+" for depthToSpace with input shape "+r.shape}),L.runKernelFunc(function(s){return s.depthToSpace(r,e,n)},{$x:r})}}),Vn=O({expandDims_:function(t,e){e===void 0&&(e=0);var n=T(t,"x","expandDims",null);I(e<=n.rank,function(){return"Axis must be <= rank of the tensor"});var r=n.shape.slice();return e<0&&(I(-(n.rank+1)<=e,function(){return"Axis must be in the interval ["+-(n.rank+1)+", "+n.rank+"]"}),e=n.rank+e+1),r.splice(e,0,1),vr(n,r)}}),eS=O({eye_:function(t,e,n,r){r===void 0&&(r="float32"),e==null&&(e=t);for(var o=ge([t,e],r),i=t<=e?t:e,a=0;a<i;++a)o.set(1,a,a);var s=o.toTensor().as2D(t,e);if(n==null)return s;if(n.length===1)return ks(Vn(s,0),[n[0],1,1]);if(n.length===2)return ks(Vn(Vn(s,0),0),[n[0],n[1],1,1]);if(n.length===3)return ks(Vn(Vn(Vn(s,0),0),0),[n[0],n[1],n[2],1,1]);throw new Error("eye() currently supports only 1D and 2D batchShapes, but received "+n.length+"D.")}}),dB=O({multinomial_:function(t,e,n,r){r===void 0&&(r=!1);var o=T(t,"logits","multinomial"),i=o.size,a=o.rank;if(i<2)throw new Error("Error in multinomial: you need at least 2 outcomes, but got "+i+".");if(a>2)throw new Error("Rank of probabilities must be 1 or 2, but is "+a);n=n||Math.random();var s=a===1?o.as2D(1,-1):o,u=L.runKernelFunc(function(l){return l.multinomial(s,r,e,n)},{logits2D:s});return a===1?u.as1D():u}}),Rm=O({oneHot_:function(t,e,n,r){if(n===void 0&&(n=1),r===void 0&&(r=0),e<2)throw new Error("Error in oneHot: depth must be >=2, but it is "+e);var o=T(t,"indices","oneHot","int32"),i=o.shape.concat([e]);return o=o.flatten(),L.runKernelFunc(function(a){return a.oneHot(o,e,n,r)},{$indices:o},function(a){return{$indices:function(){return Ye(o.shape,"float32")}}}).reshape(i)}}),Da=O({pad_:function(t,e,n){n===void 0&&(n=0);var r=T(t,"x","pad");if(r.rank===0)throw new Error("pad(scalar) is not defined. Pass non-scalar to pad");var o={paddings:e,constantValue:n};return L.runKernelFunc(function(i){return i.pad(r,e,n)},{x:r},function(i){var a=e.map(function(s){return s[0]});return{x:function(){return i.slice(a,r.shape)}}},"PadV2",o)}}),fB=O({pad1d_:function(t,e,n){return n===void 0&&(n=0),I(e.length===2,function(){return"Invalid number of paddings. Must be length of 2."}),Da(t,[e],n)}}),hB=O({pad2d_:function(t,e,n){return n===void 0&&(n=0),I(e.length===2&&e[0].length===2&&e[1].length===2,function(){return"Invalid number of paddings. Must be length of 2 each."}),Da(t,e,n)}}),pB=O({pad3d_:function(t,e,n){return n===void 0&&(n=0),I(e.length===3&&e[0].length===2&&e[1].length===2&&e[2].length===2,function(){return"Invalid number of paddings. Must be length of 2 each."}),Da(t,e,n)}}),vB=O({pad4d_:function(t,e,n){return n===void 0&&(n=0),I(e.length===4&&e[0].length===2&&e[1].length===2&&e[2].length===2&&e[3].length===2,function(){return"Invalid number of paddings. Must be length of 2 each."}),Da(t,e,n)}}),mB=O({rand_:function(t,e,n){var r=se(t),o=null;if(n==null||n==="float32")o=new Float32Array(r);else if(n==="int32")o=new Int32Array(r);else{if(n!=="bool")throw new Error("Unknown data type "+n);o=new Uint8Array(r)}for(var i=0;i<r;i++)o[i]=e();return L.makeTensor(o,t,n)}}),gB=O({randomNormal_:function(t,e,n,r,o){if(e===void 0&&(e=0),n===void 0&&(n=1),r!=null&&r==="bool")throw new Error("Unsupported data type "+r);for(var i=new vy(e,n,r,!1,o),a=ge(t,r),s=0;s<a.values.length;s++)a.values[s]=i.nextValue();return a.toTensor()}}),yB=O({randomGamma_:function(t,e,n,r,o){if(n===void 0&&(n=1),r===void 0&&(r="float32"),n==null&&(n=1),r==null&&(r="float32"),r!=="float32"&&r!=="int32")throw new Error("Unsupported data type "+r);for(var i=new rB(e,n,r,o),a=ge(t,r),s=0;s<a.values.length;s++)a.values[s]=i.nextValue();return a.toTensor()}}),tS=O({randomUniform_:function(t,e,n,r,o){e===void 0&&(e=0),n===void 0&&(n=1),r===void 0&&(r="float32");for(var i=ge(t,r),a=new oB(e,n,null,o),s=0;s<i.values.length;s++)i.values[s]=a.nextValue();return i.toTensor()}}),vr=O({reshape_:function(t,e){var n=T(t,"x","reshape",null);e=Q4(e,n.size),I(n.size===se(e),function(){return"new shape and old shape must have the same number of elements."});var r={shape:e};return L.runKernelFunc(function(o){return o.reshape(n,e)},{x:n},function(o){return{x:function(){return o.reshape(n.shape)}}},"Reshape",r)}}),nS=O({spaceToBatchND_:function(t,e,n){var r=T(t,"x","spaceToBatchND");return I(r.rank>=1+e.length,function(){return"input rank "+r.rank+" should be > than [blockShape] "+e.length}),I(n.length===e.length,function(){return"paddings.shape[0] "+n.length+" must be equal to [blockShape] "+e.length}),I(r.shape.reduce(function(o,i,a){return a>0&&a<=e.length?o&&(i+n[a-1][0]+n[a-1][1])%e[a-1]==0:o},!0),function(){return"input spatial dimensions "+r.shape.slice(1)+" with paddings "+n.toString()+" must be divisible by blockShapes "+e.toString()}),L.runKernelFunc(function(o){return o.spaceToBatchND(r,e,n)},{$x:r},function(o){return{$x:function(){return o.batchToSpaceND(e,n)}}})}}),rS=O({squeeze_:function(t,e){var n=T(t,"x","squeeze");return vr(n,Qi(n.shape,e).newShape)}}),Fn=O({stack_:function(t,e){e===void 0&&(e=0);var n=rf(t,"tensors","stack");if(I(n.length>=1,function(){return"Pass at least one tensor to tf.stack"}),n.length===1)return n[0].expandDims(e);var r=n[0].rank,o=n[0].shape,i=n[0].dtype;I(e<=r,function(){return"Axis must be <= rank of the tensor"}),n.forEach(function(s){Le(o,s.shape,"All tensors passed to stack must have matching shapes")}),n.forEach(function(s){I(i===s.dtype,function(){return"All tensors passed to stack must have matching dtypes"})});var a=n.map(function(s){return s.expandDims(e)});return _t(a,e)}}),ks=O({tile_:function(t,e){var n=T(t,"x","tile",null);I(n.rank===e.length,function(){return"Error in transpose: rank of input "+n.rank+" must match length of reps "+e+"."});var r=[n],o={reps:e};return L.runKernelFunc(function(i,a){var s=i.tile(n,e);return a([n]),s},{x:n},function(i,a){var s=a[0];return{x:function(){var u=Ne(s);if(s.rank===1)for(var l=0;l<e[0];++l)u=u.add(i.slice([l*s.shape[0]],[s.shape[0]]));else if(s.rank===2)for(l=0;l<e[0];++l)for(var c=0;c<e[1];++c)u=u.add(i.slice([l*s.shape[0],c*s.shape[1]],[s.shape[0],s.shape[1]]));else if(s.rank===3)for(l=0;l<e[0];++l)for(c=0;c<e[1];++c)for(var d=0;d<e[2];++d)u=u.add(i.slice([l*s.shape[0],c*s.shape[1],d*s.shape[2]],[s.shape[0],s.shape[1],s.shape[2]]));else{if(s.rank!==4)throw new Error("Gradient for tile operation is not implemented for rank-"+s.rank+" tensors yet.");for(l=0;l<e[0];++l)for(c=0;c<e[1];++c)for(d=0;d<e[2];++d)for(var f=0;f<e[3];++f)u=u.add(i.slice([l*s.shape[0],c*s.shape[1],d*s.shape[2],f*s.shape[3]],[s.shape[0],s.shape[1],s.shape[2],s.shape[3]]))}return u}}},"Tile",o,r)}}),wB=O({truncatedNormal_:function(t,e,n,r,o){if(e===void 0&&(e=0),n===void 0&&(n=1),r!=null&&r==="bool")throw new Error("Unsupported data type "+r);for(var i=new vy(e,n,r,!0,o),a=ge(t,r),s=0;s<a.values.length;s++)a.values[s]=i.nextValue();return a.toTensor()}}),Et=O({unstack_:function(t,e){e===void 0&&(e=0),e=e||0;var n=T(t,"x","unstack");I(e>=-n.shape.length&&e<n.shape.length,function(){return"Axis = "+e+" is not in [-"+n.shape.length+", "+n.shape.length+")"}),e<0&&(e+=n.shape.length);var r={axis:e};return L.runKernelFunc(function(o){return o.unstack(n,e)},{x:n},function(o){return{x:function(){return Fn(o,e)}}},"Unpack",r)}}),xB=function(t,e){return ie(this,void 0,void 0,function(){var n,r,o,i,a,s,u,l,c,d;return ae(this,function(f){switch(f.label){case 0:return n=T(t,"x","setdiff1d"),r=T(e,"y","setdiff1d"),I(n.dtype===r.dtype,function(){return"x and y should have the same dtype, but got x ("+n.dtype+") and y ("+r.dtype+")."}),I(n.rank===1,function(){return"x should be 1D tensor, but got x ("+n.shape+")."}),I(r.rank===1,function(){return"y should be 1D tensor, but got y ("+r.shape+")."}),[4,n.data()];case 1:return o=f.sent(),[4,r.data()];case 2:for(i=f.sent(),a=new Set(i),s=0,c=0;c<o.length;c++)a.has(o[c])||s++;for(u=new Rl([s],n.dtype),l=new Rl([s],"int32"),c=0,d=0;c<o.length;c++)a.has(o[c])||(u.values[d]=o[c],l.values[d]=c,d++);return[2,[u.toTensor(),l.toTensor()]]}})})};function af(t,e,n,r){r===void 0&&(r=!0);var o=[];if(r)(o=o.concat(e.slice(0))).push(t[0]/n),o=o.concat(t.slice(1));else{o=o.concat(t[0]);for(var i=e.length,a=0;a<i;++a)o=o.concat([t[a+1]/e[a],e[a]]);o=o.concat(t.slice(i+1))}return o}function sf(t,e,n){n===void 0&&(n=!0);var r=[];if(n){r.push(e);for(var o=e+1;o<t;++o)o<=2*e?(r.push(o),r.push(o-(e+1))):r.push(o)}else{var i=[],a=[];for(o=1;o<t;++o)o>=2*e+1||o%2==1?a.push(o):i.push(o);r.push.apply(r,i),r.push(0),r.push.apply(r,a)}return r}function uf(t,e,n,r){r===void 0&&(r=!0);var o=[];r?o.push(t[0]/n):o.push(t[0]*n);for(var i=1;i<t.length;++i)i<=e.length?r?o.push(e[i-1]*t[i]):o.push(t[i]/e[i-1]):o.push(t[i]);return o}function oS(t,e){for(var n=[0],r=0;r<e;++r)n.push(t[r][0]);return n}function iS(t,e,n){for(var r=t.slice(0,1),o=0;o<n;++o)r.push(t[o+1]-e[o][0]-e[o][1]);return r}function aS(t,e){if(t.rank<1)throw new Error("tf.gatherND() expects the input to be rank 1 or higher, but the rank was "+t.rank+".");if(e.rank<1)throw new Error("tf.gatherND() expects the indices to be rank 1 or higher, but the rank was "+e.rank+".");if(e.dtype!=="int32")throw new Error("tf.gatherND() expects the indices to be int32 type, but the dtype was "+e.dtype+".");if(e.shape[e.rank-1]>t.rank)throw new Error("index innermost dimension length must be <= tensor rank; saw: "+e.shape[e.rank-1]+" vs. "+t.rank);if(t.size===0)throw new Error("Requested more than 0 entries, but input is empty. Input shape: "+t.shape+".");for(var n=e.shape,r=n[n.length-1],o=1,i=0;i<n.length-1;++i)o*=n[i];var a=t.shape,s=n.slice();s.pop();var u=1;for(i=r;i<t.rank;++i)u*=a[i],s.push(a[i]);var l=Gr(t.shape).map(function(c){return c/u}).concat([1]).slice(0,r);return[s,o,u,l]}var sS=30;function _p(t){return t<=sS?t:bm(t,Math.floor(Math.sqrt(t)))}function bB(t,e,n){var r=e.rank>1?e.shape[e.rank-1]:1,o=e.rank>1?e.rank-1:1,i="Must have updates.shape = indices.shape[:batchDim] + shape[sliceDim:], got updates.shape: "+n.shape+", indices.shape: "+e.shape+", shape: "+t+", sliceDim: "+r+", and batchDim: "+o+".";if(n.rank<o)throw new Error(i+" update.rank < "+o+". ");if(t.length<r+(n.rank-o))throw new Error(i+" Output shape length < "+(r+(n.rank-o)));if(n.rank!==o+t.length-r)throw new Error(i+" update.rank != "+(o+t.length-r));for(var a=0;a<o;++a)if(n.shape[a]!==e.shape[a])throw new Error(i+" updates.shape["+a+"] ("+n.shape[a]+") != indices.shape["+a+"] ("+e.shape[a]+").");for(a=0;a<n.rank-o;++a)if(n.shape[a+o]!==t[a+r])throw new Error(i+" updates.shape["+(a+o)+"] ("+n.shape[a+o]+") != shape["+(a+o)+"] ("+t[a+o]+")")}function _B(t,e,n){if(e.rank<1)throw new Error("tf.scatterND() expects the indices to be rank 1 or higher, but the rank was "+e.rank+".");if(t.rank<1)throw new Error("tf.scatterND() expects the updates to be rank 1 or higher, but the rank was "+t.rank+".");if(e.dtype!=="int32")throw new Error("The dtype of 'indices' should be int32, but got dtype: "+e.dtype);if(n.length<1)throw new Error("Output rank must be greater or equal to 1, but got shape: "+n);if(n.length===0){if(e.size===0)throw new Error("Indices specified for empty output. indices shape: "+e.shape);if(t.size===0)throw new Error("Updates specified for empty output. updates shape: "+t.shape)}bB(n,e,t)}function lf(t,e,n){for(var r=e.shape.length,o=r>1?e.shape[r-1]:1,i=n.length,a=1,s=o;s<i;++s)a*=n[s];var u=o<1?1:o;return{sliceRank:o,numUpdates:se(e.shape)/u,sliceSize:a,strides:Gr(n.slice(0,o)).concat([1]),outputSize:se(n)}}function EB(t,e,n){I(t.rank===e.length,function(){return"Error in slice"+t.rank+"D: Length of begin "+e+" must match the rank of the array ("+t.rank+")."}),I(t.rank===n.length,function(){return"Error in slice"+t.rank+"D: Length of size "+n+" must match the rank of the array ("+t.rank+")."});for(var r=function(i){I(e[i]+n[i]<=t.shape[i],function(){return"Error in slice"+t.rank+"D: begin["+i+"] + size["+i+"] ("+(e[i]+n[i])+") would overflow input.shape["+i+"] ("+t.shape[i]+")"})},o=0;o<t.rank;++o)r(o)}function Xw(t){for(var e=[],n=0;t>0;)1&t&&e.push(n),t/=2,n++;return e}function my(t,e,n){for(var r=[],o=0;o<t.length;o++)r[o]=Math.ceil((e[o]-t[o])/n[o]);return r}function CB(t,e,n,r,o){var i=e[o],a=n[o]||1;(t&1<<o||i==null)&&(i=a>0?Number.MIN_SAFE_INTEGER:Number.MAX_SAFE_INTEGER);var s=r[o];return i<0&&(i+=s),i=ym(0,i,s-1)}function SB(t,e,n,r,o){var i=e[o],a=n[o]||1;(t&1<<o||i==null)&&(i=a>0?Number.MAX_SAFE_INTEGER:Number.MIN_SAFE_INTEGER);var s=r[o];return i<0&&(i+=s),i=a>0?ym(0,i,s):ym(-1,i,s-1)}function uS(t,e,n){for(var r=n.length,o=0;o<n.length;o++)if(n[o]>1){r=o;break}for(o=r+1;o<n.length;o++)if(e[o]>0||n[o]!==t[o])return!1;return!0}function lS(t,e){for(var n=t.length>0?t[t.length-1]:1,r=0;r<t.length-1;r++)n+=t[r]*e[r];return n}function kB(t,e){I(xm(t),function(){return"The f passed in variableGrads(f) must be a function"}),I(e==null||Array.isArray(e)&&e.every(function(c){return c instanceof ru}),function(){return"The varList passed in variableGrads(f, varList) must be an array of variables"});var n=e!=null;if(!n)for(var r in e=[],L.registeredVariables)e.push(L.registeredVariables[r]);var o=n?e.filter(function(c){return!c.trainable}):null,i=e.length;I((e=e.filter(function(c){return c.trainable})).length>0,function(){return"variableGrads() expects at least one of the input variables to be trainable, but none of the "+i+" variables is trainable."});var a=L.gradients(t,e,null,!0),s=a.value,u=a.grads;I(u.some(function(c){return c!=null}),function(){return"Cannot find a connection between any variable and the result of the loss function y=f(x). Please make sure the operations that use variables are inside the function f passed to minimize()."}),I(s.rank===0,function(){return"The f passed in variableGrads(f) must return a scalar, but it returned a rank-"+s.rank+" tensor"});var l={};return e.forEach(function(c,d){u[d]!=null&&(l[c.name]=u[d])}),o!=null&&o.forEach(function(c){return l[c.name]=null}),{value:s,grads:l}}function rh(t){return L.customGrad(t)}var Ro=O({softmax_:function(t,e){e===void 0&&(e=-1);var n=T(t,"logits","softmax","float32");if(e===-1&&(e=n.rank-1),e!==n.rank-1)throw Error("Softmax along a non-last dimension is not yet supported. Logits was rank "+n.rank+" and dim was "+e);return L.runKernelFunc(function(r,o){var i=r.softmax(n,e);return o([i]),i},{logits:n},function(r,o){var i=o[0],a=r.mul(i);return{logits:function(){return a.sub(a.sum([e],!0).mul(i))}}},"Softmax",{dim:e},[],[!0])}}),RB=O({logSoftmax_:function(t,e){e===void 0&&(e=-1);var n=T(t,"logits","logSoftmax");if(e===-1&&(e=n.rank-1),e!==n.rank-1)throw Error("Log Softmax along a non-last dimension is not yet supported. Logits was rank "+n.rank+" and axis was "+e);return rh(function(r,o){var i=r.max(e,!0),a=r.sub(i),s=a.toFloat().sub(a.exp().sum(e,!0).log());return o([s]),{value:s,gradFunc:function(u,l){var c=l[0].exp();return u.sub(u.sum(e,!0).mul(c))}}})(n)}}),cS=function(){function t(e,n){this.backend=e,this.dataMover=n,this.data=new WeakMap,this.dataIdsCount=0}return t.prototype.get=function(e){return this.data.has(e)||this.dataMover.moveData(this.backend,e),this.data.get(e)},t.prototype.set=function(e,n){this.dataIdsCount++,this.data.set(e,n)},t.prototype.has=function(e){return this.data.has(e)},t.prototype.delete=function(e){return this.dataIdsCount--,this.data.delete(e)},t.prototype.numDataIds=function(){return this.dataIdsCount},t}(),dS=function(){function t(){}return t.prototype.time=function(e){return z("time")},t.prototype.read=function(e){return z("read")},t.prototype.readSync=function(e){return z("readSync")},t.prototype.numDataIds=function(){return z("numDataIds")},t.prototype.disposeData=function(e){return z("disposeData")},t.prototype.write=function(e,n,r){return z("write")},t.prototype.move=function(e,n,r,o){return z("move")},t.prototype.memory=function(){return z("memory")},t.prototype.floatPrecision=function(){return z("floatPrecision")},t.prototype.epsilon=function(){return this.floatPrecision()===32?1e-7:1e-4},t.prototype.batchMatMul=function(e,n,r,o){return z("batchMatMul")},t.prototype.fusedBatchMatMul=function(e){return e.a,e.b,e.transposeA,e.transposeB,e.bias,e.activation,e.preluActivationWeights,z("fusedBatchMatMul")},t.prototype.slice=function(e,n,r){return z("slice")},t.prototype.stridedSlice=function(e,n,r,o){return z("stridedSlice")},t.prototype.unstack=function(e,n){return z("unstack")},t.prototype.reverse=function(e,n){return z("reverse")},t.prototype.concat=function(e,n){return z("concat")},t.prototype.neg=function(e){return z("neg")},t.prototype.add=function(e,n){return z("add")},t.prototype.addN=function(e){return z("addN")},t.prototype.subtract=function(e,n){return z("subtract")},t.prototype.multiply=function(e,n){return z("multiply")},t.prototype.realDivide=function(e,n){return z("realDivide")},t.prototype.floorDiv=function(e,n){return z("floorDiv")},t.prototype.sum=function(e,n){return z("sum")},t.prototype.prod=function(e,n){return z("prod")},t.prototype.unsortedSegmentSum=function(e,n,r){return z("unsortedSegmentSum")},t.prototype.argMin=function(e,n){return z("argMin")},t.prototype.argMax=function(e,n){return z("argMax")},t.prototype.equal=function(e,n){return z("equal")},t.prototype.notEqual=function(e,n){return z("notEqual")},t.prototype.less=function(e,n){return z("less")},t.prototype.lessEqual=function(e,n){return z("lessEqual")},t.prototype.greater=function(e,n){return z("greater")},t.prototype.greaterEqual=function(e,n){return z("greaterEqual")},t.prototype.logicalNot=function(e){return z("logicalNot")},t.prototype.logicalAnd=function(e,n){return z("logicalAnd")},t.prototype.logicalOr=function(e,n){return z("logicalOr")},t.prototype.where=function(e){return z("where")},t.prototype.select=function(e,n,r){return z("select")},t.prototype.topk=function(e,n,r){return z("topk")},t.prototype.min=function(e,n){return z("min")},t.prototype.minimum=function(e,n){return z("minimum")},t.prototype.mod=function(e,n){return z("mod")},t.prototype.max=function(e,n){return z("max")},t.prototype.maximum=function(e,n){return z("maximum")},t.prototype.all=function(e,n){return z("all")},t.prototype.any=function(e,n){return z("any")},t.prototype.squaredDifference=function(e,n){return z("squaredDifference")},t.prototype.ceil=function(e){return z("ceil")},t.prototype.floor=function(e){return z("floor")},t.prototype.round=function(e){return z("round")},t.prototype.sign=function(e){return z("sign")},t.prototype.isNaN=function(e){return z("isNaN")},t.prototype.isInf=function(e){return z("isInf")},t.prototype.isFinite=function(e){return z("isFinite")},t.prototype.pow=function(e,n){return z("pow")},t.prototype.exp=function(e){return z("exp")},t.prototype.expm1=function(e){return z("expm1")},t.prototype.softmax=function(e,n){return z("softmax")},t.prototype.log=function(e){return z("log")},t.prototype.log1p=function(e){return z("log1p")},t.prototype.sqrt=function(e){return z("sqrt")},t.prototype.rsqrt=function(e){return z("rsqrt")},t.prototype.square=function(e){return z("square")},t.prototype.reciprocal=function(e){return z("reciprocal")},t.prototype.relu=function(e){return z("relu")},t.prototype.relu6=function(e){return z("relu6")},t.prototype.prelu=function(e,n){return z("prelu")},t.prototype.elu=function(e){return z("elu")},t.prototype.eluDer=function(e,n){return z("eluDer")},t.prototype.selu=function(e){return z("selu")},t.prototype.int=function(e){return z("int")},t.prototype.clip=function(e,n,r){return z("clip")},t.prototype.abs=function(e){return z("abs")},t.prototype.complexAbs=function(e){return z("complexAbs")},t.prototype.sigmoid=function(e){return z("sigmoid")},t.prototype.softplus=function(e){return z("softplus")},t.prototype.sin=function(e){return z("sin")},t.prototype.cos=function(e){return z("cos")},t.prototype.tan=function(e){return z("tan")},t.prototype.asin=function(e){return z("asin")},t.prototype.acos=function(e){return z("acos")},t.prototype.atan=function(e){return z("atan")},t.prototype.atan2=function(e,n){return z("atan2")},t.prototype.sinh=function(e){return z("sinh")},t.prototype.cosh=function(e){return z("cosh")},t.prototype.tanh=function(e){return z("tanh")},t.prototype.asinh=function(e){return z("asinh")},t.prototype.acosh=function(e){return z("acosh")},t.prototype.atanh=function(e){return z("atanh")},t.prototype.erf=function(e){return z("erf")},t.prototype.step=function(e,n){return z("step")},t.prototype.fusedConv2d=function(e){return e.input,e.filter,e.convInfo,e.bias,e.activation,e.preluActivationWeights,z("fusedConv2d")},t.prototype.conv2d=function(e,n,r){return z("conv2d")},t.prototype.conv2dDerInput=function(e,n,r){return z("conv2dDerInput")},t.prototype.conv2dDerFilter=function(e,n,r){return z("conv2dDerFilter")},t.prototype.fusedDepthwiseConv2D=function(e){return e.input,e.filter,e.convInfo,e.bias,e.activation,e.preluActivationWeights,z("fusedDepthwiseConv2D")},t.prototype.depthwiseConv2D=function(e,n,r){return z("depthwiseConv2D")},t.prototype.depthwiseConv2DDerInput=function(e,n,r){return z("depthwiseConv2DDerInput")},t.prototype.depthwiseConv2DDerFilter=function(e,n,r){return z("depthwiseConv2DDerFilter")},t.prototype.conv3d=function(e,n,r){return z("conv3d")},t.prototype.conv3dDerInput=function(e,n,r){return z("conv3dDerInput")},t.prototype.conv3dDerFilter=function(e,n,r){return z("conv3dDerFilter")},t.prototype.maxPool=function(e,n){return z("maxPool")},t.prototype.maxPoolBackprop=function(e,n,r,o){return z("maxPoolBackprop")},t.prototype.avgPool=function(e,n){return z("avgPool")},t.prototype.avgPoolBackprop=function(e,n,r){return z("avgPoolBackprop")},t.prototype.avgPool3d=function(e,n){return z("avgPool3d")},t.prototype.avgPool3dBackprop=function(e,n,r){return z("avgPool3dBackprop")},t.prototype.maxPool3d=function(e,n){return z("maxPool3d")},t.prototype.maxPool3dBackprop=function(e,n,r,o){return z("maxPool3dBackprop")},t.prototype.reshape=function(e,n){return z("reshape")},t.prototype.cast=function(e,n){return z("cast")},t.prototype.tile=function(e,n){return z("tile")},t.prototype.pad=function(e,n,r){return z("pad")},t.prototype.transpose=function(e,n){return z("transpose")},t.prototype.gather=function(e,n,r){return z("gather")},t.prototype.gatherND=function(e,n){return z("gatherND")},t.prototype.scatterND=function(e,n,r){return z("scatterND")},t.prototype.batchToSpaceND=function(e,n,r){return z("batchToSpaceND")},t.prototype.spaceToBatchND=function(e,n,r){return z("spaceToBatchND")},t.prototype.resizeBilinear=function(e,n,r,o){return z("resizeBilinear")},t.prototype.resizeBilinearBackprop=function(e,n,r){return z("resizeBilinearBackprop")},t.prototype.resizeNearestNeighbor=function(e,n,r,o){return z("resizeNearestNeighbor")},t.prototype.resizeNearestNeighborBackprop=function(e,n,r){return z("resizeNearestNeighborBackprop")},t.prototype.batchNormalization=function(e,n,r,o,i,a){return z("batchNormalization")},t.prototype.localResponseNormalization4D=function(e,n,r,o,i){return z("localResponseNormalization4D")},t.prototype.LRNGrad=function(e,n,r,o,i,a,s){return z("LRNGrad")},t.prototype.multinomial=function(e,n,r,o){return z("multinomial")},t.prototype.oneHot=function(e,n,r,o){return z("oneHot")},t.prototype.cumsum=function(e,n,r,o){return z("cumsum")},t.prototype.nonMaxSuppression=function(e,n,r,o,i){return z("nonMaxSuppression")},t.prototype.fft=function(e){return z("fft")},t.prototype.ifft=function(e){return z("ifft")},t.prototype.complex=function(e,n){return z("complex")},t.prototype.real=function(e){return z("real")},t.prototype.imag=function(e){return z("imag")},t.prototype.cropAndResize=function(e,n,r,o,i,a){return z("cropAndResize")},t.prototype.depthToSpace=function(e,n,r){return z("depthToSpace")},t.prototype.split=function(e,n,r){return z("split")},t.prototype.sparseToDense=function(e,n,r,o){return z("sparseToDense")},t.prototype.diag=function(e){return z("diag")},t.prototype.fill=function(e,n,r){return z("fill")},t.prototype.onesLike=function(e){return z("onesLike")},t.prototype.zerosLike=function(e){return z("zerosLike")},t.prototype.linspace=function(e,n,r){return z("linspace")},t.prototype.dispose=function(){return z("dispose")},t}();function z(t){throw new Error("'"+t+"' not yet implemented or not found in the registry. Did you forget to import the kernel?")}function ci(t,e){for(var n=t.length,r=[],o=0;o<n;o++){var i=n-1-o,a=t[i]||1;(e[e.length-1-o]||1)>1&&a===1&&r.unshift(i)}return r}function Ct(t,e){for(var n=[],r=0;r<e.length;r++){var o=t[t.length-r-1],i=e.length-r-1,a=e[i];(o==null||o===1&&a>1)&&n.unshift(i)}return n}function Te(t,e){for(var n=[],r=Math.max(t.length,e.length),o=0;o<r;o++){var i=t[t.length-o-1];i==null&&(i=1);var a=e[e.length-o-1];if(a==null&&(a=1),i===1)n.unshift(a);else if(a===1)n.unshift(i);else{if(i!==a)throw Error("Operands could not be broadcast together with shapes "+t+" and "+e+".");n.unshift(i)}}return n}function Il(t,e,n,r,o,i,a){a===void 0&&(a="channelsLast");var s,u=ff(e),l=u[0],c=u[1];if(a==="channelsLast")s=[l,c,t[3],t[3]];else{if(a!=="channelsFirst")throw new Error("Unknown dataFormat "+a);s=[l,c,t[1],t[1]]}return Na(t,s,n,r,o,i,!1,a)}function cf(t,e,n,r,o,i,a){a===void 0&&(a="NDHWC");var s,u,l=Tm(e),c=l[0],d=l[1],f=l[2];if(a==="NDHWC")u="channelsLast",s=[c,d,f,t[4],t[4]];else{if(a!=="NCDHW")throw new Error("Unknown dataFormat "+a);u="channelsFirst",s=[c,d,f,t[1],t[1]]}return df(t,s,n,r,o,!1,u,i)}function Na(t,e,n,r,o,i,a,s){a===void 0&&(a=!1),s===void 0&&(s="channelsLast");var u=[-1,-1,-1,-1],l=u[0],c=u[1],d=u[2],f=u[3];if(s==="channelsLast")l=t[0],c=t[1],d=t[2],f=t[3];else{if(s!=="channelsFirst")throw new Error("Unknown dataFormat "+s);l=t[0],f=t[1],c=t[2],d=t[3]}var h,v=e[0],p=e[1],m=e[3],g=ff(n),y=g[0],w=g[1],x=ff(r),b=x[0],_=x[1],E=Rs(v,b),C=Rs(p,_),R=function(M,j,W,U,D,F,$,q){var K,Q,Z;if(typeof M=="number"){K={top:M,bottom:M,left:M,right:M,type:M===0?"VALID":"NUMBER"};var ue=function(me,Ae,Ce,Ue,ze){Ue==null&&(Ue=fS(me,Ae,Ce));var je=me[0],ln=me[1],jt=el((je-Ae+2*Ue)/Ce+1,ze);I(dt(jt),function(){return"The output # of rows ("+jt+") must be an integer. Change the stride and/or zero pad parameters"});var ft=el((ln-Ae+2*Ue)/Ce+1,ze);return I(dt(ft),function(){return"The output # of columns ("+ft+") must be an integer. Change the stride and/or zero pad parameters"}),[jt,ft]}([j,W],F,U,M,q);Q=ue[0],Z=ue[1]}else if(M==="same"){Q=Math.ceil(j/U),Z=Math.ceil(W/D);var fe=Math.max(0,(Q-1)*U+F-j),oe=Math.max(0,(Z-1)*D+$-W),xe=Math.floor(fe/2),ye=fe-xe,Be=Math.floor(oe/2);K={top:xe,bottom:ye,left:Be,right:oe-Be,type:"SAME"}}else{if(M!=="valid")throw Error("Unknown padding parameter: "+M);K={top:0,bottom:0,left:0,right:0,type:"VALID"},Q=Math.ceil((j-F+1)/U),Z=Math.ceil((W-$+1)/D)}return{padInfo:K,outHeight:Q,outWidth:Z}}(o,c,d,y,w,E,C,i),S=R.padInfo,P=R.outHeight,A=R.outWidth,B=a?m*f:m;return s==="channelsFirst"?h=[l,B,P,A]:s==="channelsLast"&&(h=[l,P,A,B]),{batchSize:l,dataFormat:s,inHeight:c,inWidth:d,inChannels:f,outHeight:P,outWidth:A,outChannels:B,padInfo:S,strideHeight:y,strideWidth:w,filterHeight:v,filterWidth:p,effectiveFilterHeight:E,effectiveFilterWidth:C,dilationHeight:b,dilationWidth:_,inShape:t,outShape:h,filterShape:e}}function df(t,e,n,r,o,i,a,s){i===void 0&&(i=!1),a===void 0&&(a="channelsLast");var u=[-1,-1,-1,-1,-1],l=u[0],c=u[1],d=u[2],f=u[3],h=u[4];if(a==="channelsLast")l=t[0],c=t[1],d=t[2],f=t[3],h=t[4];else{if(a!=="channelsFirst")throw new Error("Unknown dataFormat "+a);l=t[0],h=t[1],c=t[2],d=t[3],f=t[4]}var v,p=e[0],m=e[1],g=e[2],y=e[4],w=Tm(n),x=w[0],b=w[1],_=w[2],E=Tm(r),C=E[0],R=E[1],S=E[2],P=Rs(p,C),A=Rs(m,R),B=Rs(g,S),M=function($,q,K,Q,Z,ue,fe,oe,xe,ye,Be){var me,Ae,Ce,Ue;if(typeof $=="number"){me={top:$,bottom:$,left:$,right:$,front:$,back:$,type:$===0?"VALID":"NUMBER"};var ze=function(No,tr,Wt,Cn,$n,yu){$n==null&&($n=fS(No,tr,Cn));var Ma=No[0],gh=No[1],sc=No[2],ji=el((Ma-tr+2*$n)/Cn+1,yu);I(dt(ji),function(){return"The output # of depths ("+ji+") must be an integer. Change the stride and/or zero pad parameters"});var kr=el((gh-tr+2*$n)/Cn+1,yu);I(dt(kr),function(){return"The output # of rows ("+kr+") must be an integer. Change the stride and/or zero pad parameters"});var La=el((sc-tr+2*$n)/Cn+1,yu);return I(dt(La),function(){return"The output # of columns ("+La+") must be an integer. Change the stride and/or zero pad parameters"}),[ji,kr,La,Wt]}([q,K,Q,1],oe,1,Z,$,Be);Ae=ze[0],Ce=ze[1],Ue=ze[2]}else if($==="same"){Ae=Math.ceil(q/Z),Ce=Math.ceil(K/ue),Ue=Math.ceil(Q/fe);var je=(Ae-1)*Z+oe-q,ln=(Ce-1)*ue+xe-K,jt=(Ue-1)*fe+ye-Q,ft=Math.floor(je/2),to=je-ft,Zt=Math.floor(ln/2),er=ln-Zt,Nt=Math.floor(jt/2);me={top:Zt,bottom:er,left:Nt,right:jt-Nt,front:ft,back:to,type:"SAME"}}else{if($!=="valid")throw Error("Unknown padding parameter: "+$);me={top:0,bottom:0,left:0,right:0,front:0,back:0,type:"VALID"},Ae=Math.ceil((q-oe+1)/Z),Ce=Math.ceil((K-xe+1)/ue),Ue=Math.ceil((Q-ye+1)/fe)}return{padInfo:me,outDepth:Ae,outHeight:Ce,outWidth:Ue}}(o,c,d,f,x,b,_,P,A,B,s),j=M.padInfo,W=M.outDepth,U=M.outHeight,D=M.outWidth,F=i?y*h:y;return a==="channelsFirst"?v=[l,F,W,U,D]:a==="channelsLast"&&(v=[l,W,U,D,F]),{batchSize:l,dataFormat:a,inDepth:c,inHeight:d,inWidth:f,inChannels:h,outDepth:W,outHeight:U,outWidth:D,outChannels:F,padInfo:j,strideDepth:x,strideHeight:b,strideWidth:_,filterDepth:p,filterHeight:m,filterWidth:g,effectiveFilterDepth:P,effectiveFilterHeight:A,effectiveFilterWidth:B,dilationDepth:C,dilationHeight:R,dilationWidth:S,inShape:t,outShape:v,filterShape:e}}function fS(t,e,n,r){r===void 0&&(r=1);var o=Rs(e,r);return Math.floor((t[0]*(n-1)-n+o)/2)}function ff(t){return typeof t=="number"?[t,t,t]:t.length===2?[t[0],t[1],1]:t}function Tm(t){return typeof t=="number"?[t,t,t]:t}function Rs(t,e){return e<=1?t:t+(t-1)*(e-1)}function el(t,e){if(!e)return t;switch(e){case"round":return Math.round(t);case"ceil":return Math.ceil(t);case"floor":return Math.floor(t);default:throw new Error("Unknown roundingMode "+e)}}function iu(t){var e=ff(t),n=e[0],r=e[1],o=e[2];return n===1&&r===1&&o===1}function En(t,e){return iu(t)||iu(e)}function gy(t){if(t==="NHWC")return"channelsLast";if(t==="NCHW")return"channelsFirst";throw new Error("Unknown dataFormat "+t)}function hS(t,e,n){if(e==="complex64"){if(t.dtype==="complex64")return t.clone();var r=Ye(t.shape),o=t.toFloat(),i=n.complex(o,r);return r.dispose(),o.dispose(),i}if(!eL(t.dtype,e))return L.makeTensorFromDataId(t.dataId,t.shape,e);if(t.dtype==="complex64"){var a=n.real(t);return i=a.cast(e),a.dispose(),i}if(e==="int32")return n.int(t);if(e==="bool"){var s=ee(0,t.dtype);return i=n.notEqual(t,s),s.dispose(),i}throw new Error("Error in Cast: failed to cast "+t.dtype+" to "+e)}function Im(t,e){return L.makeTensorFromDataId(t.dataId,e,t.dtype)}function pS(t,e,n){var r=(e-t)/(n-1),o=Yl(n,"float32");o[0]=t;for(var i=1;i<o.length;i++)o[i]=o[i-1]+r;return pt(o,"float32")}function Am(t,e){if(t.length!==e.length)throw new Error("Cannot merge real and imag arrays of different lengths. real:"+t.length+", imag: "+e.length+".");for(var n=new Float32Array(2*t.length),r=0;r<n.length;r+=2)n[r]=t[r/2],n[r+1]=e[r/2];return n}function Yw(t,e){return{real:t[2*e],imag:t[2*e+1]}}function TB(t,e,n,r){t[2*r]=e,t[2*r+1]=n}function IB(t,e,n){var r=(n?2:-2)*Math.PI*(t/e);return{real:Math.cos(r),imag:Math.sin(r)}}function AB(t,e,n){var r=function(i,a,s){return function(u,l,c){for(var d=0,f=u.length,h=0,v=!1;d<f;){var p=c(l,u[h=d+(f-d>>>1)]);p>0?d=h+1:(f=h,v=!p)}return v?d:-d-1}(i,a,s||PB)}(t,e,n),o=r<0?-(r+1):r;t.splice(o,0,e)}function PB(t,e){return t>e?1:t<e?-1:0}function yy(t,e,n,r,o){return vS(t,e,n,r,o,0).selectedIndices}function wy(t,e,n,r,o,i){var a=vS(t,e,n,r,o,i);return a.numValidOutputs.dispose(),{selectedIndices:a.selectedIndices,selectedScores:a.selectedScores}}function vS(t,e,n,r,o,i,a,s){s===void 0&&(s=!1);for(var u=Array.from(e).map(function(x,b){return{score:x,boxIndex:b,suppressBeginIndex:0}}).filter(function(x){return x.score>o}).sort(Qw),l=i>0?-.5/i:0,c=[],d=[];c.length<n&&u.length>0;){var f=u.pop(),h=f.score,v=f.boxIndex,p=f.suppressBeginIndex;if(h<o)break;for(var m=!1,g=c.length-1;g>=p;--g){var y=DB(t,v,c[g]);if(y>=r){m=!0;break}if(f.score=f.score*NB(r,l,y),f.score<=o)break}f.suppressBeginIndex=c.length,m||(f.score===h?(c.push(v),d.push(f.score)):f.score>o&&AB(u,f,Qw))}var w=c.length;return s&&(c.fill(0,w),d.fill(0,w)),{selectedIndices:pt(c,"int32"),selectedScores:pt(d,"float32"),numValidOutputs:ee(w,"int32")}}function DB(t,e,n){var r=t.subarray(4*e,4*e+4),o=t.subarray(4*n,4*n+4),i=Math.min(r[0],r[2]),a=Math.min(r[1],r[3]),s=Math.max(r[0],r[2]),u=Math.max(r[1],r[3]),l=Math.min(o[0],o[2]),c=Math.min(o[1],o[3]),d=Math.max(o[0],o[2]),f=Math.max(o[1],o[3]),h=(s-i)*(u-a),v=(d-l)*(f-c);if(h<=0||v<=0)return 0;var p=Math.max(i,l),m=Math.max(a,c),g=Math.min(s,d),y=Math.min(u,f),w=Math.max(g-p,0)*Math.max(y-m,0);return w/(h+v-w)}function NB(t,e,n){var r=Math.exp(e*n*n);return n<=t?r:0}function Qw(t,e){return t.score-e.score||t.score===e.score&&e.boxIndex-t.boxIndex}function mS(t,e,n){var r=new Array(t.rank).fill(0),o=t.shape.slice();return e.map(function(i){o[n]=i;var a=t.slice(r,o);return r[n]+=i,a})}function gS(t,e){for(var n=new Array(t.rank),r=0;r<n.length;r++)n[r]=t.shape[r]*e[r];var o=ge(n,t.dtype);for(r=0;r<o.values.length;++r){for(var i=o.indexToLoc(r),a=new Array(t.rank),s=0;s<a.length;s++)a[s]=i[s]%t.shape[s];var u=t.locToIndex(a);o.values[r]=t.values[u]}return o.toTensor()}function yS(t,e,n,r,o){for(var i=e[e.length-1],a=[t.length/i,i],s=a[0],u=a[1],l=kl(n,s*r),c=kl("int32",s*r),d=0;d<s;d++){for(var f=d*u,h=t.subarray(f,f+u),v=[],p=0;p<h.length;p++)v.push({value:h[p],index:p});v.sort(function(x,b){return b.value-x.value});var m=d*r,g=l.subarray(m,m+r),y=c.subarray(m,m+r);for(p=0;p<r;p++)g[p]=v[p].value,y[p]=v[p].index}var w=e.slice();return w[w.length-1]=r,[Lt(l,w,n),Lt(c,w,"int32")]}function xy(t,e){for(var n=[],r=0;r<e.length;r++)e[r]&&n.push(r);var o=ge(t,"int32"),i=ge([n.length,t.length],"int32");for(r=0;r<n.length;r++){var a=o.indexToLoc(n[r]),s=r*t.length;i.values.set(a,s)}return i.toTensor()}var OB=function(t,e){this.outputShape=[],this.outputShape=t,this.variableNames=e.map(function(o,i){return"T"+i});var n=[];this.variableNames.forEach(function(o){n.push("float v"+o+" = get"+o+"AtOutCoords();")});var r=this.variableNames.map(function(o){return"v"+o}).join(" + ");this.userCode=`
      void main() {
        `+n.join(`
        `)+`

        float result = `+r+`;
        setOutput(result);
      }
    `},FB=function(t,e){this.outputShape=[],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=t,this.variableNames=e.map(function(o,i){return"T"+i});var n=[];this.variableNames.forEach(function(o){n.push("vec4 v"+o+" = get"+o+"AtOutCoords();")});var r=this.variableNames.map(function(o){return"v"+o}).join(" + ");this.userCode=`
      void main() {
        `+n.join(`
        `)+`

        vec4 result = `+r+`;
        setOutput(result);
      }
    `},MB=function(t,e,n){this.variableNames=["A"];var r=t.windowSize,o=t.batchSize,i=t.inSize,a=Math.ceil(i/r);n||this.variableNames.push("bestIndicesA"),this.outputShape=[o,a];var s=e==="max"?">":"<",u=n?"inOffset + i;":"round(getBestIndicesA(batch, inOffset + i));";this.userCode=`
      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];
        int outIdx = coords[1];
        int inOffset = outIdx * `+r+`;

        int bestIndex = inOffset;
        float bestValue = getA(batch, bestIndex);

        for (int i = 0; i < `+r+`; i++) {
          int inIdx = `+u+`;
          float candidate = getA(batch, inIdx);
          if (candidate `+s+` bestValue) {
            bestValue = candidate;
            bestIndex = inIdx;
          }
        }
        setOutput(float(bestIndex));
      }
    `};function wS(t,e){return["x","y","z","w","u","v"].slice(0,e).map(function(n){return t+"."+n})}function mn(t,e){return e===1?[t]:wS(t,e)}function Kt(){var t,e,n,r,o,i,a,s,u,l;return H().getNumber("WEBGL_VERSION")===2?(t="#version 300 es",e="in",n="out",r="in",o="texture",i="outputColor",a="out vec4 outputColor;",s=`
      bool isnan_custom(float val) {
        return (val > 0.0 || val < 0.0) ? false : val != 0.0;
      }

      bvec4 isnan_custom(vec4 val) {
        return bvec4(isnan_custom(val.x),
          isnan_custom(val.y), isnan_custom(val.z), isnan_custom(val.w));
      }

      #define isnan(value) isnan_custom(value)
    `,u="",l=`
      #define round(value) newRound(value)
      int newRound(float value) {
        return int(floor(value + 0.5));
      }

      ivec4 newRound(vec4 value) {
        return ivec4(floor(value + vec4(0.5)));
      }
    `):(t="",e="attribute",n="varying",r="varying",o="texture2D",i="gl_FragColor",a="",s=`
      #define isnan(value) isnan_custom(value)
      bool isnan_custom(float val) {
        return (val > 0. || val < 1. || val == 0.) ? false : true;
      }
      bvec4 isnan_custom(vec4 val) {
        return bvec4(isnan(val.x), isnan(val.y), isnan(val.z), isnan(val.w));
      }
    `,u=`
      uniform float INFINITY;

      bool isinf(float val) {
        return abs(val) == INFINITY;
      }
      bvec4 isinf(vec4 val) {
        return equal(abs(val), vec4(INFINITY));
      }
    `,l=`
      int round(float value) {
        return int(floor(value + 0.5));
      }

      ivec4 round(vec4 value) {
        return ivec4(floor(value + vec4(0.5)));
      }
    `),{version:t,attribute:e,varyingVs:n,varyingFs:r,texture2D:o,output:i,defineOutput:a,defineSpecialNaN:s,defineSpecialInf:u,defineRound:l}}function ta(t,e,n){n===void 0&&(n="index");var r=Gr(e);return r.map(function(o,i){return"int "+t[i]+" = "+n+" / "+o+"; "+(i===r.length-1?"int "+t[i+1]+" = "+n+" - "+t[i]+" * "+o:"index -= "+t[i]+" * "+o)+";"}).join("")}function by(t){var e=Gr(t).map(function(n){return n.toString()});return`
  int getFlatIndex(ivec3 coords) {
    return coords.x * `+e[0]+" + coords.y * "+e[1]+` + coords.z;
  }
`}var xS=`
  const float FLOAT_MAX = 1.70141184e38;
  const float FLOAT_MIN = 1.17549435e-38;

  lowp vec4 encode_float(highp float v) {
    if (isnan(v)) {
      return vec4(255, 255, 255, 255);
    }

    highp float av = abs(v);

    if(av < FLOAT_MIN) {
      return vec4(0.0, 0.0, 0.0, 0.0);
    } else if(v > FLOAT_MAX) {
      return vec4(0.0, 0.0, 128.0, 127.0) / 255.0;
    } else if(v < -FLOAT_MAX) {
      return vec4(0.0, 0.0,  128.0, 255.0) / 255.0;
    }

    highp vec4 c = vec4(0,0,0,0);

    highp float e = floor(log2(av));
    highp float m = exp2(fract(log2(av))) - 1.0;

    c[2] = floor(128.0 * m);
    m -= c[2] / 128.0;
    c[1] = floor(32768.0 * m);
    m -= c[1] / 32768.0;
    c[0] = floor(8388608.0 * m);

    highp float ebias = e + 127.0;
    c[3] = floor(ebias / 2.0);
    ebias -= c[3] * 2.0;
    c[2] += floor(ebias) * 128.0;

    c[3] += 128.0 * step(0.0, -v);

    return c / 255.0;
  }
`;function LB(t,e,n,r){var o=[];t.forEach(function(h){var v=se(h.shapeInfo.logicalShape);h.shapeInfo.isUniform?o.push("uniform float "+h.name+(v>1?"["+v+"]":"")+";"):(o.push("uniform sampler2D "+h.name+";"),o.push("uniform int offset"+h.name+";"))});var i,a,s=o.join(`
`),u=t.map(function(h){return function(v,p,m){m===void 0&&(m=!1);var g="";g+=m?bS(v):es(v);var y=v.shapeInfo.logicalShape,w=p.logicalShape;return y.length<=w.length&&(g+=m?function(x,b){var _,E=x.name,C=E.charAt(0).toUpperCase()+E.slice(1),R="get"+C+"AtOutCoords",S=x.shapeInfo.logicalShape.length,P=b.logicalShape.length,A=ci(x.shapeInfo.logicalShape,b.logicalShape),B=qe(P),M=P-S,j=["x","y","z","w","u","v"];_=S===0?"":P<2&&A.length>=1?"coords = 0;":A.map(function(K){return"coords."+j[K+M]+" = 0;"}).join(`
`);var W="";W=P<2&&S>0?"coords":x.shapeInfo.logicalShape.map(function(K,Q){return"coords."+j[Q+M]}).join(", ");var U="return outputValue;",D=se(x.shapeInfo.logicalShape)===1,F=se(b.logicalShape)===1;if(S!==1||D||F){if(D&&!F)U=P===1?`
        return vec4(outputValue.x, outputValue.x, 0., 0.);
      `:`
        return vec4(outputValue.x);
      `;else if(A.length){var $=S-2,q=S-1;A.indexOf($)>-1&&A.indexOf(q)>-1?U="return vec4(outputValue.x);":A.indexOf($)>-1?U="return vec4(outputValue.x, outputValue.y, outputValue.x, outputValue.y);":A.indexOf(q)>-1&&(U="return vec4(outputValue.xx, outputValue.zz);")}}else U=`
      return vec4(outputValue.xy, outputValue.xy);
    `;return`
    vec4 `+R+`() {
      `+B+` coords = getOutputCoords();
      `+_+`
      vec4 outputValue = get`+C+"("+W+`);
      `+U+`
    }
  `}(v,p):function(x,b){var _=x.name,E=_.charAt(0).toUpperCase()+_.slice(1),C="get"+E+"AtOutCoords",R=b.texShape,S=x.shapeInfo.texShape,P=x.shapeInfo.logicalShape.length,A=b.logicalShape.length;if(!x.shapeInfo.isUniform&&P===A&&x.shapeInfo.flatOffset==null&&At(S,R))return`
      float `+C+`() {
        return sampleTexture(`+_+`, resultUV);
      }
    `;var B,M=qe(A),j=ci(x.shapeInfo.logicalShape,b.logicalShape),W=A-P,U=["x","y","z","w","u","v"];B=P===0?"":A<2&&j.length>=1?"coords = 0;":j.map(function(F){return"coords."+U[F+W]+" = 0;"}).join(`
`);var D="";return D=A<2&&P>0?"coords":x.shapeInfo.logicalShape.map(function(F,$){return"coords."+U[$+W]}).join(", "),`
    float `+C+`() {
      `+M+` coords = getOutputCoords();
      `+B+`
      return get`+E+"("+D+`);
    }
  `}(v,p)),g}(h,e,r)}).join(`
`),l=e.texShape,c=Kt(),d=function(h){return`
    float sampleTexture(sampler2D textureSampler, vec2 uv) {
      return `+h.texture2D+`(textureSampler, uv).r;
    }
  `}(c),f=function(h){return h.version+`
    precision highp float;
    precision highp int;
    precision highp sampler2D;
    `+h.varyingFs+` vec2 resultUV;
    `+h.defineOutput+`
    const vec2 halfCR = vec2(0.5, 0.5);

    struct ivec5
    {
      int x;
      int y;
      int z;
      int w;
      int u;
    };

    struct ivec6
    {
      int x;
      int y;
      int z;
      int w;
      int u;
      int v;
    };

    uniform float NAN;
    `+h.defineSpecialNaN+`
    `+h.defineSpecialInf+`
    `+h.defineRound+`

    int imod(int x, int y) {
      return x - y * (x / y);
    }

    int idiv(int a, int b, float sign) {
      int res = a / b;
      int mod = imod(a, b);
      if (sign < 0. && mod != 0) {
        res -= 1;
      }
      return res;
    }

    //Based on the work of Dave Hoskins
    //https://www.shadertoy.com/view/4djSRW
    #define HASHSCALE1 443.8975
    float random(float seed){
      vec2 p = resultUV * seed;
      vec3 p3  = fract(vec3(p.xyx) * HASHSCALE1);
      p3 += dot(p3, p3.yzx + 19.19);
      return fract((p3.x + p3.y) * p3.z);
    }

    `+BB+`
    `+$B+`
    `+jB+`
  `}(c);return e.isPacked?(i=function(h,v){switch(h.length){case 0:return`
    int getOutputCoords() {
      return 0;
    }
  `;case 1:return function(x,b){var _=[Math.ceil(b[0]/2),Math.ceil(b[1]/2)];return _[0]===1?`
      int getOutputCoords() {
        return 2 * int(resultUV.x * `+_[1]+`.0);
      }
    `:_[1]===1?`
      int getOutputCoords() {
        return 2 * int(resultUV.y * `+_[0]+`.0);
      }
    `:`
    int getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(`+_[0]+", "+_[1]+`));
      return 2 * (resTexRC.x * `+_[1]+` + resTexRC.y);
    }
  `}(0,v);case 2:return function(x,b){var _=[Math.ceil(b[0]/2),Math.ceil(b[1]/2)];if(At(x,b))return`
      ivec2 getOutputCoords() {
        return 2 * ivec2(resultUV.yx * vec2(`+_[0]+", "+_[1]+`));
      }
    `;var E=Math.ceil(x[1]/2);return`
    ivec2 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(`+_[0]+", "+_[1]+`));

      int index = resTexRC.x * `+_[1]+` + resTexRC.y;
      int r = 2 * (index / `+E+`);
      int c = imod(index, `+E+`) * 2;

      return ivec2(r, c);
    }
  `}(h,v);case 3:return p=h,m=v,g=[Math.ceil(m[0]/2),Math.ceil(m[1]/2)],y=Math.ceil(p[2]/2),w=y*Math.ceil(p[1]/2),`
    ivec3 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(`+g[0]+", "+g[1]+`));
      int index = resTexRC.x * `+g[1]+` + resTexRC.y;

      int b = index / `+w+`;
      index -= b * `+w+`;

      int r = 2 * (index / `+y+`);
      int c = imod(index, `+y+`) * 2;

      return ivec3(b, r, c);
    }
  `;default:return function(x,b){for(var _=[Math.ceil(b[0]/2),Math.ceil(b[1]/2)],E=Math.ceil(x[x.length-1]/2),C=E*Math.ceil(x[x.length-2]/2),R=C,S="",P="b, r, c",A=2;A<x.length-1;A++)R*=x[x.length-A-1],S=`
      int b`+A+" = index / "+R+`;
      index -= b`+A+" * "+R+`;
    `+S,P="b"+A+", "+P;return`
    ivec`+x.length+` getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(`+_[0]+", "+_[1]+`));
      int index = resTexRC.x * `+_[1]+` + resTexRC.y;

      `+S+`

      int b = index / `+C+`;
      index -= b * `+C+`;

      int r = 2 * (index / `+E+`);
      int c = imod(index, `+E+`) * 2;

      return ivec`+x.length+"("+P+`);
    }
  `}(h,v)}var p,m,g,y,w}(e.logicalShape,l),a=function(h){return`
    void setOutput(vec4 val) {
      `+h.output+` = val;
    }
  `}(c)):(i=function(h,v){switch(h.length){case 0:return`
    int getOutputCoords() {
      return 0;
    }
  `;case 1:return function(g,y){return y[0]===1?`
      int getOutputCoords() {
        return int(resultUV.x * `+y[1]+`.0);
      }
    `:y[1]===1?`
      int getOutputCoords() {
        return int(resultUV.y * `+y[0]+`.0);
      }
    `:`
    int getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(`+y[0]+", "+y[1]+`));
      return resTexRC.x * `+y[1]+` + resTexRC.y;
    }
  `}(0,v);case 2:return function(g,y){return At(g,y)?`
      ivec2 getOutputCoords() {
        return ivec2(resultUV.yx * vec2(`+y[0]+", "+y[1]+`));
      }
    `:g[1]===1?`
      ivec2 getOutputCoords() {
        ivec2 resTexRC = ivec2(resultUV.yx *
                               vec2(`+y[0]+", "+y[1]+`));
        int index = resTexRC.x * `+y[1]+` + resTexRC.y;
        return ivec2(index, 0);
      }
    `:g[0]===1?`
      ivec2 getOutputCoords() {
        ivec2 resTexRC = ivec2(resultUV.yx *
                               vec2(`+y[0]+", "+y[1]+`));
        int index = resTexRC.x * `+y[1]+` + resTexRC.y;
        return ivec2(0, index);
      }
    `:`
    ivec2 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(`+y[0]+", "+y[1]+`));
      int index = resTexRC.x * `+y[1]+` + resTexRC.y;
      int r = index / `+g[1]+`;
      int c = index - r * `+g[1]+`;
      return ivec2(r, c);
    }
  `}(h,v);case 3:return p=v,m=ta(["r","c","d"],h),`
    ivec3 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(`+p[0]+", "+p[1]+`));
      int index = resTexRC.x * `+p[1]+` + resTexRC.y;
      `+m+`
      return ivec3(r, c, d);
    }
  `;case 4:return function(g,y){var w=ta(["r","c","d","d2"],g);return`
    ivec4 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
        vec2(`+y[0]+", "+y[1]+`));
      int index = resTexRC.x * `+y[1]+` + resTexRC.y;
      `+w+`
      return ivec4(r, c, d, d2);
    }
  `}(h,v);case 5:return function(g,y){var w=ta(["r","c","d","d2","d3"],g);return`
    ivec5 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx * vec2(`+y[0]+`,
                             `+y[1]+`));

      int index = resTexRC.x * `+y[1]+` + resTexRC.y;

      `+w+`

      ivec5 outShape = ivec5(r, c, d, d2, d3);
      return outShape;
    }
  `}(h,v);case 6:return function(g,y){var w=ta(["r","c","d","d2","d3","d4"],g);return`
    ivec6 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
        vec2(`+y[0]+", "+y[1]+`));
      int index = resTexRC.x * `+y[1]+` + resTexRC.y;

      `+w+`

      ivec6 result = ivec6(r, c, d, d2, d3, d4);
      return result;
    }
  `}(h,v);default:throw new Error(h.length+"-D output sampling is not yet supported")}var p,m}(e.logicalShape,l),a=function(h){return`
    void setOutput(float val) {
      `+h.output+` = vec4(val, 0, 0, 0);
    }
  `}(c)),r&&(f+=WB),[f,d,a,s,i,u,n].join(`
`)}function es(t){var e=t.shapeInfo.logicalShape;switch(e.length){case 0:return function(n){var r=n.name,o="get"+r.charAt(0).toUpperCase()+r.slice(1);if(n.shapeInfo.isUniform)return"float "+o+"() {return "+r+";}";var i=n.shapeInfo.texShape,a=i[0],s=i[1];if(a===1&&s===1)return`
      float `+o+`() {
        return sampleTexture(`+r+`, halfCR);
      }
    `;var u=n.shapeInfo.texShape,l=u[0],c=u[1],d=Vi(r);return`
    float `+o+`() {
      vec2 uv = uvFromFlat(`+l+", "+c+", "+d+`);
      return sampleTexture(`+r+`, uv);
    }
  `}(t);case 1:return function(n){var r=n.name,o="get"+r.charAt(0).toUpperCase()+r.slice(1);if(n.shapeInfo.isUniform)return`
      float `+o+`(int index) {
        `+Ka(n)+`
      }
    `;var i=n.shapeInfo.texShape,a=i[0],s=i[1];if(s===1&&a===1)return`
      float `+o+`(int index) {
        return sampleTexture(`+r+`, halfCR);
      }
    `;var u=Vi(r);return s===1?`
      float `+o+`(int index) {
        vec2 uv = vec2(0.5, (float(index + `+u+") + 0.5) / "+a+`.0);
        return sampleTexture(`+r+`, uv);
      }
    `:a===1?`
      float `+o+`(int index) {
        vec2 uv = vec2((float(index + `+u+") + 0.5) / "+s+`.0, 0.5);
        return sampleTexture(`+r+`, uv);
      }
    `:`
    float `+o+`(int index) {
      vec2 uv = uvFromFlat(`+a+", "+s+", index + "+u+`);
      return sampleTexture(`+r+`, uv);
    }
  `}(t);case 2:return function(n){var r=n.shapeInfo.logicalShape,o=n.name,i="get"+o.charAt(0).toUpperCase()+o.slice(1),a=n.shapeInfo.texShape;if(a!=null&&At(r,a)){var s=a[0],u=a[1];return`
    float `+i+`(int row, int col) {
      vec2 uv = (vec2(col, row) + halfCR) / vec2(`+u+".0, "+s+`.0);
      return sampleTexture(`+o+`, uv);
    }
  `}var l=Qi(r),c=l.newShape,d=l.keptDims,f=c;if(f.length<r.length){var h=ts(n,f);return`
      `+es(h)+`
      float `+i+`(int row, int col) {
        return `+i+"("+ns(["row","col"],d)+`);
      }
    `}if(n.shapeInfo.isUniform)return`
      float `+i+`(int row, int col) {
        int index = round(dot(vec2(row, col), vec2(`+r[1]+`, 1)));
        `+Ka(n)+`
      }
    `;var v=a[0],p=a[1],m=Vi(o);return p===1?`
    float `+i+`(int row, int col) {
      float index = dot(vec3(row, col, `+m+"), vec3("+r[1]+`, 1, 1));
      vec2 uv = vec2(0.5, (index + 0.5) / `+v+`.0);
      return sampleTexture(`+o+`, uv);
    }
  `:v===1?`
    float `+i+`(int row, int col) {
      float index = dot(vec3(row, col, `+m+"), vec3("+r[1]+`, 1, 1));
      vec2 uv = vec2((index + 0.5) / `+p+`.0, 0.5);
      return sampleTexture(`+o+`, uv);
    }
  `:`
  float `+i+`(int row, int col) {
    // Explicitly use integer operations as dot() only works on floats.
    int index = row * `+r[1]+" + col + "+m+`;
    vec2 uv = uvFromFlat(`+v+", "+p+`, index);
    return sampleTexture(`+o+`, uv);
  }
`}(t);case 3:return function(n){var r=n.shapeInfo.logicalShape,o=n.name,i="get"+o.charAt(0).toUpperCase()+o.slice(1),a=r[1]*r[2],s=r[2],u=Qi(r),l=u.newShape,c=u.keptDims,d=l;if(d.length<r.length){var f=ts(n,d);return`
        `+es(f)+`
        float `+i+`(int row, int col, int depth) {
          return `+i+"("+ns(["row","col","depth"],c)+`);
        }
      `}if(n.shapeInfo.isUniform)return`
      float `+i+`(int row, int col, int depth) {
        int index = round(dot(vec3(row, col, depth),
                          vec3(`+a+", "+s+`, 1)));
        `+Ka(n)+`
      }
    `;var h=n.shapeInfo.texShape,v=h[0],p=h[1],m=n.shapeInfo.flatOffset;if(p===a&&m==null)return`
        float `+i+`(int row, int col, int depth) {
          float texR = float(row);
          float texC = dot(vec2(col, depth), vec2(`+s+`, 1));
          vec2 uv = (vec2(texC, texR) + halfCR) /
                     vec2(`+p+".0, "+v+`.0);
          return sampleTexture(`+o+`, uv);
        }
      `;if(p===s&&m==null)return`
    float `+i+`(int row, int col, int depth) {
      float texR = dot(vec2(row, col), vec2(`+r[1]+`, 1));
      float texC = float(depth);
      vec2 uv = (vec2(texC, texR) + halfCR) / vec2(`+p+".0, "+v+`.0);
      return sampleTexture(`+o+`, uv);
    }
  `;var g=Vi(o);return`
      float `+i+`(int row, int col, int depth) {
        // Explicitly use integer operations as dot() only works on floats.
        int index = row * `+a+" + col * "+s+" + depth + "+g+`;
        vec2 uv = uvFromFlat(`+v+", "+p+`, index);
        return sampleTexture(`+o+`, uv);
      }
  `}(t);case 4:return function(n){var r=n.shapeInfo.logicalShape,o=n.name,i="get"+o.charAt(0).toUpperCase()+o.slice(1),a=r[3],s=r[2]*a,u=r[1]*s,l=Qi(r),c=l.newShape,d=l.keptDims;if(c.length<r.length){var f=ts(n,c);return`
      `+es(f)+`
      float `+i+`(int row, int col, int depth, int depth2) {
        return `+i+"("+ns(["row","col","depth","depth2"],d)+`);
      }
    `}if(n.shapeInfo.isUniform)return`
      float `+i+`(int row, int col, int depth, int depth2) {
        int index = round(dot(vec4(row, col, depth, depth2),
                          vec4(`+u+", "+s+", "+a+`, 1)));
        `+Ka(n)+`
      }
    `;var h=n.shapeInfo.flatOffset,v=n.shapeInfo.texShape,p=v[0],m=v[1];if(m===u&&h==null)return`
      float `+i+`(int row, int col, int depth, int depth2) {
        float texR = float(row);
        float texC =
            dot(vec3(col, depth, depth2),
                vec3(`+s+", "+a+`, 1));
        vec2 uv = (vec2(texC, texR) + halfCR) /
                   vec2(`+m+".0, "+p+`.0);
        return sampleTexture(`+o+`, uv);
      }
    `;if(m===a&&h==null)return`
      float `+i+`(int row, int col, int depth, int depth2) {
        float texR = dot(vec3(row, col, depth),
                         vec3(`+r[1]*r[2]+", "+r[2]+`, 1));
        float texC = float(depth2);
        vec2 uv = (vec2(texC, texR) + halfCR) /
                  vec2(`+m+".0, "+p+`.0);
        return sampleTexture(`+o+`, uv);
      }
    `;var g=Vi(o);return`
    float `+i+`(int row, int col, int depth, int depth2) {
      // Explicitly use integer operations as dot() only works on floats.
      int index = row * `+u+" + col * "+s+` +
          depth * `+a+` + depth2;
      vec2 uv = uvFromFlat(`+p+", "+m+", index + "+g+`);
      return sampleTexture(`+o+`, uv);
    }
  `}(t);case 5:return function(n){var r=n.shapeInfo.logicalShape,o=n.name,i="get"+o.charAt(0).toUpperCase()+o.slice(1),a=r[4],s=r[3]*a,u=r[2]*s,l=r[1]*u,c=Qi(r),d=c.newShape,f=c.keptDims;if(d.length<r.length){var h=ts(n,d);return`
      `+es(h)+`
      float `+i+`(int row, int col, int depth, int depth2, int depth3) {
        return `+i+"("+ns(["row","col","depth","depth2","depth3"],f)+`);
      }
    `}if(n.shapeInfo.isUniform)return`
      float `+i+`(int row, int col, int depth, int depth2, int depth3) {
        float index = dot(
          vec4(row, col, depth, depth2),
          vec4(`+l+", "+u+", "+s+", "+a+`)) +
          depth3;
        `+Ka(n)+`
      }
    `;var v=n.shapeInfo.flatOffset,p=n.shapeInfo.texShape,m=p[0],g=p[1];if(g===l&&v==null)return`
      float `+i+`(int row, int col, int depth, int depth2, int depth3) {
        int texR = row;
        float texC = dot(vec4(col, depth, depth2, depth3),
                         vec4(`+u+", "+s+", "+a+`, 1));
        vec2 uv = (vec2(texC, texR) + halfCR) /
                   vec2(`+g+".0, "+m+`.0);
        return sampleTexture(`+o+`, uv);
      }
    `;if(g===a&&v==null)return`
      float `+i+`(int row, int col, int depth, int depth2, int depth3) {
        float texR = dot(
          vec4(row, col, depth, depth2),
          vec4(`+r[1]*r[2]*r[3]+`,
               `+r[2]*r[3]+", "+r[3]+`, 1));
        int texC = depth3;
        vec2 uv = (vec2(texC, texR) + halfCR) /
                  vec2(`+g+".0, "+m+`.0);
        return sampleTexture(`+o+`, uv);
      }
    `;var y=Vi(o);return`
    float `+i+`(int row, int col, int depth, int depth2, int depth3) {
      // Explicitly use integer operations as dot() only works on floats.
      int index = row * `+l+" + col * "+u+" + depth * "+s+` +
          depth2 * `+a+" + depth3 + "+y+`;
      vec2 uv = uvFromFlat(`+m+", "+g+`, index);
      return sampleTexture(`+o+`, uv);
    }
  `}(t);case 6:return function(n){var r=n.shapeInfo.logicalShape,o=n.name,i="get"+o.charAt(0).toUpperCase()+o.slice(1),a=Qi(r),s=a.newShape,u=a.keptDims;if(s.length<r.length){var l=ts(n,s);return`
      `+es(l)+`
      float `+i+`(int row, int col, int depth,
                    int depth2, int depth3, int depth4) {
        return `+i+"("+ns(["row","col","depth","depth2","depth3","depth4"],u)+`);
      }
    `}var c=r[5],d=r[4]*c,f=r[3]*d,h=r[2]*f,v=r[1]*h;if(n.shapeInfo.isUniform)return`
      float `+i+`(int row, int col, int depth,
                  int depth2, int depth3, int depth4) {
        int index = round(dot(
          vec4(row, col, depth, depth2),
          vec4(`+v+", "+h+", "+f+", "+d+`)) +
          dot(
            vec2(depth3, depth4),
            vec2(`+c+`, 1)));
        `+Ka(n)+`
      }
    `;var p=n.shapeInfo.flatOffset,m=n.shapeInfo.texShape,g=m[0],y=m[1];if(y===v&&p==null)return`
      float `+i+`(int row, int col, int depth,
                    int depth2, int depth3, int depth4) {
        int texR = row;
        float texC = dot(vec4(col, depth, depth2, depth3),
          vec4(`+h+", "+f+", "+d+", "+c+`)) +
               float(depth4);
        vec2 uv = (vec2(texC, texR) + halfCR) /
                   vec2(`+y+".0, "+g+`.0);
        return sampleTexture(`+o+`, uv);
      }
    `;if(y===c&&p==null)return`
      float `+i+`(int row, int col, int depth,
                    int depth2, int depth3, int depth4) {
        float texR = dot(vec4(row, col, depth, depth2),
          vec4(`+r[1]*r[2]*r[3]*r[4]+`,
               `+r[2]*r[3]*r[4]+`,
               `+r[3]*r[4]+`,
               `+r[4]+`)) + float(depth3);
        int texC = depth4;
        vec2 uv = (vec2(texC, texR) + halfCR) /
                  vec2(`+y+".0, "+g+`.0);
        return sampleTexture(`+o+`, uv);
      }
    `;var w=Vi(o);return`
    float `+i+`(int row, int col, int depth,
                  int depth2, int depth3, int depth4) {
      // Explicitly use integer operations as dot() only works on floats.
      int index = row * `+v+" + col * "+h+" + depth * "+f+` +
          depth2 * `+d+" + depth3 * "+c+" + depth4 + "+w+`;
      vec2 uv = uvFromFlat(`+g+", "+y+`, index);
      return sampleTexture(`+o+`, uv);
    }
  `}(t);default:throw new Error(e.length+"-D input sampling is not yet supported")}}function bS(t){var e,n,r;switch(t.shapeInfo.logicalShape.length){case 0:return e=t.name,n="get"+e.charAt(0).toUpperCase()+e.slice(1),r=Kt(),`
    vec4 `+n+`() {
      return `+r.texture2D+"("+e+`, halfCR);
    }
  `;case 1:return function(o){var i=o.name,a="get"+i.charAt(0).toUpperCase()+i.slice(1),s=o.shapeInfo.texShape,u=[Math.ceil(s[0]/2),Math.ceil(s[1]/2)],l=Kt();return`
    vec4 `+a+`(int index) {
      vec2 uv = packedUVfrom1D(
        `+u[0]+", "+u[1]+`, index);
      return `+l.texture2D+"("+i+`, uv);
    }
  `}(t);case 2:return function(o){var i=o.shapeInfo.logicalShape,a=o.name,s="get"+a.charAt(0).toUpperCase()+a.slice(1),u=o.shapeInfo.texShape,l=u[0],c=u[1],d=Kt();if(u!=null&&At(i,u))return`
      vec4 `+s+`(int row, int col) {
        vec2 uv = (vec2(col, row) + halfCR) / vec2(`+c+".0, "+l+`.0);

        return `+d.texture2D+"("+a+`, uv);
      }
    `;var f=[Math.ceil(u[0]/2),Math.ceil(u[1]/2)],h=Math.ceil(i[1]/2);return`
    vec4 `+s+`(int row, int col) {
      vec2 uv = packedUVfrom2D(`+h+", "+f[0]+", "+f[1]+`, row, col);
      return `+d.texture2D+"("+a+`, uv);
    }
  `}(t);case 3:return function(o){var i=o.shapeInfo.logicalShape,a=o.name,s="get"+a.charAt(0).toUpperCase()+a.slice(1),u=o.shapeInfo.texShape,l=[Math.ceil(u[0]/2),Math.ceil(u[1]/2)];if(i[0]===1){var c=i.slice(1),d=ts(o,c);return`
        `+bS(d)+`
        vec4 `+s+`(int b, int row, int col) {
          return `+s+"("+ns(["b","row","col"],[1,2])+`);
        }
      `}var f=l[0],h=l[1],v=Math.ceil(i[2]/2),p=v*Math.ceil(i[1]/2),m=Kt();return`
    vec4 `+s+`(int b, int row, int col) {
      vec2 uv = packedUVfrom3D(
        `+f+", "+h+", "+p+", "+v+`, b, row, col);
      return `+m.texture2D+"("+a+`, uv);
    }
  `}(t);default:return function(o){for(var i=o.shapeInfo.logicalShape,a=i.length,s=o.name,u="get"+s.charAt(0).toUpperCase()+s.slice(1),l=o.shapeInfo.texShape,c=[Math.ceil(l[0]/2),Math.ceil(l[1]/2)],d=c[0],f=c[1],h=Math.ceil(i[a-1]/2),v=h*Math.ceil(i[a-2]/2),p="int b, int row, int col",m="b * "+v+" + (row / 2) * "+h+" + (col / 2)",g=2;g<a-1;g++)p="int b"+g+", "+p,v*=i[a-g-1],m="b"+g+" * "+v+" + "+m;var y=Kt();return`
    vec4 `+u+"("+p+`) {
      int index = `+m+`;
      int texR = index / `+f+`;
      int texC = index - texR * `+f+`;
      vec2 uv = (vec2(texC, texR) + halfCR) / vec2(`+f+", "+d+`);
      return `+y.texture2D+"("+s+`, uv);
    }
  `}(t)}}var BB=`
vec2 uvFromFlat(int texNumR, int texNumC, int index) {
  int texR = index / texNumC;
  int texC = index - texR * texNumC;
  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);
}
vec2 packedUVfrom1D(int texNumR, int texNumC, int index) {
  int texelIndex = index / 2;
  int texR = texelIndex / texNumC;
  int texC = texelIndex - texR * texNumC;
  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);
}
`,$B=`
vec2 packedUVfrom2D(int texelsInLogicalRow, int texNumR,
  int texNumC, int row, int col) {
  int texelIndex = (row / 2) * texelsInLogicalRow + (col / 2);
  int texR = texelIndex / texNumC;
  int texC = texelIndex - texR * texNumC;
  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);
}
`,jB=`
vec2 packedUVfrom3D(int texNumR, int texNumC,
    int texelsInBatch, int texelsInLogicalRow, int b,
    int row, int col) {
  int index = b * texelsInBatch + (row / 2) * texelsInLogicalRow + (col / 2);
  int texR = index / texNumC;
  int texC = index - texR * texNumC;
  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);
}
`,WB=`
  float getChannel(vec4 frag, vec2 innerDims) {
    vec2 modCoord = mod(innerDims, 2.);
    return modCoord.x == 0. ?
      (modCoord.y == 0. ? frag.r : frag.g) :
      (modCoord.y == 0. ? frag.b : frag.a);
  }
  float getChannel(vec4 frag, int dim) {
    float modCoord = mod(float(dim), 2.);
    return modCoord == 0. ? frag.r : frag.g;
  }
`;function Vi(t){return"offset"+t}function Ka(t){var e=t.name,n=se(t.shapeInfo.logicalShape);return n<2?"return "+e+";":`
    for (int i = 0; i < `+n+`; i++) {
      if (i == index) {
        return `+e+`[i];
      }
    }
  `}function qe(t){if(t<=1)return"int";if(t===2)return"ivec2";if(t===3)return"ivec3";if(t===4)return"ivec4";if(t===5)return"ivec5";if(t===6)return"ivec6";throw Error("GPU for rank "+t+" is not yet supported")}function ts(t,e){var n=JSON.parse(JSON.stringify(t));return n.shapeInfo.logicalShape=e,n}function ns(t,e){return e.map(function(n){return t[n]}).join(", ")}var UB=function(t,e,n,r){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,I(t.length>2,function(){return"Packed arg"+(n.charAt(0).toUpperCase()+n.slice(1))+" supports only inputs with rank above 2."});var o=t[t.length-1],i=Math.ceil(o/e);this.outputShape=t.slice(0,-1),i>1&&this.outputShape.push(i),r||this.variableNames.push("bestIndicesA");var a,s,u=this.outputShape,l=u.length,c=qe(l),d=mn("coords",l);if(i===1){var f=qe(s=l+1);a=`
        `+f+" sourceLocR = "+f+"("+d.join()+`, 0);
        ++`+d[l-1]+`;
        `+f+" sourceLocG = "+f+"("+d.join()+`, 0);
        ++`+d[l-2]+`;
        `+f+" sourceLocA = "+f+"("+d.join()+`, 0);
        --`+d[l-1]+`;
        `+f+" sourceLocB = "+f+"("+d.join()+`, 0);
        --`+d[l-2]+";"}else s=l,a=`
        `+c+` sourceLocR = coords;
        ++`+d[l-1]+`;
        `+c+` sourceLocG = coords;
        ++`+d[l-2]+`;
        `+c+` sourceLocA = coords;
        --`+d[l-1]+`;
        `+c+` sourceLocB = coords;
        --`+d[l-2]+";";var h=["x","y","z","w","u","v"].slice(0,s),v="."+h[s-1],p=h.map(function(C){return"int "+C}),m=mn("sourceLocR",s-1).concat("inIdx.r"),g=mn("sourceLocG",s-1).concat("inIdx.g"),y=mn("sourceLocB",s-1).concat("inIdx.b"),w=mn("sourceLocA",s-1).concat("inIdx.a"),x=n==="max"?"greaterThan":"lessThan",b=r?"":`
          inIdx = round(vec4(getBestIndicesAChannel(`+m.join()+`),
                             getBestIndicesAChannel(`+g.join()+`),
                             getBestIndicesAChannel(`+y.join()+`),
                             getBestIndicesAChannel(`+w.join()+")));",_=`vec4(
            getAChannel(`+m.join()+`),
            hasNextCol ? getAChannel(`+g.join()+`) : 0.,
            hasNextRow ? getAChannel(`+y.join()+`) : 0.,
            hasNextRow && hasNextCol ? getAChannel(`+w.join()+") : 0.)",E=r?"":`
      float getBestIndicesAChannel(`+p.join()+`) {
        return getChannel(getBestIndicesA(`+h.join()+`),
                                          vec2(`+h.slice(-2).join()+`));
      }`;this.userCode=`
      float getAChannel(`+p.join()+`) {
        return getChannel(getA(`+h.join()+`),
                               vec2(`+h.slice(-2).join()+`));
      }
      `+E+`
      void main() {
        `+c+` coords = getOutputCoords();
        bool hasNextCol = `+d[l-1]+" < "+(u[l-1]-1)+`;
        bool hasNextRow = `+d[l-2]+" < "+(u[l-2]-1)+`;
        `+a+`
        ivec4 srcIdx = ivec4(sourceLocR`+v+", sourceLocG"+v+`,
          sourceLocB`+v+", sourceLocA"+v+") * "+e+`;
        ivec4 inIdx = srcIdx;
        vec4 bestIndex = vec4(inIdx);
        vec4 bestValue = `+_+`;

        for (int i = 0; i < `+e+`; i++) {
          inIdx = srcIdx;
          `+b+`
          vec4 candidate = `+_+`;
          bvec4 nan = isnan(candidate);
          bvec4 replace = bvec4(
            vec4(`+x+`(candidate, bestValue)) * (vec4(1.0) - vec4(nan)));

          bestValue = vec4(replace.x  ? candidate.x : bestValue.x,
                           replace.y  ? candidate.y : bestValue.y,
                           replace.z  ? candidate.z : bestValue.z,
                           replace.w  ? candidate.w : bestValue.w);
          bestIndex = mix(bestIndex, vec4(inIdx), vec4(replace));
          srcIdx++;
        }
        setOutput(bestIndex);
      }
    `},zB=function(t){this.variableNames=["dy"],this.outputShape=t.inShape;var e=t.filterHeight,n=t.filterWidth,r=t.strideHeight,o=t.strideWidth,i=t.dilationHeight,a=t.dilationWidth,s=t.effectiveFilterHeight,u=t.effectiveFilterWidth,l=s-1-t.padInfo.top,c=u-1-t.padInfo.left,d=1/(e*n);this.userCode=`
      const ivec2 pads = ivec2(`+l+", "+c+`);
      const float avgMultiplier = float(`+d+`);

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];

        ivec2 dyRCCorner = coords.yz - pads;
        int dyRCorner = dyRCCorner.x;
        int dyCCorner = dyRCCorner.y;

        // Convolve dy(?, ?, d) with pos mask(:, :, d) to get dx(xR, xC, d).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        for (int wR = 0; wR < `+s+`;
            wR += `+i+`) {
          float dyR = float(dyRCorner + wR) / `+r+`.0;

          if (dyR < 0.0 || dyR >= `+t.outHeight+`.0 || fract(dyR) > 0.0) {
            continue;
          }
          int idyR = int(dyR);

          for (int wC = 0; wC < `+u+`;
            wC+= `+a+`) {
            float dyC = float(dyCCorner + wC) / `+o+`.0;

            if (dyC < 0.0 || dyC >= `+t.outWidth+`.0 ||
                fract(dyC) > 0.0) {
              continue;
            }
            int idyC = int(dyC);

            float dyValue = getDy(b, idyR, idyC, d);

            dotProd += dyValue * avgMultiplier;
          }
        }
        setOutput(dotProd);
      }
    `},VB=function(t){this.variableNames=["dy"],this.outputShape=t.inShape;var e=t.filterDepth,n=t.filterHeight,r=t.filterWidth,o=t.strideDepth,i=t.strideHeight,a=t.strideWidth,s=t.dilationDepth,u=t.dilationHeight,l=t.dilationWidth,c=t.effectiveFilterDepth,d=t.effectiveFilterHeight,f=t.effectiveFilterWidth,h=c-1-t.padInfo.front,v=d-1-t.padInfo.top,p=f-1-t.padInfo.left,m=1/(e*n*r);this.userCode=`
      const ivec3 pads = ivec3(`+h+", "+v+", "+p+`);
      const float avgMultiplier = float(`+m+`);

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int ch = coords.u;

        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;
        int dyDCorner = dyCorner.x;
        int dyRCorner = dyCorner.y;
        int dyCCorner = dyCorner.z;

        // Convolve dy(?, ?, ?, d) with pos mask(:, :, :, ch) to get
        // dx(xD, xR, xC, ch).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;

        for (int wD = 0; wD < `+c+`;
            wD += `+s+`) {
          float dyD = float(dyDCorner + wD) / `+o+`.0;

          if (dyD < 0.0 || dyD >= `+t.outDepth+`.0 || fract(dyD) > 0.0) {
            continue;
          }
          int idyD = int(dyD);

          for (int wR = 0; wR < `+d+`;
              wR += `+u+`) {
            float dyR = float(dyRCorner + wR) / `+i+`.0;

            if (dyR < 0.0 || dyR >= `+t.outHeight+`.0 ||
                fract(dyR) > 0.0) {
              continue;
            }
            int idyR = int(dyR);

            for (int wC = 0; wC < `+f+`;
                wC += `+l+`) {
              float dyC = float(dyCCorner + wC) / `+a+`.0;

              if (dyC < 0.0 || dyC >= `+t.outWidth+`.0 ||
                  fract(dyC) > 0.0) {
                continue;
              }
              int idyC = int(dyC);

              float dyValue = getDy(batch, idyD, idyR, idyC, ch);

              dotProd += dyValue * avgMultiplier;
            }
          }
        }
        setOutput(dotProd);
      }
    `},HB=function(t,e,n,r,o,i){this.outputShape=[],this.variableNames=["x","mean","variance"],Te(t,e),Te(t,n);var a="0.0";r!=null&&(Te(t,r),this.variableNames.push("offset"),a="getOffsetAtOutCoords()");var s="1.0";o!=null&&(Te(t,o),this.variableNames.push("scale"),s="getScaleAtOutCoords()"),this.outputShape=t,this.userCode=`
      void main() {
        float x = getXAtOutCoords();
        float mean = getMeanAtOutCoords();
        float variance = getVarianceAtOutCoords();
        float offset = `+a+`;
        float scale = `+s+`;
        float inv = scale * inversesqrt(variance + float(`+i+`));
        setOutput(dot(vec3(x, -mean, offset), vec3(inv, inv, 1)));
      }
    `},GB=function(t,e,n,r,o,i){this.packedInputs=!0,this.packedOutput=!0,this.variableNames=["x","mean","variance"],Te(t,e),Te(t,n);var a="vec4(0.0)";r!=null&&(Te(t,r),this.variableNames.push("offset"),a="getOffsetAtOutCoords()");var s="vec4(1.0)";o!=null&&(Te(t,o),this.variableNames.push("scale"),s="getScaleAtOutCoords()"),this.outputShape=t,this.userCode=`
      void main() {
        vec4 offset = `+a+`;
        vec4 scale = `+s+`;

        vec4 x = getXAtOutCoords();
        vec4 mean = getMeanAtOutCoords();
        vec4 variance = getVarianceAtOutCoords();

        vec4 inv = scale * inversesqrt(variance + vec4(`+i+`));

        setOutput((x - mean) * inv + offset);
      }
    `},qB="return areal * breal - aimag * bimag;",KB="return areal * bimag + aimag * breal;",Jw=function(t,e,n){this.variableNames=["AReal","AImag","BReal","BImag"],this.outputShape=Te(e,n),this.userCode=`
      float binaryOpComplex(
          float areal, float aimag, float breal, float bimag) {
        `+t+`
      }

      void main() {
        float areal = getARealAtOutCoords();
        float aimag = getAImagAtOutCoords();
        float breal = getBRealAtOutCoords();
        float bimag = getBImagAtOutCoords();
        setOutput(binaryOpComplex(areal, aimag, breal, bimag));
      }
    `},Ep="return a + b;",Cp="return a - b;",Zw="return a * b;",_S="return (a < 0.) ? b * a : a;",st=function(t,e,n){this.variableNames=["A","B"],this.outputShape=Te(e,n),this.userCode=`
      float binaryOperation(float a, float b) {
        `+t+`
      }

      void main() {
        float a = getAAtOutCoords();
        float b = getBAtOutCoords();
        setOutput(binaryOperation(a, b));
      }
    `},ES=`
  vec4 aLessThanZero = vec4(lessThan(a, vec4(0.)));
  return (aLessThanZero * (b * a)) + ((vec4(1.0) - aLessThanZero) * a);
`,ao=function(t,e,n,r){r===void 0&&(r=!1),this.variableNames=["A","B"],this.supportsBroadcasting=!0,this.packedInputs=!0,this.packedOutput=!0,this.outputShape=Te(e,n);var o=this.outputShape.length,i="";if(r)if(o===0||se(this.outputShape)===1)i=`
          result.y = 0.;
          result.z = 0.;
          result.w = 0.;
        `;else if(i=`
          `+qe(o)+` coords = getOutputCoords();
        `,o===1)i+=`
            result.y = (coords + 1) >= `+this.outputShape[0]+` ? 0. : result.y;
            result.z = 0.;
            result.w = 0.;
          `;else{var a=mn("coords",o);i+=`
            bool nextRowOutOfBounds =
              (`+a[o-2]+" + 1) >= "+this.outputShape[o-2]+`;
            bool nextColOutOfBounds =
              (`+a[o-1]+" + 1) >= "+this.outputShape[o-1]+`;
            result.y = nextColOutOfBounds ? 0. : result.y;
            result.z = nextRowOutOfBounds ? 0. : result.z;
            result.w = nextColOutOfBounds || nextRowOutOfBounds ? 0. : result.w;
          `}this.userCode=`
      vec4 binaryOperation(vec4 a, vec4 b) {
        `+t+`
      }

      void main() {
        vec4 a = getAAtOutCoords();
        vec4 b = getBAtOutCoords();

        vec4 result = binaryOperation(a, b);
        `+i+`

        setOutput(result);
      }
    `},XB=function(){function t(e){this.variableNames=["A"],this.outputShape=e,this.userCode=`
      uniform float minVal;
      uniform float maxVal;

      void main() {
        float value = getAAtOutCoords();
        if (isnan(value)) {
          setOutput(value);
          return;
        }

        setOutput(clamp(value, minVal, maxVal));
      }
    `}return t.prototype.getCustomSetupFunc=function(e,n){var r=this;return function(o,i){r.minLoc==null&&(r.minLoc=o.getUniformLocationNoThrow(i,"minVal"),r.maxLoc=o.getUniformLocationNoThrow(i,"maxVal")),o.gl.uniform1f(r.minLoc,e),o.gl.uniform1f(r.maxLoc,n)}},t}(),YB=function(){function t(e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=e,this.userCode=`
      uniform float minVal;
      uniform float maxVal;

      void main() {
        vec4 value = getAAtOutCoords();

        if (any(isnan(value))) {
          setOutput(value);
          return;
        }

        setOutput(clamp(value, vec4(minVal), vec4(maxVal)));
      }
    `}return t.prototype.getCustomSetupFunc=function(e,n){var r=this;return function(o,i){r.minLoc==null&&(r.minLoc=o.getUniformLocationNoThrow(i,"minVal"),r.maxLoc=o.getUniformLocationNoThrow(i,"maxVal")),o.gl.uniform1f(r.minLoc,e),o.gl.uniform1f(r.maxLoc,n)}},t}(),QB=function(t){this.variableNames=["real","imag"],this.outputShape=t,this.userCode=`
      void main() {
        float re = abs(getRealAtOutCoords());
        float im = abs(getImagAtOutCoords());
        float mx = max(re, im);

        // sadly the length function in glsl is not underflow-safe
        // (at least not on Intel GPUs). So the safe solution is
        // to ensure underflow-safety in all cases.
        setOutput(
          mx == 0.0 ? 0.0 : mx * length(vec2(1, min(re, im)/mx))
        );
      }
    `},JB=function(t){this.outputShape=[],this.outputShape=ou(t,1),this.variableNames=t.map(function(s,u){return"T"+u});var e=new Array(t.length-1);e[0]=t[0][1];for(var n=1;n<e.length;n++)e[n]=e[n-1]+t[n][1];var r=["if (yC < "+e[0]+") setOutput(getT0(yR, yC));"];for(n=1;n<e.length;n++){var o=e[n-1];r.push("else if (yC < "+e[n]+") setOutput(getT"+n+"(yR, yC-"+o+"));")}var i=e.length,a=e[e.length-1];r.push("else setOutput(getT"+i+"(yR, yC-"+a+"));"),this.userCode=`
      void main() {
        ivec2 coords = getOutputCoords();
        int yR = coords.x;
        int yC = coords.y;

        `+r.join(`
        `)+`
      }
    `},ZB=function(t,e){this.packedInputs=!0,this.packedOutput=!0,this.outputShape=[],this.outputShape=ou(t,e);var n=this.outputShape,r=n.length,o=qe(r),i=mn("coords",r),a=["x","y","z","w","u","v"].slice(0,r);this.variableNames=t.map(function(m,g){return"T"+g});var s=new Array(t.length-1);s[0]=t[0][e];for(var u=1;u<s.length;u++)s[u]=s[u-1]+t[u][e];var l=a[e],c=a.slice(-2),d=a.join(),f="if ("+l+" < "+s[0]+`) {
        return getChannel(
            getT0(`+d+"), vec2("+c.join()+`));
        }`;for(u=1;u<s.length;u++){var h=s[u-1];f+=`
        if (`+l+" < "+s[u]+"  && "+l+" >= "+s[u-1]+`) {
          return getChannel(
            getT`+u+"("+zc(a,l,h)+`),
            vec2(`+zc(c,l,h)+`));
        }`}var v=s.length,p=s[s.length-1];f+=`
        return getChannel(
          getT`+v+"("+zc(a,l,p)+`),
          vec2(`+zc(c,l,p)+"));",this.userCode=`
      float getValue(`+a.map(function(m){return"int "+m})+`) {
        `+f+`
      }

      void main() {
        `+o+` coords = getOutputCoords();
        vec4 result = vec4(getValue(`+i+`), 0., 0., 0.);

        `+i[r-1]+" = "+i[r-1]+` + 1;
        if (`+i[r-1]+" < "+n[r-1]+`) {
          result.g = getValue(`+i+`);
        }

        `+i[r-2]+" = "+i[r-2]+` + 1;
        if (`+i[r-2]+" < "+n[r-2]+`) {
          result.a = getValue(`+i+`);
        }

        `+i[r-1]+" = "+i[r-1]+` - 1;
        if (`+i[r-2]+" < "+n[r-2]+` &&
            `+i[r-1]+" < "+n[r-1]+`) {
          result.b = getValue(`+i+`);
        }
        setOutput(result);
      }
    `};function zc(t,e,n){var r=t.indexOf(e);return t.map(function(o,i){return i===r?o+" - "+n:o}).join()}var e$=function(t){this.variableNames=["x","dy"],this.outputShape=t.filterShape;var e=t.strideHeight,n=t.strideWidth,r=t.padInfo.top,o=t.padInfo.left,i=t.dataFormat==="channelsLast";this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int wR = coords.x;
        int wC = coords.y;
        int d1 = coords.z;
        int d2 = coords.w;

        // Convolve x(?, ?, d1) with dy(:, :, d2) to get dw(wR, wC, d1, d2).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;

        for (int b = 0; b < `+t.batchSize+`; b++) {
          for (int yR = 0; yR < `+t.outHeight+`; yR++) {
            int xR = wR + yR * `+e+" - "+r+`;

            if (xR < 0 || xR >= `+t.inHeight+`) {
              continue;
            }

            for (int yC = 0; yC < `+t.outWidth+`; yC++) {
              int xC = wC + yC * `+n+" - "+o+`;

              if (xC < 0 || xC >= `+t.inWidth+`) {
                continue;
              }

              if (`+i+`) {
                float dyValue = getDy(b, yR, yC, d2);
                float xValue = getX(b, xR, xC, d1);
                dotProd += (xValue * dyValue);
              } else {
                float dyValue = getDy(b, d2, yR, yC);
                float xValue = getX(b, d1, xR, xC);
                dotProd += (xValue * dyValue);
              }

            }
          }
        }
        setOutput(dotProd);
      }
    `},t$=function(t){this.variableNames=["dy","W"],this.outputShape=t.inShape;var e=t.filterHeight,n=t.filterWidth,r=t.strideHeight,o=t.strideWidth,i=t.dataFormat==="channelsLast",a=e-1-t.padInfo.top,s=n-1-t.padInfo.left,u=i?1:2,l=i?2:3,c=i?3:1;this.userCode=`
      const ivec2 pads = ivec2(`+a+", "+s+`);

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords[0];
        int d1 = coords[`+c+`];

        ivec2 dyCorner = ivec2(coords[`+u+"], coords["+l+`]) - pads;
        int dyRCorner = dyCorner.x;
        int dyCCorner = dyCorner.y;

        // Convolve dy(?, ?, d2) with w(:, :, d1, d2) to compute dx(xR, xC, d1).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        for (int wR = 0; wR < `+e+`; wR++) {
          float dyR = float(dyRCorner + wR) / `+r+`.0;

          if (dyR < 0.0 || dyR >= `+t.outHeight+`.0 || fract(dyR) > 0.0) {
            continue;
          }
          int idyR = int(dyR);

          int wRPerm = `+e+` - 1 - wR;

          for (int wC = 0; wC < `+n+`; wC++) {
            float dyC = float(dyCCorner + wC) / `+o+`.0;

            if (dyC < 0.0 || dyC >= `+t.outWidth+`.0 ||
                fract(dyC) > 0.0) {
              continue;
            }
            int idyC = int(dyC);

            int wCPerm = `+n+` - 1 - wC;

            for (int d2 = 0; d2 < `+t.outChannels+`; d2++) {

              if (`+i+`) {
                float xValue = getDy(batch, idyR, idyC, d2);
                float wValue = getW(wRPerm, wCPerm, d1, d2);
                dotProd += xValue * wValue;
              } else {
                float xValue = getDy(batch, d2, idyR, idyC);
                float wValue = getW(wRPerm, wCPerm, d1, d2);
                dotProd += xValue * wValue;
              }

            }
          }
        }
        setOutput(dotProd);
      }
    `},n$=function(t){this.variableNames=["x","dy"],this.outputShape=t.filterShape;var e=t.strideDepth,n=t.strideHeight,r=t.strideWidth,o=t.padInfo.front,i=t.padInfo.top,a=t.padInfo.left;this.userCode=`
      void main() {
        ivec5 coords = getOutputCoords();
        int wF = coords.x;
        int wR = coords.y;
        int wC = coords.z;
        int d1 = coords.w;
        int d2 = coords.u;

        float dotProd = 0.0;

        for (int b = 0; b < `+t.batchSize+`; b++) {
          for (int yF = 0; yF < `+t.outDepth+`; yF++) {
            int xF = wF + yF * `+e+" - "+o+`;

            if (xF < 0 || xF >= `+t.inDepth+`) {
              continue;
            }

            for (int yR = 0; yR < `+t.outHeight+`; yR++) {
              int xR = wR + yR * `+n+" - "+i+`;

              if (xR < 0 || xR >= `+t.inHeight+`) {
                continue;
              }

              for (int yC = 0; yC < `+t.outWidth+`; yC++) {
                int xC = wC + yC * `+r+" - "+a+`;

                if (xC < 0 || xC >= `+t.inWidth+`) {
                  continue;
                }

                float dyValue = getDy(b, yF, yR, yC, d2);
                float xValue = getX(b, xF, xR, xC, d1);
                dotProd += (xValue * dyValue);
              }
            }
          }
        }
        setOutput(dotProd);
      }
    `},r$=function(t){this.variableNames=["dy","W"],this.outputShape=t.inShape;var e=t.filterDepth,n=t.filterHeight,r=t.filterWidth,o=t.strideDepth,i=t.strideHeight,a=t.strideWidth,s=e-1-t.padInfo.front,u=n-1-t.padInfo.top,l=r-1-t.padInfo.left;this.userCode=`
      const ivec3 pads = ivec3(`+s+", "+u+", "+l+`);

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int d1 = coords.u;


        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;
        int dyFCorner = dyCorner.x;
        int dyRCorner = dyCorner.y;
        int dyCCorner = dyCorner.z;

        float dotProd = 0.0;
        for (int wF = 0; wF < `+e+`; wF++) {
          float dyF = float(dyFCorner + wF) / `+o+`.0;

          if (dyF < 0.0 || dyF >= `+t.outDepth+`.0 || fract(dyF) > 0.0) {
            continue;
          }
          int idyF = int(dyF);

          int wFPerm = `+e+` - 1 - wF;

          for (int wR = 0; wR < `+n+`; wR++) {
            float dyR = float(dyRCorner + wR) / `+i+`.0;

            if (dyR < 0.0 || dyR >= `+t.outHeight+`.0 ||
              fract(dyR) > 0.0) {
              continue;
            }
            int idyR = int(dyR);

            int wRPerm = `+n+` - 1 - wR;

            for (int wC = 0; wC < `+r+`; wC++) {
              float dyC = float(dyCCorner + wC) / `+a+`.0;

              if (dyC < 0.0 || dyC >= `+t.outWidth+`.0 ||
                  fract(dyC) > 0.0) {
                continue;
              }
              int idyC = int(dyC);

              int wCPerm = `+r+` - 1 - wC;

              for (int d2 = 0; d2 < `+t.outChannels+`; d2++) {
                float xValue = getDy(batch, idyF, idyR, idyC, d2);
                float wValue = getW(wFPerm, wRPerm, wCPerm, d1, d2);
                dotProd += xValue * wValue;
              }
            }
          }
        }
        setOutput(dotProd);
      }
    `},o$=function(t){this.variableNames=["x","dy"],this.outputShape=t.filterShape;var e=t.strideHeight,n=t.strideWidth,r=t.padInfo.top,o=t.padInfo.left,i=t.outChannels/t.inChannels;this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int wR = coords.x;
        int wC = coords.y;
        int d1 = coords.z;
        int dm = coords.w;
        int d2 = d1 * `+i+` + dm;

        float dotProd = 0.0;

        // TO DO: Vec4 over the batch size
        for (int b = 0; b < `+t.batchSize+`; b++) {
          for (int yR = 0; yR < `+t.outHeight+`; yR++) {
            int xR = wR + yR * `+e+" - "+r+`;

            if (xR < 0 || xR >= `+t.inHeight+`) {
              continue;
            }

            for (int yC = 0; yC < `+t.outWidth+`; yC++) {
              int xC = wC + yC * `+n+" - "+o+`;

              if (xC < 0 || xC >= `+t.inWidth+`) {
                continue;
              }

              float dyValue = getDy(b, yR, yC, d2);
              float xValue = getX(b, xR, xC, d1);
              dotProd += (xValue * dyValue);
            }
          }
        }
        setOutput(dotProd);
      }
    `},i$=function(t){this.variableNames=["dy","W"],this.outputShape=t.inShape;var e=t.filterHeight,n=t.filterWidth,r=t.strideHeight,o=t.strideWidth,i=e-1-t.padInfo.top,a=n-1-t.padInfo.left,s=t.outChannels/t.inChannels;this.userCode=`
      const ivec2 pads = ivec2(`+i+", "+a+`);

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords[0];
        int d1 = coords[3];
        ivec2 dyCorner = coords.yz - pads;
        int dyRCorner = dyCorner.x;
        int dyCCorner = dyCorner.y;

        float dotProd = 0.0;

        for (int wR = 0; wR < `+e+`; wR++) {
          float dyR = float(dyRCorner + wR) / `+r+`.0;

          if (dyR < 0.0 || dyR >= `+t.outHeight+`.0 || fract(dyR) > 0.0) {
            continue;
          }
          int idyR = int(dyR);

          int wRPerm = `+e+` - 1 - wR;

          for (int wC = 0; wC < `+n+`; wC++) {
            float dyC = float(dyCCorner + wC) / `+o+`.0;

            if (dyC < 0.0 || dyC >= `+t.outWidth+`.0 ||
                fract(dyC) > 0.0) {
              continue;
            }
            int idyC = int(dyC);

            int wCPerm = `+n+` - 1 - wC;

            // TO DO: Vec4 over the channelMul
            for (int dm = 0; dm < `+s+`; dm++) {
              int d2 = d1 * `+s+` + dm;
              float xValue = getDy(batch, idyR, idyC, d2);
              float wValue = getW(wRPerm, wCPerm, d1, dm);
              dotProd += xValue * wValue;
            }
          }
        }
        setOutput(dotProd);
      }
    `},ex=function(t,e,n,r){e===void 0&&(e=!1),n===void 0&&(n=null),r===void 0&&(r=!1),this.variableNames=["x","W"],this.outputShape=t.outShape;var o=t.padInfo.top,i=t.padInfo.left,a=t.strideHeight,s=t.strideWidth,u=t.dilationHeight,l=t.dilationWidth,c=t.filterHeight,d=t.filterWidth,f=4*Math.floor(t.inChannels/4),h=t.inChannels%4,v=t.dataFormat==="channelsLast",p=v?1:2,m=v?2:3,g=v?3:1,y="",w="";n&&(y=r?`float activation(float a) {
          float b = getPreluActivationWeightsAtOutCoords();
          `+n+`
        }`:`
          float activation(float x) {
            `+n+`
          }
        `,w="result = activation(result);");var x=e?"result += getBiasAtOutCoords();":"";e&&this.variableNames.push("bias"),r&&this.variableNames.push("preluActivationWeights"),this.userCode=`
      `+y+`

      const ivec2 strides = ivec2(`+a+", "+s+`);
      const ivec2 pads = ivec2(`+o+", "+i+`);

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords[0];
        int d2 = coords[`+g+`];

        ivec2 xRCCorner =
            ivec2(coords[`+p+"], coords["+m+`]) * strides - pads;
        int xRCorner = xRCCorner.x;
        int xCCorner = xRCCorner.y;

        // Convolve x(?, ?, d1) with w(:, :, d1, d2) to get y(yR, yC, d2).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        for (int wR = 0; wR < `+c+`; wR++) {
          int xR = xRCorner + wR * `+u+`;

          if (xR < 0 || xR >= `+t.inHeight+`) {
            continue;
          }

          for (int wC = 0; wC < `+d+`; wC++) {
            int xC = xCCorner + wC * `+l+`;

            if (xC < 0 || xC >= `+t.inWidth+`) {
              continue;
            }

            for (int d1 = 0; d1 < `+f+`; d1 += 4) {
              vec4 wValues = vec4(
                getW(wR, wC, d1, d2),
                getW(wR, wC, d1 + 1, d2),
                getW(wR, wC, d1 + 2, d2),
                getW(wR, wC, d1 + 3, d2)
              );

              if (`+v+`) {
                vec4 xValues = vec4(
                  getX(batch, xR, xC, d1),
                  getX(batch, xR, xC, d1 + 1),
                  getX(batch, xR, xC, d1 + 2),
                  getX(batch, xR, xC, d1 + 3)
                );
                dotProd += dot(xValues, wValues);
              } else {
                vec4 xValues = vec4(
                  getX(batch, d1, xR, xC),
                  getX(batch, d1 + 1, xR, xC),
                  getX(batch, d1 + 2, xR, xC),
                  getX(batch, d1 + 3, xR, xC)
                );
                dotProd += dot(xValues, wValues);
              }
            }

            if (`+(h===1)+`) {

              if (`+v+`) {
                dotProd +=
                    getX(batch, xR, xC, `+f+`) *
                    getW(wR, wC, `+f+`, d2);
              } else {
                dotProd +=
                    getX(batch, `+f+`, xR, xC) *
                    getW(wR, wC, `+f+`, d2);
              }

            } else if (`+(h===2)+`) {
              vec2 wValues = vec2(
                getW(wR, wC, `+f+`, d2),
                getW(wR, wC, `+f+` + 1, d2)
              );

              if (`+v+`) {
                vec2 xValues = vec2(
                  getX(batch, xR, xC, `+f+`),
                  getX(batch, xR, xC, `+f+` + 1)
                );
                dotProd += dot(xValues, wValues);
              } else {
                vec2 xValues = vec2(
                  getX(batch, `+f+`, xR, xC),
                  getX(batch, `+f+` + 1, xR, xC)
                );
                dotProd += dot(xValues, wValues);
              }

            } else if (`+(h===3)+`) {
              vec3 wValues = vec3(
                getW(wR, wC, `+f+`, d2),
                getW(wR, wC, `+f+` + 1, d2),
                getW(wR, wC, `+f+` + 2, d2)
              );

              if (`+v+`) {
                vec3 xValues = vec3(
                  getX(batch, xR, xC, `+f+`),
                  getX(batch, xR, xC, `+f+` + 1),
                  getX(batch, xR, xC, `+f+` + 2)
                );
                dotProd += dot(xValues, wValues);
              } else {
                vec3 xValues = vec3(
                  getX(batch, `+f+`, xR, xC),
                  getX(batch, `+f+` + 1, xR, xC),
                  getX(batch, `+f+` + 2, xR, xC)
                );
                dotProd += dot(xValues, wValues);
              }

            }
          }
        }

        float result = dotProd;
        `+x+`
        `+w+`
        setOutput(result);
      }
    `},a$=function(t){this.variableNames=["x","W"],this.outputShape=t.outShape;var e=t.padInfo.front,n=t.padInfo.top,r=t.padInfo.left,o=t.strideDepth,i=t.strideHeight,a=t.strideWidth,s=t.dilationDepth,u=t.dilationHeight,l=t.dilationWidth,c=t.filterDepth,d=t.filterHeight,f=t.filterWidth,h=4*Math.floor(t.inChannels/4),v=t.inChannels%4;this.userCode=`
      const ivec3 strides = ivec3(`+o+", "+i+", "+a+`);
      const ivec3 pads = ivec3(`+e+", "+n+", "+r+`);

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int d2 = coords.u;

        ivec3 xFRCCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;
        int xFCorner = xFRCCorner.x;
        int xRCorner = xFRCCorner.y;
        int xCCorner = xFRCCorner.z;

        // Convolve x(?, ?, ?, d1) with w(:, :, :, d1, d2) to get
        // y(yF, yR, yC, d2). ? = to be determined. : = across all
        // values in that axis.
        float dotProd = 0.0;
        for (int wF = 0; wF < `+c+`; wF++) {
          int xF = xFCorner + wF * `+s+`;

          if (xF < 0 || xF >= `+t.inDepth+`) {
            continue;
          }

          for (int wR = 0; wR < `+d+`; wR++) {
            int xR = xRCorner + wR * `+u+`;

            if (xR < 0 || xR >= `+t.inHeight+`) {
              continue;
            }

            for (int wC = 0; wC < `+f+`; wC++) {
              int xC = xCCorner + wC * `+l+`;

              if (xC < 0 || xC >= `+t.inWidth+`) {
                continue;
              }

              for (int d1 = 0; d1 < `+h+`; d1 += 4) {
                vec4 xValues = vec4(
                  getX(batch, xF, xR, xC, d1),
                  getX(batch, xF, xR, xC, d1 + 1),
                  getX(batch, xF, xR, xC, d1 + 2),
                  getX(batch, xF, xR, xC, d1 + 3)
                );
                vec4 wValues = vec4(
                  getW(wF, wR, wC, d1, d2),
                  getW(wF, wR, wC, d1 + 1, d2),
                  getW(wF, wR, wC, d1 + 2, d2),
                  getW(wF, wR, wC, d1 + 3, d2)
                );

                dotProd += dot(xValues, wValues);
              }

              if (`+(v===1)+`) {
                dotProd +=
                  getX(batch, xF, xR, xC, `+h+`) *
                  getW(wF, wR, wC, `+h+`, d2);
              } else if (`+(v===2)+`) {
                vec2 xValues = vec2(
                  getX(batch, xF, xR, xC, `+h+`),
                  getX(batch, xF, xR, xC, `+h+` + 1)
                );
                vec2 wValues = vec2(
                  getW(wF, wR, wC, `+h+`, d2),
                  getW(wF, wR, wC, `+h+` + 1, d2)
                );
                dotProd += dot(xValues, wValues);
              } else if (`+(v===3)+`) {
                vec3 xValues = vec3(
                  getX(batch, xF, xR, xC, `+h+`),
                  getX(batch, xF, xR, xC, `+h+` + 1),
                  getX(batch, xF, xR, xC, `+h+` + 2)
                );
                vec3 wValues = vec3(
                  getW(wF, wR, wC, `+h+`, d2),
                  getW(wF, wR, wC, `+h+` + 1, d2),
                  getW(wF, wR, wC, `+h+` + 2, d2)
                );
                dotProd += dot(xValues, wValues);
              }
            }
          }
        }
        setOutput(dotProd);
      }
    `},tx=function(t,e,n,r){e===void 0&&(e=!1),n===void 0&&(n=null),r===void 0&&(r=!1),this.variableNames=["x","W"],this.outputShape=t.outShape;var o=t.inHeight,i=t.inWidth,a=t.padInfo.top,s=t.padInfo.left,u=t.strideHeight,l=t.strideWidth,c=t.dilationHeight,d=t.dilationWidth,f=t.filterHeight,h=t.filterWidth,v=t.outChannels/t.inChannels,p="",m="";n&&(p=r?`float activation(float a) {
          float b = getPreluActivationWeightsAtOutCoords();
          `+n+`
        }`:`
          float activation(float x) {
            `+n+`
          }
        `,m="result = activation(result);");var g=e?"result += getBiasAtOutCoords();":"";e&&this.variableNames.push("bias"),r&&this.variableNames.push("preluActivationWeights"),this.userCode=`
      `+p+`

      const ivec2 strides = ivec2(`+u+", "+l+`);
      const ivec2 pads = ivec2(`+a+", "+s+`);

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords.x;
        ivec2 xRCCorner = coords.yz * strides - pads;
        int d2 = coords.w;
        int d1 = d2 / `+v+`;
        int q = d2 - d1 * `+v+`;

        int xRCorner = xRCCorner.x;
        int xCCorner = xRCCorner.y;

        // Convolve x(?, ?, d1) with w(:, :, d1, q) to get y(yR, yC, d2).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        // TO DO(dsmilkov): Flatten the two for loops and vec4 the operations.
        for (int wR = 0; wR < `+f+`; wR++) {
          int xR = xRCorner + wR * `+c+`;

          if (xR < 0 || xR >= `+o+`) {
            continue;
          }

          for (int wC = 0; wC < `+h+`; wC++) {
            int xC = xCCorner + wC * `+d+`;

            if (xC < 0 || xC >= `+i+`) {
              continue;
            }

            float xVal = getX(batch, xR, xC, d1);
            float wVal = getW(wR, wC, d1, q);
            dotProd += xVal * wVal;
          }
        }

        float result = dotProd;
        `+g+`
        `+m+`
        setOutput(result);
      }
    `},nx=function(t,e,n,r){e===void 0&&(e=!1),n===void 0&&(n=null),r===void 0&&(r=!1),this.variableNames=["x","W"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=t.outShape;for(var o=t.inHeight,i=t.inWidth,a=t.padInfo.top,s=t.padInfo.left,u=t.strideHeight,l=t.strideWidth,c=t.dilationHeight,d=t.dilationWidth,f=t.filterHeight,h=t.filterWidth,v=h,p="int xR; int xC; int xCOffset;",m=0;m<f;m++)for(var g=0;g<h;g++)p+=`
          vec4 xTexelR`+m+"C"+2*g+` = vec4(0.);
          vec4 wR`+m+"C"+g+` = vec4(0.);
          vec4 xR`+m+"C"+g+" = vec4(0.);";for(m=0;m<f;m++)for(var y=0;y<v;y++){if(p+=`
          xR = xRCorner + `+m*c+`;
          xC = xCCorner + `+(g=2*y)*d+`;
        `,l===1){if(g<h&&(p+=s%2==1?`
                xCOffset = xC + 1;
                if(xR >= 0 && xR < `+o+" && xCOffset >= 0 && xCOffset < "+i+`) {
                  xTexelR`+m+"C"+g+` = getX(batch, xR, xCOffset, d1);

                  // Need to manually clear unused channels in case
                  // we're reading from recycled texture.
                  if(xCOffset + 1 >= `+i+`) {
                    xTexelR`+m+"C"+g+`.zw = vec2(0.);
                  }
                } else {
                  xTexelR`+m+"C"+g+` = vec4(0.);
                }

                xCOffset = xC + 1 - 2;
                if(xR >= 0 && xR < `+o+" && xCOffset >= 0 && xCOffset < "+i+`) {
                  vec4 previous = getX(batch, xR, xCOffset, d1);

                  // Need to manually clear unused channels in case
                  // we're reading from recycled texture.
                  if(xCOffset + 1 >= `+i+`) {
                    previous.zw = vec2(0.);
                  }

                  xR`+m+"C"+g+" = vec4(previous.zw, xTexelR"+m+"C"+g+`.xy);
                } else {
                  xR`+m+"C"+g+" = vec4(0, 0, xTexelR"+m+"C"+g+`.xy);
                }
              `:`
                if(xR >= 0 && xR < `+o+" && xC >= 0 && xC < "+i+`) {
                  xTexelR`+m+"C"+g+` = getX(batch, xR, xC, d1);
                } else {
                  xTexelR`+m+"C"+g+` = vec4(0.);
                }

                xR`+m+"C"+g+" = xTexelR"+m+"C"+g+`;
              `,g+1<h)){var w=s%2==0?WC(d):d;d%2==0&&s%2==1||d%2!=0&&s%2!=1?(p+=`
                  xCOffset = xC + `+s%2+" + "+w+`;

                  if(xR >= 0 && xR < `+o+` &&
                    xCOffset >= 0 && xCOffset < `+i+`) {
                    xTexelR`+m+"C"+(g+2)+` = getX(batch, xR, xCOffset, d1);
                  }
                `,d>1&&(p+=`
                    xCOffset -= 2;
                    if(xR >= 0 && xR < `+o+` &&
                      xCOffset >= 0 && xCOffset < `+i+`) {
                      xTexelR`+m+"C"+g+` = getX(batch, xR, xCOffset, d1);
                    } else {
                      xTexelR`+m+"C"+g+` = vec4(0.);
                    }
                  `),p+=`
                  xR`+m+"C"+(g+1)+` = vec4(
                    xTexelR`+m+"C"+g+".zw, xTexelR"+m+"C"+(g+2)+`.xy);
                `):p+=`
                  xCOffset = xC + `+w+`;

                  if(xR >= 0 && xR < `+o+` &&
                    xCOffset >= 0 && xCOffset < `+i+`) {
                    xTexelR`+m+"C"+(g+2)+` = getX(batch, xR, xCOffset, d1);
                  }

                  xR`+m+"C"+(g+1)+" = xTexelR"+m+"C"+(g+2)+`;
                `}}else g<h&&(p+=`
              if(xR >= 0 && xR < `+o+`) {
            `,s%2==1?(p+=`
                xCOffset = xC + 1 - `+l+`;
                if(xCOffset >= 0 && xCOffset < `+i+`) {
                  xTexelR`+m+"C"+g+` = getX(batch, xR, xCOffset, d1);
                } else {
                  xTexelR`+m+"C"+g+` = vec4(0.);
                }

                if(xC + 1 >= 0 && xC + 1 < `+i+`) {
                  xTexelR`+m+"C"+(g+2)+` = getX(batch, xR, xC + 1, d1);
                } else {
                  xTexelR`+m+"C"+(g+2)+` = vec4(0.);
                }

                xR`+m+"C"+g+` = vec4(
                  xTexelR`+m+"C"+g+".zw, xTexelR"+m+"C"+(g+2)+`.zw);
              `,g+1<h&&(p+=`
                  vec4 final = vec4(0.);
                  xCOffset = xC + 1 + `+l+`;
                  if(xCOffset >= 0 && xCOffset < `+i+`) {
                    final = getX(batch, xR, xCOffset, d1);
                  }
                  xR`+m+"C"+(g+1)+" = vec4(xTexelR"+m+"C"+(g+2)+`.xy, final.xy);
                `)):(p+=`
                if(xC >= 0 && xC < `+i+`) {
                  xTexelR`+m+"C"+g+` = getX(batch, xR, xC, d1);
                } else {
                  xTexelR`+m+"C"+g+` = vec4(0.);
                }

                xCOffset = xC + `+l+`;
                if(xCOffset >= 0 && xCOffset < `+i+`) {
                  xTexelR`+m+"C"+(g+2)+` = getX(batch, xR, xCOffset, d1);
                } else {
                  xTexelR`+m+"C"+(g+2)+` = vec4(0.);
                }

                xR`+m+"C"+g+` = vec4(
                  xTexelR`+m+"C"+g+".xy, xTexelR"+m+"C"+(g+2)+`.xy);
              `,g+1<h&&(p+=`
                  xR`+m+"C"+(g+1)+` = vec4(
                    xTexelR`+m+"C"+g+".zw, xTexelR"+m+"C"+(g+2)+`.zw);
                `)),p+="}");g<h&&(p+=`
            vec4 wTexelR`+m+"C"+g+" = getW("+m+", "+g+`, d1, q);
            wR`+m+"C"+g+" = vec4(wTexelR"+m+"C"+g+".xz, wTexelR"+m+"C"+g+`.xz);
          `,g+1<h&&(p+=`
              vec4 wTexelR`+m+"C"+(g+1)+" = getW("+m+", "+(g+1)+`, d1, q);
              wR`+m+"C"+(g+1)+` =
                vec4(wTexelR`+m+"C"+(g+1)+".xz, wTexelR"+m+"C"+(g+1)+".xz);"))}for(m=0;m<f;m++)for(g=0;g<h;g++)p+="dotProd += xR"+m+"C"+g+" * wR"+m+"C"+g+";";var x="",b="";n&&(x=r?`vec4 activation(vec4 a) {
          vec4 b = getPreluActivationWeightsAtOutCoords();
          `+n+`
        }`:`vec4 activation(vec4 x) {
          `+n+`
        }`,b="result = activation(result);");var _=e?"result += getBiasAtOutCoords();":"";e&&this.variableNames.push("bias"),r&&this.variableNames.push("preluActivationWeights"),this.userCode=`
      `+x+`

      const ivec2 strides = ivec2(`+u+", "+l+`);
      const ivec2 pads = ivec2(`+a+", "+s+`);

      void main() {

        ivec4 coords = getOutputCoords();
        int batch = coords.x;
        ivec2 xRCCorner = coords.yz * strides - pads;
        int d2 = coords.w;
        int d1 = d2;
        int q = 0;
        int xRCorner = xRCCorner.x;
        int xCCorner = xRCCorner.y;

        vec4 dotProd = vec4(0.);

        `+p+`

        vec4 result = dotProd;
        `+_+`
        `+b+`
        setOutput(result);
      }
    `},s$=function(t,e,n,r,o){this.variableNames=["Image","Boxes","BoxInd"],this.outputShape=[];var i=t[0],a=t[1],s=t[2],u=t[3],l=e[0],c=n[0],d=n[1];this.outputShape=[l,c,d,u];var f=r==="bilinear"?1:0,h=[a-1+".0",s-1+".0"],v=h[0],p=h[1],m=c>1?[""+(a-1)/(c-1),"(y2-y1) * height_ratio","y1*"+v+" + float(y)*(height_scale)"]:["0.0","0.0","0.5 * (y1+y2) * "+v],g=m[0],y=m[1],w=m[2],x=d>1?[""+(s-1)/(d-1),"(x2-x1) * width_ratio","x1*"+p+" + float(x)*(width_scale)"]:["0.0","0.0","0.5 * (x1+x2) * "+p],b=x[0],_=x[1],E=x[2];this.userCode=`
      const float height_ratio = float(`+g+`);
      const float width_ratio = float(`+b+`);
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int y = coords[1];
        int x = coords[2];
        int d = coords[3];

        // get box vals
        float y1 = getBoxes(b,0);
        float x1 = getBoxes(b,1);
        float y2 = getBoxes(b,2);
        float x2 = getBoxes(b,3);

        // get image in batch index
        int bInd = round(getBoxInd(b));
        if(bInd < 0 || bInd >= `+i+`) {
          return;
        }

        float height_scale = `+y+`;
        float width_scale = `+_+`;

        float in_y = `+w+`;
        if( in_y < 0.0 || in_y > `+v+` ) {
          setOutput(float(`+o+`));
          return;
        }
        float in_x = `+E+`;
        if( in_x < 0.0 || in_x > `+p+` ) {
          setOutput(float(`+o+`));
          return;
        }

        vec2 sourceFracIndexCR = vec2(in_x,in_y);
        if(`+f+` == 1) {
          // Compute the four integer indices.
          ivec2 sourceFloorCR = ivec2(sourceFracIndexCR);
          ivec2 sourceCeilCR = ivec2(ceil(sourceFracIndexCR));

          float topLeft = getImage(b, sourceFloorCR.y, sourceFloorCR.x, d);
          float bottomLeft = getImage(b, sourceCeilCR.y, sourceFloorCR.x, d);
          float topRight = getImage(b, sourceFloorCR.y, sourceCeilCR.x, d);
          float bottomRight = getImage(b, sourceCeilCR.y, sourceCeilCR.x, d);

          vec2 fracCR = sourceFracIndexCR - vec2(sourceFloorCR);

          float top = topLeft + (topRight - topLeft) * fracCR.x;
          float bottom = bottomLeft + (bottomRight - bottomLeft) * fracCR.x;
          float newValue = top + (bottom - top) * fracCR.y;
          setOutput(newValue);
        } else {
          // Compute the coordinators of nearest neighbor point.
          ivec2 sourceNearestCR = ivec2(floor(
            sourceFracIndexCR + vec2(0.5,0.5)));
          float newValue = getImage(b, sourceNearestCR.y, sourceNearestCR.x, d);
          setOutput(newValue);
        }
      }
    `},u$=function(t,e,n){this.variableNames=["x"],this.outputShape=t;var r=t.length,o=t[t.length-1],i=n?"<":">";this.userCode=`
      int getIndex(int i) {
        `+(n?"return "+o+" -i - 1;":"return i;")+`
      }

      void main() {
        `+qe(r)+` coords = getOutputCoords();
        int end = `+rx(r,"coords")+`;
        float val = 0.0;
        for (int i = `+o+` - 1; i >= 0; i -= 1) {
          int idx = getIndex(i);
          if (idx `+i+` end) {
            continue;
          }
          if (idx == end && `+e+`) {
            continue;
          }
          `+rx(r,"coords")+` = idx;
          val += getX(`+function(a,s){if(a===1)return""+s;if(a===2)return s+".x, "+s+".y";if(a===3)return s+".x, "+s+".y, "+s+".z";if(a===4)return s+".x, "+s+".y, "+s+".z, "+s+".w";throw Error("Cumulative sum for rank "+a+" is not yet supported")}(r,"coords")+`);
        }
        setOutput(val);
      }
    `};function rx(t,e){if(t===1)return""+e;if(t===2)return e+".y";if(t===3)return e+".z";if(t===4)return e+".w";throw Error("Cumulative sum for rank "+t+" is not yet supported")}var l$=function(t){this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0,this.outPackingScheme=Tl.DENSE;var e=Zu(t),n=Kt();this.outputShape=t,this.userCode=`
      ivec3 outCoordsFromFlatIndex(int index) {
        `+ta(["r","c","d"],t)+`
        return ivec3(r, c, d);
      }

      void main() {
        ivec2 resTexRC = ivec2(resultUV.yx *
          vec2(`+e[0]+", "+e[1]+`));
        int index = 4 * (resTexRC.x * `+e[1]+` + resTexRC.y);

        vec4 result = vec4(0.);

        for (int i=0; i<4; i++) {
          int flatIndex = index + i;
          ivec3 rc = outCoordsFromFlatIndex(flatIndex);
          result[i] = getA(rc.x, rc.y, rc.z);
        }

        `+n.output+` = result;
      }
    `},c$=function(t){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outPackingScheme=Tl.DENSE;var e=Zu(t),n=Kt();this.outputShape=t,this.userCode=`
      ivec3 outCoordsFromFlatIndex(int index) {
        `+ta(["r","c","d"],t)+`
        return ivec3(r, c, d);
      }

      void main() {
        ivec2 resTexRC = ivec2(resultUV.yx *
          vec2(`+e[0]+", "+e[1]+`));
        int index = 4 * (resTexRC.x * `+e[1]+` + resTexRC.y);

        vec4 result = vec4(0.);

        for (int i=0; i<4; i++) {
          int flatIndex = index + i;
          ivec3 rc = outCoordsFromFlatIndex(flatIndex);
          result[i] = getChannel(getA(rc.x, rc.y, rc.z), vec2(rc.y, rc.z));
        }

        `+n.output+` = result;
      }
    `},d$=function(){function t(e,n,r){this.variableNames=["x"],this.outputShape=[],this.outputShape=e,this.blockSize=n,this.dataFormat=r,this.userCode=`
    void main() {
      ivec4 coords = getOutputCoords();
      int b = coords[0];
      int h = `+this.getHeightCoordString()+`;
      int w = `+this.getWidthCoordString()+`;
      int d = `+this.getDepthCoordString()+`;

      int in_h = h / `+n+`;
      int offset_h = imod(h, `+n+`);
      int in_w = w / `+n+`;
      int offset_w = imod(w, `+n+`);
      int offset_d = (offset_h * `+n+` + offset_w) *
        `+this.getOutputDepthSize()+`;
      int in_d = d + offset_d;

      float result = `+this.getInputSamplingString()+`;
      setOutput(result);
    }
  `}return t.prototype.getHeightCoordString=function(){return this.dataFormat==="NHWC"?"coords[1]":"coords[2]"},t.prototype.getWidthCoordString=function(){return this.dataFormat==="NHWC"?"coords[2]":"coords[3]"},t.prototype.getDepthCoordString=function(){return this.dataFormat==="NHWC"?"coords[3]":"coords[1]"},t.prototype.getOutputDepthSize=function(){return this.dataFormat==="NHWC"?this.outputShape[3]:this.outputShape[1]},t.prototype.getInputSamplingString=function(){return this.dataFormat==="NHWC"?"getX(b, in_h, in_w, in_d)":"getX(b, in_d, in_h, in_w)"},t}(),f$=function(t){this.variableNames=["X"],this.outputShape=[t,t],this.userCode=`
      void main() {
          ivec2 coords = getOutputCoords();
          float val = coords[0] == coords[1] ? getX(coords[0]) : 0.0;
          setOutput(val);
      }
    `},h$=function(t){this.variableNames=["A"],this.outTexUsage=An.DOWNLOAD;var e=Kt();this.outputShape=t,this.userCode=`
      `+xS+`

      void main() {
        float x = getAAtOutCoords();
        `+e.output+` = encode_float(x);
      }
    `},p$=function(t){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!1,this.outTexUsage=An.DOWNLOAD;var e=Kt();this.outputShape=t,this.userCode=`
      `+xS+`

      void main() {
        ivec3 coords = getOutputCoords();
        float x = getChannel(getAAtOutCoords(), vec2(coords.y, coords.z));
        `+e.output+` = encode_float(x);
      }
    `},v$=function(t,e,n){n===void 0&&(n=!1),this.variableNames=["A"];var r=Kt(),o=e[0],i=e[1];this.outputShape=t;var a="result";n&&(a="floor(result * 255. + 0.5)"),this.userCode=`
      `+by(t)+`

      void main() {
        ivec3 coords = getOutputCoords();

        int flatIndex = getFlatIndex(coords);
        int offset = imod(flatIndex, 4);

        flatIndex = idiv(flatIndex, 4, 1.);
        
        int r = flatIndex / `+i+`;
        int c = imod(flatIndex, `+i+`);
        vec2 uv = (vec2(c, r) + halfCR) / vec2(`+i+".0, "+o+`.0);
        vec4 values = `+r.texture2D+`(A, uv);

        float result;

        if(offset == 0) {
          result = values[0];
        } else if(offset == 1) {
          result = values[1];
        } else if(offset == 2) {
          result = values[2];
        } else {
          result = values[3];
        }

        `+r.output+" = vec4("+a+`, 0., 0., 0.);
      }
    `},m$=function(t,e,n){n===void 0&&(n=!1),this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0;var r=Kt(),o=e[0],i=e[1];this.outputShape=t;var a="",s="result";n&&(s="floor(result * 255. + 0.5)");for(var u=0;u<=1;u++)for(var l=0;l<=1;l++){var c=2*u+l;a+=`
          localCoords = coords;
          if(localCoords[2] + `+l+" < "+t[2]+`) {
            localCoords[2] += `+l+`;
            if(localCoords[1] + `+u+" < "+t[1]+`) {
              localCoords[1] += `+u+`;

              flatIndex = getFlatIndex(localCoords);
              offset = imod(flatIndex, 4);

              flatIndex = idiv(flatIndex, 4, 1.);

              r = flatIndex / `+i+`;
              c = imod(flatIndex, `+i+`);
              uv = (vec2(c, r) + halfCR) / vec2(`+i+".0, "+o+`.0);
              values = `+r.texture2D+`(A, uv);

              if(offset == 0) {
                result[`+c+`] = values[0];
              } else if(offset == 1) {
                result[`+c+`] = values[1];
              } else if(offset == 2) {
                result[`+c+`] = values[2];
              } else {
                result[`+c+`] = values[3];
              }
            }
          }
        `}this.userCode=`
      `+by(t)+`

      void main() {
        ivec3 coords = getOutputCoords();

        vec4 result = vec4(0.);
        int flatIndex, r, c, offset;
        ivec3 localCoords;
        vec2 uv;
        vec4 values;

        `+a+`

        `+r.output+" = "+s+`;
      }
    `},g$="return real * expR - imag * expI;",y$="return real * expI + imag * expR;",ox=function(t,e,n){this.variableNames=["real","imag"];var r=e[1];this.outputShape=e;var o=n?"2.0 * "+Math.PI:"-2.0 * "+Math.PI,i=n?r+".0":"1.0";this.userCode=`
      const float exponentMultiplier = `+o+`;

      float unaryOpComplex(float real, float expR, float imag, float expI) {
        `+t+`
      }

      float mulMatDFT(int batch, int index) {
        float indexRatio = float(index) / float(`+r+`);
        float exponentMultiplierTimesIndexRatio =
            exponentMultiplier * indexRatio;

        float result = 0.0;

        for (int i = 0; i < `+r+`; i++) {
          // x = (-2|2 * PI / N) * index * i;
          float x = exponentMultiplierTimesIndexRatio * float(i);
          float expR = cos(x);
          float expI = sin(x);
          float real = getReal(batch, i);
          float imag = getImag(batch, i);

          result +=
              unaryOpComplex(real, expR, imag, expI) / `+i+`;
        }

        return result;
      }

      void main() {
        ivec2 coords = getOutputCoords();
        setOutput(mulMatDFT(coords[0], coords[1]));
      }
    `},w$=function(){function t(e,n){this.outputShape=[],this.variableNames=["x"],this.outputShape=e,this.userCode=`
      uniform float value;
      void main() {
        // Input can be obtained from uniform value.
        setOutput(value);
      }
    `}return t.prototype.getCustomSetupFunc=function(e){var n=this;return function(r,o){n.valueLoc==null&&(n.valueLoc=r.getUniformLocationNoThrow(o,"value")),r.gl.uniform1f(n.valueLoc,e)}},t}(),x$=function(t,e,n){this.variableNames=["A","indices"];var r=t.slice();r[n]=e,this.outputShape=r,this.rank=r.length;var o=qe(this.rank),i=function(a,s){var u=a.length;if(u>4)throw Error("Gather for rank "+u+" is not yet supported");if(u===1)return"int(getIndices(resRC))";for(var l=["resRC.x","resRC.y","resRC.z","resRC.w"],c=[],d=0;d<a.length;d++)d===s?c.push("int(getIndices("+l[d]+"))"):c.push(""+l[d]);return c.join()}(t,n);this.userCode=`
      void main() {
        `+o+` resRC = getOutputCoords();
        setOutput(getA(`+i+`));
      }
    `},b$=function(t,e,n){this.sliceDim=t,this.strides=e,this.variableNames=["x","indices"],this.outputShape=n;var r=qe(e.length),o=qe(n.length),i=this.sliceDim>1?"strides[j]":"strides";this.userCode=`
        `+r+" strides = "+r+"("+this.strides+`);
         void main() {
          `+o+` coords = getOutputCoords();
          int flattenIndex = 0;
          for (int j = 0; j < `+this.sliceDim+`; j++) {
            int index = round(getIndices(coords[0], j));
            flattenIndex += index * `+i+`;
          }
          setOutput(getX(flattenIndex, coords[1]));
        }
      `};function _$(t,e){var n=Kt();return gL(t,e,n.version+`
    precision highp float;
    `+n.attribute+` vec3 clipSpacePos;
    `+n.attribute+` vec2 uv;
    `+n.varyingVs+` vec2 resultUV;

    void main() {
      gl_Position = vec4(clipSpacePos, 1);
      resultUV = uv;
    }`)}function E$(t,e){return _L(t,e,new Float32Array([-1,1,0,0,1,-1,-1,0,0,0,1,1,0,1,1,1,-1,0,1,0]))}function C$(t,e){return EL(t,e,new Uint16Array([0,1,2,2,1,3]))}function Jl(t,e,n,r,o,i,a){SL(n,r);var s=CL(t,e),u=t.TEXTURE_2D;return le(t,e,function(){return t.bindTexture(u,s)}),le(t,e,function(){return t.texParameteri(u,t.TEXTURE_WRAP_S,t.CLAMP_TO_EDGE)}),le(t,e,function(){return t.texParameteri(u,t.TEXTURE_WRAP_T,t.CLAMP_TO_EDGE)}),le(t,e,function(){return t.texParameteri(u,t.TEXTURE_MIN_FILTER,t.NEAREST)}),le(t,e,function(){return t.texParameteri(u,t.TEXTURE_MAG_FILTER,t.NEAREST)}),le(t,e,function(){return t.texImage2D(u,0,o,n,r,0,i,a,null)}),le(t,e,function(){return t.bindTexture(t.TEXTURE_2D,null)}),s}function S$(t,e,n,r,o){var i=th(n,r);return Jl(t,e,i[0],i[1],o.internalFormatFloat,o.textureFormatFloat,t.FLOAT)}function k$(t,e,n,r,o){var i=th(n,r);return Jl(t,e,i[0],i[1],o.internalFormatHalfFloat,o.textureFormatFloat,o.textureTypeHalfFloat)}function R$(t,e,n,r,o){var i=th(n,r);return Jl(t,e,i[0],i[1],t.RGBA,t.RGBA,t.UNSIGNED_BYTE)}function T$(t,e,n,r,o){var i=Ql(n,r);return Jl(t,e,i[0],i[1],o.internalFormatPackedFloat,t.RGBA,t.FLOAT)}function I$(t,e,n,r,o){var i=Ql(n,r);return Jl(t,e,i[0],i[1],o.internalFormatPackedHalfFloat,t.RGBA,o.textureTypeHalfFloat)}function A$(t,e,n,r){return le(t,e,function(){return t.bindBuffer(t.ARRAY_BUFFER,r)}),Hw(t,e,n,"clipSpacePos",r,3,20,0)&&Hw(t,e,n,"uv",r,2,20,12)}function P$(t,e,n,r,o,i,a){var s,u,l;le(t,e,function(){return t.bindTexture(t.TEXTURE_2D,n)}),i instanceof Uint8Array?(s=new Uint8Array(r*o*4),u=t.UNSIGNED_BYTE,l=t.RGBA):(s=new Float32Array(r*o*4),u=t.FLOAT,l=a.internalFormatPackedFloat),s.set(i),le(t,e,function(){return t.texImage2D(t.TEXTURE_2D,0,l,r,o,0,t.RGBA,u,s)}),le(t,e,function(){return t.bindTexture(t.TEXTURE_2D,null)})}function D$(t,e,n,r){le(t,e,function(){return t.bindTexture(t.TEXTURE_2D,n)}),r.data instanceof Uint8Array?le(t,e,function(){return t.texImage2D(t.TEXTURE_2D,0,t.RGBA,r.width,r.height,0,t.RGBA,t.UNSIGNED_BYTE,r.data)}):le(t,e,function(){return t.texImage2D(t.TEXTURE_2D,0,t.RGBA,t.RGBA,t.UNSIGNED_BYTE,r)}),le(t,e,function(){return t.bindTexture(t.TEXTURE_2D,null)})}function N$(t,e,n,r,o){var i=t.createBuffer();le(t,e,function(){return t.bindBuffer(t.PIXEL_PACK_BUFFER,i)});var a=16*n*r;return le(t,e,function(){return t.bufferData(t.PIXEL_PACK_BUFFER,a,t.STREAM_READ)}),le(t,e,function(){return t.readPixels(0,0,r,n,t.RGBA,t.FLOAT,0)}),le(t,e,function(){return t.bindBuffer(t.PIXEL_PACK_BUFFER,null)}),i}function O$(t,e,n){var r=t,o=new Float32Array(n);return r.bindBuffer(r.PIXEL_PACK_BUFFER,e),r.getBufferSubData(r.PIXEL_PACK_BUFFER,0,o),r.bindBuffer(r.PIXEL_PACK_BUFFER,null),o}function F$(t,e,n,r,o){var i=th(n,r),a=i[0],s=i[1],u=new Uint8Array(n*r*4);return le(t,e,function(){return t.readPixels(0,0,a,s,o.downloadTextureFormat,t.UNSIGNED_BYTE,u)}),new Float32Array(u.buffer)}function M$(t,e,n,r,o,i,a,s){var u=t,l=new Float32Array(function(c,d){var f=Ql(c,d);return f[0]*f[1]*4}(i,a));return u.bindBuffer(u.PIXEL_PACK_BUFFER,e),u.getBufferSubData(u.PIXEL_PACK_BUFFER,0,l),u.bindBuffer(u.PIXEL_PACK_BUFFER,null),l}function L$(t,e,n,r){var o=new Float32Array(n*r*4);return le(t,e,function(){return t.readPixels(0,0,r,n,t.RGBA,t.FLOAT,o)}),o}var B$=function(){function t(e){this.outputTexture=null,this.program=null,this.disposed=!1,this.vertexAttrsAreBound=!1,this.itemsToPoll=[];var n=H().getNumber("WEBGL_VERSION");e!=null?(this.gl=e,fL(n,e)):this.gl=Qr(n);var r="WEBGL_color_buffer_float";if(H().getNumber("WEBGL_VERSION")===1){if(this.textureFloatExtension=$c(this.gl,this.debug,"OES_texture_float"),qn(this.gl,"OES_texture_half_float"))this.textureHalfFloatExtension=$c(this.gl,this.debug,"OES_texture_half_float");else if(H().get("WEBGL_FORCE_F16_TEXTURES"))throw new Error("GL context does not support half float textures, yet the environment flag WEBGL_FORCE_F16_TEXTURES is set to true.");if(this.colorBufferFloatExtension=this.gl.getExtension(r),qn(this.gl,"EXT_color_buffer_half_float"))this.colorBufferHalfFloatExtension=$c(this.gl,this.debug,"EXT_color_buffer_half_float");else if(H().get("WEBGL_FORCE_F16_TEXTURES"))throw new Error("GL context does not support color renderable half floats, yet the environment flag WEBGL_FORCE_F16_TEXTURES is set to true.")}else if(r="EXT_color_buffer_float",qn(this.gl,r))this.colorBufferFloatExtension=this.gl.getExtension(r);else{if(!qn(this.gl,"EXT_color_buffer_half_float"))throw new Error("GL context does not support color renderable floats");this.colorBufferHalfFloatExtension=this.gl.getExtension("EXT_color_buffer_half_float")}this.vertexBuffer=E$(this.gl,this.debug),this.indexBuffer=C$(this.gl,this.debug),this.framebuffer=kL(this.gl,this.debug),this.textureConfig=dy(this.gl,this.textureHalfFloatExtension)}return Object.defineProperty(t.prototype,"debug",{get:function(){return H().getBool("DEBUG")},enumerable:!0,configurable:!0}),t.prototype.dispose=function(){var e=this;if(!this.disposed){this.program!=null&&console.warn("Disposing a GPGPUContext that still has a bound WebGLProgram. This is probably a resource leak, delete the program with GPGPUContext.deleteProgram before disposing."),this.outputTexture!=null&&console.warn("Disposing a GPGPUContext that still has a bound output matrix texture.  This is probably a resource leak, delete the output matrix texture with GPGPUContext.deleteMatrixTexture before disposing.");var n=this.gl;le(n,this.debug,function(){return n.finish()}),le(n,this.debug,function(){return n.bindFramebuffer(n.FRAMEBUFFER,null)}),le(n,this.debug,function(){return n.deleteFramebuffer(e.framebuffer)}),le(n,this.debug,function(){return n.bindBuffer(n.ARRAY_BUFFER,null)}),le(n,this.debug,function(){return n.bindBuffer(n.ELEMENT_ARRAY_BUFFER,null)}),le(n,this.debug,function(){return n.deleteBuffer(e.indexBuffer)}),this.disposed=!0}},t.prototype.createFloat32MatrixTexture=function(e,n){return this.throwIfDisposed(),S$(this.gl,this.debug,e,n,this.textureConfig)},t.prototype.createFloat16MatrixTexture=function(e,n){return this.throwIfDisposed(),k$(this.gl,this.debug,e,n,this.textureConfig)},t.prototype.createUnsignedBytesMatrixTexture=function(e,n){return this.throwIfDisposed(),R$(this.gl,this.debug,e,n,this.textureConfig)},t.prototype.uploadPixelDataToTexture=function(e,n){this.throwIfDisposed(),D$(this.gl,this.debug,e,n)},t.prototype.uploadDenseMatrixToTexture=function(e,n,r,o){this.throwIfDisposed(),P$(this.gl,this.debug,e,n,r,o,this.textureConfig)},t.prototype.createFloat16PackedMatrixTexture=function(e,n){return this.throwIfDisposed(),I$(this.gl,this.debug,e,n,this.textureConfig)},t.prototype.createPackedMatrixTexture=function(e,n){return this.throwIfDisposed(),T$(this.gl,this.debug,e,n,this.textureConfig)},t.prototype.deleteMatrixTexture=function(e){var n=this;this.throwIfDisposed(),this.outputTexture===e&&(Gw(this.gl,this.debug,this.framebuffer),this.outputTexture=null),le(this.gl,this.debug,function(){return n.gl.deleteTexture(e)})},t.prototype.downloadByteEncodedFloatMatrixFromOutputTexture=function(e,n,r){var o=this;return this.downloadMatrixDriver(e,function(){return F$(o.gl,o.debug,n,r,o.textureConfig)})},t.prototype.downloadPackedMatrixFromBuffer=function(e,n,r,o,i,a){return M$(this.gl,e,0,0,0,i,a,this.textureConfig)},t.prototype.downloadFloat32MatrixFromBuffer=function(e,n){return O$(this.gl,e,n)},t.prototype.createBufferFromTexture=function(e,n,r){this.bindTextureToFrameBuffer(e);var o=N$(this.gl,this.debug,n,r,this.textureConfig);return this.unbindTextureToFrameBuffer(),o},t.prototype.createAndWaitForFence=function(){var e=this.createFence(this.gl);return this.pollFence(e)},t.prototype.createFence=function(e){var n,r,o=this;if(H().getBool("WEBGL_FENCE_API_ENABLED")){var i=e,a=i.fenceSync(i.SYNC_GPU_COMMANDS_COMPLETE,0);e.flush(),r=function(){var s=i.clientWaitSync(a,0,0);return s===i.ALREADY_SIGNALED||s===i.CONDITION_SATISFIED},n=a}else H().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")>0?(n=this.beginQuery(),this.endQuery(),r=function(){return o.isQueryAvailable(n,H().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))}):r=function(){return!0};return{query:n,isFencePassed:r}},t.prototype.downloadMatrixFromPackedTexture=function(e,n,r){var o=this;return this.downloadMatrixDriver(e,function(){return L$(o.gl,o.debug,n,r)})},t.prototype.createProgram=function(e){this.throwIfDisposed();var n=this.gl,r=yL(n,this.debug,e),o=_$(n,this.debug),i=xL(n,this.debug);return le(n,this.debug,function(){return n.attachShader(i,o)}),le(n,this.debug,function(){return n.attachShader(i,r)}),bL(n,this.debug,i),this.debug&&wp(n,this.debug,i),this.vertexAttrsAreBound||(this.setProgram(i),this.vertexAttrsAreBound=A$(n,this.debug,this.program,this.vertexBuffer)),i},t.prototype.deleteProgram=function(e){var n=this;this.throwIfDisposed(),e===this.program&&(this.program=null),e!=null&&le(this.gl,this.debug,function(){return n.gl.deleteProgram(e)})},t.prototype.setProgram=function(e){var n=this;this.throwIfDisposed(),this.program=e,this.program!=null&&this.debug&&wp(this.gl,this.debug,this.program),le(this.gl,this.debug,function(){return n.gl.useProgram(e)})},t.prototype.getUniformLocation=function(e,n,r){return r===void 0&&(r=!0),this.throwIfDisposed(),r?TL(this.gl,this.debug,e,n):IL(this.gl,e,n)},t.prototype.getAttributeLocation=function(e,n){var r=this;return this.throwIfDisposed(),le(this.gl,this.debug,function(){return r.gl.getAttribLocation(e,n)})},t.prototype.getUniformLocationNoThrow=function(e,n){return this.throwIfDisposed(),this.gl.getUniformLocation(e,n)},t.prototype.setInputMatrixTexture=function(e,n,r){this.throwIfDisposed(),this.throwIfNoProgram(),AL(this.gl,this.debug,this.program,e,n,r)},t.prototype.setOutputMatrixTexture=function(e,n,r){this.setOutputMatrixTextureDriver(e,r,n)},t.prototype.setOutputPackedMatrixTexture=function(e,n,r){this.throwIfDisposed();var o=Ql(n,r),i=o[0],a=o[1];this.setOutputMatrixTextureDriver(e,i,a)},t.prototype.setOutputMatrixWriteRegion=function(e,n,r,o){this.setOutputMatrixWriteRegionDriver(r,e,o,n)},t.prototype.setOutputPackedMatrixWriteRegion=function(e,n,r,o){throw new Error("setOutputPackedMatrixWriteRegion not implemented.")},t.prototype.debugValidate=function(){this.program!=null&&wp(this.gl,this.debug,this.program),jc(this.gl)},t.prototype.executeProgram=function(){this.throwIfDisposed(),this.throwIfNoProgram();var e=this.gl;this.debug&&this.debugValidate(),le(e,this.debug,function(){return e.drawElements(e.TRIANGLES,6,e.UNSIGNED_SHORT,0)})},t.prototype.blockUntilAllProgramsCompleted=function(){var e=this;this.throwIfDisposed(),le(this.gl,this.debug,function(){return e.gl.finish()})},t.prototype.getQueryTimerExtension=function(){return this.disjointQueryTimerExtension==null&&(this.disjointQueryTimerExtension=$c(this.gl,this.debug,H().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")===2?"EXT_disjoint_timer_query_webgl2":"EXT_disjoint_timer_query")),this.disjointQueryTimerExtension},t.prototype.getQueryTimerExtensionWebGL2=function(){return this.getQueryTimerExtension()},t.prototype.getQueryTimerExtensionWebGL1=function(){return this.getQueryTimerExtension()},t.prototype.beginQuery=function(){if(H().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")===2){var e=this.gl,n=this.getQueryTimerExtensionWebGL2(),r=e.createQuery();return e.beginQuery(n.TIME_ELAPSED_EXT,r),r}var o=this.getQueryTimerExtensionWebGL1(),i=o.createQueryEXT();return o.beginQueryEXT(o.TIME_ELAPSED_EXT,i),i},t.prototype.endQuery=function(){if(H().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")!==2){var e=this.getQueryTimerExtensionWebGL1();e.endQueryEXT(e.TIME_ELAPSED_EXT)}else{var n=this.gl,r=this.getQueryTimerExtensionWebGL2();n.endQuery(r.TIME_ELAPSED_EXT)}},t.prototype.waitForQueryAndGetTime=function(e){return ie(this,void 0,void 0,function(){var n=this;return ae(this,function(r){switch(r.label){case 0:return[4,$w(function(){return n.disposed||n.isQueryAvailable(e,H().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))})];case 1:return r.sent(),[2,this.getQueryTime(e,H().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))]}})})},t.prototype.getQueryTime=function(e,n){if(n===0)return null;if(n===2){var r=this.gl;return r.getQueryParameter(e,r.QUERY_RESULT)/1e6}var o=this.getQueryTimerExtensionWebGL1();return o.getQueryObjectEXT(e,o.QUERY_RESULT_EXT)/1e6},t.prototype.isQueryAvailable=function(e,n){if(n===0)return!0;if(n===2){var r=this.gl,o=this.getQueryTimerExtensionWebGL2(),i=r.getQueryParameter(e,r.QUERY_RESULT_AVAILABLE);return this.disjoint==null&&(this.disjoint=this.gl.getParameter(o.GPU_DISJOINT_EXT)),i&&!this.disjoint}return i=(o=this.getQueryTimerExtensionWebGL1()).getQueryObjectEXT(e,o.QUERY_RESULT_AVAILABLE_EXT),this.disjoint==null&&(this.disjoint=this.gl.getParameter(o.GPU_DISJOINT_EXT)),i&&!this.disjoint},t.prototype.pollFence=function(e){var n=this;return new Promise(function(r){n.addItemToPoll(function(){return e.isFencePassed()},function(){return r()})})},t.prototype.pollItems=function(){for(var e=function(r){for(var o=0;o<r.length&&r[o]();++o);return o-1}(this.itemsToPoll.map(function(r){return r.isDoneFn})),n=0;n<=e;++n)(0,this.itemsToPoll[n].resolveFn)();this.itemsToPoll=this.itemsToPoll.slice(e+1)},t.prototype.addItemToPoll=function(e,n){var r=this;this.itemsToPoll.push({isDoneFn:e,resolveFn:n}),this.itemsToPoll.length>1||$w(function(){return r.pollItems(),r.itemsToPoll.length===0})},t.prototype.bindTextureToFrameBuffer=function(e){this.throwIfDisposed(),xp(this.gl,this.debug,e,this.framebuffer),this.debug&&jc(this.gl)},t.prototype.unbindTextureToFrameBuffer=function(){this.outputTexture!=null?(xp(this.gl,this.debug,this.outputTexture,this.framebuffer),this.debug&&jc(this.gl)):Gw(this.gl,this.debug,this.framebuffer)},t.prototype.downloadMatrixDriver=function(e,n){this.bindTextureToFrameBuffer(e);var r=n();return this.unbindTextureToFrameBuffer(),r},t.prototype.setOutputMatrixTextureDriver=function(e,n,r){this.throwIfDisposed();var o=this.gl;xp(o,this.debug,e,this.framebuffer),this.debug&&jc(o),this.outputTexture=e,le(o,this.debug,function(){return o.viewport(0,0,n,r)}),le(o,this.debug,function(){return o.scissor(0,0,n,r)})},t.prototype.setOutputMatrixWriteRegionDriver=function(e,n,r,o){var i=this;this.throwIfDisposed(),le(this.gl,this.debug,function(){return i.gl.scissor(e,n,r,o)})},t.prototype.throwIfDisposed=function(){if(this.disposed)throw new Error("Attempted to use disposed GPGPUContext.")},t.prototype.throwIfNoProgram=function(){if(this.program==null)throw new Error("No GPU program is currently set.")},t}();function ix(t,e){if(t.length!==e.length)throw Error("Binary was compiled with "+t.length+" inputs, but was executed with "+e.length+" inputs");t.forEach(function(n,r){var o=n.logicalShape,i=e[r],a=i.shape;if(!At(o,a))throw Error("Binary was compiled with different shapes than the current args. Shapes "+o+" and "+a+" must match");if(!n.isUniform||!i.isUniform){var s=n.texShape,u=i.isUniform?null:i.texData.texShape;if(!At(s,u))throw Error("Binary was compiled with different texture shapes than the current args. Shape "+s+" and "+u+" must match")}})}var $$=function(t,e,n){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=t;for(var r=n.filterWidth,o=n.inChannels,i=n.strideWidth,a=n.strideHeight,s=n.padInfo,u=n.outWidth,l=n.dilationWidth,c=n.dilationHeight,d=n.dataFormat,f=s.left,h=s.top,v=o*r,p=Kt(),m=d==="channelsLast",g=m?0:1,y=m?1:2,w="",x=0;x<=1;x++)for(var b=0;b<=1;b++)w+=`
          blockIndex = rc.y + `+b+`;
          pos = rc.x + `+x+`;

          if(blockIndex < `+t[1]+" && pos < "+t[0]+`) {
            offsetY = int(blockIndex / (`+u+")) * "+a+" - "+h+`;
            d0 = offsetY + `+c+" * (pos / "+v+`);

            if(d0 < `+e[g]+` && d0 >= 0) {

              offsetX = int(mod(float(blockIndex), `+u+".) * "+i+". - "+f+`.);
              d1 = offsetX + `+l+" * (int(mod(float(pos), "+v+".) / "+o+`.));

              if(d1 < `+e[y]+` && d1 >= 0) {

                ch = int(mod(float(pos), `+o+`.));

                if (`+m+`) {
                  innerDims = vec2(d1, ch);
                  result[`+(2*x+b)+`] = getChannel(
                    getA(d0, int(innerDims.x),
                    int(innerDims.y)), innerDims);
                } else {
                  innerDims = vec2(d0, d1);
                  result[`+(2*x+b)+`] = getChannel(
                    getA(ch, int(innerDims.x),
                    int(innerDims.y)), innerDims);
                }
              }
            }
          }
        `;this.userCode=`
      void main() {
        ivec2 rc = getOutputCoords();

        vec4 result = vec4(0);

        int blockIndex, pos, offsetY, d0, offsetX, d1, ch;
        vec2 innerDims;

        `+w+`

        `+p.output+` = result;
      }
    `},j$=function(t,e,n,r,o){this.variableNames=["x"],this.outputShape=[];var i,a=e,s=t[3]-1;this.outputShape=t;var u="float("+n+") + float("+r+") * sum";i=o===.5?"inversesqrt("+u+")":o===1?"1.0/("+u+")":"exp(log("+u+") * float(-"+o+"));",this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int r = coords[1];
        int c = coords[2];
        int d = coords[3];
        float x = getX(b, r, c, d);
        float sum = 0.0;
        for (int j = -`+a+"; j <= "+a+`; j++) {
          int idx = d + j;
          if (idx >= 0 && idx <=  `+s+`) {
            float z = getX(b, r, c, idx);
            sum += z * z;
          }
        }
        float val = x * `+i+`;
        setOutput(val);
      }
    `},W$=function(t,e,n,r,o){this.variableNames=["inputImage","outputImage","dy"],this.outputShape=[],this.outputShape=t,this.depth=t[3],this.depthRadius=e,this.bias=n,this.alpha=r,this.beta=o,this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int r = coords[1];
        int c = coords[2];

        float result = 0.0;
        for (int d = 0; d < `+this.depth+`; ++d) {
          int depthBegin = int(max(0.0, float(d - `+e+`)));
          int depthEnd = int(min(float(`+this.depth+`),
              float(d + `+e+` + 1)));

          const int MIN_DEPTH_BEGIN = 0;
          const int MAX_DEPTH_END = `+this.depth+`;

          float norm = 0.0;
          for (int k = MIN_DEPTH_BEGIN; k < MAX_DEPTH_END; ++k) {
            if (k < depthBegin){
              continue;
            }
            else if (k >= depthBegin && k < depthEnd) {
              norm += getInputImage(b, r, c, k) * getInputImage(b, r, c, k);
            }
            else {
              break;
            }
          }

          norm = float(`+r+") * norm + float("+n+`);

          for(int k = MIN_DEPTH_BEGIN; k < MAX_DEPTH_END; ++k){
            if (k < depthBegin){
              continue;
            }
            else if (k >= depthBegin && k < depthEnd){
              float dyi = -2.0 * float(`+r+`)
                * float(`+o+`)
                * getInputImage(b ,r ,c, k) * getOutputImage(b, r, c, d)
                / norm;
              if (k == d) {
                dyi += pow(norm, -1.0 * `+o+`);
              }
              if (k == coords[3]) {
                dyi *= getDy(b, r, c, d);
                result += dyi;
              }
            }
            else {
              break;
            }
          }
      }
      setOutput(result);
      }
    `},U$=function(t,e,n,r,o){this.variableNames=["x"],this.outputShape=[],this.packedInputs=!0,this.packedOutput=!0;var i,a=e,s=t[3]-1;this.outputShape=t;var u="float("+n+") + float("+r+") * sum";i=o===.5?"inversesqrt("+u+")":o===1?"1.0/("+u+")":"exp(log("+u+") * float(-"+o+"));",this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords.x;
        int r = coords.y;
        int c = coords.z;
        int d = coords.w;

        bool hasNextCol = d < `+this.outputShape[3]+`;
        bool hasNextRow = c < `+this.outputShape[2]+`;

        vec4 sum = vec4(0.);
        vec4 xFragAtOutputCoords = getX(b, r, c, d);

        vec4 xAtOutputCoords = vec4(
          getChannel(xFragAtOutputCoords, vec2(c, d)),
          hasNextCol ?
            getChannel(xFragAtOutputCoords, vec2(c, d + 1)) : 0.0,
          hasNextRow ?
            getChannel(xFragAtOutputCoords , vec2(c + 1, d)) : 0.0,
          (hasNextRow && hasNextCol) ?
            getChannel(xFragAtOutputCoords, vec2(c + 1, d + 1)) : 0.0
        );

        int firstChannel = d - `+a+`;
        vec2 cache = vec2(0.);
        if(firstChannel >= 0){
          vec4 firstChannelFrag = getX(b, r, c, firstChannel);
          cache.x = getChannel(firstChannelFrag, vec2(c, firstChannel));
            if(hasNextRow){
              cache.y = getChannel(firstChannelFrag, vec2(c + 1, firstChannel));
            }
        }

        ivec2 depth = ivec2(d, d + 1);
        for (int j = - `+a+"; j <= "+a+`; j++) {
          ivec2 idx = depth + j;
          bvec2 aboveLowerBound = greaterThanEqual(idx, ivec2(0));
          bvec2 belowUpperBound = lessThanEqual(idx, ivec2(`+s+`));

          bool depthInRange = aboveLowerBound.x && belowUpperBound.x;
          bool depthPlusOneInRange = aboveLowerBound.y && belowUpperBound.y;

          if(depthInRange || depthPlusOneInRange){
            vec4 z = vec4(0.);
            vec4 xFragAtCurrentDepth;
            z.xz = cache.xy;
            if(depthPlusOneInRange && hasNextCol){
              xFragAtCurrentDepth = idx.y != d ?
                getX(b, r, c, idx.y) : xFragAtOutputCoords;
              z.y = getChannel(xFragAtCurrentDepth, vec2(c, idx.y));
              if(hasNextRow){
                z.w = getChannel(xFragAtCurrentDepth, vec2(c + 1, idx.y));
              }
            }
            cache.xy = z.yw;
            sum += z * z;
          }
        }
        vec4 result = xAtOutputCoords * `+i+`;
        setOutput(result);
      }
    `},z$=function(t){this.variableNames=["dy","maxPos"],this.outputShape=t.inShape;var e=t.strideHeight,n=t.strideWidth,r=t.dilationHeight,o=t.effectiveFilterHeight,i=t.effectiveFilterWidth,a=o-1-t.padInfo.top,s=i-1-t.padInfo.left,u=o*i-1;this.userCode=`
      const ivec2 pads = ivec2(`+a+", "+s+`);

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];

        ivec2 dyRCCorner = coords.yz - pads;
        int dyRCorner = dyRCCorner.x;
        int dyCCorner = dyRCCorner.y;

        // Convolve dy(?, ?, d) with pos mask(:, :, d) to get dx(xR, xC, d).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        for (int wR = 0; wR < `+o+`;
          wR += `+r+`) {
          float dyR = float(dyRCorner + wR) / `+e+`.0;

          if (dyR < 0.0 || dyR >= `+t.outHeight+`.0 || fract(dyR) > 0.0) {
            continue;
          }
          int idyR = int(dyR);

          for (int wC = 0; wC < `+i+`; wC++) {
            float dyC = float(dyCCorner + wC) / `+n+`.0;

            if (dyC < 0.0 || dyC >= `+t.outWidth+`.0 ||
                fract(dyC) > 0.0) {
              continue;
            }
            int idyC = int(dyC);

            float dyValue = getDy(b, idyR, idyC, d);
            int maxPosValue = `+u+` - int(getMaxPos(b, idyR, idyC, d));

            // Get the current value, check it against the value from the
            // position matrix.
            int curPosValue = wR * `+i+` + wC;
            float mask = float(maxPosValue == curPosValue ? 1.0 : 0.0);

            dotProd += dyValue * mask;
          }
        }
        setOutput(dotProd);
      }
    `},V$=function(t){this.variableNames=["dy","maxPos"],this.outputShape=t.inShape;var e=t.strideDepth,n=t.strideHeight,r=t.strideWidth,o=t.dilationDepth,i=t.dilationHeight,a=t.dilationWidth,s=t.effectiveFilterDepth,u=t.effectiveFilterHeight,l=t.effectiveFilterWidth,c=s-1-t.padInfo.front,d=u-1-t.padInfo.top,f=l-1-t.padInfo.left,h=s*u*l-1;this.userCode=`
      const ivec3 pads = ivec3(`+c+", "+d+", "+f+`);

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int ch = coords.u;

        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;
        int dyDCorner = dyCorner.x;
        int dyRCorner = dyCorner.y;
        int dyCCorner = dyCorner.z;

        // Convolve dy(?, ?, ?, ch) with pos mask(:, :, :, d) to get
        // dx(xD, xR, xC, ch).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;

        for (int wD = 0; wD < `+s+`;
           wD += `+o+`) {
          float dyD = float(dyDCorner + wD) / `+e+`.0;

          if (dyD < 0.0 || dyD >= `+t.outDepth+`.0 || fract(dyD) > 0.0) {
            continue;
          }
          int idyD = int(dyD);

          for (int wR = 0; wR < `+u+`;
              wR += `+i+`) {
            float dyR = float(dyRCorner + wR) / `+n+`.0;

            if (dyR < 0.0 || dyR >= `+t.outHeight+`.0 ||
                fract(dyR) > 0.0) {
              continue;
            }
            int idyR = int(dyR);

            for (int wC = 0; wC < `+l+`;
                wC += `+a+`) {
              float dyC = float(dyCCorner + wC) / `+r+`.0;

              if (dyC < 0.0 || dyC >= `+t.outWidth+`.0 ||
                  fract(dyC) > 0.0) {
                continue;
              }
              int idyC = int(dyC);

              float dyValue = getDy(batch, idyD, idyR, idyC, ch);
              int maxPosValue = `+h+` -
                  int(getMaxPos(batch, idyD, idyR, idyC, ch));

              // Get the current value, check it against the value from the
              // position matrix.
              int curPosValue =
                  wD * `+u+" * "+l+` +
                  wR * `+l+` + wC;
              float mask = float(maxPosValue == curPosValue ? 1.0 : 0.0);

              dotProd += dyValue * mask;
            }
          }
        }
        setOutput(dotProd);
      }
    `},Sp=function(t,e,n,r,o,i,a){n===void 0&&(n=!1),r===void 0&&(r=!1),o===void 0&&(o=!1),i===void 0&&(i=null),a===void 0&&(a=!1),this.variableNames=["matrixA","matrixB"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=e;var s=n?t[1]:t[2],u=Math.ceil(s/2),l=n?"i * 2, rc.y":"rc.y, i * 2",c=r?"rc.z, i * 2":"i * 2, rc.z",d=n?["a.xxyy","a.zzww"]:["a.xxzz","a.yyww"],f=r?["b.xzxz","b.ywyw"]:["b.xyxy","b.zwzw"],h="",v="";i&&(h=a?`vec4 activation(vec4 a) {
          vec4 b = getPreluActivationWeightsAtOutCoords();
          `+i+`
        }`:`vec4 activation(vec4 x) {
          `+i+`
        }`,v="result = activation(result);");var p=o?"result += getBiasAtOutCoords();":"";o&&this.variableNames.push("bias"),a&&this.variableNames.push("preluActivationWeights"),this.userCode=`
      `+h+`

      const float sharedDimension = `+u+`.0;

      vec4 dot2x2ARowBCol(ivec3 rc) {
        vec4 result = vec4(0);
        for (int i = 0; i < `+u+`; i++) {
          vec4 a = getMatrixA(rc.x, `+l+`);
          vec4 b = getMatrixB(rc.x, `+c+`);

          // These swizzled products need to be separately added.
          // See: https://github.com/tensorflow/tfjs/issues/1735
          result += (`+d[0]+" * "+f[0]+`);
          result += (`+d[1]+" * "+f[1]+`);
        }
        return result;
      }

      void main() {
        ivec3 rc = getOutputCoords();
        vec4 result = dot2x2ARowBCol(rc);

        `+p+`

        `+v+`

        setOutput(result);
      }
    `},H$=function(){function t(e,n,r){this.variableNames=["probs"],this.outputShape=[e,r],this.userCode=`
      uniform float seed;

      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];

        float r = random(seed);
        float cdf = 0.0;

        for (int i = 0; i < `+(n-1)+`; i++) {
          cdf += getProbs(batch, i);

          if (r < cdf) {
            setOutput(float(i));
            return;
          }
        }

        // If no other event happened, last event happened.
        setOutput(float(`+(n-1)+`));
      }
    `}return t.prototype.getCustomSetupFunc=function(e){var n=this;return function(r,o){n.seedLoc==null&&(n.seedLoc=r.getUniformLocation(o,"seed")),r.gl.uniform1f(n.seedLoc,e)}},t}(),G$=function(t,e,n,r){this.variableNames=["indices"],this.outputShape=[t,e],this.userCode=`
      void main() {
        ivec2 coords = getOutputCoords();
        int index = round(getIndices(coords.x));
        setOutput(mix(float(`+r+"), float("+n+`),
                      float(index == coords.y)));
      }
    `},q$=function(t){this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0,this.outputShape=t;var e=t.length;if(e===0)this.userCode=`
        void main() {
          setOutput(vec4(getA(), 0., 0., 0.));
        }
      `;else{var n=mn("rc",e),r=qe(e),o=function(s,u,l){if(s===1)return"rc > "+u[0];for(var c="",d=s-2;d<s;d++)c+=l[d]+" >= "+u[d],d<s-1&&(c+="||");return c}(e,t,n),i=function(s,u,l,c){if(s===1)return"";var d=c.slice(-2);return`
    int r = `+d[0]+`;
    int c = `+d[1]+`;
    int rp1 = r + 1;
    int cp1 = c + 1;

    bool cEdge = cp1 >= `+u+`;
    bool rEdge = rp1 >= `+l+`;
  `}(e,t[t.length-1],t[t.length-2],n),a=function(s,u){var l=s.length,c=function(d,f){for(var h=[],v=0;v<=1;v++)for(var p=0;p<=1;p++){for(var m=(v===0?"r":"rp1")+", "+(p===0?"c":"cp1"),g=2;g<d;g++)m=f[f.length-1-g]+","+m;h.push(m)}return h}(l,u);return l===1?`getA(rc),
            rc + 1 >= `+s[0]+` ? 0. : getA(rc + 1),
            0, 0`:"getA("+c[0]+`),
          cEdge ? 0. : getA(`+c[1]+`),
          rEdge ? 0. : getA(`+c[2]+`),
          rEdge || cEdge ? 0. : getA(`+c[3]+")"}(t,n);this.userCode=`
        void main() {
          `+r+` rc = getOutputCoords();

          if(`+o+`) {
            setOutput(vec4(0));
          } else {
            `+i+`

            setOutput(vec4(`+a+`));
          }
        }
      `}},K$=function(t,e,n){this.variableNames=["x"],this.outputShape=e.map(function(u,l){return u[0]+t[l]+u[1]});var r=t.length,o=qe(r),i=e.map(function(u){return u[0]}).join(","),a=e.map(function(u,l){return u[0]+t[l]}).join(","),s=["coords[0]","coords[1]","coords[2]","coords[3]"].slice(0,r);this.userCode=r!==1?`
      `+o+" start = "+o+"("+i+`);
      `+o+" end = "+o+"("+a+`);

      void main() {
        `+o+` outC = getOutputCoords();
        if (any(lessThan(outC, start)) || any(greaterThanEqual(outC, end))) {
          setOutput(float(`+n+`));
        } else {
          `+o+` coords = outC - start;
          setOutput(getX(`+s+`));
        }
      }
    `:`
        int start = `+i+`;
        int end = `+a+`;

        void main() {
          int outC = getOutputCoords();
          if (outC < start || outC >= end) {
            setOutput(float(`+n+`));
          } else {
            setOutput(getX(outC - start));
          }
        }
      `},X$=function(t,e,n){this.variableNames=["x"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=e.map(function(m,g){return m[0]+t[g]+m[1]});for(var r=t.length,o=qe(r),i=e.map(function(m){return m[0]}).join(","),a=e.map(function(m,g){return m[0]+t[g]}).join(","),s=mn("rc",r),u=mn("source",r),l=s[r-1]+" < "+this.outputShape[r-1],c=r===1?"source":"vec2("+u.slice(-2).join()+")",d=[o+" rc = outputLoc;",s[r-1]+` += 1;
       if(`+l+`) {
      `,r===1?"":`}
       rc = outputLoc;
       `+s[r-2]+` += 1;
       if(`+s[r-2]+" < "+this.outputShape[r-2]+") {",r===1?"":"  "+s[r-1]+` += 1;
         if(`+l+") {"],f=r===1?"rc < start || rc >= end":"any(lessThan(rc, start)) || any(greaterThanEqual(rc, end))",h="",v=0,p=r===1?2:4;v<p;v++)h+=`
        `+d[v]+`
        if (`+f+`) {
          result[`+v+"] = float("+n+`);
        } else {
          `+o+` source = rc - start;
          result[`+v+"] = getChannel(getX("+u.join()+"), "+c+`);
        }
      `;h+=r===1?"} ":"}}",this.userCode=`
      const `+o+" start = "+o+"("+i+`);
      const `+o+" end = "+o+"("+a+`);

      void main() {
        `+o+` outputLoc = getOutputCoords();
        vec4 result = vec4(0.);
        `+h+`
        setOutput(result);
      }
    `},kp=function(t,e,n){if(this.variableNames=["x"],e==="avg"&&n)throw new Error("Cannot compute positions for average pool.");var r=t.filterWidth,o=t.strideHeight,i=t.strideWidth,a=t.dilationHeight,s=t.dilationWidth,u=t.effectiveFilterHeight,l=t.effectiveFilterWidth,c=t.padInfo.top,d=t.padInfo.left;this.outputShape=t.outShape;var f=e==="avg",h="0.0";if(f||(h="-1.0 / 1e-20"),n)this.userCode=`
        const ivec2 strides = ivec2(`+o+", "+i+`);
        const ivec2 pads = ivec2(`+c+", "+d+`);

        void main() {
          ivec4 coords = getOutputCoords();
          int batch = coords[0];
          int d = coords[3];

          ivec2 xRCCorner = coords.yz * strides - pads;
          int xRCorner = xRCCorner.x;
          int xCCorner = xRCCorner.y;

          // max/min x(?, ?, d) to get y(yR, yC, d).
          // ? = to be determined
          float minMaxValue = 0.0;
          float minMaxValueFound = 0.0;
          int minMaxPosition = 0;
          float avgValue = 0.0;

          for (int wR = 0; wR < `+u+`;
              wR += `+a+`) {
            int xR = xRCorner + wR;

            if (xR < 0 || xR >= `+t.inHeight+`) {
              continue;
            }

            for (int wC = 0; wC < `+l+`;
                wC += `+s+`) {
              int xC = xCCorner + wC;

              if (xC < 0 || xC >= `+t.inWidth+`) {
                continue;
              }

              float value = getX(batch, xR, xC, d);

              // If a min / max value has already been found, use it. If not,
              // use the current value.
              float currMinMaxValue = mix(
                  value, minMaxValue, minMaxValueFound);
              if (value >= currMinMaxValue) {
                minMaxValue = value;
                minMaxValueFound = 1.0;
                minMaxPosition = wR * `+l+` + wC;
              }
            }
          }
          setOutput(float(minMaxPosition));
        }
      `;else{var v=e+"("+e+"("+e+"(minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])";e==="avg"&&(v="avgValue / count");var p=4*Math.floor(r/4),m=r%4,g=`
      if (`+f+`) {
        avgValue += dot(values, ones);
      } else {
        minMaxValue = max(values, minMaxValue);
      }
    `;this.userCode=`
      const ivec2 strides = ivec2(`+o+", "+i+`);
      const ivec2 pads = ivec2(`+c+", "+d+`);
      const float initializationValue = `+h+`;
      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);

      float count = 0.0;

      float getValue(int batch, int xR, int xC, int d) {
        if (xC < 0 || xC >= `+t.inWidth+`) {
          return initializationValue;
        }
        count += 1.0;
        return getX(batch, xR, xC, d);
      }

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords[0];
        int d = coords[3];

        ivec2 xRCCorner = coords.yz * strides - pads;
        int xRCorner = xRCCorner.x;
        int xCCorner = xRCCorner.y;

        // max/min x(?, ?, d) to get y(yR, yC, d).
        // ? = to be determined
        vec4 minMaxValue = vec4(`+h+`);
        float avgValue = 0.0;
        count = 0.0;

        for (int wR = 0; wR < `+u+`;
            wR += `+a+`) {
          int xR = xRCorner + wR;

          if (xR < 0 || xR >= `+t.inHeight+`) {
            continue;
          }

          for (int wC = 0; wC < `+p+`; wC += 4) {
            int xC = xCCorner + wC * `+s+`;

            vec4 values = vec4(
              getValue(batch, xR, xC, d),
              getValue(batch, xR, xC + `+s+`, d),
              getValue(batch, xR, xC + 2 * `+s+`, d),
              getValue(batch, xR, xC + 3 * `+s+`, d)
            );

            `+g+`
          }

          int xC = xCCorner + `+p+`;
          if (`+(m===1)+`) {
            vec4 values = vec4(
              getValue(batch, xR, xC, d),
              initializationValue,
              initializationValue,
              initializationValue
            );

            `+g+`
          } else if (`+(m===2)+`) {
            vec4 values = vec4(
              getValue(batch, xR, xC, d),
              getValue(batch, xR, xC + `+s+`, d),
              initializationValue,
              initializationValue
            );

            `+g+`
          } else if (`+(m===3)+`) {
            vec4 values = vec4(
              getValue(batch, xR, xC, d),
              getValue(batch, xR, xC + `+s+`, d),
              getValue(batch, xR, xC + 2 * `+s+`, d),
              initializationValue
            );

            `+g+`
          }
        }
        setOutput(`+v+`);
      }
    `}},Rp=function(t,e,n){if(this.variableNames=["x"],e==="avg"&&n)throw new Error("Cannot compute positions for average pool.");var r=t.filterWidth,o=t.strideDepth,i=t.strideHeight,a=t.strideWidth,s=t.dilationDepth,u=t.dilationHeight,l=t.dilationWidth,c=t.effectiveFilterDepth,d=t.effectiveFilterHeight,f=t.effectiveFilterWidth,h=t.padInfo.front,v=t.padInfo.top,p=t.padInfo.left;this.outputShape=t.outShape;var m=e==="avg",g="0.0";if(m||(g="-1.0 / 1e-20"),n)this.userCode=`
        const ivec3 strides =
            ivec3(`+o+", "+i+", "+a+`);
        const ivec3 pads = ivec3(`+h+", "+v+", "+p+`);

        void main() {
          ivec5 coords = getOutputCoords();
          int batch = coords.x;
          int ch = coords.u;

          ivec3 xCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;
          int xDCorner = xCorner.x;
          int xRCorner = xCorner.y;
          int xCCorner = xCorner.z;

          // max/min x(?, ?, ?, ch) to get y(yD, yR, yC, ch).
          // ? = to be determined
          float minMaxValue = 0.0;
          float minMaxValueFound = 0.0;
          int minMaxPosition = 0;

          for (int wD = 0; wD < `+c+`;
              wD += `+s+`) {
            int xD = xDCorner + wD;

            if (xD < 0 || xD >= `+t.inDepth+`) {
              continue;
            }

            for (int wR = 0; wR < `+d+`;
                wR += `+u+`) {
              int xR = xRCorner + wR;

              if (xR < 0 || xR >= `+t.inHeight+`) {
                continue;
              }

              for (int wC = 0; wC < `+f+`;
                  wC += `+l+`) {
                int xC = xCCorner + wC;

                if (xC < 0 || xC >= `+t.inWidth+`) {
                  continue;
                }

                float value = getX(batch, xD, xR, xC, ch);

                // If a min / max value has already been found, use it. If not,
                // use the current value.
                float currMinMaxValue = mix(
                    value, minMaxValue, minMaxValueFound);
                if (value >= currMinMaxValue) {
                  minMaxValue = value;
                  minMaxValueFound = 1.0;
                  minMaxPosition =
                      wD * `+d+" * "+f+` +
                      wR * `+f+` + wC;;
                }
              }
            }
          }
          setOutput(float(minMaxPosition));
        }
      `;else{var y=e+"("+e+"("+e+"(minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])";e==="avg"&&(y="avgValue / count");var w=4*Math.floor(r/4),x=r%4,b=`
      if (`+m+`) {
        avgValue += dot(values, ones);
      } else {
        minMaxValue = max(values, minMaxValue);
      }
    `;this.userCode=`
      const ivec3 strides =
        ivec3(`+o+", "+i+", "+a+`);
      const ivec3 pads = ivec3(`+h+", "+v+", "+p+`);
      const float initializationValue = `+g+`;
      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);

      float count = 0.0;

      float getValue(int batch, int xD, int xR, int xC, int ch) {
        if (xC < 0 || xC >= `+t.inWidth+`) {
          return initializationValue;
        }
        count += 1.0;
        return getX(batch, xD, xR, xC, ch);
      }

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int ch = coords.u;

        ivec3 xCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;
        int xDCorner = xCorner.x;
        int xRCorner = xCorner.y;
        int xCCorner = xCorner.z;

        // max/min x(?, ?, ?, d) to get y(yD, yR, yC, ch).
        // ? = to be determined
        vec4 minMaxValue = vec4(`+g+`);
        float avgValue = 0.0;
        count = 0.0;

        for (int wD = 0; wD < `+c+`;
            wD += `+s+`) {
          int xD = xDCorner + wD;

          if (xD < 0 || xD >= `+t.inDepth+`) {
            continue;
          }

          for (int wR = 0; wR < `+d+`;
            wR += `+u+`) {
            int xR = xRCorner + wR;

            if (xR < 0 || xR >= `+t.inHeight+`) {
              continue;
            }

            for (int wC = 0; wC < `+w+`; wC += 4) {
              int xC = xCCorner + wC * `+l+`;

              vec4 values = vec4(
                getValue(batch, xD, xR, xC, ch),
                getValue(batch, xD, xR, xC + `+l+`, ch),
                getValue(batch, xD, xR, xC + 2 * `+l+`, ch),
                getValue(batch, xD, xR, xC + 3 * `+l+`, ch)
              );

              `+b+`
            }

            int xC = xCCorner + `+w+`;
            if (`+(x===1)+`) {
              vec4 values = vec4(
                getValue(batch, xD, xR, xC, ch),
                initializationValue,
                initializationValue,
                initializationValue
              );

              `+b+`
            } else if (`+(x===2)+`) {
              vec4 values = vec4(
                getValue(batch, xD, xR, xC, ch),
                getValue(batch, xD, xR, xC + `+l+`, ch),
                initializationValue,
                initializationValue
              );

              `+b+`
            } else if (`+(x===3)+`) {
              vec4 values = vec4(
                getValue(batch, xD, xR, xC, ch),
                getValue(batch, xD, xR, xC + `+l+`, ch),
                getValue(batch, xD, xR, xC + 2 * `+l+`, ch),
                initializationValue
              );

              `+b+`
            }
          }
          setOutput(`+y+`);
        }
      }
    `}},Y$=function(t,e){this.variableNames=["x"];var n=t.windowSize,r=t.batchSize,o=t.inSize,i=Math.ceil(o/n);this.outputShape=[r,i];var a="0.0",s="";e==="prod"?a="1.0":e==="min"?(a="1.0 / 1e-20",s="min"):e==="max"&&(a="-1.0 / 1e-20",s="max");var u=e+"("+e+"("+e+"(minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])";e==="sum"?u="sumValue":e==="prod"?u="prodValue":e==="all"?u="allValue":e==="any"&&(u="anyValue");var l=4*Math.floor(n/4),c=n%4,d=`
      if (`+(e==="sum")+`) {
        sumValue += dot(values, ones);
      } else if (`+(e==="prod")+`) {
        vec2 tmp = vec2(values[0], values[1]) * vec2(values[2], values[3]);
        prodValue *= tmp[0] * tmp[1];
      } else {
        minMaxValue = `+s+`(values, minMaxValue);
      }
    `,f="vec4";e==="all"?(a="1.0",d=`
        bool reducedAllValue = all(values);
        float floatedReducedAllValue = float(reducedAllValue);
        allValue = float(allValue >= 1.0 && floatedReducedAllValue >= 1.0);
      `,f="bvec4"):e==="any"&&(a="0.0",d=`
        bool reducedAnyValue = any(values);
        float floatedReducedAnyValue = float(reducedAnyValue);
        anyValue = float(anyValue >= 1.0 || floatedReducedAnyValue >= 1.0);
      `,f="bvec4");var h="";o%n>0&&(h=`
        if (inIdx < 0 || inIdx >= `+o+`) {
          return initializationValue;
        }
      `),this.userCode=`
      const float initializationValue = `+a+`;
      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);

      float getValue(int batch, int inIdx) {
        `+h+`
        return getX(batch, inIdx);
      }

      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];
        int outIdx = coords[1];
        int inOffset = outIdx * `+n+`;

        vec4 minMaxValue = vec4(`+a+`);
        float prodValue = 1.0;
        float sumValue = 0.0;
        float allValue = 1.0;
        float anyValue = 0.0;

        for (int i = 0; i < `+l+`; i += 4) {
          int inIdx = inOffset + i;
          `+f+" values = "+f+`(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            getValue(batch, inIdx + 3)
          );

          `+d+`
        }

        int inIdx = inOffset + `+l+`;
        if (`+(c===1)+`) {
          `+f+" values = "+f+`(
            getValue(batch, inIdx),
            initializationValue,
            initializationValue,
            initializationValue
          );

          `+d+`
        } else if (`+(c===2)+`) {
          `+f+" values = "+f+`(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            initializationValue,
            initializationValue
          );

          `+d+`
        } else if (`+(c===3)+`) {
          `+f+" values = "+f+`(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            initializationValue
          );

          `+d+`
        }
        setOutput(`+u+`);
      }
    `},Q$=function(t,e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=t;for(var n="",r=0;r<4;r++){var o="thisRC = rc;";r%2==1&&(o+="thisRC.z += 1;"),r>1&&(o+="thisRC.y += 1;"),n+=`
        `+o+`
        `+(r>0?"if(thisRC.y < rows && thisRC.z < cols){":"")+`
          int flatIndex = getFlatIndex(thisRC);

          ivec3 inputRC = inputCoordsFromReshapedOutCoords(flatIndex);
          vec2 inputRCInnerDims = vec2(float(inputRC.y),float(inputRC.z));

          result[`+r+`] =
            getChannel(getA(inputRC.x, inputRC.y, inputRC.z), inputRCInnerDims);
        `+(r>0?"}":"")+`
      `}this.userCode=`
      
    ivec3 inputCoordsFromReshapedOutCoords(int index) {
      `+ta(["r","c","d"],e)+`
      return ivec3(r, c, d);
    }
  
      `+by(t)+`

      void main() {
        ivec3 rc = getOutputCoords();

        vec4 result = vec4(0.);

        ivec3 thisRC;
        int rows = `+t[1]+`;
        int cols = `+t[2]+`;

        `+n+`

        setOutput(result);
      }
    `},J$=function(t,e,n){this.variableNames=["dy"],this.outputShape=[],this.outputShape=e.shape;var r=e.shape,o=r[1],i=r[2],a=t.shape,s=a[1],u=a[2],l=[n&&s>1?o-1:o,n&&u>1?i-1:i],c=[n&&s>1?s-1:s,n&&u>1?u-1:u],d=l[0]/c[0],f=l[1]/c[1],h=1/d,v=1/f,p=2*Math.ceil(h)+2,m=2*Math.ceil(v)+2;this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        int r = coords[1];
        int c = coords[2];

        float accumulator = 0.0;

        const float heightScale = float(`+d+`);
        const float widthScale = float(`+f+`);

        const float invHeightScale = float(`+h+`);
        const float invWidthScale = float(`+v+`);

        const int winHeight = int(`+p+`);
        const int winWidth = int(`+m+`);

        // Compute bounds for where in dy we will look
        float startRLerp = floor(float(r) * invHeightScale);
        int startDyR = int(startRLerp - float(winHeight / 2));

        float startCLerp = floor(float(c) * invWidthScale);
        int startDyC = int(startCLerp - float(winWidth / 2));

        // Loop over dy
        for (int dyROffset = 0; dyROffset < winHeight; dyROffset++) {
          int dyR = dyROffset + startDyR;

          // Guard against the window exceeding the bounds of dy
          if (dyR < 0 || dyR >= `+s+`) {
            continue;
          }

          for (int dyCOffset = 0; dyCOffset < winWidth; dyCOffset++) {
            int dyC = dyCOffset + startDyC;

            // Guard against the window exceeding the bounds of dy
            if (dyC < 0 || dyC >= `+u+`) {
              continue;
            }

            float dxR = float(dyR) * heightScale;
            int topDxRIndex = int(floor(dxR));
            int bottomDxRIndex = int(min(ceil(dxR), `+(o-1)+`.0));
            float dxRLerp = dxR - float(topDxRIndex);
            float inverseDxRLerp = 1.0 - dxRLerp;

            float dxC = float(dyC) * widthScale;
            int leftDxCIndex = int(floor(dxC));
            int rightDxCIndex = int(min(ceil(dxC), `+(i-1)+`.0));
            float dxCLerp = dxC - float(leftDxCIndex);
            float inverseDxCLerp = 1.0 - dxCLerp;

            if (r == topDxRIndex && c == leftDxCIndex) {
              // topLeft
              accumulator +=
                getDy(b, dyR, dyC, d) * inverseDxRLerp * inverseDxCLerp;
            }

            if (r == topDxRIndex && c == rightDxCIndex) {
              // topRight
              accumulator += getDy(b, dyR, dyC, d) * inverseDxRLerp * dxCLerp;
            }

            if (r == bottomDxRIndex && c == leftDxCIndex) {
              // bottomLeft
              accumulator += getDy(b, dyR, dyC, d) * dxRLerp * inverseDxCLerp;
            }

            if (r == bottomDxRIndex && c == rightDxCIndex) {
              // bottomRight
              accumulator += getDy(b, dyR, dyC, d) * dxRLerp * dxCLerp;
            }
          }
        }
        // End loop over dy

        setOutput(accumulator);
      }
    `},Z$=function(t,e,n,r){this.variableNames=["A"],this.outputShape=[];var o=t[0],i=t[1],a=t[2],s=t[3];this.outputShape=[o,e,n,s];var u=[r&&e>1?i-1:i,r&&n>1?a-1:a],l=[r&&e>1?e-1:e,r&&n>1?n-1:n];this.userCode=`
      const vec2 effectiveInputOverOutputRatioRC = vec2(
          `+u[0]/l[0]+`,
          `+u[1]/l[1]+`);
      const vec2 inputShapeRC = vec2(`+i+".0, "+a+`.0);

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        ivec2 yRC = coords.yz;

        // Fractional source index.
        vec2 sourceFracIndexRC = vec2(yRC) * effectiveInputOverOutputRatioRC;

        // Compute the four integer indices.
        ivec2 sourceFloorRC = ivec2(sourceFracIndexRC);
        ivec2 sourceCeilRC = ivec2(
          min(inputShapeRC - 1.0, ceil(sourceFracIndexRC)));

        float topLeft = getA(b, sourceFloorRC.x, sourceFloorRC.y, d);
        float bottomLeft = getA(b, sourceCeilRC.x, sourceFloorRC.y, d);
        float topRight = getA(b, sourceFloorRC.x, sourceCeilRC.y, d);
        float bottomRight = getA(b, sourceCeilRC.x, sourceCeilRC.y, d);

        vec2 fracRC = sourceFracIndexRC - vec2(sourceFloorRC);

        float top = topLeft + (topRight - topLeft) * fracRC.y;
        float bottom = bottomLeft + (bottomRight - bottomLeft) * fracRC.y;
        float newValue = top + (bottom - top) * fracRC.x;

        setOutput(newValue);
      }
    `},ej=function(t,e,n,r){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=[];var o=t[0],i=t[1],a=t[2],s=t[3];this.outputShape=[o,e,n,s];var u=[r&&e>1?i-1:i,r&&n>1?a-1:a],l=[r&&e>1?e-1:e,r&&n>1?n-1:n];this.userCode=`
      const vec3 effectiveInputOverOutputRatioRC = vec3(
          `+u[0]/l[0]+`,
          `+u[1]/l[1]+`,
          `+u[1]/l[1]+`);
      const vec3 inputShapeRC = vec3(`+i+".0, "+a+`.0,
                                     `+a+`.0);

      float getAValue(int b, int r, int c, int d) {
        return getChannel(getA(b, r, c, d), vec2(c, d));
      }

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        // Calculate values for next column in yRC.z.
        ivec3 yRC = coords.yzz + ivec3(0, 0, 1);

        // Fractional source index.
        vec3 sourceFracIndexRC = vec3(yRC) * effectiveInputOverOutputRatioRC;

        // Compute the four integer indices.
        ivec3 sourceFloorRC = ivec3(sourceFracIndexRC);
        ivec3 sourceCeilRC = ivec3(
          min(inputShapeRC - 1.0, ceil(sourceFracIndexRC)));

        // Should we calculate next column and row elements in 2x2 packed cell.
        bool hasNextCol = d < `+(s-1)+`;
        bool hasNextRow = coords.z < `+(n-1)+`;

        // In parallel, construct four corners for all four components in
        // packed 2x2 cell.
        vec4 topLeft = vec4(
          getAValue(b, sourceFloorRC.x, sourceFloorRC.y, d),
          hasNextCol ? getAValue(b, sourceFloorRC.x, sourceFloorRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceFloorRC.x, sourceFloorRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceFloorRC.x, sourceFloorRC.z, d + 1) : 0.0);

        vec4 bottomLeft = vec4(
          getAValue(b, sourceCeilRC.x, sourceFloorRC.y, d),
          hasNextCol ? getAValue(b, sourceCeilRC.x, sourceFloorRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceCeilRC.x, sourceFloorRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceCeilRC.x, sourceFloorRC.z, d + 1) : 0.0);

        vec4 topRight = vec4(
          getAValue(b, sourceFloorRC.x, sourceCeilRC.y, d),
          hasNextCol ? getAValue(b, sourceFloorRC.x, sourceCeilRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceFloorRC.x, sourceCeilRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceFloorRC.x, sourceCeilRC.z, d + 1) : 0.0);

        vec4 bottomRight = vec4(
          getAValue(b, sourceCeilRC.x, sourceCeilRC.y, d),
          hasNextCol ? getAValue(b, sourceCeilRC.x, sourceCeilRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceCeilRC.x, sourceCeilRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceCeilRC.x, sourceCeilRC.z, d + 1) : 0.0);

        vec3 fracRC = sourceFracIndexRC - vec3(sourceFloorRC);

        vec4 top = mix(topLeft, topRight, fracRC.yyzz);
        vec4 bottom = mix(bottomLeft, bottomRight, fracRC.yyzz);
        vec4 newValue = mix(top, bottom, fracRC.x);

        setOutput(newValue);
      }
    `},tj=function(t,e,n){this.variableNames=["dy"],this.outputShape=[],this.outputShape=e.shape;var r=e.shape,o=r[1],i=r[2],a=t.shape,s=a[1],u=a[2],l=[n&&s>1?o-1:o,n&&u>1?i-1:i],c=[n&&s>1?s-1:s,n&&u>1?u-1:u],d=l[0]/c[0],f=l[1]/c[1],h=1/d,v=1/f,p=2*Math.ceil(h)+2,m=2*Math.ceil(v)+2;this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        int r = coords[1];
        int c = coords[2];

        float accumulator = 0.0;

        const float heightScale = float(`+d+`);
        const float widthScale = float(`+f+`);

        const float invHeightScale = float(`+h+`);
        const float invWidthScale = float(`+v+`);

        const int winHeight = int(`+p+`);
        const int winWidth = int(`+m+`);

        // Compute bounds for where in dy we will look
        float startRLerp = floor(float(r) * invHeightScale);
        int startDyR = int(floor(startRLerp - float(winHeight / 2)));

        float startCLerp = floor(float(c) * invWidthScale);
        int startDyC = int(floor(startCLerp - float(winWidth / 2)));

        // Loop over dy
        for (int dyROffset = 0; dyROffset < winHeight; dyROffset++) {
          int dyR = dyROffset + startDyR;

          // Guard against the window exceeding the bounds of dy
          if (dyR < 0 || dyR >= `+s+`) {
            continue;
          }

          for (int dyCOffset = 0; dyCOffset < winWidth; dyCOffset++) {
            int dyC = dyCOffset + startDyC;

            // Guard against the window exceeding the bounds of dy
            if (dyC < 0 || dyC >= `+u+`) {
              continue;
            }

            float sourceFracRow =
              float(`+l[0]+`) *
                (float(dyR) / float(`+c[0]+`));

            float sourceFracCol =
                float(`+l[1]+`) *
                  (float(dyC) / float(`+c[1]+`));

            int sourceNearestRow = int(min(
                float(int(`+o+`) - 1),
                `+n+` ? float(round(sourceFracRow)) :
                                  float(floor(sourceFracRow))));

            int sourceNearestCol = int(min(
                float(int(`+i+`) - 1),
                `+n+` ? float(round(sourceFracCol)) :
                                  float(floor(sourceFracCol))));

            if (r == sourceNearestRow && c == sourceNearestCol) {
              accumulator += getDy(b, dyR, dyC, d);
            }
          }
        }
        // End loop over dy

        setOutput(accumulator);
      }
    `},nj=function(t,e,n,r){this.variableNames=["A"],this.outputShape=[];var o=t[0],i=t[1],a=t[2],s=t[3];this.outputShape=[o,e,n,s];var u=[r&&e>1?i-1:i,r&&n>1?a-1:a],l=[r&&e>1?e-1:e,r&&n>1?n-1:n],c=r?"0.5":"0.0";this.userCode=`
      const vec2 effectiveInputOverOutputRatioRC = vec2(
          `+u[0]/l[0]+`,
          `+u[1]/l[1]+`);
      const vec2 inputShapeRC = vec2(`+i+".0, "+a+`.0);

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        ivec2 yRC = coords.yz;

        // Fractional source index.
        vec2 sourceFracIndexRC = vec2(yRC) * effectiveInputOverOutputRatioRC;

        // Compute the coordinators of nearest neighbor point.
        ivec2 sourceNearestRC = ivec2(
          min(inputShapeRC - 1.0, floor(sourceFracIndexRC + `+c+`)));

        float newValue = getA(b, sourceNearestRC.x, sourceNearestRC.y, d);

        setOutput(newValue);
      }
    `},rj=function(t,e){this.variableNames=["x"];var n=t.length;if(n>4)throw new Error("WebGL backend: Reverse of rank-"+n+" tensor is not yet supported");if(this.outputShape=t,n!==1){var r=t.map(function(i,a){return function(s){return e.indexOf(s)!==-1&&t[s]!==1?t[s]+" - coords["+s+"] - 1":"coords["+s+"]"}(a)}).join(","),o=qe(n);this.userCode=`
      void main() {
        `+o+` coords = getOutputCoords();
        setOutput(getX(`+r+`));
      }
    `}else this.userCode=`
        void main() {
          int coord = getOutputCoords();
          setOutput(getX(`+t[0]+` - coord - 1));
        }
      `},oj=function(t,e){this.variableNames=["x"],this.packedInputs=!0,this.packedOutput=!0;var n=t.length;if(n>4)throw new Error("WebGL backend: Reverse of rank-"+n+" tensor is not yet supported");this.outputShape=t;var r=mn("rc",n),o=r[n-1]+" + 1 < "+this.outputShape[n-1],i=r[n-2]+" + 1 < "+this.outputShape[n-2],a=qe(n);function s(u){var l=t.map(function(c,d){return function(f,h){return e.indexOf(f)!==-1&&t[f]!==1?t[f]+" - "+h[f]+" - 1":""+h[f]}(d,u)});return"getChannel(getX("+l.join(",")+"), vec2("+l.slice(-2).join(",")+"))"}this.userCode=n===1?`
        void main(){
          int rc = getOutputCoords();
          vec4 result = vec4(0.);
          result.r = getChannel(getX(`+t[0]+` - rc - 1),
            `+t[0]+` - rc - 1);
          if(`+o+`){
              result.g = getChannel(getX(`+t[0]+` - (rc  + 1) - 1),
                `+t[0]+` - (rc  + 1) - 1);
          }
          setOutput(result);
        }
      `:`
        void main() {
          `+a+` rc = getOutputCoords();
          vec4 result = vec4(0.);
          result.r = `+function(u){return s(u)}(r.slice())+`;
          if(`+o+`){
            result.g = `+function(u){return u[n-1]="("+u[n-1]+" + 1)",s(u)}(r.slice())+`;
          }
          if(`+i+`) {
            result.b = `+function(u){return u[n-2]="("+u[n-2]+" + 1)",s(u)}(r.slice())+`;
            if(`+o+`) {
              result.a = `+function(u){return u[n-1]="("+u[n-1]+" + 1)",u[n-2]="("+u[n-2]+" + 1)",s(u)}(r.slice())+`;
            }
          }
          setOutput(result);
        }
    `},ax=function(t,e,n,r,o,i,a){this.variableNames=["updates","indices","defaultValue"],this.outputShape=i;var s=qe(o.length),u=qe(i.length),l="";n===1?l="i":n===2&&(l="i, j");var c="getIndices("+l+")",d="";r===1?d="i":r===2&&(d="i, coords[1]");var f="getUpdates("+d+")",h=e>1?"strides[j]":"strides";this.userCode=`
        `+s+" strides = "+s+"("+o+`);

        void main() {
          `+u+` coords = getOutputCoords();
          float sum = 0.0;
          bool found = false;
          for (int i = 0; i < `+t+`; i++) {
            int flattenedIndex = 0;
            for (int j = 0; j < `+e+`; j++) {
              int index = round(`+c+`);
              flattenedIndex += index * `+h+`;
            }
            if (flattenedIndex == coords[0]) {
              sum += `+f+`;
              found = true;
            }
          }
          setOutput(mix(getDefaultValue(), sum, float(found)));
        }
      `},ij=function(t,e){this.variableNames=["x","segmentIds"];var n=t.windowSize,r=t.batchSize,o=t.inSize,i=t.numSegments,a=i*Math.ceil(o/n);this.outputShape=[r,a];var s=4*Math.floor(n/4),u=n%4,l=`
        sumValue += dot(values, segFilter);
    `,c="";o%n>0&&(c=`
        if (inIdx < 0 || inIdx >= `+o+`) {
          return initializationValue;
        }
      `);var d="";o%n>0&&(d=`
        if (inIdx < 0 || inIdx >= `+o+`) {
          return -1.0;
        }
      `),this.userCode=`
      const float initializationValue = 0.0;

      float getValue(int batch, int inIdx) {
        `+c+`
        return getX(batch, inIdx);
      }

      float getSegmentIdAtIndex(int inIdx) {
        `+d+`
        return getSegmentIds(inIdx);
      }

      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];
        int outIdx = coords[1];
        int inOffset = int(floor(float(outIdx) / float(
          `+i+")) * float("+n+`));
        int currentSeg = int(mod(float(outIdx), float(`+i+`)));

        float sumValue = 0.0;

        for (int i = 0; i < `+s+`; i += 4) {
          int inIdx = inOffset + i;
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            getValue(batch, inIdx + 3)
          );

          vec4 segFilter = vec4(
            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 2)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 3)) == currentSeg ? 1 : 0
          );

          `+l+`
        }

        int inIdx = inOffset + `+s+`;
        if (`+(u===1)+`) {
          vec4 values = vec4(
            getValue(batch, inIdx),
            initializationValue,
            initializationValue,
            initializationValue
          );

          int inIdxSeg = int(getSegmentIdAtIndex(inIdx));

          vec4 segFilter = vec4(
            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,
            0,
            0,
            0
          );

          `+l+`
        } else if (`+(u===2)+`) {
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            initializationValue,
            initializationValue
          );

          vec4 segFilter = vec4(
            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,
              0,
              0
          );

          `+l+`
        } else if (`+(u===3)+`) {
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            initializationValue
          );

          vec4 segFilter = vec4(
            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 2)) == currentSeg ? 1 : 0,
            0
          );

          `+l+`
        }
        setOutput(sumValue);
      }
    `},aj=function(t,e,n){var r,o;if(this.variableNames=["c","a","b"],this.outputShape=e,n>4)throw Error("Where for rank "+n+" is not yet supported");if(n===1)o="resRC",r="resRC";else{for(var i=["resRC.x","resRC.y","resRC.z","resRC.w"],a=[],s=[],u=0;u<e.length;u++)s.push(""+i[u]),u<t&&a.push(""+i[u]);r=a.join(),o=s.join()}var l=qe(n);this.userCode=`
      void main() {
        `+l+` resRC = getOutputCoords();
        float cVal = getC(`+r+`);
        if (cVal >= 1.0) {
          setOutput(getA(`+o+`));
        } else {
          setOutput(getB(`+o+`));
        }
      }
    `},sj=function(){function t(e){this.variableNames=["source"],this.outputShape=e,this.rank=e.length;var n,r=qe(this.rank),o="uniform int start["+this.rank+"];",i=function(a){if(a===1)return"sourceLoc";if(a<=6)return Tp.slice(0,a).map(function(s){return"sourceLoc."+s}).join(",");throw Error("Slicing for rank "+a+" is not yet supported")}(this.rank);n=`
        `+r+` sourceLoc;
        `+r+` coords = getOutputCoords();
        `+e.map(function(a,s){return"sourceLoc."+Tp[s]+" = start["+s+"] + coords."+Tp[s]+";"}).join(`
`)+`
      `,this.userCode=`
      `+o+`
      void main() {
        `+n+`
        setOutput(getSource(`+i+`));
      }
    `}return t.prototype.getCustomSetupFunc=function(e){var n=this;if(e.length!==this.rank)throw Error("The rank ("+this.rank+") of the program must match the length of start ("+e.length+")");return function(r,o){n.startLoc==null&&(n.startLoc=r.getUniformLocationNoThrow(o,"start"),n.startLoc==null)||r.gl.uniform1iv(n.startLoc,e)}},t}(),Tp=["x","y","z","w","u","v"],uj=function(){function t(e){this.variableNames=["source"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=e,this.rank=e.length;var n=qe(this.rank),r=mn("coords",this.rank),o=mn("sourceLoc",this.rank),i=this.rank===1?"sourceLoc":"vec2("+o.slice(-2).join()+")",a="getChannel(getSource("+o.join()+"), "+i+")",s=`
      result.x = `+a+`;
      if (++`+r[this.rank-1]+" < "+e[this.rank-1]+`) {
        ++`+o[this.rank-1]+`;
        result.y = `+a+`;
        --`+o[this.rank-1]+`;
      }
    `,u=this.rank===1?"":`
      --`+r[this.rank-1]+`;
      if (++`+r[this.rank-2]+" < "+e[this.rank-2]+`) {
        ++`+o[this.rank-2]+`;
        result.z = `+a+`;
        if (++`+r[this.rank-1]+" < "+e[this.rank-1]+`) {
          ++`+o[this.rank-1]+`;
          result.w = `+a+`;
        }
      }
    `,l=this.rank<=4?`sourceLoc = coords +
            `+n+"("+e.map(function(c,d){return"start["+d+"]"}).join()+");":e.map(function(c,d){return o[d]+" = "+r[d]+" + start["+d+"];"}).join(`
`);this.userCode=`
      uniform int start[`+this.rank+`];
      void main() {
        `+n+` coords = getOutputCoords();
        `+n+` sourceLoc;
        `+l+`
        vec4 result = vec4(0.);
        `+s+`
        `+u+`
        setOutput(result);
      }
    `}return t.prototype.getCustomSetupFunc=function(e){var n=this;if(e.length!==this.rank)throw Error("The rank ("+this.rank+") of the program must match the length of start ("+e.length+")");return function(r,o){n.startLoc==null&&(n.startLoc=r.getUniformLocationNoThrow(o,"start"),n.startLoc==null)||r.gl.uniform1iv(n.startLoc,e)}},t}(),lj=function(t,e,n){this.variableNames=["x"],this.outputShape=n;var r=n.length,o=qe(n.length),i=qe(n.length),a="";if(r===1)a="coords * strides + begin";else{var s=0;a=n.map(function(u,l){return s++,n.length===1?"coords * strides["+l+"] + begin["+l+"]":"coords["+(s-1)+"] * strides["+l+"] + begin["+l+"]"}).join(",")}this.userCode=`
      `+o+" begin = "+o+"("+t+`);
      `+o+" strides = "+o+"("+e+`);

      void main() {
        `+i+` coords = getOutputCoords();
        setOutput(getX(`+a+`));
      }
    `},cj=function(){function t(e){this.gpgpu=e,this.numUsedTextures=0,this.numFreeTextures=0,this.freeTextures={},this.logEnabled=!1,this.usedTextures={}}return t.prototype.acquireTexture=function(e,n,r){var o,i=sx(n,r),a=ux(e,i,r);if(a in this.freeTextures||(this.freeTextures[a]=[]),a in this.usedTextures||(this.usedTextures[a]=[]),this.freeTextures[a].length>0){this.numFreeTextures--,this.numUsedTextures++,this.log();var s=this.freeTextures[a].shift();return this.usedTextures[a].push(s),s}return this.numUsedTextures++,this.log(),i===Tn.PACKED_2X2_FLOAT32?o=this.gpgpu.createPackedMatrixTexture(e[0],e[1]):i===Tn.PACKED_2X2_FLOAT16?o=this.gpgpu.createFloat16PackedMatrixTexture(e[0],e[1]):i===Tn.UNPACKED_FLOAT32?o=this.gpgpu.createFloat32MatrixTexture(e[0],e[1]):i===Tn.UNPACKED_FLOAT16?o=this.gpgpu.createFloat16MatrixTexture(e[0],e[1]):i===Tn.PACKED_4X1_UNSIGNED_BYTE&&(o=this.gpgpu.createUnsignedBytesMatrixTexture(e[0],e[1])),this.usedTextures[a].push(o),o},t.prototype.releaseTexture=function(e,n,r,o){if(this.freeTextures!=null){var i=ux(n,sx(r,o),o);i in this.freeTextures||(this.freeTextures[i]=[]),this.freeTextures[i].push(e),this.numFreeTextures++,this.numUsedTextures--;var a=this.usedTextures[i],s=a.indexOf(e);if(s<0)throw new Error("Cannot release a texture that was never provided by this texture manager");a.splice(s,1),this.log()}},t.prototype.log=function(){if(this.logEnabled){var e=this.numFreeTextures+this.numUsedTextures;console.log("Free/Used",this.numFreeTextures+" / "+this.numUsedTextures,"("+e+")")}},t.prototype.getNumUsedTextures=function(){return this.numUsedTextures},t.prototype.getNumFreeTextures=function(){return this.numFreeTextures},t.prototype.dispose=function(){var e=this;if(this.freeTextures!=null){for(var n in this.freeTextures)this.freeTextures[n].forEach(function(r){e.gpgpu.deleteMatrixTexture(r)});for(var n in this.usedTextures)this.usedTextures[n].forEach(function(o){e.gpgpu.deleteMatrixTexture(o)});this.freeTextures=null,this.usedTextures=null,this.numUsedTextures=0,this.numFreeTextures=0}},t}();function sx(t,e){if(t===An.UPLOAD)return Tn.PACKED_2X2_FLOAT32;if(t===An.RENDER||t==null)return function(n){return H().getBool("WEBGL_RENDER_FLOAT32_ENABLED")?n?Tn.PACKED_2X2_FLOAT32:Tn.UNPACKED_FLOAT32:n?Tn.PACKED_2X2_FLOAT16:Tn.UNPACKED_FLOAT16}(e);if(t===An.DOWNLOAD||t===An.PIXELS)return Tn.PACKED_4X1_UNSIGNED_BYTE;throw new Error("Unknown logical texture type "+t)}function ux(t,e,n){return t[0]+"_"+t[1]+"_"+e+"_"+n}var dj=function(t,e){this.variableNames=["A"];for(var n=new Array(t.length),r=0;r<n.length;r++)n[r]=t[r]*e[r];this.outputShape=n,this.rank=n.length;var o=qe(this.rank),i=function(a){var s=a.length;if(s>5)throw Error("Tile for rank "+s+" is not yet supported");if(s===1)return"imod(resRC, "+a[0]+")";for(var u=["resRC.x","resRC.y","resRC.z","resRC.w","resRC.u"],l=[],c=0;c<a.length;c++)l.push("imod("+u[c]+", "+a[c]+")");return l.join()}(t);this.userCode=`
      void main() {
        `+o+` resRC = getOutputCoords();
        setOutput(getA(`+i+`));
      }
    `},fj=function(t,e){this.variableNames=["A"];for(var n=new Array(t.length),r=0;r<n.length;r++)n[r]=t[e[r]];this.outputShape=n,this.rank=n.length;var o=qe(this.rank),i=function(a){var s=a.length;if(s>6)throw Error("Transpose for rank "+s+" is not yet supported");for(var u=["resRC.x","resRC.y","resRC.z","resRC.w","resRC.u","resRC.v"],l=new Array(s),c=0;c<a.length;c++)l[a[c]]=u[c];return l.join()}(e);this.userCode=`
    void main() {
      `+o+` resRC = getOutputCoords();
      setOutput(getA(`+i+`));
    }
    `},hj=function(t,e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0;for(var n=new Array(t.length),r=0;r<n.length;r++)n[r]=t[e[r]];if(this.outputShape=n,this.rank=n.length,this.rank>6)throw Error("Packed transpose for rank "+this.rank+" is not yet supported.");var o=qe(this.rank),i=wS("rc",this.rank),a=new Array(this.rank);for(r=0;r<e.length;r++)a[e[r]]=i[r];var s="vec2("+a.slice(-2).join()+")",u="++"+i[this.rank-1]+" < "+n[this.rank-1],l="getChannel(getA("+a.join()+"), "+s+")";this.userCode=`
    void main() {
      `+o+` rc = getOutputCoords();
      vec4 result = vec4(0.);
      result[0] = `+l+`;
      if(`+u+`) {
        result[1] = `+l+`;
      }
      --`+i[this.rank-1]+`;
      if(++`+i[this.rank-2]+" < "+n[this.rank-2]+`) {
        result[2] = `+l+`;
        if(`+u+`) {
          result[3] = `+l+`;
        }
      }
      setOutput(result);
    }
    `},_y=1.7580993408473768,Ey=1.0507009873554805,Ee=function(t,e){this.variableNames=["A"],this.outputShape=t,this.userCode=`
      float unaryOperation(float x) {
        `+e+`
      }

      void main() {
        float x = getAAtOutCoords();
        float y = unaryOperation(x);

        setOutput(y);
      }
    `},Sr="if (isnan(x)) return x;",pj="return x;",lx="return abs(x);",CS=Sr+`
  return (x < 0.0) ? 0.0 : x;
`,SS=Sr+`
  return (x < 0.0) ? 0.0 : min(6.0, x);
`,kS="return (x >= 0.0) ? x : (exp(x) - 1.0);",vj=`
  // Stable and Attracting Fixed Point (0, 1) for Normalized Weights.
  // see: https://arxiv.org/abs/1706.02515
  float scaleAlpha = `+_y+`;
  float scale = `+Ey+`;
  return (x >= 0.0) ? scale * x : scaleAlpha * (exp(x) - 1.0);
`,cx="return -x;",dx="return ceil(x);",fx="return floor(x);",hx="return exp(x);",px="return exp(x) - 1.0;",mj=Sr+`
  return sin(x);
`,gj=Sr+`
  return cos(x);
`,yj=Sr+`
  if (abs(x) > 1.) {
    return NAN;
  }
  return asin(x);
`,wj=Sr+`
  if (abs(x) > 1.) {
    return NAN;
  }
  return acos(x);
`,xj=Sr+`
  return atan(x);
`,bj=Sr+"return log(x + sqrt(x * x + 1.0));",_j=Sr+`
  if (x < 1.0) return NAN;
  return log(x + sqrt(x * x - 1.0));`,Ej=Sr+`
  if ((x < -1.0) || (x > 1.0)) return NAN;
  return (log(1.0 + x) - log(1.0 - x)) / 2.0;`,Vc="return x;",Cj="return x;",RS=`
  vec4 result = x * vec4(greaterThanEqual(x, vec4(0.0)));
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`,TS=`
  vec4 result = min(x, vec4(6.)) * vec4(greaterThanEqual(x, vec4(0.0)));
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`,IS=`
  vec4 result;

  result.r = (x.r >= 0.0) ? x.r : (exp(x.r) - 1.0);
  result.g = (x.g >= 0.0) ? x.g : (exp(x.g) - 1.0);
  result.b = (x.b >= 0.0) ? x.b : (exp(x.b) - 1.0);
  result.a = (x.a >= 0.0) ? x.a : (exp(x.a) - 1.0);

  return result;
`,Nu=function(t,e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=t,this.userCode=`
      vec4 unaryOperation(vec4 x) {
        `+e+`
      }

      void main() {
        vec4 x = getAAtOutCoords();
        vec4 y = unaryOperation(x);

        setOutput(y);
      }
    `},Sj=function(t){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!1,this.outputShape=t;var e=t.length,n=mn("rc",e),r=qe(e),o=function(s,u){if(s===1)return"rc";for(var l="",c=0;c<s;c++)l+=u[c],c<s-1&&(l+=",");return l}(e,n),i=n.slice(-2),a=e<=1?"rc":"vec2("+i.join(",")+")";this.userCode=`
      void main() {
        `+r+` rc = getOutputCoords();
        vec4 packedInput = getA(`+o+`);

        setOutput(getChannel(packedInput, `+a+`));
      }
    `},Hc={};function Gc(t,e){if(e===void 0&&(e=!1),t==="linear")return e?Cj:pj;if(t==="relu")return e?RS:CS;if(t==="elu")return e?IS:kS;if(t==="relu6")return e?TS:SS;if(t==="prelu")return e?ES:_S;throw new Error("Activation "+t+" has not been implemented for the WebGL backend.")}var kj=600,Rj=function(t){function e(n){var r,o=t.call(this)||this;if(o.pendingRead=new WeakMap,o.pendingDisposal=new WeakSet,o.dataRefCount=new WeakMap,o.numBytesInGPU=0,o.uploadWaitMs=0,o.downloadWaitMs=0,o.warnedAboutMemory=!1,o.pendingDeletes=0,o.disposed=!1,!H().getBool("HAS_WEBGL"))throw new Error("WebGL is not supported on this device");if(n==null){var i=Qr(H().getNumber("WEBGL_VERSION"));o.binaryCache=((r=H().getNumber("WEBGL_VERSION"))in Hc||(Hc[r]={}),Hc[r]),o.gpgpu=new B$(i),o.canvas=i.canvas,o.gpgpuCreatedLocally=!0}else o.gpgpu=n,o.binaryCache={},o.gpgpuCreatedLocally=!1,o.canvas=n.gl.canvas;return o.textureManager=new cj(o.gpgpu),o.numMBBeforeWarning=H().global.screen==null?1024:H().global.screen.height*H().global.screen.width*window.devicePixelRatio*kj/1024/1024,o.texData=new cS(o,L),o}return Cr(e,t),e.prototype.numDataIds=function(){return this.texData.numDataIds()+(this.cpuBackend?this.cpuBackend.numDataIds():0)-this.pendingDeletes},e.prototype.write=function(n,r,o){if(H().getBool("DEBUG")&&this.checkNumericalProblems(n),o==="complex64"&&n!=null)throw new Error("Cannot write to a complex64 dtype. Please use tf.complex(real, imag).");var i={};return this.texData.set(i,{shape:r,dtype:o,values:n,usage:An.UPLOAD}),i},e.prototype.move=function(n,r,o,i){if(H().getBool("DEBUG")&&this.checkNumericalProblems(r),i==="complex64")throw new Error("Cannot write to a complex64 dtype. Please use tf.complex(real, imag).");this.texData.set(n,{shape:o,dtype:i,values:r,usage:An.UPLOAD})},e.prototype.readSync=function(n){var r=this.texData.get(n),o=r.values,i=r.dtype,a=r.complexTensors,s=r.slice,u=r.shape,l=r.isPacked;if(s!=null){var c=void 0;c=l?new Nu(u,Vc):new Ee(u,Vc);var d=this.runWebGLProgram(c,[{dataId:n,shape:u,dtype:i}],i),f=this.readSync(d.dataId);return this.disposeData(d.dataId),f}if(o!=null)return this.convertAndCacheOnCPU(n);if(i==="string")return o;var h,v,p=this.activeTimers!=null;return p&&(h=Fr()),i==="complex64"?v=Am(a.real.dataSync(),a.imag.dataSync()):v=this.getValuesFromTexture(n),p&&(this.downloadWaitMs+=Fr()-h),this.convertAndCacheOnCPU(n,v)},e.prototype.read=function(n){return ie(this,void 0,void 0,function(){var r,o,i,a,s,u,l,c,d,f,h,v,p,m,g,y,w,x,b,_,E,C;return ae(this,function(R){switch(R.label){case 0:if(this.pendingRead.has(n))return r=this.pendingRead.get(n),[2,new Promise(function(S){return r.push(S)})];if(o=this.texData.get(n),i=o.values,a=o.shape,s=o.slice,u=o.dtype,l=o.complexTensors,c=o.isPacked,s!=null)return d=void 0,d=c?new Nu(a,Vc):new Ee(a,Vc),f=this.runWebGLProgram(d,[{dataId:n,shape:a,dtype:u}],u),h=this.read(f.dataId),this.disposeData(f.dataId),[2,h];if(i!=null)return[2,this.convertAndCacheOnCPU(n)];if(!H().getBool("WEBGL_DOWNLOAD_FLOAT_ENABLED")&&H().getNumber("WEBGL_VERSION")===2)throw new Error("tensor.data() with WEBGL_DOWNLOAD_FLOAT_ENABLED=false and WEBGL_VERSION=2 not yet supported.");return v=null,u!=="complex64"&&H().get("WEBGL_BUFFER_SUPPORTED")&&(p=this.decode(n),m=this.texData.get(p.dataId),v=(C=this.gpgpu).createBufferFromTexture.apply(C,[m.texture].concat(Zu(a)))),this.pendingRead.set(n,[]),u==="complex64"?[3,2]:[4,this.gpgpu.createAndWaitForFence()];case 1:R.sent(),R.label=2;case 2:return u!=="complex64"?[3,4]:[4,Promise.all([l.real.data(),l.imag.data()])];case 3:return y=R.sent(),w=y[0],x=y[1],g=Am(w,x),[3,5];case 4:v==null?g=this.getValuesFromTexture(n):(b=se(a),g=this.gpgpu.downloadFloat32MatrixFromBuffer(v,b)),R.label=5;case 5:return p!=null&&this.disposeData(p.dataId),_=this.convertAndCacheOnCPU(n,g),E=this.pendingRead.get(n),this.pendingRead.delete(n),E.forEach(function(S){return S(_)}),this.pendingDisposal.has(n)&&(this.pendingDisposal.delete(n),this.disposeData(n),this.pendingDeletes--),[2,_]}})})},e.prototype.checkNumericalProblems=function(n){if(n!=null)for(var r=0;r<n.length;r++){var o=n[r];if(!vL(o))throw H().getBool("WEBGL_RENDER_FLOAT32_CAPABLE")?Error("The value "+o+" cannot be represented with your current settings. Consider enabling float32 rendering: 'tf.env().set('WEBGL_RENDER_FLOAT32_ENABLED', true);'"):Error("The value "+o+" cannot be represented on this device.")}},e.prototype.getValuesFromTexture=function(n){var r,o=this.texData.get(n),i=o.shape,a=o.dtype,s=o.isPacked,u=se(i);if(H().getBool("WEBGL_DOWNLOAD_FLOAT_ENABLED")){var l=this.decode(n),c=this.texData.get(l.dataId),d=(r=this.gpgpu).downloadMatrixFromPackedTexture.apply(r,[c.texture].concat(Zu(i))).subarray(0,u);return this.disposeData(l.dataId),d}var f=H().getBool("WEBGL_PACK")&&s===!0,h=f?bp(i):i,v=f?new p$(h):new h$(h),p=this.runWebGLProgram(v,[{shape:h,dtype:a,dataId:n}],"float32"),m=this.texData.get(p.dataId),g=this.gpgpu.downloadByteEncodedFloatMatrixFromOutputTexture(m.texture,m.texShape[0],m.texShape[1]).subarray(0,u);return this.disposeData(p.dataId),g},e.prototype.time=function(n){return ie(this,void 0,void 0,function(){var r,o,i,a,s,u,l;return ae(this,function(c){switch(c.label){case 0:return r=this.activeTimers,o=[],i=!1,this.programTimersStack==null?(this.programTimersStack=o,i=!0):this.activeTimers.push(o),this.activeTimers=o,n(),a=nu(this.activeTimers.map(function(d){return d.query})).filter(function(d){return d!=null}),s=nu(this.activeTimers.map(function(d){return d.name})).filter(function(d){return d!=null}),this.activeTimers=r,i&&(this.programTimersStack=null),u={uploadWaitMs:this.uploadWaitMs,downloadWaitMs:this.downloadWaitMs,kernelMs:null,wallMs:null},H().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0?[4,Promise.all(a)]:[3,2];case 1:return l=c.sent(),u.kernelMs=X4(l),u.getExtraProfileInfo=function(){return l.map(function(d,f){return{name:s[f],ms:d}}).map(function(d){return d.name+": "+d.ms}).join(", ")},[3,3];case 2:u.kernelMs={error:"WebGL query timers are not supported in this environment."},c.label=3;case 3:return this.uploadWaitMs=0,this.downloadWaitMs=0,[2,u]}})})},e.prototype.memory=function(){return{unreliable:!1,numBytesInGPU:this.numBytesInGPU}},e.prototype.startTimer=function(){return H().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0?this.gpgpu.beginQuery():{startMs:Fr(),endMs:null}},e.prototype.endTimer=function(n){return H().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0?(this.gpgpu.endQuery(),n):(n.endMs=Fr(),n)},e.prototype.getQueryTime=function(n){return ie(this,void 0,void 0,function(){var r;return ae(this,function(o){return H().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0?[2,this.gpgpu.waitForQueryAndGetTime(n)]:[2,(r=n).endMs-r.startMs]})})},e.prototype.disposeData=function(n){if(!this.pendingDisposal.has(n)){if(this.pendingRead.has(n))return this.pendingDisposal.add(n),void this.pendingDeletes++;if(this.texData.has(n)){this.releaseGPUData(n);var r=this.texData.get(n).complexTensors;r!=null&&(r.real.dispose(),r.imag.dispose()),this.texData.delete(n)}}},e.prototype.releaseGPUData=function(n){var r=this.texData.get(n),o=r.texture,i=r.dtype,a=r.texShape,s=r.usage,u=r.isPacked,l=r.slice,c=l&&l.origDataId||n,d=this.dataRefCount.get(c);d>1?this.dataRefCount.set(c,d-1):(this.dataRefCount.delete(c),o!=null&&(this.numBytesInGPU-=this.computeBytes(a,i),this.textureManager.releaseTexture(o,a,s,u)));var f=this.texData.get(n);f.texture=null,f.texShape=null,f.isPacked=!1,f.slice=null},e.prototype.getTexture=function(n){return this.uploadToGPU(n),this.texData.get(n).texture},e.prototype.getDataInfo=function(n){return this.texData.get(n)},e.prototype.getCPUBackend=function(){return H().getBool("WEBGL_CPU_FORWARD")?(this.cpuBackend==null&&(this.cpuBackend=L.findBackend("cpu")),this.cpuBackend):null},e.prototype.shouldExecuteOnCPU=function(n,r){var o=this;return r===void 0&&(r=128),this.getCPUBackend()!=null&&n.every(function(i){return o.texData.get(i.dataId).texture==null&&i.size<r})},e.prototype.getGPGPUContext=function(){return this.gpgpu},e.prototype.complex=function(n,r){var o=this.makeOutput(n.shape,"complex64");return this.texData.get(o.dataId).complexTensors={real:L.keep(n.clone()),imag:L.keep(r.clone())},o},e.prototype.real=function(n){return this.texData.get(n.dataId).complexTensors.real.clone()},e.prototype.imag=function(n){return this.texData.get(n.dataId).complexTensors.imag.clone()},e.prototype.slice=function(n,r,o){if(this.shouldExecuteOnCPU([n]))return this.cpuBackend.slice(n,r,o);if(se(o)===0)return Lt([],o,n.dtype);var i=this.texData.get(n.dataId).isPacked,a=uS(n.shape,r,o);if(i||!a){var s=H().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new uj(o):new sj(o),u=s.getCustomSetupFunc(r);return this.compileAndRun(s,[n],null,u)}return this.uploadToGPU(n.dataId),this.shallowSlice(n,r,o)},e.prototype.shallowSlice=function(n,r,o){var i=this.texData.get(n.dataId),a=this.makeOutput(o,n.dtype),s=this.texData.get(a.dataId);Object.assign(s,i),s.shape=o,s.dtype=n.dtype;var u=lS(r,n.strides);i.slice&&(u+=i.slice.flatOffset),s.slice={flatOffset:u,origDataId:i.slice&&i.slice.origDataId||n.dataId};var l=this.dataRefCount.get(s.slice.origDataId)||1;return this.dataRefCount.set(s.slice.origDataId,l+1),a},e.prototype.stridedSlice=function(n,r,o,i){if(this.shouldExecuteOnCPU([n]))return this.cpuBackend.stridedSlice(n,r,o,i);var a=my(r,o,i);if(a.some(function(u){return u===0}))return Lt([],a);var s=new lj(r,i,a);return this.compileAndRun(s,[n])},e.prototype.reverse=function(n,r){var o=H().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new oj(n.shape,r):new rj(n.shape,r);return this.compileAndRun(o,[n])},e.prototype.concat=function(n,r){if(n[0].dtype==="complex64"){var o=n.map(function(h){return Hn(h)}),i=n.map(function(h){return $r(h)});return Ft(this.concat(o,r),this.concat(i,r))}if(this.shouldExecuteOnCPU(n))return this.cpuBackend.concat(n,r);if(n.length===1)return n[0];if(n.length>H().getNumber("WEBGL_MAX_TEXTURES_IN_SHADER")){var a=Math.floor(n.length/2),s=this.concat(n.slice(0,a),r),u=this.concat(n.slice(a),r);return this.concat([s,u],r)}if(H().getBool("WEBGL_PACK_ARRAY_OPERATIONS")&&n[0].rank>1){var l=new ZB(n.map(function(h){return h.shape}),r);return this.compileAndRun(l,n)}var c=ou(n.map(function(h){return h.shape}),r),d=n.map(function(h){return h.as2D(-1,se(h.shape.slice(r)))}),f=new JB(d.map(function(h){return h.shape}));return this.compileAndRun(f,d).reshape(c)},e.prototype.neg=function(n){if(this.shouldExecuteOnCPU([n]))return this.cpuBackend.neg(n);if(H().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(n,cx,n.dtype);var r=new Ee(n.shape,cx);return this.compileAndRun(r,[n])},e.prototype.batchMatMul=function(n,r,o,i){var a=o?n.shape[2]:n.shape[1],s=i?r.shape[1]:r.shape[2],u=o?n.shape[1]:n.shape[2],l=n.shape[0];if((a===1||s===1)&&u>1e3){o&&(n=n.transpose([0,2,1])),i&&(r=r.transpose([0,2,1]));var c=s===1?n:n.as3D(l,u,1),d=s===1?2:1,f=s===1?r.as3D(l,1,u):r;return this.multiply(c,f).sum(d,!0)}var h=Mt(n.dtype,r.dtype),v=new Sp(n.shape,[l,a,s],o,i);return this.compileAndRun(v,[n,r],h)},e.prototype.fusedBatchMatMul=function(n){var r=n.a,o=n.b,i=n.transposeA,a=n.transposeB,s=n.bias,u=n.activation,l=n.preluActivationWeights,c=i?r.shape[2]:r.shape[1],d=a?o.shape[1]:o.shape[2],f=r.shape[0],h=Mt(r.dtype,o.dtype),v=s!=null,p=l!=null,m=u?Gc(u,!0):null,g=new Sp(r.shape,[f,c,d],i,a,v,m,p),y=[r,o];return s&&y.push(s),l&&y.push(l),this.compileAndRun(g,y,h)},e.prototype.multiply=function(n,r){if(n.dtype==="complex64"){var o=this.texData.get(n.dataId),i=this.texData.get(r.dataId),a=new Jw(qB,n.shape,r.shape),s=new Jw(KB,n.shape,r.shape),u=[this.makeComplexComponentTensorInfo(n,o.complexTensors.real),this.makeComplexComponentTensorInfo(n,o.complexTensors.imag),this.makeComplexComponentTensorInfo(r,i.complexTensors.real),this.makeComplexComponentTensorInfo(r,i.complexTensors.imag)],l=this.compileAndRun(a,u),c=this.compileAndRun(s,u),d=this.complex(l,c);return l.dispose(),c.dispose(),d}if(this.shouldExecuteOnCPU([n,r]))return this.cpuBackend.multiply(n,r);if(H().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(n,r,Zw,n.dtype);var f=new st(Zw,n.shape,r.shape);return this.compileAndRun(f,[n,r],n.dtype)},e.prototype.batchNormalization=function(n,r,o,i,a,s){var u=[n,r,o],l=null;s!=null&&(l=s.shape,u.push(s));var c=null;if(a!=null&&(c=a.shape,u.push(a)),H().getBool("WEBGL_PACK_NORMALIZATION")){var d=new GB(n.shape,r.shape,o.shape,l,c,i);return this.compileAndRun(d,u)}var f=new HB(n.shape,r.shape,o.shape,l,c,i);return this.compileAndRun(f,u)},e.prototype.localResponseNormalization4D=function(n,r,o,i,a){var s=H().getBool("WEBGL_PACK_NORMALIZATION")?new U$(n.shape,r,o,i,a):new j$(n.shape,r,o,i,a);return this.compileAndRun(s,[n])},e.prototype.LRNGrad=function(n,r,o,i,a,s,u){var l=new W$(r.shape,i,a,s,u);return this.compileAndRun(l,[r,o,n])},e.prototype.tile=function(n,r){if(n.dtype==="string"){var o=this.readSync(n.dataId).map(function(a){return Zd(a)});return gS(ge(n.shape,n.dtype,o),r)}var i=new dj(n.shape,r);return this.compileAndRun(i,[n])},e.prototype.pad=function(n,r,o){var i=H().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new X$(n.shape,r,o):new K$(n.shape,r,o);return this.compileAndRun(i,[n])},e.prototype.transpose=function(n,r){if(this.shouldExecuteOnCPU([n]))return this.cpuBackend.transpose(n,r);var o=H().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new hj(n.shape,r):new fj(n.shape,r);return this.compileAndRun(o,[n])},e.prototype.gather=function(n,r,o){if(this.shouldExecuteOnCPU([n,r]))return this.cpuBackend.gather(n,r,o);var i=new x$(n.shape,r.size,o);return this.compileAndRun(i,[n,r])},e.prototype.batchToSpaceND=function(n,r,o){I(n.rank<=4,function(){return"batchToSpaceND for rank > 4 with a WebGL backend not implemented yet"});var i=r.reduce(function(d,f){return d*f}),a=af(n.shape,r,i),s=sf(a.length,r.length),u=uf(n.shape,r,i),l=oS(o,r.length),c=iS(u,o,r.length);return n.reshape(a).transpose(s).reshape(u).slice(l,c)},e.prototype.spaceToBatchND=function(n,r,o){I(n.rank<=4,function(){return"spaceToBatchND for rank > 4 with a WebGL backend not implemented yet"});var i=r.reduce(function(f,h){return f*h}),a=[[0,0]];a.push.apply(a,o);for(var s=1+r.length;s<n.shape.length;++s)a.push([0,0]);var u=n.pad(a),l=af(u.shape,r,i,!1),c=sf(l.length,r.length,!1),d=uf(u.shape,r,i,!1);return u.reshape(l).transpose(c).reshape(d)},e.prototype.reduce=function(n,r,o){var i=n.shape[0],a=n.shape[1],s=_p(a),u=new Y$({windowSize:s,inSize:a,batchSize:i},r),l=this.compileAndRun(u,[n],o);return l.shape[1]===1?l:this.reduce(l,r,o)},e.prototype.argReduce=function(n,r,o){o===void 0&&(o=null);var i=n.shape[0],a=n.shape[1];o!=null&&(i=o.shape[0],a=o.shape[1]);var s=_p(a),u=new MB({windowSize:s,inSize:a,batchSize:i},r,o==null),l=[n];o!=null&&l.push(o);var c=this.compileAndRun(u,l,"int32");return c.shape[1]===1?c:this.argReduce(n,r,c)},e.prototype.argReducePacked=function(n,r,o){o===void 0&&(o=null);var i=o!=null?o.shape:n.shape,a=_p(i[i.length-1]),s=new UB(i,a,r,o==null),u=o==null?[n]:[n,o],l=this.compileAndRun(s,u,"int32");return l.rank===n.rank?this.argReducePacked(n,r,l):l},e.prototype.sum=function(n,r){kn("sum",r,n.rank);var o=Ht(n.shape,r),i=o[0],a=se(o[1]),s=n.as2D(-1,a),u=pp(n.dtype);return this.reduce(s,"sum",u).reshape(i)},e.prototype.prod=function(n,r){if(this.shouldExecuteOnCPU([n]))return this.cpuBackend.prod(n,r);var o=Ht(n.shape,r),i=o[0],a=se(o[1]),s=n.as2D(-1,a),u=pp(n.dtype);return this.reduce(s,"prod",u).reshape(i)},e.prototype.unsortedSegmentSum=function(n,r,o){var i=0,a=Jr([i],n.rank),s=n;a!=null&&(s=n.transpose(a),i=Zr(1,n.rank)[0]);var u=function(h,v,p){for(var m=[],g=h.length,y=0;y<g;y++)y!==v?m.push(h[y]):m.push(p);return m}(s.shape,i,o),l=se([s.shape[i]]),c=s.as2D(-1,l),d=pp(n.dtype),f=this.segOpCompute(c,"unsortedSegmentSum",r,d,o).reshape(u);return a!=null&&(f=f.transpose(fy(a))),f},e.prototype.segOpCompute=function(n,r,o,i,a){var s=n.shape[0],u=n.shape[1],l=function(f,h){var v,p=!1;for(f<=sS?(v=f,p=!0):v=bm(f,Math.floor(Math.sqrt(f)));!p;)v>h||v===f?p=!0:v=bm(f,v+1);return v}(u,a),c=new ij({windowSize:l,inSize:u,batchSize:s,numSegments:a}),d=this.compileAndRun(c,[n,o],i);return d.shape[1]===a?d:(o=of(0,a).tile([u/l]),this.segOpCompute(d,r,o,i,a))},e.prototype.argMinMaxReduce=function(n,r,o){var i=[r];if(kn("arg"+o.charAt(0).toUpperCase()+o.slice(1),i,n.rank),!H().getBool("WEBGL_PACK_REDUCE")||n.rank<=2){var a=Ht(n.shape,i),s=a[0],u=se(a[1]),l=n.as2D(-1,u);return this.argReduce(l,o).reshape(s)}return this.argReducePacked(n,o)},e.prototype.argMin=function(n,r){return this.argMinMaxReduce(n,r,"min")},e.prototype.argMax=function(n,r){return this.argMinMaxReduce(n,r,"max")},e.prototype.cumsum=function(n,r,o,i){if(r!==n.rank-1)throw new Error("WebGL cumsum shader expects an inner-most axis="+(n.rank-1)+" but got axis="+r);var a=new u$(n.shape,o,i);return this.compileAndRun(a,[n])},e.prototype.equal=function(n,r){if(H().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(n,r,`
  return vec4(equal(a, b));
`,"bool");var o=new st("return float(a == b);",n.shape,r.shape);return this.compileAndRun(o,[n,r],"bool")},e.prototype.notEqual=function(n,r){if(H().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(n,r,`
  return vec4(notEqual(a, b));
`,"bool");var o=new st("return float(a != b);",n.shape,r.shape);return this.compileAndRun(o,[n,r],"bool")},e.prototype.less=function(n,r){if(this.shouldExecuteOnCPU([n,r]))return this.cpuBackend.less(n,r);if(H().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(n,r,`
  return vec4(lessThan(a, b));
`,"bool");var o=new st("return float(a < b);",n.shape,r.shape);return this.compileAndRun(o,[n,r],"bool")},e.prototype.lessEqual=function(n,r){if(H().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(n,r,`
  return vec4(lessThanEqual(a, b));
`,"bool");var o=new st("return float(a <= b);",n.shape,r.shape);return this.compileAndRun(o,[n,r],"bool")},e.prototype.greater=function(n,r){if(this.shouldExecuteOnCPU([n,r]))return this.cpuBackend.greater(n,r);if(H().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(n,r,`
  return vec4(greaterThan(a, b));
`,"bool");var o=new st("return float(a > b);",n.shape,r.shape);return this.compileAndRun(o,[n,r],"bool")},e.prototype.greaterEqual=function(n,r){if(H().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(n,r,`
  return vec4(greaterThanEqual(a, b));
`,"bool");var o=new st("return float(a >= b);",n.shape,r.shape);return this.compileAndRun(o,[n,r],"bool")},e.prototype.logicalNot=function(n){var r=new Ee(n.shape,"return float(!(x >= 1.0));");return this.compileAndRun(r,[n])},e.prototype.logicalAnd=function(n,r){if(H().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(n,r,`
  return vec4(
    vec4(greaterThanEqual(a, vec4(1.0))) *
    vec4(greaterThanEqual(b, vec4(1.0))));
`,"bool");var o=new st("return float(a >= 1.0 && b >= 1.0);",n.shape,r.shape);return this.compileAndRun(o,[n,r],"bool")},e.prototype.logicalOr=function(n,r){if(H().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(n,r,`
  return min(
    vec4(greaterThanEqual(a, vec4(1.0))) +
    vec4(greaterThanEqual(b, vec4(1.0))),
    vec4(1.0));
`,"bool");var o=new st("return float(a >= 1.0 || b >= 1.0);",n.shape,r.shape);return this.compileAndRun(o,[n,r],"bool")},e.prototype.select=function(n,r,o){var i=new aj(n.rank,r.shape,r.rank);return this.compileAndRun(i,[n,r,o],Mt(r.dtype,o.dtype))},e.prototype.where=function(n){nf("tf.where() in webgl locks the UI thread. Call tf.whereAsync() instead");var r=n.dataSync();return xy(n.shape,r)},e.prototype.topk=function(n,r,o){return yS(n.dataSync(),n.shape,n.dtype,r)},e.prototype.min=function(n,r){kn("min",r,n.rank);var o=Ht(n.shape,r),i=o[0],a=se(o[1]),s=n.as2D(-1,a);return this.reduce(s,"min",s.dtype).reshape(i)},e.prototype.minimum=function(n,r){if(this.shouldExecuteOnCPU([n,r]))return this.cpuBackend.minimum(n,r);var o=H().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new ao(`
  vec4 result = vec4(min(a, b));
  vec4 isNaN = min(vec4(isnan(a)) + vec4(isnan(b)), vec4(1.0));
  
  result.r = isNaN.r > 0. ? NAN : result.r;
  result.g = isNaN.g > 0. ? NAN : result.g;
  result.b = isNaN.b > 0. ? NAN : result.b;
  result.a = isNaN.a > 0. ? NAN : result.a;

  return result;
`,n.shape,r.shape):new st(`
  if (isnan(a)) return a;
  if (isnan(b)) return b;

  return min(a, b);
`,n.shape,r.shape);return this.compileAndRun(o,[n,r])},e.prototype.mod=function(n,r){var o=H().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new ao(`
  vec4 result = mod(a, b);
  vec4 isNaN = vec4(equal(b, vec4(0.0)));
  
  result.r = isNaN.r > 0. ? NAN : result.r;
  result.g = isNaN.g > 0. ? NAN : result.g;
  result.b = isNaN.b > 0. ? NAN : result.b;
  result.a = isNaN.a > 0. ? NAN : result.a;

  return result;
`,n.shape,r.shape):new st(`if (b == 0.0) return NAN;
  return mod(a, b);`,n.shape,r.shape);return this.compileAndRun(o,[n,r])},e.prototype.max=function(n,r){if(this.shouldExecuteOnCPU([n]))return this.cpuBackend.max(n,r);kn("max",r,n.rank);var o=Ht(n.shape,r),i=o[0],a=se(o[1]),s=n.as2D(-1,a);return this.reduce(s,"max",s.dtype).reshape(i)},e.prototype.maximum=function(n,r){if(this.shouldExecuteOnCPU([n,r]))return this.cpuBackend.maximum(n,r);var o=H().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new ao(`
  vec4 result = vec4(max(a, b));
  vec4 isNaN = min(vec4(isnan(a)) + vec4(isnan(b)), vec4(1.0));
  
  result.r = isNaN.r > 0. ? NAN : result.r;
  result.g = isNaN.g > 0. ? NAN : result.g;
  result.b = isNaN.b > 0. ? NAN : result.b;
  result.a = isNaN.a > 0. ? NAN : result.a;

  return result;
`,n.shape,r.shape):new st(`
  if (isnan(a)) return a;
  if (isnan(b)) return b;

  return max(a, b);
`,n.shape,r.shape);return this.compileAndRun(o,[n,r])},e.prototype.all=function(n,r){kn("all",r,n.rank);var o=Ht(n.shape,r),i=o[0],a=se(o[1]),s=n.as2D(-1,a);return this.reduce(s,"all",s.dtype).reshape(i)},e.prototype.any=function(n,r){kn("any",r,n.rank);var o=Ht(n.shape,r),i=o[0],a=se(o[1]),s=n.as2D(-1,a);return this.reduce(s,"any",s.dtype).reshape(i)},e.prototype.realDivide=function(n,r){if(H().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(n,r,`
  // vec4 one = vec4(equal(a, b));
  // return one + (vec4(1.0) - one) * a / b;
  vec4 result = a / b;
  if(a.x == b.x) {
    result.x = 1.;
  }
  if(a.y == b.y) {
    result.y = 1.;
  }
  if(a.z == b.z) {
    result.z = 1.;
  }
  if(a.w == b.w) {
    result.w = 1.;
  }

  return result;
`,"float32",!0);var o=new st(`
if (a == b) {
  return 1.0;
};
return a / b;`,n.shape,r.shape);return this.compileAndRun(o,[n,r],"float32")},e.prototype.floorDiv=function(n,r){if(H().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(n,r,`
  ivec4 ia = round(a);
  ivec4 ib = round(b);
  bvec4 cond = notEqual(ib, ivec4(0));
  ivec4 result = ivec4(0);
  vec4 s = sign(a) * sign(b);

  // Windows (D3D) wants guaranteed non-zero int division at compile-time.
  if (cond[0]) {
    result[0] = idiv(ia[0], ib[0], s[0]);
  }
  if (cond[1]) {
    result[1] = idiv(ia[1], ib[1], s[1]);
  }
  if (cond[2]) {
    result[2] = idiv(ia[2], ib[2], s[2]);
  }
  if (cond[3]) {
    result[3] = idiv(ia[3], ib[3], s[3]);
  }
  return vec4(result);
`,"int32");var o=new st(`
  float s = sign(a) * sign(b);
  int ia = round(a);
  int ib = round(b);
  if (ib != 0) {
    // Windows (D3D) wants guaranteed non-zero int division at compile-time.
    return float(idiv(ia, ib, s));
  } else {
    return NAN;
  }
`,n.shape,r.shape);return this.compileAndRun(o,[n,r],"int32")},e.prototype.add=function(n,r){if(n.dtype==="complex64"&&r.dtype==="complex64")return this.complexSeparableBinaryOp(n,r,Ep);if(this.shouldExecuteOnCPU([n,r]))return this.cpuBackend.add(n,r);var o=Mt(n.dtype,r.dtype);if(H().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(n,r,Ep,o);var i=new st(Ep,n.shape,r.shape);return this.compileAndRun(i,[n,r],o)},e.prototype.packedUnaryOp=function(n,r,o){var i=new Nu(n.shape,r);return this.compileAndRun(i,[n],o)},e.prototype.packedBinaryOp=function(n,r,o,i,a){a===void 0&&(a=!1);var s=new ao(o,n.shape,r.shape,a);return this.compileAndRun(s,[n,r],i)},e.prototype.complexSeparableBinaryOp=function(n,r,o){var i=this,a=this.texData.get(n.dataId),s=this.texData.get(r.dataId),u=[[a.complexTensors.real,s.complexTensors.real],[a.complexTensors.imag,s.complexTensors.imag]].map(function(f){var h=f[0],v=f[1],p=i.makeComplexComponentTensorInfo(n,h),m=i.makeComplexComponentTensorInfo(r,v),g=new st(o,n.shape,r.shape);return i.compileAndRun(g,[p,m],Mt(h.dtype,v.dtype))}),l=u[0],c=u[1],d=this.complex(l,c);return l.dispose(),c.dispose(),d},e.prototype.makeComplexComponentTensorInfo=function(n,r){return{dataId:r.dataId,dtype:r.dtype,shape:n.shape}},e.prototype.addN=function(n){if(n.length===1)return n[0];if(n.length>H().get("WEBGL_MAX_TEXTURES_IN_SHADER")){var r=Math.floor(n.length/2),o=this.addN(n.slice(0,r)),i=this.addN(n.slice(r));return this.addN([o,i])}var a=n.map(function(l){return l.dtype}).reduce(function(l,c){return Mt(l,c)}),s=n.map(function(l){return l.shape}),u=H().getBool("WEBGL_PACK")?new FB(n[0].shape,s):new OB(n[0].shape,s);return this.compileAndRun(u,n,a)},e.prototype.subtract=function(n,r){if(n.dtype==="complex64"&&r.dtype==="complex64")return this.complexSeparableBinaryOp(n,r,Cp);if(this.shouldExecuteOnCPU([n,r]))return this.cpuBackend.subtract(n,r);var o=Mt(n.dtype,r.dtype);if(H().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(n,r,Cp,n.dtype);var i=new st(Cp,n.shape,r.shape);return this.compileAndRun(i,[n,r],o)},e.prototype.pow=function(n,r){var o=H().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new ao(`
  // isModRound1 has 1 for components with round(mod(b, 2.0)) == 1, 0 otherwise.
  vec4 isModRound1 = vec4(equal(round(mod(b, 2.0)), ivec4(1)));
  vec4 multiplier = sign(a) * isModRound1 + (vec4(1.0) - isModRound1);
  vec4 result = multiplier * pow(abs(a), b);

  // Ensure that a^0 = 1, including 0^0 = 1 as this correspond to TF and JS
  bvec4 isExpZero = equal(b, vec4(0.0));
  result.r = isExpZero.r ? 1.0 : result.r;
  result.g = isExpZero.g ? 1.0 : result.g;
  result.b = isExpZero.b ? 1.0 : result.b;
  result.a = isExpZero.a ? 1.0 : result.a;

  vec4 isNaN = vec4(lessThan(a, vec4(0.0))) * vec4(lessThan(floor(b), b));
  
  result.r = isNaN.r > 0. ? NAN : result.r;
  result.g = isNaN.g > 0. ? NAN : result.g;
  result.b = isNaN.b > 0. ? NAN : result.b;
  result.a = isNaN.a > 0. ? NAN : result.a;

  return result;
`,n.shape,r.shape):new st(`
if(a < 0.0 && floor(b) < b){
  return NAN;
}
if (b == 0.0) {
  return 1.0;
}
return (round(mod(b, 2.0)) != 1) ?
    pow(abs(a), b) : sign(a) * pow(abs(a), b);
`,n.shape,r.shape),i=Mt(n.dtype,r.dtype);return this.compileAndRun(o,[n,r],i)},e.prototype.ceil=function(n){if(this.shouldExecuteOnCPU([n]))return this.cpuBackend.ceil(n);if(H().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(n,dx,n.dtype);var r=new Ee(n.shape,dx);return this.compileAndRun(r,[n])},e.prototype.floor=function(n){if(this.shouldExecuteOnCPU([n]))return this.cpuBackend.floor(n);if(H().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(n,fx,n.dtype);var r=new Ee(n.shape,fx);return this.compileAndRun(r,[n])},e.prototype.sign=function(n){var r=new Ee(n.shape,`
  if (isnan(x)) { return 0.0; }
  return sign(x);
`);return this.compileAndRun(r,[n])},e.prototype.isNaN=function(n){var r=new Ee(n.shape,"return float(isnan(x));");return this.compileAndRun(r,[n],"bool")},e.prototype.isInf=function(n){var r=new Ee(n.shape,"return float(isinf(x));");return this.compileAndRun(r,[n],"bool")},e.prototype.isFinite=function(n){var r=new Ee(n.shape,"return float(!isnan(x) && !isinf(x));");return this.compileAndRun(r,[n],"bool")},e.prototype.round=function(n){var r=new Ee(n.shape,`
  // OpenGL ES does not support round function.
  // The algorithm is based on banker's rounding.
  float base = floor(x);
  if ((x - base) < 0.5) {
    return floor(x);
  } else if ((x - base) > 0.5) {
    return ceil(x);
  } else {
    if (mod(base, 2.0) == 0.0) {
      return base;
    } else {
      return base + 1.0;
    }
  }
`);return this.compileAndRun(r,[n])},e.prototype.exp=function(n){if(this.shouldExecuteOnCPU([n]))return this.cpuBackend.exp(n);if(H().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(n,hx,n.dtype);var r=new Ee(n.shape,hx);return this.compileAndRun(r,[n])},e.prototype.expm1=function(n){if(this.shouldExecuteOnCPU([n]))return this.cpuBackend.expm1(n);if(H().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(n,px,n.dtype);var r=new Ee(n.shape,px);return this.compileAndRun(r,[n])},e.prototype.softmax=function(n,r){var o=kt([r],n.shape),i=this.max(n,o),a=_n(i.shape,o),s=this.subtract(n,i.reshape(a)),u=this.exp(s),l=this.sum(u,o).reshape(a);return this.realDivide(u,l)},e.prototype.log=function(n){if(this.shouldExecuteOnCPU([n]))return this.cpuBackend.log(n);if(H().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(n,`
  vec4 result = log(x);
  vec4 isNaN = vec4(lessThan(x, vec4(0.0)));
  result.r = isNaN.r == 1.0 ? NAN : result.r;
  result.g = isNaN.g == 1.0 ? NAN : result.g;
  result.b = isNaN.b == 1.0 ? NAN : result.b;
  result.a = isNaN.a == 1.0 ? NAN : result.a;

  return result;
`,n.dtype);var r=new Ee(n.shape,`if (x < 0.0) return NAN;
  return log(x);`);return this.compileAndRun(r,[n])},e.prototype.log1p=function(n){var r=new Ee(n.shape,"return log(1.0 + x);");return this.compileAndRun(r,[n])},e.prototype.sqrt=function(n){var r=new Ee(n.shape,"return sqrt(x);");return this.compileAndRun(r,[n])},e.prototype.rsqrt=function(n){if(this.shouldExecuteOnCPU([n]))return this.cpuBackend.rsqrt(n);var r=new Ee(n.shape,"return inversesqrt(x);");return this.compileAndRun(r,[n])},e.prototype.reciprocal=function(n){var r=new Ee(n.shape,"return 1.0 / x;");return this.compileAndRun(r,[n])},e.prototype.relu=function(n){var r;return r=H().getBool("WEBGL_PACK")?new Nu(n.shape,RS):new Ee(n.shape,CS),this.compileAndRun(r,[n])},e.prototype.relu6=function(n){var r;return r=H().getBool("WEBGL_PACK")?new Nu(n.shape,TS):new Ee(n.shape,SS),this.compileAndRun(r,[n])},e.prototype.prelu=function(n,r){var o=H().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new ao(ES,n.shape,r.shape):new st(_S,n.shape,r.shape);return this.compileAndRun(o,[n,r])},e.prototype.elu=function(n){if(H().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(n,IS,n.dtype);var r=new Ee(n.shape,kS);return this.compileAndRun(r,[n])},e.prototype.eluDer=function(n,r){var o=H().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new ao(`
  vec4 bGTEZero = vec4(greaterThanEqual(b, vec4(0.)));
  return (bGTEZero * a) + ((vec4(1.0) - bGTEZero) * (a * (b + vec4(1.0))));
`,n.shape,r.shape):new st("return (b >= 1.0) ? a : a * (b + 1.0);",n.shape,r.shape);return this.compileAndRun(o,[n,r])},e.prototype.selu=function(n){var r=new Ee(n.shape,vj);return this.compileAndRun(r,[n])},e.prototype.int=function(n){var r=new Ee(n.shape,"return float(int(x));");return this.compileAndRun(r,[n],"int32")},e.prototype.clip=function(n,r,o){var i,a=(i=H().getBool("WEBGL_PACK_CLIP")?new YB(n.shape):new XB(n.shape)).getCustomSetupFunc(r,o);return this.compileAndRun(i,[n],null,a)},e.prototype.abs=function(n){if(this.shouldExecuteOnCPU([n]))return this.cpuBackend.abs(n);if(H().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(n,lx,n.dtype);var r=new Ee(n.shape,lx);return this.compileAndRun(r,[n])},e.prototype.complexAbs=function(n){var r=this.texData.get(n.dataId),o=new QB(n.shape),i=[this.makeComplexComponentTensorInfo(n,r.complexTensors.real),this.makeComplexComponentTensorInfo(n,r.complexTensors.imag)];return this.compileAndRun(o,i)},e.prototype.sigmoid=function(n){var r=new Ee(n.shape,"return 1.0 / (1.0 + exp(-1.0 * x));");return this.compileAndRun(r,[n])},e.prototype.softplus=function(n){var r=new Ee(n.shape,`
  float epsilon = 1.1920928955078125e-7;
  float threshold = log(epsilon) + 2.0;

  bool too_large = x > -threshold;
  bool too_small = x < threshold;

  float result;
  float exp_x = exp(x);

  if (too_large){
    result = x;
  }
  else if (too_small){
    result = exp_x;
  }
  else{
    result = log(exp_x + 1.0);
  }
  return result;
`);return this.compileAndRun(r,[n])},e.prototype.sin=function(n){var r=new Ee(n.shape,mj);return this.compileAndRun(r,[n])},e.prototype.cos=function(n){var r=new Ee(n.shape,gj);return this.compileAndRun(r,[n])},e.prototype.tan=function(n){var r=new Ee(n.shape,"return tan(x);");return this.compileAndRun(r,[n])},e.prototype.asin=function(n){var r=new Ee(n.shape,yj);return this.compileAndRun(r,[n])},e.prototype.acos=function(n){var r=new Ee(n.shape,wj);return this.compileAndRun(r,[n])},e.prototype.atan=function(n){var r=new Ee(n.shape,xj);return this.compileAndRun(r,[n])},e.prototype.atan2=function(n,r){var o=H().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new ao(`
  vec4 result = atan(a, b);
  vec4 isNaN = min(vec4(isnan(a)) + vec4(isnan(b)), vec4(1.0));
  
  result.r = isNaN.r > 0. ? NAN : result.r;
  result.g = isNaN.g > 0. ? NAN : result.g;
  result.b = isNaN.b > 0. ? NAN : result.b;
  result.a = isNaN.a > 0. ? NAN : result.a;

  return result;
`,n.shape,r.shape):new st(`
  if (isnan(a)) return a;
  if (isnan(b)) return b;

  return atan(a, b);
`,n.shape,r.shape);return this.compileAndRun(o,[n,r])},e.prototype.sinh=function(n){var r=new Ee(n.shape,`
  float e2x = exp(x);
  return (e2x - 1.0 / e2x) / 2.0;
`);return this.compileAndRun(r,[n])},e.prototype.cosh=function(n){var r=new Ee(n.shape,`
  float e2x = exp(-x);
  return (e2x + 1.0 / e2x) / 2.0;
`);return this.compileAndRun(r,[n])},e.prototype.tanh=function(n){var r=new Ee(n.shape,`
  float e2x = exp(-2.0 * abs(x));
  return sign(x) * (1.0 - e2x) / (1.0 + e2x);
`);return this.compileAndRun(r,[n])},e.prototype.asinh=function(n){var r=new Ee(n.shape,bj);return this.compileAndRun(r,[n])},e.prototype.acosh=function(n){var r=new Ee(n.shape,_j);return this.compileAndRun(r,[n])},e.prototype.atanh=function(n){var r=new Ee(n.shape,Ej);return this.compileAndRun(r,[n])},e.prototype.erf=function(n){var r=new Ee(n.shape,`
  // Error function is calculated approximately with elementary function.
  // See "Handbook of Mathematical Functions with Formulas,
  // Graphs, and Mathematical Tables", Abramowitz and Stegun.
  float p = 0.3275911;
  float a1 = 0.254829592;
  float a2 = -0.284496736;
  float a3 = 1.421413741;
  float a4 = -1.453152027;
  float a5 = 1.061405429;

  float sign = sign(x);
  x = abs(x);
  float t = 1.0 / (1.0 + p * x);
  return sign * (1.0 - (((((a5*t + a4)*t) + a3)*t + a2)*t + a1)*t*exp(-x*x));
`);return this.compileAndRun(r,[n])},e.prototype.step=function(n,r){var o=new Ee(n.shape,function(i){return i===void 0&&(i=0),Sr+`
    return x > 0.0 ? 1.0 : float(`+i+`);
  `}(r));return this.compileAndRun(o,[n])},e.prototype.conv2dByMatMul=function(n,r,o,i,a,s){var u=n.shape,l=this.texData.get(n.dataId),c=o.inChannels,d=u[0]*u[1]*u[2],f=o.outChannels,h=o.dataFormat==="channelsLast",v=(d===1||f===1)&&c>1e3,p=u[2]%2!=0&&!!l.isPacked;if(v||!H().getBool("WEBGL_LAZILY_UNPACK")||!H().getBool("WEBGL_PACK_BINARY_OPERATIONS")||!p){var m=h?u[0]*u[1]*u[2]:u[0]*u[2]*u[3],g=this.reshape(n,[1,m,o.inChannels]),y=this.reshape(r,[1,o.inChannels,o.outChannels]);return this.reshape(this.fusedBatchMatMul({a:g,b:y,transposeA:!1,transposeB:!1,bias:i,activation:a,preluActivationWeights:s}),o.outShape)}var w=h?u[0]*u[1]*(u[2]+1):u[0]*u[2]*(u[3]+1),x={dataId:n.dataId,shape:[1,w,o.inChannels],dtype:n.dtype},b=l.shape;l.shape=l.shape.slice(),l.shape[l.shape.length-2]++,I(Uc(l.shape,x.shape),function(){return"packed reshape "+l.shape+" to "+x.shape+" isn't free"});var _=this.reshape(r,[1,o.inChannels,o.outChannels]),E=this.fusedBatchMatMul({a:x,b:_,transposeA:!1,transposeB:!1,bias:i,activation:a,preluActivationWeights:s}),C=this.texData.get(E.dataId);return I(C.isPacked,function(){return"batchMatMul result is expected to be packed"}),l.shape=b,C.shape=o.outShape,L.makeTensorFromDataId(E.dataId,o.outShape,E.dtype)},e.prototype.conv2dWithIm2Row=function(n,r,o,i,a,s){var u=o.filterWidth,l=o.filterHeight,c=o.inChannels,d=o.outWidth,f=o.outHeight,h=o.dataFormat==="channelsLast",v=u*l*c,p=f*d,m=[v,p],g=n.squeeze([0]),y=r.reshape([1,v,-1]),w=new $$(m,g.shape,o),x=this.compileAndRun(w,[g]).reshape([1,m[0],m[1]]),b=i!=null,_=s!=null,E=a?Gc(a,!0):null,C=new Sp(x.shape,[1,p,o.outChannels],!0,!1,b,E,_),R=[x,y];i&&R.push(i),_&&R.push(s);var S=this.compileAndRun(C,R);return h?S.reshape([1,f,d,o.outChannels]):S.reshape([1,o.outChannels,f,d])},e.prototype.fusedConv2d=function(n){var r=n.input,o=n.filter,i=n.convInfo,a=n.bias,s=n.activation,u=n.preluActivationWeights;if(i.filterHeight===1&&i.filterWidth===1&&i.dilationHeight===1&&i.dilationWidth===1&&i.strideHeight===1&&i.strideWidth===1&&(i.padInfo.type==="SAME"||i.padInfo.type==="VALID"))return this.conv2dByMatMul(r,o,i,a,s,u);if(H().getBool("WEBGL_CONV_IM2COL")&&r.shape[0]===1)return this.conv2dWithIm2Row(r,o,i,a,s,u);var l=a!=null,c=u!=null,d=s?Gc(s,!1):null,f=new ex(i,l,d,c),h=[r,o];return a&&h.push(a),u&&h.push(u),this.compileAndRun(f,h)},e.prototype.conv2d=function(n,r,o){if(o.filterHeight===1&&o.filterWidth===1&&o.dilationHeight===1&&o.dilationWidth===1&&o.strideHeight===1&&o.strideWidth===1&&(o.padInfo.type==="SAME"||o.padInfo.type==="VALID"))return this.conv2dByMatMul(n,r,o);if(H().getBool("WEBGL_CONV_IM2COL")&&n.shape[0]===1)return this.conv2dWithIm2Row(n,r,o);var i=new ex(o);return this.compileAndRun(i,[n,r])},e.prototype.conv2dDerInput=function(n,r,o){var i=new t$(o);return this.compileAndRun(i,[n,r])},e.prototype.conv2dDerFilter=function(n,r,o){var i=new e$(o);return this.compileAndRun(i,[n,r])},e.prototype.fusedDepthwiseConv2D=function(n){var r,o=n.input,i=n.filter,a=n.convInfo,s=n.bias,u=n.activation,l=n.preluActivationWeights,c=H().getBool("WEBGL_PACK_DEPTHWISECONV")&&a.strideWidth<=2&&a.outChannels/a.inChannels==1,d=u?Gc(u,c):null,f=[o,i],h=s!=null,v=l!=null;return h&&f.push(s),v&&f.push(l),c?(r=new nx(a,h,d,v),this.compileAndRun(r,f)):(r=new tx(a,h,d,v),this.compileAndRun(r,f))},e.prototype.depthwiseConv2D=function(n,r,o){var i;return H().getBool("WEBGL_PACK_DEPTHWISECONV")&&o.strideWidth<=2&&o.outChannels/o.inChannels==1?(i=new nx(o),this.compileAndRun(i,[n,r])):(i=new tx(o),this.compileAndRun(i,[n,r]))},e.prototype.depthwiseConv2DDerInput=function(n,r,o){var i=new i$(o);return this.compileAndRun(i,[n,r])},e.prototype.depthwiseConv2DDerFilter=function(n,r,o){var i=new o$(o);return this.compileAndRun(i,[n,r])},e.prototype.conv3d=function(n,r,o){var i=new a$(o);return this.compileAndRun(i,[n,r])},e.prototype.conv3dDerInput=function(n,r,o){var i=new r$(o);return this.compileAndRun(i,[n,r])},e.prototype.conv3dDerFilter=function(n,r,o){var i=new n$(o);return this.compileAndRun(i,[n,r])},e.prototype.maxPool=function(n,r){var o=new kp(r,"max",!1);return this.compileAndRun(o,[n])},e.prototype.avgPool=function(n,r){var o=new kp(r,"avg",!1);return this.compileAndRun(o,[n],"float32")},e.prototype.maxPoolBackprop=function(n,r,o,i){var a=new kp(i,"max",!0),s=this.compileAndRun(a,[r]),u=new z$(i),l=this.compileAndRun(u,[n,s],r.dtype);return s.dispose(),l},e.prototype.avgPoolBackprop=function(n,r,o){var i=new zB(o);return this.compileAndRun(i,[n],r.dtype)},e.prototype.cast=function(n,r){return hS(n,r,this)},e.prototype.unstack=function(n,r){for(var o=n.shape[r],i=new Array(n.rank-1),a=0,s=0;s<n.rank;s++)s!==r&&(i[a++]=n.shape[s]);var u=new Array(n.rank).fill(0),l=n.shape.slice();l[r]=1;var c=new Array(o);for(s=0;s<c.length;s++)u[r]=s,c[s]=this.slice(n,u,l).reshape(i);return c},e.prototype.avgPool3d=function(n,r){var o=new Rp(r,"avg",!1);return this.compileAndRun(o,[n],"float32")},e.prototype.avgPool3dBackprop=function(n,r,o){var i=new VB(o);return this.compileAndRun(i,[n],r.dtype)},e.prototype.maxPool3d=function(n,r){var o=new Rp(r,"max",!1);return this.compileAndRun(o,[n],"float32")},e.prototype.maxPool3dBackprop=function(n,r,o,i){var a=new Rp(i,"max",!0),s=this.compileAndRun(a,[r]),u=new V$(i),l=this.compileAndRun(u,[n,s],r.dtype);return s.dispose(),l},e.prototype.reshape=function(n,r){var o=this.texData.get(n.dataId);if(o.isPacked&&!Uc(n.shape,r)&&(o.texture===null||!Uc(o.shape,r))){var i=this.packedReshape(n,r);return L.makeTensorFromDataId(i.dataId,i.shape,i.dtype)}return Im(n,r)},e.prototype.resizeBilinear=function(n,r,o,i){var a=H().getBool("WEBGL_PACK_IMAGE_OPERATIONS")?new ej(n.shape,r,o,i):new Z$(n.shape,r,o,i);return this.compileAndRun(a,[n],"float32")},e.prototype.resizeBilinearBackprop=function(n,r,o){var i=new J$(n,r,o);return this.compileAndRun(i,[n])},e.prototype.resizeNearestNeighbor=function(n,r,o,i){var a=new nj(n.shape,r,o,i);return this.compileAndRun(a,[n])},e.prototype.resizeNearestNeighborBackprop=function(n,r,o){var i=new tj(n,r,o);return this.compileAndRun(i,[n])},e.prototype.multinomial=function(n,r,o,i){var a=r?n:Ro(n),s=a.shape[0],u=a.shape[1],l=new H$(s,u,o),c=l.getCustomSetupFunc(i);return this.compileAndRun(l,[a],"int32",c)},e.prototype.oneHot=function(n,r,o,i){var a=new G$(n.size,r,o,i);return this.compileAndRun(a,[n])},e.prototype.diag=function(n){var r=new f$(n.size);return this.compileAndRun(r,[n])},e.prototype.nonMaxSuppression=function(n,r,o,i,a){return nf("tf.nonMaxSuppression() in webgl locks the UI thread. Call tf.nonMaxSuppressionAsync() instead"),yy(n.dataSync(),r.dataSync(),o,i,a)},e.prototype.cropAndResize=function(n,r,o,i,a,s){var u=new s$(n.shape,r.shape,i,a,s);return this.compileAndRun(u,[n,r,o],"float32")},e.prototype.depthToSpace=function(n,r,o){I(r>1,function(){return"blockSize should be > 1 for depthToSpace, but was: "+r});var i=n.shape[0],a=o==="NHWC"?n.shape[1]:n.shape[2],s=o==="NHWC"?n.shape[2]:n.shape[3],u=o==="NHWC"?n.shape[3]:n.shape[1],l=a*r,c=s*r,d=u/(r*r),f=new d$(o==="NHWC"?[i,l,c,d]:[i,d,l,c],r,o);return this.compileAndRun(f,[n])},e.prototype.split=function(n,r,o){return mS(n,r,o)},e.prototype.scatterND=function(n,r,o){var i=lf(0,n,o),a=i.sliceRank,s=i.numUpdates,u=i.sliceSize,l=i.strides,c=i.outputSize,d=[c/u,u],f=n.reshape([s,a]),h=r.reshape([s,u]);if(c===0)return Im(Lt([]),o);var v=ee(0),p=new ax(s,a,f.rank,h.rank,l,d);return this.compileAndRun(p,[h,f,v]).reshape(o)},e.prototype.sparseToDense=function(n,r,o,i){var a=lf(0,n,o),s=a.sliceRank,u=a.numUpdates,l=a.strides,c=a.outputSize,d=new ax(u,s,n.rank,r.rank,l,[c,1]);return this.compileAndRun(d,[r,n,i]).reshape(o)},e.prototype.fft=function(n){return this.fftImpl(n,!1)},e.prototype.ifft=function(n){return this.fftImpl(n,!0)},e.prototype.fftImpl=function(n,r){var o=this.texData.get(n.dataId),i=new ox(g$,n.shape,r),a=new ox(y$,n.shape,r),s=[this.makeComplexComponentTensorInfo(n,o.complexTensors.real),this.makeComplexComponentTensorInfo(n,o.complexTensors.imag)],u=this.compileAndRun(i,s),l=this.compileAndRun(a,s),c=this.complex(u,l).as2D(n.shape[0],n.shape[1]);return u.dispose(),l.dispose(),c},e.prototype.gatherND=function(n,r){var o=r.shape,i=o[o.length-1],a=aS(n,r),s=a[0],u=a[1],l=a[2],c=a[3],d=r.reshape([u,i]),f=n.reshape([n.size/l,l]),h=new b$(i,c,[u,l]);return this.compileAndRun(h,[f,d]).reshape(s)},e.prototype.fill=function(n,r,o){if((o=o||Xl(r))==="string"){var i=Jd(o,se(n));return i.fill(r),L.makeTensor(i,n,o,this)}var a=new w$(n,r),s=a.getCustomSetupFunc(r);return this.compileAndRun(a,[],o,s)},e.prototype.onesLike=function(n){if(n.dtype==="string")throw new Error("onesLike is not supported under string dtype");return this.fill(n.shape,1,n.dtype)},e.prototype.zerosLike=function(n){return this.fill(n.shape,n.dtype==="string"?"":0,n.dtype)},e.prototype.linspace=function(n,r,o){return pS(n,r,o)},e.prototype.makeTensorInfo=function(n,r){var o=this.write(null,n,r);return this.texData.get(o).usage=null,{dataId:o,shape:n,dtype:r}},e.prototype.makeOutput=function(n,r){var o=this.makeTensorInfo(n,r).dataId;return L.makeTensorFromDataId(o,n,r,this)},e.prototype.unpackTensor=function(n){var r=new Sj(n.shape);return this.runWebGLProgram(r,[n],n.dtype)},e.prototype.packTensor=function(n){var r=new q$(n.shape);return this.runWebGLProgram(r,[n],n.dtype,null,!0)},e.prototype.packedReshape=function(n,r){var o=[ef(n.shape)].concat(tf(n.shape)),i={dtype:n.dtype,shape:o,dataId:n.dataId},a=[ef(r)].concat(tf(r)),s=new Q$(a,o),u=this.runWebGLProgram(s,[i],n.dtype,null,!0);return{dataId:u.dataId,shape:r,dtype:u.dtype}},e.prototype.decode=function(n){var r,o=this.texData.get(n),i=o.isPacked,a=o.shape,s=o.dtype,u=bp(a);return r=i?new c$(u):new l$(u),{dtype:s,shape:a,dataId:this.runWebGLProgram(r,[{shape:u,dtype:s,dataId:n}],s,null,!0).dataId}},e.prototype.runWebGLProgram=function(n,r,o,i,a){var s=this;a===void 0&&(a=!1);var u=this.makeTensorInfo(n.outputShape,o),l=this.texData.get(u.dataId);if(n.packedOutput&&(l.isPacked=!0),n.outPackingScheme===Tl.DENSE){var c=Zu(n.outputShape);l.texShape=c.map(function(w){return 2*w})}if(n.outTexUsage!=null&&(l.usage=n.outTexUsage),se(u.shape)===0)return l.values=kl(u.dtype,0),u;var d=[],f=r.map(function(w){if(w.dtype==="complex64")throw new Error("GPGPUProgram does not support complex64 input. For complex64 dtypes, please separate the program into real and imaginary parts.");var x=s.texData.get(w.dataId);if(x.texture==null){if(!n.packedInputs&&se(w.shape)<=H().getNumber("WEBGL_SIZE_UPLOAD_UNIFORM"))return{shape:w.shape,texData:null,isUniform:!0,uniformValues:x.values};n.packedInputs&&(x.isPacked=!0,x.shape=w.shape)}else if(!!x.isPacked!=!!n.packedInputs)w=x.isPacked?s.unpackTensor(w):s.packTensor(w),d.push(w),x=s.texData.get(w.dataId);else if(x.isPacked&&!Uc(x.shape,w.shape)){var b=w,_=w.shape;w.shape=x.shape,w=s.packedReshape(w,_),d.push(w),x=s.texData.get(w.dataId),b.shape=_}return s.uploadToGPU(w.dataId),{shape:w.shape,texData:x,isUniform:!1}});this.uploadToGPU(u.dataId);var h,v={shape:u.shape,texData:l,isUniform:!1},p=function(w,x,b){var _="";x.concat(b).forEach(function(R){var S=R.texData!=null&&R.texData.slice!=null&&R.texData.slice.flatOffset>0,P=R.isUniform?"uniform":R.texData.texShape;_+=R.shape+"_"+P+"_"+S});var E=w.userCode,C=w.constructor.name;return C+="_"+_+"_"+E}(n,f,v),m=this.getAndSaveBinary(p,function(){return function(w,x,b,_){var E=x.userCode,C=b.map(function(D,F){var $={logicalShape:D.shape,texShape:D.isUniform?null:D.texData.texShape,isUniform:D.isUniform,isPacked:!D.isUniform&&D.texData.isPacked,flatOffset:null};return D.texData!=null&&D.texData.slice!=null&&D.texData.slice.flatOffset>0&&($.flatOffset=D.texData.slice.flatOffset),{name:x.variableNames[F],shapeInfo:$}}),R=C.map(function(D){return D.shapeInfo}),S={logicalShape:_.shape,texShape:_.texData.texShape,isUniform:!1,isPacked:_.texData.isPacked,flatOffset:null},P=LB(C,S,E,x.packedInputs),A=w.createProgram(P),B=null,M=w.getUniformLocation(A,"NAN",!1);H().getNumber("WEBGL_VERSION")===1&&(B=w.getUniformLocation(A,"INFINITY",!1));for(var j={},W=0;W<x.variableNames.length;W++){var U=x.variableNames[W];j[U]=w.getUniformLocation(A,U,!1),j["offset"+U]=w.getUniformLocation(A,"offset"+U,!1)}return{program:x,source:P,webGLProgram:A,uniformLocations:j,inShapeInfos:R,outShapeInfo:S,infLoc:B,nanLoc:M}}(s.gpgpu,n,f,v)}),g=this.activeTimers!=null;if(g&&(h=this.startTimer()),function(w,x,b,_,E){ix(x.inShapeInfos,b),ix([x.outShapeInfo],[_]);var C=_.texData.texture,R=_.texData.texShape;_.texData.isPacked?w.setOutputPackedMatrixTexture(C,R[0],R[1]):w.setOutputMatrixTexture(C,R[0],R[1]),w.setProgram(x.webGLProgram),H().getNumber("WEBGL_VERSION")===1&&x.infLoc!==null&&w.gl.uniform1f(x.infLoc,1/0),x.nanLoc!==null&&w.gl.uniform1f(x.nanLoc,NaN),b.forEach(function(S,P){var A=x.program.variableNames[P],B=x.uniformLocations[A],M=x.uniformLocations["offset"+A];if(B!=null)if(S.isUniform)if(se(S.shape)<2)w.gl.uniform1f(B,S.uniformValues[0]);else{var j=S.uniformValues;j instanceof Float32Array||(j=new Float32Array(j)),w.gl.uniform1fv(B,j)}else S.texData.slice!=null&&M!=null&&w.gl.uniform1i(M,S.texData.slice.flatOffset),w.setInputMatrixTexture(S.texData.texture,B,P)}),E!=null&&E(w,x.webGLProgram),w.executeProgram()}(this.gpgpu,m,f,v,i),d.forEach(function(w){return s.disposeData(w.dataId)}),g&&(h=this.endTimer(h),this.activeTimers.push({name:n.constructor.name,query:this.getQueryTime(h)})),!H().getBool("WEBGL_LAZILY_UNPACK")&&l.isPacked&&a===!1){var y=this.unpackTensor(u);return this.disposeData(u.dataId),y}return u},e.prototype.compileAndRun=function(n,r,o,i,a){a===void 0&&(a=!1),o=o||r[0].dtype;var s=this.runWebGLProgram(n,r,o,i,a);return L.makeTensorFromDataId(s.dataId,s.shape,s.dtype)},e.prototype.getAndSaveBinary=function(n,r){return n in this.binaryCache||(this.binaryCache[n]=r()),this.binaryCache[n]},e.prototype.getTextureManager=function(){return this.textureManager},e.prototype.dispose=function(){var n=this;this.disposed||(H().getBool("IS_TEST")||Object.keys(this.binaryCache).forEach(function(r){n.gpgpu.deleteProgram(n.binaryCache[r].webGLProgram),delete n.binaryCache[r]}),this.textureManager.dispose(),this.canvas!=null&&typeof HTMLCanvasElement<"u"&&this.canvas instanceof HTMLCanvasElement?this.canvas.remove():this.canvas=null,this.gpgpuCreatedLocally&&(this.gpgpu.program=null,this.gpgpu.dispose()),this.disposed=!0)},e.prototype.floatPrecision=function(){var n=this;return this.floatPrecisionValue==null&&(this.floatPrecisionValue=ne(function(){if(!H().get("WEBGL_RENDER_FLOAT32_ENABLED")){var r=H().getBool("DEBUG");H().set("DEBUG",!1);var o=n.abs(ee(1e-8)).dataSync()[0];if(H().set("DEBUG",r),o>0)return 32}return 16})),this.floatPrecisionValue},e.prototype.epsilon=function(){return this.floatPrecision()===32?1e-7:1e-4},e.prototype.uploadToGPU=function(n){var r,o=this.texData.get(n),i=o.shape,a=o.dtype,s=o.values,u=o.texture,l=o.usage,c=o.isPacked;if(u==null){var d,f=this.activeTimers!=null;f&&(d=Fr());var h=o.texShape;if(h==null&&(h=NL(i,c),o.texShape=h),s!=null){var v=bp(i),p=void 0,m=h[1],g=h[0],y=s instanceof Uint8Array;c?(m=(r=Ql(h[0],h[1]))[0],g=r[1],p=new m$(v,[g,m],y)):p=new v$(v,[g,m],y);var w=this.makeTensorInfo([g,m],a);this.texData.get(w.dataId).usage=y?An.PIXELS:An.UPLOAD,this.gpgpu.uploadDenseMatrixToTexture(this.getTexture(w.dataId),m,g,s);var x=this.runWebGLProgram(p,[w],a,null,!0),b=this.texData.get(x.dataId);o.texture=b.texture,o.texShape=b.texShape,o.isPacked=b.isPacked,o.usage=b.usage,this.disposeData(w.dataId),this.texData.delete(x.dataId),o.values=null,f&&(this.uploadWaitMs+=Fr()-d)}else{var _=this.acquireTexture(h,l,a,c);o.texture=_}}},e.prototype.convertAndCacheOnCPU=function(n,r){var o=this.texData.get(n),i=o.dtype;return this.releaseGPUData(n),r!=null&&(o.values=function(a,s){if(s==="float32"||s==="complex64")return a;if(s==="int32"||s==="bool"){for(var u=s==="int32"?new Int32Array(a.length):new Uint8Array(a.length),l=0;l<u.length;++l)u[l]=Math.round(a[l]);return u}throw new Error("Unknown dtype "+s)}(r,i)),o.values},e.prototype.acquireTexture=function(n,r,o,i){if(this.numBytesInGPU+=this.computeBytes(n,o),!this.warnedAboutMemory&&this.numBytesInGPU>1024*this.numMBBeforeWarning*1024){var a=(this.numBytesInGPU/1024/1024).toFixed(2);this.warnedAboutMemory=!0,console.warn("High memory usage in GPU: "+a+" MB, most likely due to a memory leak")}return this.textureManager.acquireTexture(n,r,i)},e.prototype.computeBytes=function(n,r){return n[0]*n[1]*UC(r)},e}(dS);XC()&&L.registerBackend("webgl",function(){return new Rj},2);var Tj=O({square_:function(t){var e=T(t,"x","square"),n=[e];return L.runKernelFunc(function(r,o){return o([e]),r.square(e)},{x:e},null,"Square",{},n,[])}}),Al="SquaredDifference",AS=O({squaredDifference_:function(t,e){var n,r=T(t,"a","squaredDifference"),o=T(e,"b","squaredDifference");n=at(r,o),r=n[0],o=n[1],Te(r.shape,o.shape);var i={a:r,b:o},a=[r,o];return L.runKernelFunc(function(s,u){var l=s.squaredDifference(r,o);return u([r,o]),l},i,function(s,u){var l=u[0],c=u[1],d=ee(2);return{a:function(){return s.mul(l.sub(c).mul(d))},b:function(){return s.mul(c.sub(l).mul(d))}}},Al,{},a,[])}}),Ij=O({abs_:function(t){var e=T(t,"x","abs");return e.dtype==="complex64"?L.runKernelFunc(function(n){return n.complexAbs(e)},{$x:e}):L.runKernelFunc(function(n,r){var o=n.abs(e);return r([e]),o},{x:e},function(n,r){var o=r[0];return{x:function(){return n.mul(o.toFloat().step(-1))}}},"Abs")}}),Aj=O({acos_:function(t){var e=T(t,"x","acos");return L.runKernelFunc(function(n,r){var o=n.acos(e);return r([e]),o},{$x:e},function(n,r){var o=r[0];return{$x:function(){return n.divStrict(ee(1).sub(o.toFloat().square()).sqrt()).neg()}}})}}),Pj=O({acosh_:function(t){var e=T(t,"x","acosh");return L.runKernelFunc(function(n,r){var o=n.acosh(e);return r([e]),o},{$x:e},function(n,r){var o=r[0];return{$x:function(){return n.divStrict(o.toFloat().square().sub(1).sqrt())}}})}}),Dj=O({asin_:function(t){var e=T(t,"x","asin");return L.runKernelFunc(function(n,r){var o=n.asin(e);return r([e]),o},{$x:e},function(n,r){var o=r[0];return{$x:function(){return n.divStrict(ee(1).sub(o.toFloat().square()).sqrt())}}})}}),Nj=O({asinh_:function(t){var e=T(t,"x","asinh");return L.runKernelFunc(function(n,r){var o=n.asinh(e);return r([e]),o},{$x:e},function(n,r){var o=r[0];return{$x:function(){return n.divStrict(ee(1).add(o.toFloat().square()).sqrt())}}})}}),Oj=O({atan_:function(t){var e=T(t,"x","atan");return L.runKernelFunc(function(n,r){var o=n.atan(e);return r([e]),o},{$x:e},function(n,r){var o=r[0];return{$x:function(){return n.div(o.toFloat().square().add(1))}}})}}),Fj=O({atanh_:function(t){var e=T(t,"x","atanh");return L.runKernelFunc(function(n,r){var o=n.atanh(e);return r([e]),o},{$x:e},function(n,r){var o=r[0];return{$x:function(){return n.div(ee(1).sub(o.toFloat().square()))}}})}}),Mj=O({ceil_:function(t){var e=T(t,"x","ceil");return L.runKernelFunc(function(n){return n.ceil(e)},{$x:e},function(n){return{$x:function(){return Ne(n)}}})}}),Cy=O({clipByValue_:function(t,e,n){var r=T(t,"x","clipByValue");I(e<=n,function(){return"Error in clip: min ("+e+") must be less than or equal to max ("+n+")."});var o=[r],i={min:e,max:n};return L.runKernelFunc(function(a,s){var u=a.clip(r,e,n);return s([r]),u},{x:r},function(a,s){var u=s[0];return{x:function(){return a.where(u.greaterEqual(e).logicalAnd(u.lessEqual(n)),Ne(a))}}},"ClipByValue",i,o)}}),Lj=O({cos_:function(t){var e=T(t,"x","cos"),n=[e];return L.runKernelFunc(function(r,o){var i=r.cos(e);return o([e]),i},{x:e},function(r,o){var i=o[0];return{x:function(){return i.toFloat().sin().neg().mul(r)}}},"Cos",{},n)}}),Bj=O({cosh_:function(t){var e=T(t,"x","cosh");return L.runKernelFunc(function(n,r){var o=n.cosh(e);return r([e]),o},{$x:e},function(n,r){var o=r[0];return{$x:function(){return o.toFloat().sinh().mulStrict(n)}}})}}),$j=O({erf_:function(t){var e=T(t,"x","erf");return I(e.dtype==="int32"||e.dtype==="float32",function(){return"Input dtype must be `int32` or `float32`."}),e.dtype==="int32"&&(e=e.toFloat()),L.runKernelFunc(function(n,r){var o=n.erf(e);return r([e]),o},{$x:e},function(n,r){var o=r[0];return{$x:function(){return n.mul(o.square().neg().exp().mul(2/Math.sqrt(Math.PI)))}}})}}),Pm=O({exp_:function(t){var e=T(t,"x","exp");return L.runKernelFunc(function(n,r){var o=n.exp(e);return r([o]),o},{x:e},function(n,r){return{x:function(){return n.mulStrict(r[0])}}},"Exp",{},[],[!0])}}),jj=O({expm1_:function(t){var e=T(t,"x","expm1");return L.runKernelFunc(function(n,r){var o=n.expm1(e);return r([e]),o},{$x:e},function(n,r){var o=r[0];return{$x:function(){return n.mul(o.exp())}}})}}),Wj=O({floor_:function(t){var e=T(t,"x","floor");return L.runKernelFunc(function(n){return n.floor(e)},{$x:e},function(n){return{$x:function(){return Ne(n)}}})}}),Uj=O({log_:function(t){var e=T(t,"x","log"),n=[e];return L.runKernelFunc(function(r,o){var i=r.log(e);return o([e]),i},{x:e},function(r,o){var i=o[0];return{x:function(){return r.div(i.toFloat())}}},"Log",{},n)}}),zj=O({log1p_:function(t){var e=T(t,"x","log1p");return L.runKernelFunc(function(n,r){var o=n.log1p(e);return r([e]),o},{$x:e},function(n,r){var o=r[0];return{$x:function(){return n.div(o.add(1))}}})}}),Vj=O({logSigmoid_:function(t){var e=T(t,"x","logSigmoid");return L.runKernelFunc(function(n,r){var o=n.softplus(e.neg()).neg();return r([e]),o},{$x:e},function(n,r){var o=r[0];return{$x:function(){return n.mul(o.neg().sigmoid())}}})}}),hf=O({neg_:function(t){var e=T(t,"x","neg"),n=[e];return L.runKernelFunc(function(r){return r.neg(e)},{x:e},function(r){return{x:function(){return r.neg()}}},"Neg",{},n)}}),Hj=O({reciprocal_:function(t){var e=T(t,"x","reciprocal");return L.runKernelFunc(function(n,r){var o=n.reciprocal(e);return r([e]),o},{$x:e},function(n,r){var o=r[0];return{$x:function(){return n.div(o.square().neg())}}})}}),Gj=O({round_:function(t){var e=T(t,"x","round");return L.runKernelFunc(function(n){return n.round(e)},{$x:e},function(n){return{$x:function(){return Ne(n)}}})}}),PS=O({rsqrt_:function(t){var e=T(t,"x","rsqrt"),n=[e];return L.runKernelFunc(function(r,o){var i=r.rsqrt(e);return o([e]),i},{x:e},function(r,o){var i=o[0];return{x:function(){return r.div(i.pow(1.5).mul(2)).neg()}}},"Rsqrt",{},n)}}),DS=O({sigmoid_:function(t){var e=T(t,"x","sigmoid");return L.runKernelFunc(function(n,r){var o=n.sigmoid(e);return r([o]),o},{x:e},function(n,r){var o=r[0];return{x:function(){return n.mul(o.mul(ee(1).sub(o)))}}},"Sigmoid")}}),qj=O({sign_:function(t){var e=T(t,"x","sign");return L.runKernelFunc(function(n){return n.sign(e)},{$x:e},function(n){return{$x:function(){return Ne(n)}}})}}),Kj=O({isNaN_:function(t){var e=T(t,"x","isNaN");return L.runKernelFunc(function(n){return n.isNaN(e)},{$x:e},function(n){return{$x:function(){return Ne(n)}}})}}),Xj=O({isInf_:function(t){var e=T(t,"x","isInf");return L.runKernelFunc(function(n){return n.isInf(e)},{$x:e},function(n){return{$x:function(){return Ne(n)}}})}}),Yj=O({isFinite_:function(t){var e=T(t,"x","isFinite");return L.runKernelFunc(function(n){return n.isFinite(e)},{$x:e},function(n){return{$x:function(){return Ne(n)}}})}}),Qj=O({sin_:function(t){var e=T(t,"x","sin"),n=[e];return L.runKernelFunc(function(r,o){var i=r.sin(e);return o([e]),i},{x:e},function(r,o){var i=o[0];return{x:function(){return i.toFloat().cos().mul(r)}}},"Sin",{},n)}}),Jj=O({sinh_:function(t){var e=T(t,"x","sinh");return L.runKernelFunc(function(n,r){var o=n.sinh(e);return r([e]),o},{$x:e},function(n,r){var o=r[0];return{$x:function(){return o.toFloat().cosh().mulStrict(n)}}})}}),Zj=O({softplus_:function(t){var e=T(t,"x","softplus");return L.runKernelFunc(function(n,r){var o=n.softplus(e);return r([e]),o},{$x:e},function(n,r){var o=r[0];return{$x:function(){return n.mul(o.sigmoid())}}})}}),eW=O({sqrt_:function(t){var e=T(t,"x","sqrt");return L.runKernelFunc(function(n,r){var o=n.sqrt(e);return r([e]),o},{$x:e},function(n,r){var o=r[0];return{$x:function(){return n.div(o.toFloat().sqrt().mul(2))}}})}}),tW=O({step_:function(t,e){e===void 0&&(e=0);var n=T(t,"x","step");return L.runKernelFunc(function(r){return r.step(n,e)},{$x:n},function(r){return{$x:function(){return Ne(r)}}})}}),nW=O({tan_:function(t){var e=T(t,"x","tan");return L.runKernelFunc(function(n,r){var o=n.tan(e);return r([e]),o},{$x:e},function(n,r){var o=r[0];return{$x:function(){return n.div(o.cos().square())}}})}}),rW=O({tanh_:function(t){var e=T(t,"x","tanh");return L.runKernelFunc(function(n,r){var o=n.tanh(e);return r([o]),o},{x:e},function(n,r){var o=r[0];return{x:function(){return ee(1).sub(o.square()).mulStrict(n)}}},"Tanh",{},null,[!0])}});function NS(t,e,n,r,o,i){var a,s,u=T(t,"x","batchNorm"),l=T(e,"mean","batchNorm"),c=T(n,"variance","batchNorm");return o!=null&&(a=T(o,"scale","batchNorm")),r!=null&&(s=T(r,"offset","batchNorm")),I(u.rank===2,function(){return"Error in batchNorm3D: x must be rank 3 but got rank "+u.rank+"."}),I(l.rank===2||l.rank===1,function(){return"Error in batchNorm2D: mean must be rank 2 or rank 1 but got rank "+l.rank+"."}),I(c.rank===2||c.rank===1,function(){return"Error in batchNorm2D: variance must be rank 2 or rank 1 but got rank "+c.rank+"."}),a!=null&&I(a.rank===2||a.rank===1,function(){return"Error in batchNorm2D: scale must be rank 2 or rank 1 but got rank "+a.rank+"."}),s!=null&&I(s.rank===2||s.rank===1,function(){return"Error in batchNorm2D: offset must be rank 2 or rank 1 but got rank "+s.rank+"."}),Zl(u,l,c,s,a,i)}function OS(t,e,n,r,o,i){var a,s,u=T(t,"x","batchNorm"),l=T(e,"mean","batchNorm"),c=T(n,"variance","batchNorm");return o!=null&&(a=T(o,"scale","batchNorm")),r!=null&&(s=T(r,"offset","batchNorm")),I(u.rank===3,function(){return"Error in batchNorm3D: x must be rank 3 but got rank "+u.rank+"."}),I(l.rank===3||l.rank===1,function(){return"Error in batchNorm3D: mean must be rank 3 or rank 1 but got rank "+l.rank+"."}),I(c.rank===3||c.rank===1,function(){return"Error in batchNorm3D: variance must be rank 3 or rank 1 but got rank "+c.rank+"."}),a!=null&&I(a.rank===3||a.rank===1,function(){return"Error in batchNorm3D: scale must be rank 3 or rank 1 but got rank "+a.rank+"."}),s!=null&&I(s.rank===3||s.rank===1,function(){return"Error in batchNorm3D: offset must be rank 3 or rank 1 but got rank "+s.rank+"."}),Zl(u,l,c,s,a,i)}function FS(t,e,n,r,o,i){var a,s,u=T(t,"x","batchNorm"),l=T(e,"mean","batchNorm"),c=T(n,"variance","batchNorm");return o!=null&&(a=T(o,"scale","batchNorm")),r!=null&&(s=T(r,"offset","batchNorm")),I(u.rank===4,function(){return"Error in batchNorm4D: x must be rank 4 but got rank "+u.rank+"."}),I(l.rank===4||l.rank===1,function(){return"Error in batchNorm4D: mean must be rank 4 or rank 1 but got rank "+l.rank+"."}),I(c.rank===4||c.rank===1,function(){return"Error in batchNorm4D: variance must be rank 4 or rank 1 but got rank "+c.rank+"."}),a!=null&&I(a.rank===4||a.rank===1,function(){return"Error in batchNorm4D: scale must be rank 4 or rank 1 but got rank "+a.rank+"."}),s!=null&&I(s.rank===4||s.rank===1,function(){return"Error in batchNorm4D: offset must be rank 4 or rank 1 but got rank "+s.rank+"."}),Zl(u,l,c,s,a,i)}function Zl(t,e,n,r,o,i){i==null&&(i=.001);var a,s,u,l=T(t,"x","batchNorm"),c=T(e,"mean","batchNorm"),d=T(n,"variance","batchNorm");o!=null&&(a=T(o,"scale","batchNorm")),r!=null&&(s=T(r,"offset","batchNorm")),I(c.rank===d.rank,function(){return"Batch normalization gradient requires mean and variance to have equal ranks."}),I(s==null||c.rank===s.rank,function(){return"Batch normalization gradient requires mean and offset to have equal ranks."}),I(a==null||c.rank===a.rank,function(){return"Batch normalization gradient requires mean and scale to have equal ranks."}),u=l.rank===0||l.rank===1?l.as4D(1,1,1,l.size):l.rank===2?l.as4D(1,1,l.shape[0],l.shape[1]):l.rank===3?l.as4D(1,l.shape[0],l.shape[1],l.shape[2]):l;var f=[l,c,d,a];return L.runKernelFunc(function(h,v){var p=h.batchNormalization(u,qc(c),qc(d),i,qc(a),qc(s));return v([l,c,d,a]),p},{x:l,mean:c,variance:d,scale:a,offset:s},function(h,v){var p=v,m=p[0],g=p[1],y=p[2],w=p[3],x=w??ee(1),b=Ct(g.shape,u.shape),_=[];if(g.rank===1){for(var E=0;E<u.shape.length-1;++E)_.push(u.shape[E]);_.push(1)}var C=m.sub(g),R=h.mul(x),S=PS(y.add(ee(i))),P=S.mul(S).mul(S).mul(ee(-.5));return{x:function(){return g.rank===1?h.mul(ks(S.as4D(1,1,1,g.shape[0]),_)).mul(x).reshape(m.shape):h.mul(S).mul(x).reshape(m.shape)},mean:function(){var A=S.mul(ee(-1)).mul(R);return g.rank===1&&(A=A.sum(b)),A.reshape(g.shape)},variance:function(){var A=P.mul(C).mul(R);return g.rank===1&&(A=A.sum(b)),A.reshape(g.shape)},scale:function(){var A=C.mul(S),B=h.mul(A);return g.rank===1&&(B=B.sum(b)),B.reshape(g.shape)},offset:function(){var A=h;return g.rank===1&&(A=A.sum(b)),A.reshape(g.shape)}}},"BatchNormalization",{varianceEpsilon:i},f).reshape(l.shape)}function qc(t){return t==null?null:t.rank===0?t.as1D():t.rank===1?t:t.rank===2?t.as4D(1,1,t.shape[0],t.shape[1]):t.rank===3?t.as4D(1,t.shape[0],t.shape[1],t.shape[2]):t}function oh(){YC("tf.batchNormalization() is going away. Use tf.batchNorm() instead, and note the positional argument change of scale, offset, and varianceEpsilon")}var oW=O({batchNormalization2d_:function(t,e,n,r,o,i){return r===void 0&&(r=.001),oh(),NS(t,e,n,i,o,r)}}),iW=O({batchNormalization3d_:function(t,e,n,r,o,i){return r===void 0&&(r=.001),oh(),OS(t,e,n,i,o,r)}}),aW=O({batchNormalization4d_:function(t,e,n,r,o,i){return r===void 0&&(r=.001),oh(),FS(t,e,n,i,o,r)}}),sW=O({batchNormalization_:function(t,e,n,r,o,i){return r===void 0&&(r=.001),oh(),Zl(t,e,n,i,o,r)}}),MS=O({batchNorm_:Zl}),uW=O({batchNorm2d_:NS}),lW=O({batchNorm3d_:OS}),cW=O({batchNorm4d_:FS}),ih=O({logicalAnd_:function(t,e){var n=T(t,"a","logicalAnd","bool"),r=T(e,"b","logicalAnd","bool");return Te(n.shape,r.shape),L.runKernelFunc(function(o){return o.logicalAnd(n,r)},{a:n,b:r},null,"LogicalAnd")}}),dW=O({logicalNot_:function(t){var e=T(t,"x","logicalNot","bool");return L.runKernelFunc(function(n){return n.logicalNot(e)},{$x:e})}}),LS=O({logicalOr_:function(t,e){var n=T(t,"a","logicalOr","bool"),r=T(e,"b","logicalOr","bool");return Te(n.shape,r.shape),L.runKernelFunc(function(o){return o.logicalOr(n,r)},{$a:n,$b:r})}}),fW=O({logicalXor_:function(t,e){var n=T(t,"a","logicalXor","bool"),r=T(e,"b","logicalXor","bool");return Te(n.shape,r.shape),LS(t,e).logicalAnd(ih(t,e).logicalNot())}}),Ca=O({where_:function(t,e,n){var r=T(e,"a","where"),o=T(n,"b","where"),i=T(t,"condition","where","bool");return Le(r.shape,o.shape,"Error in where: "),i.rank===1?I(i.shape[0]===r.shape[0],function(){return"The first dimension of `a` must match the size of `condition`."}):Le(i.shape,o.shape,"Error in where: "),L.runKernelFunc(function(a,s){var u=a.select(i,r,o);return s([i]),u},{$condition:i,$a:r,$b:o},function(a,s){var u=s[0];return{$condition:function(){return Ne(u).toFloat()},$a:function(){return a.mul(u.cast(a.dtype))},$b:function(){return a.mul(u.logicalNot().cast(a.dtype))}}})}}),BS=function(t){return ie(this,void 0,void 0,function(){var e,n,r;return ae(this,function(o){switch(o.label){case 0:return[4,(e=T(t,"condition","whereAsync","bool")).data()];case 1:return n=o.sent(),r=xy(e.shape,n),t!==e&&e.dispose(),[2,r]}})})},ke=O({add_:function(t,e){var n,r=T(t,"a","add"),o=T(e,"b","add");n=at(r,o),r=n[0],o=n[1];var i=Te(r.shape,o.shape);return L.runKernelFunc(function(a){return a.add(r,o)},{a:r,b:o},function(a){return{a:function(){var s=a,u=Ct(r.shape,i);return u.length>0&&(s=s.sum(u)),s.reshape(r.shape)},b:function(){var s=a,u=Ct(o.shape,i);return u.length>0&&(s=s.sum(u)),s.reshape(o.shape)}}},"Add")}}),hW=O({addN_:function(t){I(Array.isArray(t),function(){return"The argument passed to tf.addN() must be a list of tensors"}),I(t.length>=1,function(){return"Must pass at least one tensor to tf.addN(), but got "+t.length});var e=t.map(function(o,i){return T(o,"tensors"+i,"addN")}),n=e[0];e.forEach(function(o){if(o.dtype!==n.dtype)throw new Error("All tensors passed to tf.addN() must have the same dtype")}),e.forEach(function(o){if(!At(o.shape,n.shape))throw new Error("All tensors passed to tf.addN() must have the same shape")});var r=e;return L.runKernelFunc(function(o){return o.addN(e)},r,function(o){var i={};return e.forEach(function(a,s){i[s]=function(){return o.clone()}}),i},"AddN")}}),pW=O({addStrict_:function(t,e){var n=T(t,"a","addStrict"),r=T(e,"b","addStrict");return Le(n.shape,r.shape,"Error in addStrict: "),n.add(r)}}),vW=O({atan2_:function(t,e){var n,r=T(t,"a","atan2"),o=T(e,"b","atan2");n=at(r,o),r=n[0],o=n[1];var i=Te(r.shape,o.shape);return L.runKernelFunc(function(a,s){var u=a.atan2(r,o);return s([r,o]),u},{$a:r,$b:o},function(a,s){var u=s[0],l=s[1];return{$a:function(){var c=ke(u.square(),l.square()),d=a.mul(l.div(c)),f=Ct(u.shape,i);return f.length>0&&(d=d.sum(f)),d.reshape(u.shape)},$b:function(){var c=ke(u.square(),l.square()),d=hf(a.mul(u.div(c))),f=Ct(l.shape,i);return f.length>0&&(d=d.sum(f)),d.reshape(l.shape)}}})}}),pr=O({div_:function(t,e){var n,r=T(t,"a","div"),o=T(e,"b","div");if(n=at(r,o),r=n[0],o=n[1],r.dtype==="int32"&&o.dtype==="int32")return $S(r,o);var i=Te(r.shape,o.shape);return L.runKernelFunc(function(a,s){var u=a.realDivide(r,o);return s([r,o]),u},{a:r,b:o},function(a,s){var u=s[0],l=s[1];return{a:function(){var c=a.div(l.toFloat()),d=Ct(u.shape,i);return d.length>0?c.sum(d).reshape(u.shape):c},b:function(){var c=a.mul(u.toFloat()),d=Ct(l.shape,i);d.length>0&&(c=c.sum(d).reshape(l.shape));var f=l.square();return c.div(f.toFloat()).neg()}}},"Div")}}),mW=O({divNoNan_:function(t,e){var n,r=T(t,"a","div"),o=T(e,"b","div");r=(n=at(r,o))[0],o=n[1];var i=pr(r,o),a=Ne(i),s=o.equal(a);return Ca(s,a,i)}}),gW=O({divStrict_:function(t,e){var n=T(t,"a","div"),r=T(e,"b","div");return Le(n.shape,r.shape,"Error in divideStrict: "),n.div(r)}}),$S=O({floorDiv_:function(t,e){var n,r=T(t,"a","floorDiv"),o=T(e,"b","floorDiv");n=at(r,o),r=n[0],o=n[1];var i=Te(r.shape,o.shape);return L.runKernelFunc(function(a,s){var u=a.floorDiv(r,o);return s([r,o]),u},{a:r,b:o},function(a,s){var u=s[0],l=s[1];return{a:function(){var c=a.div(l.toFloat()),d=Ct(u.shape,i);return d.length>0?c.sum(d).reshape(u.shape):c},b:function(){var c=a.mul(u.toFloat()),d=Ct(l.shape,i);d.length>0&&(c=c.sum(d).reshape(l.shape));var f=l.square();return c.div(f.toFloat()).neg()}}},"FloorDiv")}}),Sy=O({maximum_:function(t,e){var n,r=T(t,"a","maximum"),o=T(e,"b","maximum");return n=at(r,o),r=n[0],o=n[1],r.dtype==="bool"&&(r=r.toInt(),o=o.toInt()),Te(r.shape,o.shape),L.runKernelFunc(function(i,a){var s=i.maximum(r,o);return a([r,o]),s},{a:r,b:o},function(i,a){var s=a[0],u=a[1];return{a:function(){return i.mul(s.greaterEqual(u).toFloat())},b:function(){return i.mul(s.less(u).toFloat())}}},"Maximum")}}),yW=O({maximumStrict_:function(t,e){var n=T(t,"a","maximumStrict"),r=T(e,"b","maximumStrict");return Le(n.shape,r.shape,"Error in maximumStrict: "),n.maximum(r)}}),jS=O({minimum_:function(t,e){var n,r=T(t,"a","minimum"),o=T(e,"b","minimum");return n=at(r,o),r=n[0],o=n[1],r.dtype==="bool"&&(r=r.toInt(),o=o.toInt()),Te(r.shape,o.shape),L.runKernelFunc(function(i,a){var s=i.minimum(r,o);return a([r,o]),s},{a:r,b:o},function(i,a){var s=a[0],u=a[1];return{a:function(){return i.mul(s.lessEqual(u).toFloat())},b:function(){return i.mul(s.greater(u).toFloat())}}},"Minimum")}}),wW=O({minimumStrict_:function(t,e){var n=T(t,"a","minimumStrict"),r=T(e,"b","minimumStrict");return Le(n.shape,r.shape,"Error in minimumStrict: "),n.minimum(r)}}),xW=O({mod_:function(t,e){var n,r=T(t,"a","mod"),o=T(e,"b","mod");n=at(r,o),r=n[0],o=n[1];var i=Te(r.shape,o.shape);return L.runKernelFunc(function(a,s){var u=a.mod(r,o);return s([r,o]),u},{$a:r,$b:o},function(a,s){var u=s[0],l=s[1];return{$a:function(){var c=Ct(u.shape,i);return c.length>0?a.sum(c).reshape(u.shape):a},$b:function(){var c=a.mul(u.div(l).floor().neg()),d=Ct(l.shape,i);return d.length>0?c.sum(d).reshape(l.shape):c}}})}}),bW=O({modStrict_:function(t,e){var n=T(t,"a","modStrict"),r=T(e,"b","modStrict");return Le(n.shape,r.shape,"Error in modStrict: "),n.mod(r)}}),Yt=O({mul_:function(t,e){var n,r=T(t,"a","mul"),o=T(e,"b","mul");n=at(r,o),r=n[0],o=n[1];var i=Te(r.shape,o.shape);return L.runKernelFunc(function(a,s){var u=a.multiply(r,o);return s([r,o]),u},{a:r,b:o},function(a,s){var u=s[0],l=s[1];return{a:function(){var c=a.mul(l.toFloat()),d=Ct(u.shape,i);return d.length>0?c.sum(d).reshape(u.shape):c},b:function(){var c=a.mul(u.toFloat()),d=Ct(l.shape,i);return d.length>0?c.sum(d).reshape(l.shape):c}}},"Mul")}}),_W=O({mulStrict_:function(t,e){var n=T(t,"a","mul"),r=T(e,"b","mul");return Le(n.shape,r.shape,"Error in multiplyStrict: "),n.mul(r)}}),pf=O({pow_:function(t,e){var n,r=T(t,"base","pow"),o=T(e,"exp","pow");n=at(r,o),r=n[0],o=n[1];var i=Te(r.shape,o.shape),a=[r,o];return L.runKernelFunc(function(s,u){var l=s.pow(r,o);return u([r,o,l]),l},{a:r,b:o},function(s,u){var l=u[0],c=u[1],d=u[2];return{a:function(){var f=c.toFloat(),h=s.mul(f.mul(l.pow(f.sub(ee(1))))),v=Ct(l.shape,i);return v.length>0&&(h=h.sum(v)),h.reshape(l.shape)},b:function(){var f=l.greater(0),h=l.log().where(f,Ne(l)),v=s.mul(d.mul(h)),p=Ct(c.shape,i);return p.length>0&&(v=v.sum(p)),v.reshape(c.shape)}}},"Pow",{},a,[!0])}}),EW=O({powStrict_:function(t,e){return Le(t.shape,e.shape,"Error in powStrict: "),t.pow(e)}}),CW=O({squaredDifferenceStrict_:function(t,e){var n=T(t,"a","squaredDifferenceStrict"),r=T(e,"b","squaredDifferenceStrict");return Le(n.shape,r.shape,"Error in squaredDifferenceStrict: "),n.squaredDifference(r)}}),St=O({sub_:function(t,e){var n,r=T(t,"a","sub"),o=T(e,"b","sub");n=at(r,o),r=n[0],o=n[1];var i=Te(r.shape,o.shape);return L.runKernelFunc(function(a){return a.subtract(r,o)},{a:r,b:o},function(a){return{a:function(){var s=a,u=Ct(r.shape,i);return u.length>0&&(s=s.sum(u)),s.reshape(r.shape)},b:function(){var s=a,u=Ct(o.shape,i);return u.length>0&&(s=s.sum(u)),s.neg().reshape(o.shape)}}},"Sub")}}),SW=O({subStrict_:function(t,e){var n=T(t,"a","subStrict"),r=T(e,"b","subStrict");return Le(n.shape,r.shape,"Error in subStrict: "),n.sub(r)}}),WS=O({equal_:function(t,e){var n,r=T(t,"a","equal"),o=T(e,"b","equal");return n=at(r,o),r=n[0],o=n[1],Te(r.shape,o.shape),L.runKernelFunc(function(i){return i.equal(r,o)},{$a:r,$b:o})}}),kW=O({equalStrict_:function(t,e){var n=T(t,"a","equalStrict"),r=T(e,"b","equalStrict");return Le(n.shape,r.shape,"Error in equalStrict: "),n.equal(r)}}),RW=O({greater_:function(t,e){var n,r=T(t,"a","greater"),o=T(e,"b","greater");return n=at(r,o),r=n[0],o=n[1],Te(r.shape,o.shape),L.runKernelFunc(function(i){return i.greater(r,o)},{a:r,b:o},null,"Greater")}}),US=O({greaterEqual_:function(t,e){var n,r=T(t,"a","greaterEqual"),o=T(e,"b","greaterEqual");return n=at(r,o),r=n[0],o=n[1],Te(r.shape,o.shape),L.runKernelFunc(function(i,a){var s=i.greaterEqual(r,o);return a([r,o]),s},{a:r,b:o},function(i,a){var s=a[0],u=a[1];return{a:function(){return Ne(s)},b:function(){return Ne(u)}}},"GreaterEqual")}}),TW=O({greaterEqualStrict_:function(t,e){var n=T(t,"a","greaterEqualStrict"),r=T(e,"b","greaterEqualStrict");return Le(n.shape,r.shape,"Error in greaterEqualStrict: "),n.greaterEqual(r)}}),IW=O({greaterStrict_:function(t,e){var n=T(t,"a","greaterStrict"),r=T(e,"b","greaterStrict");return Le(n.shape,r.shape,"Error in greaterStrict: "),n.greater(r)}}),AW=O({less_:function(t,e){var n,r=T(t,"a","less"),o=T(e,"b","less");return n=at(r,o),r=n[0],o=n[1],Te(r.shape,o.shape),L.runKernelFunc(function(i){return i.less(r,o)},{a:r,b:o},null,"Less")}}),PW=O({lessEqual_:function(t,e){var n,r=T(t,"a","lessEqual"),o=T(e,"b","lessEqual");return n=at(r,o),r=n[0],o=n[1],Te(r.shape,o.shape),L.runKernelFunc(function(i,a){var s=i.lessEqual(r,o);return a([r,o]),s},{a:r,b:o},null,"LessEqual")}}),DW=O({lessEqualStrict_:function(t,e){var n=T(t,"a","lessEqualStrict"),r=T(e,"b","lessEqualStrict");return Le(n.shape,r.shape,"Error in lessEqualStrict: "),n.lessEqual(r)}}),NW=O({lessStrict_:function(t,e){var n=T(t,"a","lessStrict"),r=T(e,"b","lessStrict");return Le(n.shape,r.shape,"Error in lessStrict: "),n.less(r)}}),OW=O({notEqual_:function(t,e){var n,r=T(t,"a","notEqual"),o=T(e,"b","notEqual");return n=at(r,o),r=n[0],o=n[1],Te(r.shape,o.shape),L.runKernelFunc(function(i){return i.notEqual(r,o)},{a:r,b:o},null,"NotEqual")}}),FW=O({notEqualStrict_:function(t,e){var n=T(t,"a","notEqualStrict"),r=T(e,"b","notEqualStrict");return Le(n.shape,r.shape,"Error in notEqualStrict: "),n.notEqual(r)}});function vx(t,e){for(var n=[],r=t;r<e;++r)n.push(r);return n}function mx(t){for(var e=[],n=0;n<t.length;++n)for(var r=0;r<t[n].length;++r)e.push(t[n][r]);return e}var ky=O({gather_:function(t,e,n){n===void 0&&(n=0);var r=T(t,"x","gather"),o=T(e,"indices","gather","int32");n=kt(n,r.shape)[0];var i=function(a,s,u){for(var l=a.shape[u],c=[],d=1,f=1,h=0;h<u;h++)c.push(a.shape[h]),d*=a.shape[h];for(h=0;h<s.rank;h++)c.push(s.shape[h]);for(h=u+1;h<a.rank;h++)c.push(a.shape[h]),f*=a.shape[h];return{batchSize:d,sliceSize:f,dimSize:l,outputShape:c}}(r,o,n);return L.runKernelFunc(function(a,s){var u=a.gather(r,o.flatten(),n);return s([o]),u},{x:r,indices:o},function(a,s){var u=s[0];return{x:function(){var l=r.shape,c=u.size,d=l.slice(0,n),f=d.length,h=l.slice(n,l.length).slice(1),v=h.length,p=vx(0,f),m=vx(f+1,f+1+v),g=mx([d,[c],h]),y=a.reshape(g),w=u.reshape([c]),x=mx([[f],p,m]),b=y.transpose(x),_=zS(b,w,r.shape[n]),E=fy(x);return _=_.transpose(E)},indices:function(){return u}}},"Gather",{axis:n}).reshape(i.outputShape)}}),zS=O({unsortedSegmentSum_:function(t,e,n){var r=T(t,"x","unsortedSegmentSum"),o=T(e,"segmentIds","unsortedSegmentSum","int32");return I(dt(n),function(){return"numSegments must be of dtype int"}),L.runKernelFunc(function(i,a){var s=i.unsortedSegmentSum(r,o,n);return a([o]),s},{$x:r},function(i,a){var s=a[0];return{$x:function(){return function(u,l){for(var c=Sy(l,Ne(l)),d=ky(u,c),f=US(l,ee(0,"int32")),h=d.rank-f.rank,v=0;v<h;++v)f=Vn(f,v+1);f=ih(f,gu(d.shape,"bool"));var p=Ne(d);return Ca(f,d,p)}(i,s)}}})}}),MW=function(t,e,n){return ie(this,void 0,void 0,function(){var r,o,i,a,s,u,l,c,d,f,h,v,p;return ae(this,function(m){switch(m.label){case 0:for(r=T(t,"tensor","boolMask"),o=T(e,"mask","boolMask","bool"),i=n??0,a=o.rank,s=r.shape,I(a>0,function(){return"mask cannot be scalar"}),Le(s.slice(i,i+a),o.shape,"mask's shape must match the first K dimensions of tensor's shape,"),u=1,l=i;l<i+a;l++)u*=s[l];return c=s.slice(0,i).concat([u],s.slice(i+a)),d=r.reshape(c),f=o.reshape([-1]),[4,BS(f)];case 1:return h=m.sent(),v=h.squeeze([1]),p=ky(d,v,i),t!==r&&r.dispose(),e!==o&&o.dispose(),v.dispose(),d.dispose(),f.dispose(),h.dispose(),[2,p]}})})};function VS(t,e,n,r,o,i,a){i===void 0&&(i="NHWC"),I(t.length===e.rank,function(){return"Length of inShape ("+t.length+") and rank of dy ("+e.rank+") must match"});var s=t,u=e,l=!1;e.rank===3&&(l=!0,u=e.as4D(1,e.shape[0],e.shape[1],e.shape[2]),s=[1,t[0],t[1],t[2]]),I(s.length===4,function(){return"Error in conv2dDerInput: inShape must be length 4, but got length "+s.length+"."}),I(u.rank===4,function(){return"Error in conv2dDerInput: dy must be rank 4, but got rank "+u.rank}),I(n.rank===4,function(){return"Error in conv2dDerInput: filter must be rank 4, but got rank "+n.rank});var c=i==="NHWC"?s[3]:s[1],d=i==="NHWC"?u.shape[3]:u.shape[1];I(c===n.shape[2],function(){return"Error in conv2dDerInput: depth of input ("+c+") must match input depth for filter "+n.shape[2]+"."}),I(d===n.shape[3],function(){return"Error in conv2dDerInput: depth of output ("+d+") must match output depth for filter "+n.shape[3]+"."}),a!=null&&I(dt(o),function(){return"Error in conv2dDerInput: pad must be an integer when using, dimRoundingMode "+a+" but got pad "+o+"."});var f=gy(i),h=Na(s,n.shape,r,1,o,a,!1,f),v=L.runKernelFunc(function(p,m){var g=p.conv2dDerInput(u,n,h);return m([n,u]),g},{dy4D:u,filter:n},function(p,m){var g=m[0],y=m[1];return{dy4D:function(){return Zn(p,g,r,o,i,1,a)},filter:function(){return Ry(p,y,g.shape,r,o,i,a)}}});return l?v.as3D(v.shape[1],v.shape[2],v.shape[3]):v}function Ip(t){var e=function(i){return typeof i=="number"?[i,i,i]:i.length===2?[i[0],i[1],1]:i}(t),n=e[0],r=e[1],o=e[2];return n===1&&r===1&&o===1}function HS(t,e,n,r,o){I(t.length===e.rank,function(){return"Length of inShape ("+t.length+") and rank of dy ("+e.rank+") must match"});var i=t,a=e,s=!1;e.rank===4&&(s=!0,a=e.as5D(1,e.shape[0],e.shape[1],e.shape[2],e.shape[3]),i=[1,t[0],t[1],t[2],t[3]]);var u=i[4],l=a.shape[4];I(i.length===5,function(){return"Error in conv3dDerInput: inShape must be length 5, but got length "+i.length+"."}),I(a.rank===5,function(){return"Error in conv3dDerInput: dy must be rank 5, but got rank "+a.rank}),I(n.rank===5,function(){return"Error in conv3dDerInput: filter must be rank 5, but got rank "+n.rank}),I(u===n.shape[3],function(){return"Error in conv3dDerInput: depth of input ("+u+") must match input depth for filter "+n.shape[3]+"."}),I(l===n.shape[4],function(){return"Error in conv3dDerInput: depth of output ("+l+") must match output depth for filter "+n.shape[4]+"."});var c=df(i,n.shape,r,1,o),d=L.runKernelFunc(function(f){return f.conv3dDerInput(a,n,c)},{dy5D:a});return s?d.as4D(d.shape[1],d.shape[2],d.shape[3],d.shape[4]):d}var LW=O({conv1d_:function(t,e,n,r,o,i,a){o===void 0&&(o="NWC"),i===void 0&&(i=1);var s=T(t,"x","conv1d"),u=T(e,"filter","conv1d"),l=s,c=!1;s.rank===2&&(c=!0,l=s.as3D(1,s.shape[0],s.shape[1])),I(l.rank===3,function(){return"Error in conv1d: input must be rank 3, but got rank "+l.rank+"."}),I(u.rank===3,function(){return"Error in conv1d: filter must be rank 3, but got rank "+u.rank+"."}),a!=null&&I(dt(r),function(){return"Error in conv1d: pad must be an integer when using, dimRoundingMode "+a+" but got pad "+r+"."}),I(l.shape[2]===u.shape[1],function(){return"Error in conv1d: depth of input ("+l.shape[2]+") must match input depth for filter "+u.shape[1]+"."}),I(En(n,i),function(){return"Error in conv1D: Either stride or dilation must be 1. Got stride "+n+" and dilation '"+i+"'"}),I(o==="NWC",function(){return"Error in conv1d: got dataFormat of "+o+" but only NWC is currently supported."});var d=u.as4D(1,u.shape[0],u.shape[1],u.shape[2]),f=l.as4D(l.shape[0],1,l.shape[1],l.shape[2]),h=Zn(f,d,[1,n],r,"NHWC",[1,i],a);return c?h.as2D(h.shape[2],h.shape[3]):h.as3D(h.shape[0],h.shape[2],h.shape[3])}}),Zn=O({conv2d_:function(t,e,n,r,o,i,a){o===void 0&&(o="NHWC"),i===void 0&&(i=[1,1]);var s=T(t,"x","conv2d"),u=T(e,"filter","conv2d"),l=s,c=!1;s.rank===3&&(c=!0,l=s.as4D(1,s.shape[0],s.shape[1],s.shape[2])),I(l.rank===4,function(){return"Error in conv2d: input must be rank 4, but got rank "+l.rank+"."}),I(u.rank===4,function(){return"Error in conv2d: filter must be rank 4, but got rank "+u.rank+"."}),a!=null&&I(dt(r),function(){return"Error in conv2d: pad must be an integer when using, dimRoundingMode "+a+" but got pad "+r+"."});var d=o==="NHWC"?l.shape[3]:l.shape[1];I(d===u.shape[2],function(){return"Error in conv2d: depth of input ("+d+") must match input depth for filter "+u.shape[2]+"."}),I(En(n,i),function(){return"Error in conv2D: Either strides or dilations must be 1. Got strides "+n+" and dilations '"+i+"'"});var f=gy(o),h=Na(l.shape,u.shape,n,i,r,a,!1,f),v=[u,l],p=L.runKernelFunc(function(m,g){var y=m.conv2d(l,u,h);return g([u,l]),y},{x:l,filter:u},function(m,g){var y=g,w=y[0],x=y[1];return I(iu(i),function(){return"Error in gradient of conv2D: dilation rates greater than 1 are not yet supported in gradients. Got dilations '"+i+"'"}),{x:function(){return GS(x.shape,m,w,n,r,o)},filter:function(){return Ry(x,m,w.shape,n,r,o)}}},"Conv2D",h,v);return c?p.as3D(p.shape[1],p.shape[2],p.shape[3]):p}}),BW=O({conv3d_:function(t,e,n,r,o,i){o===void 0&&(o="NDHWC"),i===void 0&&(i=[1,1,1]);var a=T(t,"x","conv3d"),s=T(e,"filter","conv3d"),u=a,l=!1;a.rank===4&&(l=!0,u=a.as5D(1,a.shape[0],a.shape[1],a.shape[2],a.shape[3])),I(u.rank===5,function(){return"Error in conv3d: input must be rank 5, but got rank "+u.rank+"."}),I(s.rank===5,function(){return"Error in conv3d: filter must be rank 5, but got rank "+s.rank+"."}),I(u.shape[4]===s.shape[3],function(){return"Error in conv3d: depth of input ("+u.shape[4]+") must match input depth for filter "+s.shape[3]+"."}),I(function(f,h){return Ip(f)||Ip(h)}(n,i),function(){return"Error in conv3D: Either strides or dilations must be 1. Got strides "+n+" and dilations '"+i+"'"}),I(o==="NDHWC",function(){return"Error in conv3d: got dataFormat of "+o+" but only NDHWC is currently supported."});var c=df(u.shape,s.shape,n,i,r),d=L.runKernelFunc(function(f,h){var v=f.conv3d(u,s,c);return h([u,s]),v},{x:u,$filter:s},function(f,h){I(Ip(i),function(){return"Error in gradient of conv3D: dilation rates greater than 1 are not yet supported in gradients. Got dilations '"+i+"'"});var v=h[0],p=h[1];return{x:function(){return HS(v.shape,f,p,n,r)},$filter:function(){return function(m,g,y,w,x){var b=m;m.rank===4&&(b=m.as5D(1,m.shape[0],m.shape[1],m.shape[2],m.shape[3]));var _=g;_.rank===4&&(_=g.as5D(1,g.shape[0],g.shape[1],g.shape[2],g.shape[3])),I(b.rank===5,function(){return"Error in conv3dDerFilter: input must be rank 5, but got shape "+b.shape+"."}),I(_.rank===5,function(){return"Error in conv3dDerFilter: dy must be rank 5, but got shape "+_.shape+"."}),I(y.length===5,function(){return"Error in conv3dDerFilter: filterShape must be length 5, but got "+y+"."}),I(b.shape[4]===y[3],function(){return"Error in conv3dDerFilter: depth of input "+b.shape[4]+") must match input depth in filter ("+y[3]+"."}),I(_.shape[4]===y[4],function(){return"Error in conv3dDerFilter: depth of dy ("+_.shape[4]+") must match output depth for filter ("+y[4]+")."});var E=df(b.shape,y,w,1,x);return L.runKernelFunc(function(C){return C.conv3dDerFilter(b,_,E)},{x5D:b,dy5D:_})}(v,f,p.shape,n,r)}}});return l?d.as4D(d.shape[1],d.shape[2],d.shape[3],d.shape[4]):d}}),Ry=O({conv2dDerFilter_:function(t,e,n,r,o,i,a){i===void 0&&(i="NHWC");var s=t;t.rank===3&&(s=t.as4D(1,t.shape[0],t.shape[1],t.shape[2]));var u=e;u.rank===3&&(u=e.as4D(1,e.shape[0],e.shape[1],e.shape[2])),I(s.rank===4,function(){return"Error in conv2dDerFilter: input must be rank 4, but got shape "+s.shape+"."}),I(u.rank===4,function(){return"Error in conv2dDerFilter: dy must be rank 4, but got shape "+u.shape+"."}),I(n.length===4,function(){return"Error in conv2dDerFilter: filterShape must be length 4, but got "+n+"."});var l=i==="NHWC"?s.shape[3]:s.shape[1],c=i==="NHWC"?u.shape[3]:u.shape[1];I(l===n[2],function(){return"Error in conv2dDerFilter: depth of input "+l+") must match input depth in filter ("+n[2]+"."}),I(c===n[3],function(){return"Error in conv2dDerFilter: depth of dy ("+c+") must match output depth for filter ("+n[3]+")."}),a!=null&&I(dt(o),function(){return"Error in conv2dDerFilter: pad must be an integer when using, dimRoundingMode "+a+" but got pad "+o+"."});var d=gy(i),f=Na(s.shape,n,r,1,o,a,!1,d);return L.runKernelFunc(function(h){return h.conv2dDerFilter(s,u,f)},{x4D:s,dy4D:u})}}),GS=O({conv2dDerInput_:VS}),ah=O({depthwiseConv2d_:function(t,e,n,r,o,i,a){i===void 0&&(i=[1,1]);var s=T(t,"x","depthwiseConv2d"),u=T(e,"filter","depthwiseConv2d"),l=s,c=!1;s.rank===3&&(c=!0,l=s.as4D(1,s.shape[0],s.shape[1],s.shape[2])),I(l.rank===4,function(){return"Error in depthwiseConv2d: input must be rank 4, but got rank "+l.rank+"."}),I(u.rank===4,function(){return"Error in depthwiseConv2d: filter must be rank 4, but got rank "+u.rank+"."}),I(l.shape[3]===u.shape[2],function(){return"Error in depthwiseConv2d: number of input channels ("+l.shape[3]+") must match the inChannels dimension in filter "+u.shape[2]+"."}),i==null&&(i=[1,1]),I(En(n,i),function(){return"Error in depthwiseConv2d: Either strides or dilations must be 1. Got strides "+n+" and dilations '"+i+"'"}),a!=null&&I(dt(r),function(){return"Error in depthwiseConv2d: pad must be an integer when using, dimRoundingMode "+a+" but got pad "+r+"."});var d=Na(l.shape,u.shape,n,i,r,a,!0),f=[l,u],h=L.runKernelFunc(function(v,p){var m=v.depthwiseConv2D(l,u,d);return p([l,u]),m},{x:l,filter:u},function(v,p){I(iu(i),function(){return"Error in gradient of depthwiseConv2d: dilation rates greater than 1 are not yet supported. Got dilations '"+i+"'"});var m=p[0],g=p[1];return{x:function(){return qS(m.shape,v,g,d)},filter:function(){return KS(m,v,g.shape,d)}}},"DepthwiseConv2dNative",d,f);return c?h.as3D(h.shape[1],h.shape[2],h.shape[3]):h}}),qS=O({depthwiseConv2dDerInput_:function(t,e,n,r){var o=e,i=!1;e.rank===3&&(i=!0,o=e.as4D(1,e.shape[0],e.shape[1],e.shape[2]));var a=L.runKernelFunc(function(s){return s.depthwiseConv2DDerInput(o,n,r)},{dy4D:o});return i?a.as3D(a.shape[1],a.shape[2],a.shape[3]):a}}),KS=O({depthwiseConv2dDerFilter_:function(t,e,n,r){var o=t;t.rank===3&&(o=t.as4D(1,t.shape[0],t.shape[1],t.shape[2]));var i=e;return i.rank===3&&(i=e.as4D(1,e.shape[0],e.shape[1],e.shape[2])),L.runKernelFunc(function(a){return a.depthwiseConv2DDerFilter(o,i,r)},{x4D:o,dy4D:i})}}),Ty=O({separableConv2d_:function(t,e,n,r,o,i,a){i===void 0&&(i=[1,1]),a===void 0&&(a="NHWC");var s=T(t,"x","separableConv2d"),u=T(e,"depthwiseFilter","separableConv2d"),l=T(n,"pointwiseFilter","separableConv2d"),c=s,d=!1;if(s.rank===3&&(d=!0,c=s.as4D(1,s.shape[0],s.shape[1],s.shape[2])),a==="NCHW")throw new Error("separableConv2d currently does not support dataFormat NCHW; only NHWC is supported");I(c.rank===4,function(){return"Error in separableConv2d: input must be rank 4, but got rank "+c.rank+"."}),I(u.rank===4,function(){return"Error in separableConv2d: depthwise filter must be rank 4, but got rank "+u.rank+"."}),I(l.rank===4,function(){return"Error in separableConv2d: pointwise filter must be rank 4, but got rank "+u.rank+"."}),I(l.shape[0]===1,function(){return"Error in separableConv2d: the first dimension of pointwise filter  must be 1, but got "+l.shape[0]+"."}),I(l.shape[1]===1,function(){return"Error in separableConv2d: the second dimension of pointwise filter must be 1, but got "+l.shape[1]+"."});var f=u.shape[2],h=u.shape[3];I(l.shape[2]===f*h,function(){return"Error in separableConv2d: the third dimension of pointwise filter must be "+f*h+", but got "+l.shape[2]+"."});var v=ah(c,u,r,o,a,i),p=Zn(v,l,1,"valid",a);return d?p.as3D(p.shape[1],p.shape[2],p.shape[3]):p}}),$W=O({conv2dTranspose_:function(t,e,n,r,o,i){return VS(n,T(t,"x","conv2dTranspose"),T(e,"filter","conv2dTranspose"),r,o,"NHWC",i)}}),jW=O({conv3dTranspose_:function(t,e,n,r,o){return HS(n,T(t,"x","conv3dTranspose"),T(e,"filter","conv3dTranspose"),r,o)}}),sh=O({matMul_:function(t,e,n,r){var o;n===void 0&&(n=!1),r===void 0&&(r=!1);var i=T(t,"a","matMul"),a=T(e,"b","matMul");o=at(i,a),i=o[0],a=o[1];var s=n?i.shape[i.rank-2]:i.shape[i.rank-1],u=r?a.shape[a.rank-1]:a.shape[a.rank-2],l=n?i.shape[i.rank-1]:i.shape[i.rank-2],c=r?a.shape[a.rank-2]:a.shape[a.rank-1],d=i.shape.slice(0,-2),f=a.shape.slice(0,-2),h=se(d),v=se(f);I(i.rank>=2&&a.rank>=2&&i.rank===a.rank,function(){return"Error in matMul: inputs must have the same rank of at least 2, got ranks "+i.rank+" and "+a.rank+"."}),I(At(d,f),function(){return"Error in matMul: outer dimensions ("+d+") and ("+f+") of Tensors with shapes "+i.shape+" and "+a.shape+" must match."}),I(s===u,function(){return"Error in matMul: inner shapes ("+s+") and ("+u+") of Tensors with shapes "+i.shape+" and "+a.shape+" and transposeA="+n+" and transposeB="+r+" must match."});var p=i.shape.slice(0,-2).concat([l,c]),m=n?i.as3D(h,s,l):i.as3D(h,l,s),g=r?a.as3D(v,c,u):a.as3D(v,u,c),y={transposeA:n,transposeB:r};return L.runKernelFunc(function(w,x){var b=w.batchMatMul(m,g,n,r);return x([m,g]),b},{a:m,b:g},function(w,x){var b=x,_=b[0],E=b[1];return n||r?!n&&r?{a:function(){return w.matMul(E,!1,!1)},b:function(){return w.matMul(_,!0,!1)}}:n&&!r?{a:function(){return E.matMul(w,!1,!0)},b:function(){return _.matMul(w,!1,!1)}}:{a:function(){return E.matMul(w,!0,!0)},b:function(){return w.matMul(_,!0,!0)}}:{a:function(){return w.matMul(E,!1,!0)},b:function(){return _.matMul(w,!0,!1)}}},"BatchMatMul",y).reshape(p)}}),WW=O({dot_:function(t,e){var n=T(t,"t1","dot"),r=T(e,"t2","dot");I(!(n.rank!==1&&n.rank!==2||r.rank!==1&&r.rank!==2),function(){return"Error in dot: inputs must all be rank 1 or 2, but got ranks "+n.rank+" and "+r.rank+"."});var o=n.rank===1?n.size:n.shape[1],i=r.rank===1?r.size:r.shape[0];return I(o===i,function(){return"Error in dot: inner dimensions of inputs must match, but got "+o+" and "+i+"."}),n.rank===1&&r.rank===1?n.as2D(1,-1).matMul(r.as2D(-1,1)).asScalar():n.rank===1&&r.rank===2?n.as2D(1,-1).matMul(r.as2D(r.shape[0],r.shape[1])).as1D():n.rank===2&&r.rank===1?n.matMul(r.as2D(-1,1)).as1D():n.matMul(r.as2D(r.shape[0],r.shape[1]))}}),UW=O({outerProduct_:function(t,e){var n=T(t,"v1","outerProduct"),r=T(e,"v2","outerProduct");return I(n.rank===1&&r.rank===1,function(){return"Error in outerProduct: inputs must be rank 1, but got ranks "+n.rank+" and "+r.rank+"."}),n.as2D(-1,1).matMul(r.as2D(1,-1))}}),ec=O({reverse_:function(t,e){var n=T(t,"x","reverse");if(n.rank===0)return n.clone();var r=kt(e,n.shape);return L.runKernelFunc(function(o){return o.reverse(n,r)},{$x:n},function(o){return{$x:function(){return o.reverse(r)}}}).reshapeAs(n)}}),zW=O({reverse1d_:function(t){var e=T(t,"x","reverse");return I(e.rank===1,function(){return"Error in reverse1D: x must be rank 1 but got rank "+e.rank+"."}),ec(e,0)}}),VW=O({reverse2d_:function(t,e){var n=T(t,"x","reverse");return I(n.rank===2,function(){return"Error in reverse2D: x must be rank 2 but got rank "+n.rank+"."}),ec(n,e)}}),HW=O({reverse3d_:function(t,e){var n=T(t,"x","reverse");return I(n.rank===3,function(){return"Error in reverse3D: x must be rank 3 but got rank "+n.rank+"."}),ec(n,e)}}),GW=O({reverse4d_:function(t,e){var n=T(t,"x","reverse");return I(n.rank===4,function(){return"Error in reverse4D: x must be rank 4 but got rank "+n.rank+"."}),ec(n,e)}});function XS(t,e,n,r,o,i){var a=T(t,"x","maxPool"),s=a,u=!1;a.rank===3&&(u=!0,s=a.as4D(1,a.shape[0],a.shape[1],a.shape[2])),I(s.rank===4,function(){return"Error in maxPool: input must be rank 4 but got rank "+s.rank+"."}),I(En(n,r),function(){return"Error in maxPool: Either strides or dilations must be 1. Got strides "+n+" and dilations '"+r+"'"}),i!=null&&I(dt(o),function(){return"Error in maxPool: pad must be an integer when using, dimRoundingMode "+i+" but got pad "+o+"."});var l=Il(s.shape,e,n,r,o,i);if(l.filterWidth===1&&l.filterHeight===1&&At(l.inShape,l.outShape))return a.clone();var c=[s],d=L.runKernelFunc(function(f,h){var v=f.maxPool(s,l);return h([s,v]),v},{x:s},function(f,h){var v=h[0],p=h[1];return{x:function(){return function(m,g,y,w,x,b,_,E){var C=T(m,"dy","maxPoolBackprop"),R=T(g,"input","maxPoolBackprop"),S=T(y,"output","maxPoolBackprop");I(R.rank===C.rank,function(){return"Rank of input ("+R.rank+") does not match rank of dy ("+C.rank+")"}),I(En(x,b),function(){return"Error in maxPoolBackProp: Either strides or dilations must be 1. Got strides "+x+" and dilations '"+b+"'"}),I(C.rank===4,function(){return"Error in maxPoolBackprop: dy must be rank 4 but got rank "+C.rank+"."}),I(R.rank===4,function(){return"Error in maxPoolBackprop: input must be rank 4 but got rank "+R.rank+"."});var P=Il(R.shape,w,x,b,_,E);return L.runKernelFunc(function(A){return A.maxPoolBackprop(C,R,S,P)},{$dy:C,$input:R})}(f,v,p,e,n,r,o)}}},"MaxPool",l,c);return u?d.as3D(d.shape[1],d.shape[2],d.shape[3]):d}function YS(t,e,n,r,o,i){var a=T(t,"x","avgPool","float32");I(En(n,r),function(){return"Error in avgPool: Either strides or dilations must be 1. Got strides "+n+" and dilations '"+r+"'"});var s=a,u=!1;a.rank===3&&(u=!0,s=a.as4D(1,a.shape[0],a.shape[1],a.shape[2])),I(s.rank===4,function(){return"Error in avgPool: x must be rank 4 but got rank "+s.rank+"."}),i!=null&&I(dt(o),function(){return"Error in avgPool: pad must be an integer when using, dimRoundingMode "+i+" but got pad "+o+"."});var l=Il(s.shape,e,n,r,o,i);if(l.filterWidth===1&&l.filterHeight===1&&At(l.inShape,l.outShape))return a.clone();var c=L.runKernelFunc(function(d){return d.avgPool(s,l)},{x:s},function(d){return{x:function(){return function(f,h,v,p,m,g){var y=T(f,"dy","avgPoolBackprop"),w=T(h,"input","avgPoolBackprop");I(w.rank===y.rank,function(){return"Rank of input ("+w.rank+") does not match rank of dy ("+y.rank+")"}),I(En(p,m),function(){return"Error in avgPoolBackprop: Either strides or dilations must be 1. Got strides "+p+" and dilations '"+m+"'"});var x=w,b=y,_=!1;w.rank===3&&(_=!0,x=w.as4D(1,w.shape[0],w.shape[1],w.shape[2]),b=y.as4D(1,y.shape[0],y.shape[1],y.shape[2])),I(b.rank===4,function(){return"Error in avgPoolBackprop: dy must be rank 4 but got rank "+b.rank+"."}),I(x.rank===4,function(){return"Error in avgPoolBackprop: input must be rank 4 but got rank "+x.rank+"."});var E=Il(x.shape,v,p,m,g),C=L.runKernelFunc(function(R){return R.avgPoolBackprop(b,x,E)},{dy4D:b,input4D:x});return _?C.as3D(C.shape[1],C.shape[2],C.shape[3]):C}(d,s,e,n,r,o)}}},"AvgPool",l);return c=c.cast(a.dtype),u?c.as3D(c.shape[1],c.shape[2],c.shape[3]):c}var Rt=O({maxPool_:function(t,e,n,r,o){return XS(t,e,n,1,r,o)}}),tc=O({avgPool_:function(t,e,n,r,o){return YS(t,e,n,1,r,o)}}),qW=O({pool_:function(t,e,n,r,o,i){o==null&&(o=[1,1]),i==null&&(i=1),r===0&&(r="valid");var a=T(t,"x","maxPool"),s=a,u=!1;a.rank===3&&(u=!0,s=a.as4D(1,a.shape[0],a.shape[1],a.shape[2])),I(En(i,o),function(){return"Error in pool: Either strides or dilations must be 1. Got strides "+i+" and dilations '"+o+"'"});var l,c=Il(s.shape,e,i,o,r),d=[c.dilationHeight,c.dilationWidth];l=r==="same"?function(x,b){var _=x.map(function(R,S){return R+(R-1)*(b[S]-1)}).map(function(R){return R-1}),E=_.map(function(R){return Math.floor(R/2)}),C=_.map(function(R,S){return R-E[S]});return _.map(function(R,S){return[E[S],C[S]]})}([c.filterHeight,c.filterWidth],d):[[0,0],[0,0]];var f=d[0]===1&&d[1]===1,h=function(x,b,_){var E=_.map(function(M){return M[0]}),C=_.map(function(M){return M[1]}),R=x.concat(E,C),S=b.map(function(M,j){return(M-R[j]%M)%M}),P=C.map(function(M,j){return M+S[j]}),A=b.map(function(M,j){return[E[j],P[j]]}),B=b.map(function(M,j){return[0,S[j]]});return[A,B]}([c.inHeight,c.inWidth],d,l),v=h[0],p=h[1],m=f?r:"valid",g=f?s:nS(s,d,v),y=(n==="avg"?function(){return YS(g,e,i,1,m)}:function(){return XS(g,e,i,1,m)})(),w=f?y:ZC(y,d,p);return u?w.as3D(w.shape[1],w.shape[2],w.shape[3]):w}}),KW=O({maxPool3d_:function(t,e,n,r,o,i,a){i===void 0&&(i="NDHWC");var s=T(t,"x","maxPool3d"),u=s,l=!1;s.rank===4&&(l=!0,u=s.as5D(1,s.shape[0],s.shape[1],s.shape[2],s.shape[3])),a==null&&(a=[1,1,1]),I(u.rank===5,function(){return"Error in maxPool3d: x must be rank 5 but got rank "+u.rank+"."}),I(i==="NDHWC",function(){return"Error in maxPool3d: Only NDHWC is currently supported, but got dataFormat of "+i}),I(En(n,a),function(){return"Error in maxPool3d: Either strides or dilations must be 1. Got strides "+n+" and dilations '"+a+"'"}),o!=null&&I(dt(r),function(){return"Error in maxPool3d: pad must be an integer when using, dimRoundingMode "+o+" but got pad "+r+"."});var c=cf(u.shape,e,n,a,r,o,i),d=L.runKernelFunc(function(f,h){var v=f.maxPool3d(u,c);return h([u,v]),v},{x:u},function(f,h){var v=h[0],p=h[1];return{x:function(){return function(m,g,y,w,x,b,_,E){var C=T(m,"dy","maxPool3dBackprop"),R=T(g,"input","maxPool3dBackprop"),S=T(y,"output","maxPool3dBackprop"),P=C,A=R,B=S,M=!1;R.rank===4&&(M=!0,P=C.as5D(1,C.shape[0],C.shape[1],C.shape[2],C.shape[3]),A=R.as5D(1,R.shape[0],R.shape[1],R.shape[2],R.shape[3]),B=S.as5D(1,S.shape[0],S.shape[1],S.shape[2],S.shape[3])),I(P.rank===5,function(){return"Error in maxPool3dBackprop: dy must be rank 5 but got rank "+P.rank+"."}),I(A.rank===5,function(){return"Error in maxPool3dBackprop: input must be rank 5 but got rank "+A.rank+"."}),I(B.rank===5,function(){return"Error in maxPool3dBackprop: output must be rank 5 but got rank "+B.rank+"."}),b==null&&(b=[1,1,1]),I(En(x,b),function(){return"Error in maxPool3dBackprop: Either strides or dilations must be 1. Got strides "+x+" and dilations '"+b+"'"}),E!=null&&I(dt(_),function(){return"Error in maxPool3dBackprop: pad must be an integer when using, dimRoundingMode "+E+" but got pad "+_+"."});var j=cf(A.shape,w,x,b,_,E),W=L.runKernelFunc(function(U){return U.maxPool3dBackprop(P,A,B,j)},{dy5D:P,input5D:A});return M?W.as4D(W.shape[1],W.shape[2],W.shape[3],W.shape[4]):W}(f,v,p,e,n,a,r,o)}}});return l?d.as4D(d.shape[1],d.shape[2],d.shape[3],d.shape[4]):d}}),XW=O({avgPool3d_:function(t,e,n,r,o,i,a){i===void 0&&(i="NDHWC");var s=T(t,"x","avgPool3d","float32"),u=s,l=!1;s.rank===4&&(l=!0,u=s.as5D(1,s.shape[0],s.shape[1],s.shape[2],s.shape[3])),a==null&&(a=[1,1,1]),I(u.rank===5,function(){return"Error in avgPool3d: x must be rank 5 but got rank "+u.rank+"."}),I(i==="NDHWC",function(){return"Error in avgPool3d: Only NDHWC is currently supported, but got dataFormat of "+i}),I(En(n,a),function(){return"Error in avgPool3d: Either strides or dilations must be 1. Got strides "+n+" and dilations '"+a+"'"}),o!=null&&I(dt(r),function(){return"Error in avgPool3d: pad must be an integer when using, dimRoundingMode "+o+" but got pad "+r+"."});var c=cf(u.shape,e,n,a,r,o,i),d=L.runKernelFunc(function(f){return f.avgPool3d(u,c)},{x:u},function(f){return{x:function(){return function(h,v,p,m,g,y,w){var x=T(h,"dy","avgPool3dBackprop"),b=T(v,"input","avgPool3dBackprop"),_=x,E=b,C=!1;b.rank===4&&(C=!0,_=x.as5D(1,x.shape[0],x.shape[1],x.shape[2],x.shape[3]),E=b.as5D(1,b.shape[0],b.shape[1],b.shape[2],b.shape[3])),I(_.rank===5,function(){return"Error in avgPool3dBackprop: dy must be rank 5 but got rank "+_.rank+"."}),I(E.rank===5,function(){return"Error in avgPool3dBackprop: input must be rank 5 but got rank "+E.rank+"."}),g==null&&(g=[1,1,1]),I(En(m,g),function(){return"Error in avgPool3dBackprop: Either strides or dilations must be 1. Got strides "+m+" and dilations '"+g+"'"}),w!=null&&I(dt(y),function(){return"Error in maxPool3dBackprop: pad must be an integer when using, dimRoundingMode "+w+" but got pad "+y+"."});var R=cf(E.shape,p,m,g,y,w),S=L.runKernelFunc(function(P){return P.avgPool3dBackprop(_,E,R)},{dy5D:_,input5D:E});return C?S.as4D(S.shape[1],S.shape[2],S.shape[3],S.shape[4]):S}(f,u,e,n,a,r,o)}}});return d=d.cast(u.dtype),l?d.as4D(d.shape[1],d.shape[2],d.shape[3],d.shape[4]):d}}),Xr=O({slice_:function(t,e,n){var r,o,i=T(t,"x","slice");if(i.rank===0)throw new Error("Slicing scalar is not possible");(r=typeof e=="number"?[e].concat(new Array(i.rank-1).fill(0)):e.length<i.rank?e.concat(new Array(i.rank-e.length).fill(0)):e.slice()).forEach(function(u){I(u!==-1,function(){return"slice() does not support negative begin indexing."})}),o=(o=n==null?new Array(i.rank).fill(-1):typeof n=="number"?[n].concat(new Array(i.rank-1).fill(-1)):n.length<i.rank?n.concat(new Array(i.rank-n.length).fill(-1)):n).map(function(u,l){return u>=0?u:(I(u===-1,function(){return"Negative size values should be exactly -1 but got "+u+" for the slice() size at index "+l+"."}),i.shape[l]-r[l])}),EB(i,r,o);var a=i.shape,s={begin:r,size:o};return L.runKernelFunc(function(u){return u.slice(i,r,o)},{x:i},function(u){for(var l=[],c=0;c<u.rank;c++)l.push([r[c],a[c]-r[c]-o[c]]);return{x:function(){return u.pad(l)}}},"Slice",s)}}),YW=O({slice1d_:function(t,e,n){var r=T(t,"x","slice1d");return I(r.rank===1,function(){return"slice1d expects a rank-1 tensor, but got a rank-"+r.rank+" tensor"}),Xr(r,[e],[n])}}),QW=O({slice2d_:function(t,e,n){var r=T(t,"x","slice2d");return I(r.rank===2,function(){return"slice2d expects a rank-2 tensor, but got a rank-"+r.rank+" tensor"}),Xr(r,e,n)}}),QS=O({slice3d_:function(t,e,n){var r=T(t,"x","slice3d");return I(r.rank===3,function(){return"slice3d expects a rank-3 tensor, but got a rank-"+r.rank+" tensor"}),Xr(r,e,n)}}),JW=O({slice4d_:function(t,e,n){var r=T(t,"x","slice4d");return I(r.rank===4,function(){return"slice4d expects a rank-4 tensor, but got a rank-"+r.rank+" tensor"}),Xr(r,e,n)}});function JS(t,e,n,r,o){return e.rank<n.rank&&(e=e.reshape(_n(e.shape,r))),t.rank<n.rank&&(t=t.reshape(_n(t.shape,r))),{x:function(){var i=t.mul(n.equal(e).cast(t.dtype));return o==null?i:i.transpose(o)}}}var ZW=O({all_:function(t,e,n){e===void 0&&(e=null),n===void 0&&(n=!1);var r=T(t,"x","all","bool"),o=kt(e,r.shape),i=o,a=Jr(i,r.rank);a!=null&&(r=r.transpose(a),i=Zr(i.length,r.rank));var s=L.runKernelFunc(function(l){return l.all(r,i)},{$x:r});if(n){var u=_n(s.shape,o);return s.reshape(u)}return s}}),eU=O({any_:function(t,e,n){e===void 0&&(e=null),n===void 0&&(n=!1);var r=T(t,"x","any","bool"),o=kt(e,r.shape),i=o,a=Jr(i,r.rank);a!=null&&(r=r.transpose(a),i=Zr(i.length,r.rank));var s=L.runKernelFunc(function(l){return l.any(r,i)},{$x:r});if(n){var u=_n(s.shape,o);return s.reshape(u)}return s}}),tU=O({argMax_:function(t,e){e===void 0&&(e=0);var n=T(t,"x","argMax");e==null&&(e=0);var r=kt(e,n.shape),o=Jr(r,n.rank);o!=null&&(n=n.transpose(o),r=Zr(r.length,n.rank));var i={axis:r[0]},a=[n];return L.runKernelFunc(function(s,u){var l=s.argMax(n,r[0]);return u([n]),l},{x:n},function(s,u){var l=u[0];return{x:function(){return Ne(l)}}},"ArgMax",i,a)}}),nU=O({argMin_:function(t,e){e===void 0&&(e=0);var n=T(t,"x","argMin");e==null&&(e=0);var r=kt(e,n.shape),o=Jr(r,n.rank);return o!=null&&(n=n.transpose(o),r=Zr(r.length,n.rank)),L.runKernelFunc(function(i,a){var s=i.argMin(n,r[0]);return a([n]),s},{$x:n},function(i,a){var s=a[0];return{$x:function(){return Ne(s)}}})}}),rU=O({logSumExp_:function(t,e,n){e===void 0&&(e=null),n===void 0&&(n=!1);var r=T(t,"x","logSumExp"),o=kt(e,r.shape),i=r.max(o,!0),a=r.sub(i).exp().sum(o).log(),s=i.reshape(a.shape).add(a);if(n){var u=_n(s.shape,o);return s.reshape(u)}return s}}),uh=O({max_:function(t,e,n){e===void 0&&(e=null),n===void 0&&(n=!1);var r=T(t,"x","max"),o=r,i=kt(e,r.shape),a=i,s=Jr(a,r.rank);s!=null&&(r=r.transpose(s),a=Zr(a.length,r.rank));var u=[r],l=L.runKernelFunc(function(d,f){var h=d.max(r,a);return f([o,h]),h},{x:r},function(d,f){return JS(d,f[1],f[0],i,s)},"Max",{axes:a},u,[!0]);if(n){var c=_n(l.shape,i);l=l.reshape(c)}return l}}),oU=O({mean_:function(t,e,n){e===void 0&&(e=null),n===void 0&&(n=!1);var r=T(t,"x","mean"),o=kt(e,r.shape),i=se(Ht(r.shape,o)[1]);return rh(function(a){var s=ee(i);return{value:(s.dtype===a.dtype?a:a.cast(s.dtype)).div(s).sum(e,n),gradFunc:function(u){var l=a.shape.slice();return o.forEach(function(c){l[c]=1}),u.reshape(l).mul(gu(a.shape,"float32")).div(i)}}})(r)}}),iU=O({min_:function(t,e,n){e===void 0&&(e=null),n===void 0&&(n=!1);var r=T(t,"x","min"),o=r,i=kt(e,r.shape),a=i,s=Jr(a,r.rank);s!=null&&(r=r.transpose(s),a=Zr(a.length,r.rank));var u=[r],l=L.runKernelFunc(function(d,f){var h=d.min(r,a);return f([o,h]),h},{x:r},function(d,f){return JS(d,f[1],f[0],i,s)},"Min",{axes:a},u,[!0]);if(n){var c=_n(l.shape,i);l=l.reshape(c)}return l}}),aU=O({moments_:function(t,e,n){e===void 0&&(e=null),n===void 0&&(n=!1);var r=kt(e,(t=T(t,"x","moments")).shape),o=t.mean(r,n),i=o.shape;n||(i=_n(o.shape,r));var a=t.toFloat().sub(o.reshape(i)).square();return{mean:o,variance:a.mean(r,n)}}}),ZS=O({sum_:function(t,e,n){e===void 0&&(e=null),n===void 0&&(n=!1);var r=T(t,"x","sum");r.dtype==="bool"&&(r=r.toInt());var o=kt(e,r.shape);return rh(function(i){var a=Jr(o,i.rank),s=o,u=i;a!=null&&(u=i.transpose(a),s=Zr(s.length,i.rank));var l=function(h){var v=i.shape.slice();return o.forEach(function(p){v[p]=1}),h.reshape(v).mul(gu(i.shape,"float32"))},c={axes:s},d=L.runKernelFunc(function(h){return h.sum(u,s)},{x:u},function(h){return{x:function(){return l(h)}}},"Sum",c);if(n){var f=_n(d.shape,o);d=d.reshape(f)}return{value:d,gradFunc:l}})(r)}}),sU=O({prod_:function(t,e,n){e===void 0&&(e=null),n===void 0&&(n=!1);var r=T(t,"x","prod");r.dtype==="bool"&&(r=r.toInt());var o=kt(e,r.shape),i=Jr(o,r.rank),a=o,s=r;i!=null&&(s=r.transpose(i),a=Zr(a.length,r.rank));var u=L.runKernelFunc(function(c){return c.prod(s,a)},{permutedX:s});if(n){var l=_n(u.shape,o);u=u.reshape(l)}return u}}),ek=O({elu_:function(t){var e=T(t,"x","elu");return L.runKernelFunc(function(n,r){var o=n.elu(e);return r([o]),o},{$x:e},function(n,r){var o=r[0];return{$x:function(){return L.runKernelFunc(function(i){return i.eluDer(n,o)},{dy:n,y:o})}}})}}),uU=O({leakyRelu_:function(t,e){e===void 0&&(e=.2);var n=T(t,"x","leakyRelu");return Sy(ee(e).mul(n),n)}}),tk=O({prelu_:function(t,e){var n=T(t,"x","prelu"),r=T(e,"alpha","prelu");return L.runKernelFunc(function(o,i){var a=o.prelu(n,r);return i([n,r]),a},{x:n,alpha:r},function(o,i){var a=i[0],s=i[1],u=a.greater(0);return{x:function(){return Ca(u,o,o.mul(s))},alpha:function(){var l=Ca(u,Ne(o),o.mul(a)),c=Ct(s.shape,o.shape);return c.length>0&&(l=l.sum(c)),l.reshape(s.shape)}}},"Prelu")}}),rt=O({relu_:function(t){var e=T(t,"x","relu");return e.dtype==="bool"?e.toInt():L.runKernelFunc(function(n,r){var o=n.relu(e);return r([e]),o},{x:e},function(n,r){var o=r[0];return{x:function(){return n.mulStrict(o.step().toFloat())}}},"Relu")}}),nk=O({relu6_:function(t){var e=T(t,"x","relu6");return e.dtype==="bool"?e.toInt():L.runKernelFunc(function(n,r){var o=n.relu6(e);return r([e]),o},{x:e},function(n,r){var o=r[0],i=o.lessEqual(6).mul(o.step());return{x:function(){return n.mulStrict(i.toFloat())}}},"Relu6")}}),lU=O({selu_:function(t){var e=T(t,"x","selu");return L.runKernelFunc(function(n,r){var o=n.selu(e);return r([e]),o},{$x:e},function(n,r){var o=r[0];return{$x:function(){var i=o.greater(ee(0)),a=ee(_y),s=ee(Ey),u=n.mul(s),l=n.mul(a).mul(o.toFloat().exp());return Ca(i,u,l)}}})}}),Ii=O({transpose_:function(t,e){var n=T(t,"x","transpose");if(e==null&&(e=n.shape.map(function(o,i){return i}).reverse()),I(n.rank===e.length,function(){return"Error in transpose: rank of input "+n.rank+" must match length of perm "+e+"."}),e.forEach(function(o){I(o>=0&&o<n.rank,function(){return"All entries in 'perm' must be between 0 and "+(n.rank-1)+" but got "+e})}),n.rank<=1)return n.clone();var r={perm:e};return L.runKernelFunc(function(o){return o.transpose(n,e)},{x:n},function(o){var i=fy(e);return{x:function(){return o.transpose(i)}}},"Transpose",r)}}),cU=O({localResponseNormalization_:function(t,e,n,r,o){e===void 0&&(e=5),n===void 0&&(n=1),r===void 0&&(r=1),o===void 0&&(o=.5);var i=T(t,"x","localResponseNormalization");I(i.rank===4||i.rank===3,function(){return`Error in localResponseNormalization: x must be rank 3 or 4 but got
               rank `+i.rank+"."}),I(dt(e),function(){return"Error in localResponseNormalization: depthRadius must be an integer but got depthRadius "+e+"."});var a=i,s=!1;i.rank===3&&(s=!0,a=i.as4D(1,i.shape[0],i.shape[1],i.shape[2]));var u=L.runKernelFunc(function(l,c){var d=l.localResponseNormalization4D(a,e,n,r,o);return c([a,d]),d},{x4D:a},function(l,c){var d=c[0],f=c[1];return{x4D:function(){return L.runKernelFunc(function(h){return h.LRNGrad(l,d,f,e,n,r,o)},{})}}});return s?u.as3D(u.shape[1],u.shape[2],u.shape[3]):u}}),rk=O({norm_:function(t,e,n,r){e===void 0&&(e="euclidean"),n===void 0&&(n=null),r===void 0&&(r=!1);var o=function s(u,l,c){if(c===void 0&&(c=null),u.rank===0)return u.abs();if(u.rank!==1&&c===null)return s(u.reshape([-1]),l,c);if(u.rank===1||typeof c=="number"||Array.isArray(c)&&c.length===1){if(l===1)return u.abs().sum(c);if(l===1/0)return u.abs().max(c);if(l===-1/0)return u.abs().min(c);if(l==="euclidean"||l===2)return u.abs().pow(ee(2,"int32")).sum(c).sqrt();throw new Error("Error in norm: invalid ord value: "+l)}if(Array.isArray(c)&&c.length===2){if(l===1)return u.abs().sum(c[0]).max(c[1]-1);if(l===1/0)return u.abs().sum(c[1]).max(c[0]);if(l===-1/0)return u.abs().sum(c[1]).min(c[0]);if(l==="fro"||l==="euclidean")return u.square().sum(c).sqrt();throw new Error("Error in norm: invalid ord value: "+l)}throw new Error("Error in norm: invalid axis: "+c)}(t=T(t,"x","norm"),e,n),i=o.shape;if(r){var a=kt(n,t.shape);i=_n(o.shape,a)}return o.reshape(i)}}),dU=O({basicLSTMCell_:function(t,e,n,r,o,i){var a=T(t,"forgetBias","basicLSTMCell"),s=T(e,"lstmKernel","basicLSTMCell"),u=T(n,"lstmBias","basicLSTMCell"),l=T(r,"data","basicLSTMCell"),c=T(o,"c","basicLSTMCell"),d=T(i,"h","basicLSTMCell"),f=l.concat(d,1).matMul(s).add(u),h=f.shape[0],v=f.shape[1]/4,p=[h,v],m=f.slice([0,0],p),g=f.slice([0,v],p),y=f.slice([0,2*v],p),w=f.slice([0,3*v],p),x=m.sigmoid().mulStrict(g.tanh()).addStrict(c.mulStrict(a.add(y).sigmoid())),b=x.tanh().mulStrict(w.sigmoid());return[x,b]}}),fU=O({multiRNNCell_:function(t,e,n,r){for(var o=T(e,"data","multiRNNCell"),i=rf(n,"c","multiRNNCell"),a=rf(r,"h","multiRNNCell"),s=o,u=[],l=0;l<t.length;l++){var c=t[l](s,i[l],a[l]);u.push(c[0]),u.push(c[1]),s=c[1]}var d=[],f=[];for(l=0;l<u.length;l+=2)d.push(u[l]),f.push(u[l+1]);return[d,f]}}),hU=O({movingAverage_:function(t,e,n,r,o){o===void 0&&(o=!0);var i=T(t,"v","movingAverage"),a=T(e,"x","movingAverage"),s=T(n,"decay","movingAverage");cL(i,a),I(At(i.shape,a.shape),function(){return"Shape mismatch in v and x"});var u=ee(1),l=u.sub(s),c=a.sub(i).mul(l);if(o){I(r!=null,function(){return"When using zeroDebias: true, step is required."});var d=T(r,"step","movingAverage");c=c.div(u.sub(pf(s,d)))}return i.add(c)}}),pU=O({stridedSlice_:function(t,e,n,r,o,i,a,s,u){if(o===void 0&&(o=0),i===void 0&&(i=0),a===void 0&&(a=0),s===void 0&&(s=0),u===void 0&&(u=0),r==null&&(r=new Array(e.length)),a!==0)throw new Error("ellipsis mask is not yet supported");var l=T(t,"x","stridedSlice"),c=Xw(s),d=l.shape.slice();c.forEach(function(m){e[m]=0,n[m]=1,d.splice(m,0,1)}),l=l.reshape(d);for(var f=0;f<l.rank;f++)e[f]=CB(o,e,r,l.shape,f),n[f]=SB(i,n,r,l.shape,f),r[f]=r[f]||1;var h=Xw(u);h.forEach(function(m){n[m]=e[m]+1,r[m]=1});var v=my(e,n,r),p=v.filter(function(m,g){return h.indexOf(g)===-1});return r.every(function(m){return m===1})?Xr(l,e,v).reshape(p):L.runKernelFunc(function(m){return m.stridedSlice(l,e,n,r)},{$x:l}).reshape(p)}}),vU=O({topk_:function(t,e,n){e===void 0&&(e=1),n===void 0&&(n=!0);var r=T(t,"x","topk");if(r.rank===0)throw new Error("topk() expects the input to be of rank 1 or higher");var o=r.shape[r.shape.length-1];if(e>o)throw new Error("'k' passed to topk() must be <= the last dimension ("+o+") but got "+e);var i=L.runKernelFunc(function(a){return a.topk(r,e,n)},{$x:r});return{values:i[0],indices:i[1]}}}),mU=O({scatterND_:function(t,e,n){var r=T(t,"indices","scatterND","int32"),o=T(e,"updates","scatterND");return _B(o,r,n),L.runKernelFunc(function(i){return i.scatterND(r,o,n)},{indices:r,updates:o},null,"ScatterNd",{shape:n})}}),Iy=O({fft_:function(t){I(t.dtype==="complex64",function(){return"The dtype for tf.spectral.fft() must be complex64 but got "+t.dtype+"."});var e=t.shape[t.shape.length-1],n=t.size/e,r=t.as2D(n,e);return L.runKernelFunc(function(o){return o.fft(r)},{input:t}).reshape(t.shape)}}),vf=O({ifft_:function(t){I(t.dtype==="complex64",function(){return"The dtype for tf.spectral.ifft() must be complex64 but got "+t.dtype+"."});var e=t.shape[t.shape.length-1],n=t.size/e,r=t.as2D(n,e);return L.runKernelFunc(function(o){return o.ifft(r)},{input:t}).reshape(t.shape)}}),Ay=O({rfft_:function(t,e){I(t.dtype==="float32",function(){return"The dtype for rfft() must be real value but got "+t.dtype});var n,r=t.shape[t.shape.length-1],o=t.size/r;if(e!=null&&e<r){var i=t.shape.map(function(g){return 0}),a=t.shape.map(function(g){return g});a[t.shape.length-1]=e,n=t.slice(i,a),r=e}else if(e!=null&&e>r){var s=t.shape.map(function(g){return g});s[t.shape.length-1]=e-r,n=t.concat(Ye(s),t.shape.length-1),r=e}else n=t;var u=n.zerosLike(),l=Ft(n,u).as2D(o,r),c=Iy(l),d=Math.floor(r/2)+1,f=Hn(c),h=$r(c),v=f.split([d,r-d],f.shape.length-1),p=h.split([d,r-d],h.shape.length-1),m=n.shape.slice();return m[n.shape.length-1]=d,Ft(v[0],p[0]).reshape(m)}}),ok=O({irfft_:function(t){var e=t.shape[t.shape.length-1],n=t.size/e;if(e<=2){var r=t.as2D(n,e),o=vf(r);return Hn(o)}var i=[n,2*(e-1)],a=Hn(t).as2D(n,e),s=$r(t).as2D(n,e),u=a.slice([0,1],[n,e-2]).reverse(1),l=s.slice([0,1],[n,e-2]).reverse(1).mul(ee(-1)),c=a.concat(u,1),d=s.concat(l,1);return r=Ft(c,d).as2D(i[0],i[1]),o=vf(r),Hn(o)}}),gU=Object.freeze({fft:Iy,ifft:vf,rfft:Ay,irfft:ok}),yU=O({sparseToDense_:function(t,e,n,r){r===void 0&&(r=0);var o=T(t,"sparseIndices","sparseToDense","int32"),i=T(e,"sparseValues","sparseToDense"),a=T(r,"defaultValue","sparseToDense",i.dtype);return function(s,u,l,c){if(s.dtype!=="int32")throw new Error("tf.sparseToDense() expects the indices to be int32 type, but the dtype was "+s.dtype+".");if(s.rank>2)throw new Error("sparseIndices should be a scalar, vector, or matrix, but got shape "+s.shape+".");var d=s.rank>0?s.shape[0]:1,f=s.rank>1?s.shape[1]:1;if(l.length!==f)throw new Error("outputShape has incorrect number of elements:, "+l.length+", should be: "+f+".");var h=u.size;if(u.rank!==0&&(u.rank!==1||h!==d))throw new Error("sparseValues has incorrect shape "+u.shape+", should be [] or ["+d+"]");if(u.dtype!==c.dtype)throw new Error("sparseValues.dtype must match defaultValues.dtype")}(o,i,n,a),L.runKernelFunc(function(s){return s.sparseToDense(o,i,n,a)},{$sparseIndices:o,$sparseValues:i,$defaultValue:a})}}),wU=O({gatherND_:function(t,e){var n=T(e,"indices","gatherND","int32"),r=T(t,"x","gatherND");return L.runKernelFunc(function(o){return o.gatherND(r,n)},{x:r,indices:n},null,"GatherNd")}}),xU=O({diag_:function(t){var e=T(t,"x","diag").flatten(),n=t.shape.concat(t.shape);return L.runKernelFunc(function(r){return r.diag(e)},{$x:e}).reshape(n)}}),bU=O({dropout_:function(t,e,n,r){var o=T(t,"x","dropout");if(I(o.dtype==="float32",function(){return"x has to be a floating point tensor since it's going to be scaled, but got a "+o.dtype+" tensor instead."}),I(e>=0&&e<1,function(){return"rate must be a float in the range [0, 1), but got "+e+"."}),e===0)return t instanceof nt?o.clone():o;var i=function(u,l){if(l==null)return u.shape.slice();if(At(u.shape,l))return l;if(u.shape.length===l.length){for(var c=[],d=0;d<u.shape.length;d++)l[d]==null&&u.shape[d]!=null?c.push(u.shape[d]):c.push(l[d]);return c}return l}(o,n),a=1-e,s=tS(i,0,1,"float32",r).add(a).floor().div(a);return o.mul(s)}});function ik(t,e,n){for(var r=1-t%2,o=new Float32Array(t),i=0;i<t;++i){var a=2*Math.PI*i/(t+r-1);o[i]=e-n*Math.cos(a)}return pt(o,"float32")}var Py=O({hannWindow_:function(t){return ik(t,.5,.5)}}),ak=O({hammingWindow_:function(t){return ik(t,.54,.46)}}),Dy=O({frame_:function(t,e,n,r,o){r===void 0&&(r=!1),o===void 0&&(o=0);for(var i=0,a=[];i+e<=t.size;)a.push(Xr(t,i,e)),i+=n;if(r)for(;i<t.size;){var s=i+e-t.size,u=_t([Xr(t,i,e-s),qr([s],o)]);a.push(u),i+=n}return a.length===0?_i([],[0,e]):_t(a).as2D(a.length,e)}}),sk=O({stft_:function(t,e,n,r,o){var i;o===void 0&&(o=Py),r==null&&(i=e,r=Math.floor(Math.pow(2,Math.ceil(Math.log(i)/Math.log(2)))));for(var a=Dy(t,e,n),s=Yt(a,o(e)),u=[],l=0;l<a.shape[0];l++)u.push(Ay(s.slice([l,0],[1,e]),r));return _t(u)}}),_U=Object.freeze({hannWindow:Py,hammingWindow:ak,frame:Dy,stft:sk}),Xt,EU=function(t,e,n){return n===void 0&&(n=1),ie(this,void 0,void 0,function(){var r,o,i,a,s,u,l,c,d,f,h,v,p,m;return ae(this,function(g){switch(g.label){case 0:return r=T(t,"predictions","inTopK"),o=T(e,"targets","inTopK"),I(r.rank>1,function(){return"inTopK() expects the predictions to be of rank 2 or higher, but got "+r.rank}),I(r.rank-1===o.rank,function(){return"predictions rank should be 1 larger than targets rank, but got predictions rank "+r.rank+" and targets rank "+o.rank}),Le(r.shape.slice(0,r.shape.length-1),o.shape,"predictions's shape should be align with the targets' shape, except the last dimension."),i=r.shape[r.shape.length-1],I(n>0&&n<=i,function(){return"'k' passed to inTopK() must be > 0 && <= the predictions last dimension ("+i+"), but got "+n}),[4,r.data()];case 1:return a=g.sent(),[4,o.data()];case 2:for(s=g.sent(),u=[a.length/i,i],c=u[1],d=kl("bool",l=u[0]),f=0;f<l;f++){for(h=f*c,v=a.subarray(h,h+c),p=[],m=0;m<v.length;m++)p.push({value:v[m],index:m});for(p.sort(function(y,w){return w.value-y.value}),d[f]=0,m=0;m<n;m++)if(p[m].index===s[f]){d[f]=1;break}}return t!==r&&r.dispose(),e!==o&&o.dispose(),[2,Lt(d,o.shape,"bool")]}})})};(function(t){t[t.NONE=0]="NONE",t[t.MEAN=1]="MEAN",t[t.SUM=2]="SUM",t[t.SUM_BY_NONZERO_WEIGHTS=3]="SUM_BY_NONZERO_WEIGHTS"})(Xt||(Xt={}));var CU=O({absoluteDifference_:function(t,e,n,r){r===void 0&&(r=Xt.SUM_BY_NONZERO_WEIGHTS);var o=T(t,"labels","absoluteDifference"),i=T(e,"predictions","absoluteDifference"),a=null;n!=null&&(a=T(n,"weights","absoluteDifference")),Le(o.shape,i.shape,"Error in absoluteDifference: ");var s=o.sub(i).abs();return To(s,a,r)}}),To=O({computeWeightedLoss_:function(t,e,n){n===void 0&&(n=Xt.SUM_BY_NONZERO_WEIGHTS);var r=T(t,"losses","computeWeightedLoss"),o=null;e!=null&&(o=T(e,"weights","computeWeightedLoss"));var i=o==null?r:r.mul(o);if(n===Xt.NONE)return i;if(n===Xt.SUM)return i.sum();if(n===Xt.MEAN){if(o==null)return i.mean();var a=r.size/o.size,s=i.sum().div(o.sum());return a>1?s.div(ee(a)):s}if(n===Xt.SUM_BY_NONZERO_WEIGHTS){if(o==null)return i.sum().div(ee(r.size));var u=o.mul(gu(r.shape)).notEqual(ee(0)).sum().toFloat();return i.sum().div(u)}throw Error("Unknown reduction: "+n)}}),SU=O({cosineDistance_:function(t,e,n,r,o){o===void 0&&(o=Xt.SUM_BY_NONZERO_WEIGHTS);var i=T(t,"labels","cosineDistance"),a=T(e,"predictions","cosineDistance"),s=null;r!=null&&(s=T(r,"weights","cosineDistance")),Le(i.shape,a.shape,"Error in cosineDistance: ");var u=ee(1).sub(i.mul(a).sum(n,!0));return To(u,s,o)}}),kU=O({hingeLoss_:function(t,e,n,r){r===void 0&&(r=Xt.SUM_BY_NONZERO_WEIGHTS);var o=T(t,"labels","hingeLoss"),i=T(e,"predictions","hingeLoss"),a=null;n!=null&&(a=T(n,"weights","hingeLoss")),Le(o.shape,i.shape,"Error in hingeLoss: ");var s=ee(1);o=ee(2).mul(o).sub(s);var u=s.sub(o.mul(i)).relu();return To(u,a,r)}}),RU=O({huberLoss_:function(t,e,n,r,o){r===void 0&&(r=1),o===void 0&&(o=Xt.SUM_BY_NONZERO_WEIGHTS);var i=T(t,"labels","huberLoss"),a=T(e,"predictions","huberLoss"),s=null;n!=null&&(s=T(n,"weights","huberLoss")),Le(i.shape,a.shape,"Error in huberLoss: ");var u=ee(r),l=a.sub(i).abs(),c=jS(l,u),d=l.sub(c),f=ee(.5).mul(c.square()).add(u.mul(d));return To(f,s,o)}}),TU=O({logLoss_:function(t,e,n,r,o){r===void 0&&(r=1e-7),o===void 0&&(o=Xt.SUM_BY_NONZERO_WEIGHTS);var i=T(t,"labels","logLoss"),a=T(e,"predictions","logLoss"),s=null;n!=null&&(s=T(n,"weights","logLoss")),Le(i.shape,a.shape,"Error in logLoss: ");var u=ee(1),l=ee(r),c=i.mul(a.add(l).log()).neg().sub(u.sub(i).mul(u.sub(a).add(l).log()));return To(c,s,o)}}),IU=O({meanSquaredError_:function(t,e,n,r){r===void 0&&(r=Xt.SUM_BY_NONZERO_WEIGHTS);var o=T(t,"labels","meanSquaredError"),i=T(e,"predictions","meanSquaredError"),a=null;n!=null&&(a=T(n,"weights","meanSquaredError")),Le(o.shape,i.shape,"Error in meanSquaredError: ");var s=o.squaredDifference(i);return To(s,a,r)}}),AU=O({sigmoidCrossEntropy_:function(t,e,n,r,o){r===void 0&&(r=0),o===void 0&&(o=Xt.SUM_BY_NONZERO_WEIGHTS);var i=T(t,"multiClassLabels","sigmoidCrossEntropy"),a=T(e,"logits","sigmoidCrossEntropy"),s=null;if(n!=null&&(s=T(n,"weights","sigmoidCrossEntropy")),Le(i.shape,a.shape,"Error in sigmoidCrossEntropy: "),r>0){var u=ee(r),l=ee(1),c=ee(.5);i=i.mul(l.sub(u)).add(c.mul(u))}var d=function(f,h){var v=T(f,"labels","sigmoidCrossEntropyWithLogits"),p=T(h,"logits","sigmoidCrossEntropyWithLogits");Le(v.shape,p.shape,"Error in sigmoidCrossEntropyWithLogits: ");var m=p.relu(),g=p.mul(v),y=p.abs().neg().exp().log1p();return m.sub(g).add(y)}(i,a);return To(d,s,o)}}),PU=O({softmaxCrossEntropy_:function(t,e,n,r,o){r===void 0&&(r=0),o===void 0&&(o=Xt.SUM_BY_NONZERO_WEIGHTS);var i=T(t,"onehotLabels","softmaxCrossEntropy"),a=T(e,"logits","softmaxCrossEntropy"),s=null;if(n!=null&&(s=T(n,"weights","softmaxCrossEntropy")),Le(i.shape,a.shape,"Error in softmaxCrossEntropy: "),r>0){var u=ee(r),l=ee(1),c=ee(i.shape[1]);i=i.mul(l.sub(u)).add(u.div(c))}var d=function(f,h,v){if(v===void 0&&(v=-1),v===-1&&(v=h.rank-1),v!==h.rank-1)throw Error("Softmax cross entropy along a non-last dimension is not yet supported. Labels / logits was rank "+h.rank+" and dim was "+v);return rh(function(p,m,g){var y=m.logSumExp([v],!0),w=m.toFloat().sub(y);return g([p,w]),{value:w.mul(p).neg().sum([v]),gradFunc:function(x,b){var _=b[0],E=b[1],C=_n(x.shape,[v]);return[x.reshape(C).mul(_.toFloat().sub(E.exp())),x.reshape(C).mul(E.exp().sub(_.toFloat()))]}}})(f,h)}(i,a);return To(d,s,o)}}),DU=Object.freeze({get Reduction(){return Xt},absoluteDifference:CU,computeWeightedLoss:To,cosineDistance:SU,hingeLoss:kU,huberLoss:RU,logLoss:TU,meanSquaredError:IU,sigmoidCrossEntropy:AU,softmaxCrossEntropy:PU});function gx(t,e){return e===void 0&&(e=!1),L.tidy(function(){if(t.shape.length!==2)throw new Error("qr2d() requires a 2D Tensor, but got a "+t.shape.length+"D Tensor.");for(var n=t.shape[0],r=t.shape[1],o=eS(n),i=t.clone(),a=_i([[1]],[1,1]),s=a.clone(),u=n>=r?r:n,l=function(d){var f,h=i,v=s,p=o;f=L.tidy(function(){var m=i.slice([d,d],[n-d,1]),g=m.norm(),y=i.slice([d,d],[1,1]),w=_i([[-1]]).where(y.greater(0),_i([[1]])),x=y.sub(w.mul(g)),b=m.div(x);s=b.shape[0]===1?a.clone():a.concat(b.slice([1,0],[b.shape[0]-1,b.shape[1]]),0);var _=w.matMul(x).div(g).neg(),E=i.slice([d,0],[n-d,r]),C=_.mul(s);if(d===0)i=E.sub(C.matMul(s.transpose().matMul(E)));else{var R=E.sub(C.matMul(s.transpose().matMul(E)));i=i.slice([0,0],[d,r]).concat(R,0)}var S=o.slice([0,d],[n,o.shape[1]-d]);if(d===0)o=S.sub(S.matMul(s).matMul(C.transpose()));else{var P=S.sub(S.matMul(s).matMul(C.transpose()));o=o.slice([0,0],[n,d]).concat(P,1)}return[s,i,o]}),s=f[0],i=f[1],o=f[2],bn([h,v,p])},c=0;c<u;++c)l(c);return!e&&n>r&&(o=o.slice([0,0],[n,r]),i=i.slice([0,0],[r,r])),[o,i]})}var NU=O({bandPart_:function(t,e,n){if(e%1!=0)throw new Error("bandPart(): numLower must be an integer, got "+e+".");if(n%1!=0)throw new Error("bandPart(): numUpper must be an integer, got "+n+".");var r=T(t,"a","bandPart");if(r.rank<2)throw new Error("bandPart(): Rank must be at least 2, got "+r.rank+".");var o=r.shape,i=r.shape.slice(-2),a=i[0],s=i[1];if(!(e<=a))throw new Error("bandPart(): numLower ("+e+") must not be greater than the number of rows ("+a+").");if(!(n<=s))throw new Error("bandPart(): numUpper ("+n+") must not be greater than the number of columns ("+s+").");e<0&&(e=a),n<0&&(n=s);var u=of(0,a,1,"int32").reshape([-1,1]),l=of(0,s,1,"int32"),c=St(u,l),d=ih(c.lessEqual(ee(+e,"int32")),c.greaterEqual(ee(-n,"int32"))),f=Ye([a,s],r.dtype);return Fn(Et(r.reshape([-1,a,s])).map(function(h){return Ca(d,h,f)})).reshape(o)}}),OU=O({gramSchmidt_:function(t){var e;if(Array.isArray(t)){e=!1,I(t!=null&&t.length>0,function(){return"Gram-Schmidt process: input must not be null, undefined, or empty"});for(var n=t[0].shape[0],r=function(u){I(t[u].shape[0]===n,function(){return"Gram-Schmidt: Non-unique lengths found in the input vectors: ("+t[u].shape[0]+" vs. "+n+")"})},o=1;o<t.length;++o)r(o)}else e=!0,t=py(t,t.shape[0],0).map(function(u){return rS(u,[0])});I(t.length<=t[0].shape[0],function(){return"Gram-Schmidt: Number of vectors ("+t.length+") exceeds number of dimensions ("+t[0].shape[0]+")."});var i=[],a=t,s=function(u){i.push(L.tidy(function(){var l=a[u];if(u>0)for(var c=0;c<u;++c){var d=ZS(i[c].mulStrict(l)).mul(i[c]);l=l.sub(d)}return l.div(rk(l,"euclidean"))}))};for(o=0;o<t.length;++o)s(o);return e?Fn(i,0):i}}),FU=O({qr_:function(t,e){if(e===void 0&&(e=!1),t.rank<2)throw new Error("qr() requires input tensor to have a rank >= 2, but got rank "+t.rank);if(t.rank===2)return gx(t,e);var n=t.shape.slice(0,t.shape.length-2).reduce(function(a,s){return a*s}),r=Et(t.reshape([n,t.shape[t.shape.length-2],t.shape[t.shape.length-1]]),0),o=[],i=[];return r.forEach(function(a){var s=gx(a,e),u=s[0],l=s[1];o.push(u),i.push(l)}),[Fn(o,0).reshape(t.shape),Fn(i,0).reshape(t.shape)]}}),MU=Object.freeze({bandPart:NU,gramSchmidt:OU,qr:FU});function lh(t,e,n,r,o,i){r==null&&(r=.5),o==null&&(o=Number.NEGATIVE_INFINITY),i==null&&(i=0);var a=t.shape[0];return n=Math.min(n,a),I(0<=r&&r<=1,function(){return"iouThreshold must be in [0, 1], but was '"+r+"'"}),I(t.rank===2,function(){return"boxes must be a 2D tensor, but was of rank '"+t.rank+"'"}),I(t.shape[1]===4,function(){return"boxes must have 4 columns, but 2nd dimension was "+t.shape[1]}),I(e.rank===1,function(){return"scores must be a 1D tensor"}),I(e.shape[0]===a,function(){return"scores has incompatible shape with boxes. Expected "+a+", but was "+e.shape[0]}),I(0<=i&&i<=1,function(){return"softNmsSigma must be in [0, 1], but was '"+i+"'"}),{maxOutputSize:n,iouThreshold:r,scoreThreshold:o,softNmsSigma:i}}var LU=O({resizeBilinear_:function(t,e,n){n===void 0&&(n=!1);var r=T(t,"images","resizeBilinear");I(r.rank===3||r.rank===4,function(){return"Error in resizeBilinear: x must be rank 3 or 4, but got rank "+r.rank+"."}),I(e.length===2,function(){return"Error in resizeBilinear: new shape must 2D, but got shape "+e+"."});var o=r,i=!1;r.rank===3&&(i=!0,o=r.as4D(1,r.shape[0],r.shape[1],r.shape[2]));var a=e[0],s=e[1],u=L.runKernelFunc(function(l,c){return c([o]),l.resizeBilinear(o,a,s,n)},{x:o},function(l,c){return{x:function(){return L.runKernelFunc(function(d){return d.resizeBilinearBackprop(l,c[0],n)},{})}}},"ResizeBilinear",{alignCorners:n,newHeight:a,newWidth:s});return i?u.as3D(u.shape[1],u.shape[2],u.shape[3]):u}}),BU=O({resizeNearestNeighbor_:function(t,e,n){n===void 0&&(n=!1);var r=T(t,"images","resizeNearestNeighbor");I(r.rank===3||r.rank===4,function(){return"Error in resizeNearestNeighbor: x must be rank 3 or 4, but got rank "+r.rank+"."}),I(e.length===2,function(){return"Error in resizeNearestNeighbor: new shape must 2D, but got shape "+e+"."}),I(r.dtype==="float32"||r.dtype==="int32",function(){return"`images` must have `int32` or `float32` as dtype"});var o=r,i=!1;r.rank===3&&(i=!0,o=r.as4D(1,r.shape[0],r.shape[1],r.shape[2]));var a=e[0],s=e[1],u=L.runKernelFunc(function(l,c){return c([o]),l.resizeNearestNeighbor(o,a,s,n)},{batchImages:o},function(l,c){return{batchImages:function(){return L.runKernelFunc(function(d){return d.resizeNearestNeighborBackprop(l,c[0],n)},{})}}});return i?u.as3D(u.shape[1],u.shape[2],u.shape[3]):u}}),$U=O({nonMaxSuppression_:function(t,e,n,r,o){r===void 0&&(r=.5),o===void 0&&(o=Number.NEGATIVE_INFINITY);var i=T(t,"boxes","nonMaxSuppression"),a=T(e,"scores","nonMaxSuppression"),s=lh(i,a,n,r,o);n=s.maxOutputSize,r=s.iouThreshold,o=s.scoreThreshold;var u={maxOutputSize:n,iouThreshold:r,scoreThreshold:o};return L.runKernelFunc(function(l){return l.nonMaxSuppression(i,a,n,r,o)},{boxes:i,scores:a},null,"NonMaxSuppressionV3",u)}}),jU=function(t,e,n,r,o){return r===void 0&&(r=.5),o===void 0&&(o=Number.NEGATIVE_INFINITY),ie(this,void 0,void 0,function(){var i,a,s,u,l,c,d;return ae(this,function(f){switch(f.label){case 0:return i=T(t,"boxes","nonMaxSuppressionAsync"),a=T(e,"scores","nonMaxSuppressionAsync"),s=lh(i,a,n,r,o),n=s.maxOutputSize,r=s.iouThreshold,o=s.scoreThreshold,[4,Promise.all([i.data(),a.data()])];case 1:return u=f.sent(),l=u[0],c=u[1],d=yy(l,c,n,r,o),i!==t&&i.dispose(),a!==e&&a.dispose(),[2,d]}})})},WU=O({nonMaxSuppressionWithScore_:function(t,e,n,r,o,i){r===void 0&&(r=.5),o===void 0&&(o=Number.NEGATIVE_INFINITY),i===void 0&&(i=0);var a=T(t,"boxes","nonMaxSuppression"),s=T(e,"scores","nonMaxSuppression"),u=lh(a,s,n,r,o,i),l={maxOutputSize:n=u.maxOutputSize,iouThreshold:r=u.iouThreshold,scoreThreshold:o=u.scoreThreshold,softNmsSigma:i=u.softNmsSigma},c=L.runKernel("NonMaxSuppressionV5",{boxes:a,scores:s},l);return{selectedIndices:c[0],selectedScores:c[1]}}}),UU=function(t,e,n,r,o,i){return r===void 0&&(r=.5),o===void 0&&(o=Number.NEGATIVE_INFINITY),i===void 0&&(i=0),ie(this,void 0,void 0,function(){var a,s,u,l,c,d,f;return ae(this,function(h){switch(h.label){case 0:return a=T(t,"boxes","nonMaxSuppressionAsync"),s=T(e,"scores","nonMaxSuppressionAsync"),u=lh(a,s,n,r,o,i),n=u.maxOutputSize,r=u.iouThreshold,o=u.scoreThreshold,i=u.softNmsSigma,[4,Promise.all([a.data(),s.data()])];case 1:return l=h.sent(),c=l[0],d=l[1],f=wy(c,d,n,r,o,i),a!==t&&a.dispose(),s!==e&&s.dispose(),[2,f]}})})},zU=O({cropAndResize_:function(t,e,n,r,o,i){var a=T(t,"image","cropAndResize"),s=T(e,"boxes","cropAndResize","float32"),u=T(n,"boxInd","cropAndResize","int32");o=o||"bilinear",i=i||0;var l=s.shape[0];return I(a.rank===4,function(){return"Error in cropAndResize: image must be rank 4,but got rank "+a.rank+"."}),I(s.rank===2&&s.shape[1]===4,function(){return"Error in cropAndResize: boxes must be have size ["+l+",4] but had shape "+s.shape+"."}),I(u.rank===1&&u.shape[0]===l,function(){return"Error in cropAndResize: boxInd must be have size ["+l+"] but had shape "+s.shape+"."}),I(r.length===2,function(){return"Error in cropAndResize: cropSize must be of length 2, but got length "+r.length+"."}),I(r[0]>=1&&r[1]>=1,function(){return"cropSize must be atleast [1,1], but was "+r}),I(o==="bilinear"||o==="nearest",function(){return"method must be bilinear or nearest, but was "+o}),L.runKernelFunc(function(c,d){return c.cropAndResize(a,s,u,r,o,i)},{images:a,boxes:s,boxInd:u},null,"CropAndResize",{method:o,extrapolationValue:i,cropSize:r})}}),Ny=Object.freeze({resizeBilinear:LU,resizeNearestNeighbor:BU,nonMaxSuppression:$U,nonMaxSuppressionAsync:jU,nonMaxSuppressionWithScore:WU,nonMaxSuppressionWithScoreAsync:UU,cropAndResize:zU}),Oy=function(t,e){return!(t>0)||e==="linear"},Fy=function(t,e,n){if(n==null||n==="linear")return t;if(n==="relu")return t.mul(e.step());throw new Error("Gradient for activation "+n+" has not been implemented yet.")},My=function(t,e){var n=e,r=Ct(t.shape,e.shape);return r.length>0&&(n=n.sum(r)),n.reshape(t.shape)},Ly=function(t,e,n){if(e==="linear")return t;if(e==="relu")return rt(t);if(e==="elu")return ek(t);if(e==="relu6")return nk(t);if(e==="prelu")return tk(t,n);throw new Error("Unknown fused activation "+e+".")},VU=O({fusedMatMul_:function(t){var e,n=t.a,r=t.b,o=t.transposeA,i=o!==void 0&&o,a=t.transposeB,s=a!==void 0&&a,u=t.bias,l=t.activation,c=l===void 0?"linear":l,d=t.preluActivationWeights;if(Oy(L.state.gradientDepth,c)===!1){var f=sh(n,r,i,s);return u!=null&&(f=ke(f,u)),Ly(f,c,d)}var h=T(n,"a","fused matMul"),v=T(r,"b","fused matMul");e=at(h,v),h=e[0],v=e[1];var p=i?h.shape[h.rank-2]:h.shape[h.rank-1],m=s?v.shape[v.rank-1]:v.shape[v.rank-2],g=i?h.shape[h.rank-1]:h.shape[h.rank-2],y=s?v.shape[v.rank-2]:v.shape[v.rank-1],w=h.shape.slice(0,-2),x=v.shape.slice(0,-2),b=se(w),_=se(x);I(h.rank>=2&&v.rank>=2&&h.rank===v.rank,function(){return"Error in fused matMul: inputs must have the same rank of at least 2, got ranks "+h.rank+" and "+v.rank+"."}),I(At(w,x),function(){return"Error in fused matMul: outer dimensions ("+w+") and ("+x+") of Tensors with shapes "+h.shape+" and "+v.shape+" must match."}),I(p===m,function(){return"Error in fused matMul: inner shapes ("+p+") and ("+m+") of Tensors with shapes "+h.shape+" and "+v.shape+" and transposeA="+i+" and transposeB="+s+" must match."});var E,C,R=h.shape.slice(0,-2).concat([g,y]),S=i?h.as3D(b,p,g):h.as3D(b,g,p),P=s?v.as3D(_,y,m):v.as3D(_,m,y);u!=null&&Te(R,(E=at(E=T(u,"bias","fused matMul"),h)[0]).shape),d!=null&&(C=T(d,"prelu weights","fused matMul"));var A={a:S,b:P};u!=null&&(A.bias=E),d!=null&&(A.preluActivationWeights=C);var B=[S,P];return L.runKernelFunc(function(M,j){var W=M.fusedBatchMatMul({a:S,b:P,transposeA:i,transposeB:s,bias:E,activation:c,preluActivationWeights:C});return j([S,P,W]),W},A,function(M,j){var W=j[0],U=j[1],D=j[2],F=Fy(M,D,c),$={};return u!=null&&($={bias:function(){return My(E,F)}}),Object.assign(i||s?!i&&s?{a:function(){return F.matMul(U,!1,!1)},b:function(){return F.matMul(W,!0,!1)}}:i&&!s?{a:function(){return U.matMul(F,!1,!0)},b:function(){return W.matMul(F,!1,!1)}}:{a:function(){return U.matMul(F,!0,!0)},b:function(){return F.matMul(W,!0,!0)}}:{a:function(){return F.matMul(U,!1,!0)},b:function(){return W.matMul(F,!0,!1)}},$)},"_FusedMatMul",{transposeA:i,transposeB:s,activation:c},B,[!0]).reshape(R)}}),HU=O({fusedConv2d_:function(t){var e=t.x,n=t.filter,r=t.strides,o=t.pad,i=t.dataFormat,a=i===void 0?"NHWC":i,s=t.dilations,u=s===void 0?[1,1]:s,l=t.dimRoundingMode,c=t.bias,d=t.activation,f=d===void 0?"linear":d,h=t.preluActivationWeights;if(f=f||"linear",Oy(L.state.gradientDepth,f)===!1){var v=Zn(e,n,r,o,a,u,l);return c!=null&&(v=ke(v,c)),Ly(v,f,h)}var p=T(e,"x","conv2d"),m=T(n,"filter","conv2d"),g=p,y=!1;p.rank===3&&(y=!0,g=p.as4D(1,p.shape[0],p.shape[1],p.shape[2])),I(g.rank===4,function(){return"Error in fused conv2d: input must be rank 4, but got rank "+g.rank+"."}),I(m.rank===4,function(){return"Error in fused conv2d: filter must be rank 4, but got rank "+m.rank+"."}),l!=null&&I(dt(o),function(){return"Error in fused conv2d: pad must be an integer when using, dimRoundingMode "+l+" but got pad "+o+"."}),I(g.shape[3]===m.shape[2],function(){return"Error in conv2d: depth of input ("+g.shape[3]+") must match input depth for filter "+m.shape[2]+"."}),I(En(r,u),function(){return"Error in conv2D: Either strides or dilations must be 1. Got strides "+r+" and dilations '"+u+"'"}),I(a==="NHWC",function(){return"Error in conv2d: got dataFormat of "+a+" but only NHWC is currently supported."});var w,x,b=Na(g.shape,m.shape,r,u,o,l);c!=null&&(w=at(w=T(c,"bias","fused conv2d"),p)[0],Te(b.outShape,w.shape)),h!=null&&(x=T(h,"prelu weights","fused conv2d"));var _={x:g,filter:m};c!=null&&(_.bias=w),h!=null&&(_.preluActivationWeights=x);var E=[m,g],C=L.runKernelFunc(function(R,S){var P=R.fusedConv2d({input:g,filter:m,convInfo:b,bias:w,activation:f,preluActivationWeights:x});return S([m,g,P]),P},_,function(R,S){var P=S,A=P[0],B=P[1],M=P[2],j=Fy(R,M,f);I(iu(u),function(){return"Error in gradient of fused conv2D: dilation rates greater than 1 are not yet supported in gradients. Got dilations '"+u+"'"});var W={};return c!=null&&(W={bias:function(){return My(w,j)}}),Object.assign({x:function(){return GS(B.shape,j,A,r,o)},filter:function(){return Ry(B,j,A.shape,r,o)}},W)},"FusedConv2D",{convInfo:b,activation:f},E,[!0]);return y?C.as3D(C.shape[1],C.shape[2],C.shape[3]):C}}),GU=O({fusedDepthwiseConv2d_:function(t){var e=t.x,n=t.filter,r=t.strides,o=t.pad,i=t.dataFormat,a=i===void 0?"NHWC":i,s=t.dilations,u=s===void 0?[1,1]:s,l=t.dimRoundingMode,c=t.bias,d=t.activation,f=d===void 0?"linear":d,h=t.preluActivationWeights;if(Oy(L.state.gradientDepth,f)===!1){var v=ah(e,n,r,o,a,u,l);return c!=null&&(v=ke(v,c)),Ly(v,f,h)}var p=T(e,"x","depthwiseConv2d"),m=T(n,"filter","depthwiseConv2d"),g=p,y=!1;p.rank===3&&(y=!0,g=p.as4D(1,p.shape[0],p.shape[1],p.shape[2])),I(g.rank===4,function(){return"Error in fused depthwiseConv2d: input must be rank 4, but got rank "+g.rank+"."}),I(m.rank===4,function(){return"Error in fused depthwiseConv2d: filter must be rank 4, but got rank "+m.rank+"."}),I(g.shape[3]===m.shape[2],function(){return"Error in fused depthwiseConv2d: number of input channels ("+g.shape[3]+") must match the inChannels dimension in filter "+m.shape[2]+"."}),u==null&&(u=[1,1]),I(En(r,u),function(){return"Error in fused depthwiseConv2d: Either strides or dilations must be 1. Got strides "+r+" and dilations '"+u+"'"}),l!=null&&I(dt(o),function(){return"Error in fused depthwiseConv2d: pad must be an integer when using dimRoundingMode "+l+" but got pad "+o+"."});var w,x,b=Na(g.shape,m.shape,r,u,o,l,!0);c!=null&&(w=at(w=T(c,"bias","fused conv2d"),p)[0],Te(b.outShape,w.shape)),h!=null&&(x=T(h,"prelu weights","fused depthwiseConv2d"));var _={x:g,filter:m};c!=null&&(_.bias=w),h!=null&&(_.preluActivationWeights=x);var E=[m,g],C=L.runKernelFunc(function(R,S){var P=R.fusedDepthwiseConv2D({input:g,filter:m,convInfo:b,bias:w,activation:f,preluActivationWeights:x});return S([m,g,P]),P},_,function(R,S){I(iu(u),function(){return"Error in gradient of fused depthwiseConv2d: dilation rates greater than 1 are not yet supported. Got dilations '"+u+"'"});var P=S[0],A=S[1],B=S[2],M=Fy(R,B,f),j={};return c!=null&&(j={bias:function(){return My(w,M)}}),Object.assign({x:function(){return qS(A.shape,M,P,b)},filter:function(){return KS(A,M,P.shape,b)}},j)},"FusedDepthwiseConv2D",{convInfo:b,activation:f},E,[!0]);return y?C.as3D(C.shape[1],C.shape[2],C.shape[3]):C}}),qU=Object.freeze({matMul:VU,conv2d:HU,depthwiseConv2d:GU}),KU=Object.freeze({image:Ny,linalg:MU,losses:DU,spectral:gU,fused:qU,signal:_U,square:Tj,squaredDifference:AS,conv1d:LW,conv2d:Zn,conv3d:BW,depthwiseConv2d:ah,separableConv2d:Ty,conv2dTranspose:$W,conv3dTranspose:jW,op:O,batchNormalization2d:oW,batchNormalization3d:iW,batchNormalization4d:aW,batchNormalization:sW,batchNorm:MS,batchNorm2d:uW,batchNorm3d:lW,batchNorm4d:cW,booleanMaskAsync:MW,complex:Ft,real:Hn,imag:$r,concat:_t,concat1d:qL,concat2d:KL,concat3d:XL,concat4d:YL,split:py,matMul:sh,dot:WW,outerProduct:UW,reverse:ec,reverse1d:zW,reverse2d:VW,reverse3d:HW,reverse4d:GW,maxPool:Rt,avgPool:tc,pool:qW,maxPool3d:KW,avgPool3d:XW,slice:Xr,slice1d:YW,slice2d:QW,slice3d:QS,slice4d:JW,abs:Ij,acos:Aj,acosh:Pj,asin:Dj,asinh:Nj,atan:Oj,atanh:Fj,ceil:Mj,clipByValue:Cy,cos:Lj,cosh:Bj,erf:$j,exp:Pm,expm1:jj,floor:Wj,log:Uj,log1p:zj,logSigmoid:Vj,neg:hf,reciprocal:Hj,round:Gj,rsqrt:PS,sigmoid:DS,sign:qj,isNaN:Kj,isInf:Xj,isFinite:Yj,sin:Qj,sinh:Jj,softplus:Zj,sqrt:eW,step:tW,tan:nW,tanh:rW,all:ZW,any:eU,argMax:tU,argMin:nU,logSumExp:rU,max:uh,mean:oU,min:iU,moments:aU,sum:ZS,prod:sU,equal:WS,equalStrict:kW,greater:RW,greaterEqual:US,greaterEqualStrict:TW,greaterStrict:IW,less:AW,lessEqual:PW,lessEqualStrict:DW,lessStrict:NW,notEqual:OW,notEqualStrict:FW,add:ke,addN:hW,addStrict:pW,atan2:vW,div:pr,divNoNan:mW,divStrict:gW,floorDiv:$S,maximum:Sy,maximumStrict:yW,minimum:jS,minimumStrict:wW,mod:xW,modStrict:bW,mul:Yt,mulStrict:_W,pow:pf,powStrict:EW,squaredDifferenceStrict:CW,sub:St,subStrict:SW,elu:ek,leakyRelu:uU,prelu:tk,relu:rt,relu6:nk,selu:lU,logicalAnd:ih,logicalNot:dW,logicalOr:LS,logicalXor:fW,where:Ca,whereAsync:BS,buffer:ge,print:iB,batchToSpaceND:ZC,broadcastTo:aB,cast:sB,clone:uB,cumsum:lB,depthToSpace:cB,expandDims:Vn,eye:eS,multinomial:dB,oneHot:Rm,pad:Da,pad1d:fB,pad2d:hB,pad3d:pB,pad4d:vB,rand:mB,randomNormal:gB,randomGamma:yB,randomUniform:tS,reshape:vr,spaceToBatchND:nS,squeeze:rS,stack:Fn,tile:ks,truncatedNormal:wB,unstack:Et,setdiff1dAsync:xB,fill:qr,linspace:GL,ones:gu,range:of,scalar:ee,tensor:Lt,tensor1d:pt,tensor2d:_i,tensor3d:hy,tensor4d:vn,tensor5d:zL,tensor6d:VL,variable:HL,zeros:Ye,onesLike:JC,zerosLike:Ne,transpose:Ii,softmax:Ro,logSoftmax:RB,localResponseNormalization:cU,norm:rk,gather:ky,unsortedSegmentSum:zS,basicLSTMCell:dU,multiRNNCell:fU,movingAverage:hU,stridedSlice:pU,topk:vU,scatterND:mU,fft:Iy,ifft:vf,rfft:Ay,irfft:ok,sparseToDense:yU,gatherND:wU,diag:xU,dropout:bU,hannWindow:Py,hammingWindow:ak,frame:Dy,stft:sk,inTopKAsync:EU});function X(t,e){Array.isArray(t)||(t=[t]),t.forEach(function(n){n!=null&&I(n.dtype!=="complex64",function(){return e+" does not support complex64 tensors."})})}function Ap(t,e,n,r){if(n==="linear")return t.linear(e);if(n==="relu")return t.relu(e);if(n==="elu")return t.elu(e);if(n==="relu6")return t.relu6(e);if(n==="prelu")return t.prelu(e,r);throw new Error("Activation "+n+" has not been implemented for the CPU backend.")}var XU=function(t){function e(){var n=t.call(this)||this;return n.blockSize=48,n.firstUse=!0,n.data=new cS(n,L),n}return Cr(e,t),e.prototype.write=function(n,r,o){this.firstUse&&(this.firstUse=!1,H().get("IS_NODE")&&nf(`
============================
Hi there 👋. Looks like you are running TensorFlow.js in Node.js. To speed things up dramatically, install our node backend, which binds to TensorFlow C++, by running npm i @tensorflow/tfjs-node, or npm i @tensorflow/tfjs-node-gpu if you have CUDA. Then call require('@tensorflow/tfjs-node'); (-gpu suffix for CUDA) at the start of your program. Visit https://github.com/tensorflow/tfjs-node for more details.
============================`));var i={};return this.data.set(i,{values:n,dtype:o}),i},e.prototype.move=function(n,r,o,i){this.data.set(n,{values:r,dtype:i})},e.prototype.numDataIds=function(){return this.data.numDataIds()},e.prototype.read=function(n){return ie(this,void 0,void 0,function(){return ae(this,function(r){return[2,this.readSync(n)]})})},e.prototype.readSync=function(n){var r=this.data.get(n),o=r.dtype,i=r.complexTensors;return o==="complex64"?Am(this.readSync(i.real.dataId),this.readSync(i.imag.dataId)):this.data.get(n).values},e.prototype.bufferSync=function(n){var r=this.readSync(n.dataId),o=r;if(n.dtype==="string")try{o=r.map(function(i){return Zd(i)})}catch{throw new Error("Failed to decode encoded string bytes into utf-8")}return ge(n.shape,n.dtype,o)},e.prototype.makeOutput=function(n,r,o){var i=this.write(n,r,o);return L.makeTensorFromDataId(i,r,o,this)},e.prototype.disposeData=function(n){if(this.data.has(n)){var r=this.data.get(n).complexTensors;r!=null&&(r.real.dispose(),r.imag.dispose()),this.data.delete(n)}},e.prototype.time=function(n){return ie(this,void 0,void 0,function(){var r;return ae(this,function(o){return r=Fr(),n(),[2,{kernelMs:Fr()-r}]})})},e.prototype.memory=function(){return{unreliable:!0,reasons:["The reported memory is an upper bound. Due to automatic garbage collection, the true allocated memory may be less."]}},e.prototype.complex=function(n,r){var o=this.makeOutput(null,n.shape,"complex64");return this.data.get(o.dataId).complexTensors={real:L.keep(n.clone()),imag:L.keep(r.clone())},o},e.prototype.real=function(n){return this.data.get(n.dataId).complexTensors.real.clone()},e.prototype.imag=function(n){return this.data.get(n.dataId).complexTensors.imag.clone()},e.prototype.slice=function(n,r,o){if(X(n,"slice"),uS(n.shape,r,o)){var i=lS(r,n.strides),a=se(o);return Lt(this.readSync(n.dataId).subarray(i,i+a),o,n.dtype)}for(var s=ge(o,n.dtype),u=this.bufferSync(n),l=0;l<s.size;++l){var c=s.indexToLoc(l).map(function(d,f){return d+r[f]});s.values[l]=u.get.apply(u,c)}return s.toTensor()},e.prototype.stridedSlice=function(n,r,o,i){X(n,"stridedSlice");var a=my(r,o,i);if(a.some(function(h){return h===0}))return Lt([],a);for(var s=ge(a,n.dtype),u=this.bufferSync(n),l=0;l<s.size;l++){for(var c=s.indexToLoc(l),d=new Array(c.length),f=0;f<d.length;f++)d[f]=c[f]*i[f]+r[f];s.set.apply(s,[u.get.apply(u,d)].concat(c))}return s.toTensor()},e.prototype.diag=function(n){for(var r=this.readSync(n.dataId),o=ge([n.size,n.size],n.dtype),i=o.values,a=0;a<r.length;a++)i[a*n.size+a]=r[a];return o.toTensor()},e.prototype.unstack=function(n,r){for(var o=n.shape[r],i=new Array(n.rank-1),a=0,s=0;s<n.rank;s++)s!==r&&(i[a++]=n.shape[s]);var u=new Array(n.rank).fill(0),l=n.shape.slice();l[r]=1;var c=new Array(o);for(s=0;s<c.length;s++)u[r]=s,c[s]=this.slice(n,u,l).reshape(i);return c},e.prototype.reverse=function(n,r){X(n,"reverse");for(var o=ge(n.shape,n.dtype),i=this.bufferSync(n),a=function(u){var l=o.indexToLoc(u),c=l.slice();r.forEach(function(d){return c[d]=n.shape[d]-1-c[d]}),o.set.apply(o,[i.get.apply(i,c)].concat(l))},s=0;s<o.size;s++)a(s);return o.toTensor()},e.prototype.concat=function(n,r){var o=this;if(n[0].dtype==="complex64"){var i=n.map(function(h){return Hn(h)}),a=n.map(function(h){return $r(h)});return Ft(this.concat(i,r),this.concat(a,r))}var s=n.map(function(h){var v=se(h.shape.slice(r));return h.as2D(-1,v)}),u=ou(s.map(function(h){return h.shape}),1),l=ge(u,n[0].dtype).values;if(s[0].shape[0]===1){var c=0;s.forEach(function(h){l.set(o.readSync(h.dataId),c),c+=h.size})}else{var d=0;s.forEach(function(h){for(var v=o.readSync(h.dataId),p=0,m=0;m<h.shape[0];++m)for(var g=m*u[1]+d,y=0;y<h.shape[1];++y)l[g+y]=v[p++];d+=h.shape[1]})}var f=ou(n.map(function(h){return h.shape}),r);return Lt(l,f,n[0].dtype)},e.prototype.neg=function(n){return X(n,"neg"),this.multiply(ee(-1),n)},e.prototype.add=function(n,r){return n.dtype==="complex64"||r.dtype==="complex64"?this.broadcastedBinaryComplexOp(n.cast("complex64"),r.cast("complex64"),function(o,i,a,s){return{real:o+a,imag:i+s}}):this.broadcastedBinaryOp(n,r,Mt(n.dtype,r.dtype),function(o,i){return o+i})},e.prototype.addN=function(n){var r=this;X(n,"addN");for(var o=n.map(function(c){return r.readSync(c.dataId)}),i=ge(n[0].shape,n[0].dtype),a=i.values,s=0;s<n.length;s++)for(var u=o[s],l=0;l<a.length;l++)a[l]+=u[l];return i.toTensor()},e.prototype.softmax=function(n,r){var o=kt([r],n.shape),i=this.max(n,o),a=_n(i.shape,o),s=this.subtract(n,i.reshape(a)),u=this.exp(s),l=this.sum(u,o).reshape(a);return this.realDivide(u,l)},e.prototype.subtract=function(n,r){return n.dtype==="complex64"||r.dtype==="complex64"?this.broadcastedBinaryComplexOp(n.cast("complex64"),r.cast("complex64"),function(o,i,a,s){return{real:o-a,imag:i-s}}):this.broadcastedBinaryOp(n,r,Mt(n.dtype,r.dtype),function(o,i){return o-i})},e.prototype.pow=function(n,r){return X([n,r],"pow"),this.broadcastedBinaryOp(n,r,n.dtype,function(o,i){return Math.pow(o,i)})},e.prototype.batchMatMul=function(n,r,o,i){X([n,r],"matMul");for(var a=o?n.shape[1]:n.shape[2],s=o?n.shape[2]:n.shape[1],u=i?r.shape[1]:r.shape[2],l=n.shape[0],c=this.readSync(n.dataId),d=this.readSync(r.dataId),f=o?[n.strides[0],1,n.strides[1]]:[n.strides[0],n.strides[1],1],h=f[0],v=f[1],p=f[2],m=i?[1,r.strides[1],r.strides[0]]:[r.strides[1],1,r.strides[0]],g=m[0],y=m[1],w=m[2],x=s*u,b=ge([l,s,u],n.dtype),_=b.values,E=this.blockSize,C=0;C<l;C++)for(var R=0;R<s;R+=E)for(var S=0;S<u;S+=E)for(var P=0;P<a;P+=E)for(var A=Math.min(R+E,s),B=Math.min(S+E,u),M=Math.min(P+E,a),j=R;j<A;j++)for(var W=S;W<B;W++){for(var U=0,D=P;D<M;D++)U+=c[C*h+j*v+D*p]*d[D*g+W*y+C*w];_[C*x+(j*u+W)]+=U}return b.toTensor()},e.prototype.fusedBatchMatMul=function(n){var r=n.a,o=n.b,i=n.transposeA,a=n.transposeB,s=n.bias,u=n.activation,l=n.preluActivationWeights,c=this.batchMatMul(r,o,i,a);return s&&(c=this.add(c,s)),u&&(c=Ap(this,c,u,l)),c},e.prototype.multiply=function(n,r){return n.dtype==="complex64"||r.dtype==="complex64"?this.broadcastedBinaryComplexOp(n.cast("complex64"),r.cast("complex64"),function(o,i,a,s){return{real:o*a-i*s,imag:o*s+i*a}}):this.broadcastedBinaryOp(n,r,Mt(n.dtype,r.dtype),function(o,i){return o*i})},e.prototype.realDivide=function(n,r){return X([n,r],"realDivide"),this.broadcastedBinaryOp(n,r,"float32",function(o,i){return o/i})},e.prototype.floorDiv=function(n,r){return X([n,r],"floorDiv"),this.broadcastedBinaryOp(n,r,"int32",function(o,i){return Math.floor(o/i)})},e.prototype.sum=function(n,r){X(n,"sum"),kn("sum",r,n.rank);for(var o=Ht(n.shape,r),i=o[0],a=o[1],s=Ye(i,Mt(n.dtype,"int32")),u=se(a),l=this.readSync(s.dataId),c=this.readSync(n.dataId),d=0;d<l.length;++d){for(var f=d*u,h=0,v=0;v<u;++v)h+=c[f+v];l[d]=h}return s},e.prototype.prod=function(n,r){X(n,"sum");for(var o=Ht(n.shape,r),i=o[0],a=o[1],s=Ye(i,Mt(n.dtype,"int32")),u=se(a),l=this.readSync(s.dataId),c=this.readSync(n.dataId),d=0;d<l.length;++d){for(var f=d*u,h=1,v=0;v<u;++v)h*=c[f+v];l[d]=h}return s},e.prototype.unsortedSegmentSum=function(n,r,o){X(n,"unsortedSegmentSum");for(var i=[],a=n.rank-r.rank,s=0;s<a;++s)r=r.expandDims(s+1);for(s=0;s<o;++s){var u=ee(s,"int32"),l=WS(u,r).asType("float32").mul(n).sum(0);i.push(l)}return Fn(i)},e.prototype.argMin=function(n,r){X(n,"argMin");var o=[r];kn("argMin",o,n.rank);for(var i=Ht(n.shape,o),a=i[0],s=i[1],u=Ye(a,"int32"),l=se(s),c=this.readSync(u.dataId),d=this.readSync(n.dataId),f=0;f<c.length;++f){for(var h=f*l,v=d[h],p=0,m=0;m<l;++m){var g=d[h+m];g<v&&(v=g,p=m)}c[f]=p}return u},e.prototype.argMax=function(n,r){X(n,"argMax");var o=[r];kn("argMax",o,n.rank);for(var i=Ht(n.shape,o),a=i[0],s=i[1],u=Ye(a,"int32"),l=se(s),c=this.readSync(u.dataId),d=this.readSync(n.dataId),f=0;f<c.length;++f){for(var h=f*l,v=d[h],p=0,m=0;m<l;++m){var g=d[h+m];g>v&&(v=g,p=m)}c[f]=p}return u},e.prototype.cumsum=function(n,r,o,i){if(X(n,"cumsum"),r!==n.rank-1)throw new Error("backend.cumsum in CPU expects an inner-most axis="+(n.rank-1)+" but got axis="+r);for(var a=Mt(n.dtype,"int32"),s=Ye(n.shape,a),u=this.readSync(s.dataId),l=this.readSync(n.dataId),c=n.shape[n.rank-1],d=i?function(m,g){return m+c-g-1}:function(m,g){return m+g},f=0;f<l.length;f+=c)for(var h=0;h<c;h++){var v=d(f,h);if(h===0)u[v]=o?0:l[v];else{var p=d(f,h-1);u[v]=o?l[p]+u[p]:l[v]+u[p]}}return s},e.prototype.equal=function(n,r){return X([n,r],"equal"),this.broadcastedBinaryOp(n,r,"bool",function(o,i){return o===i?1:0})},e.prototype.notEqual=function(n,r){return X([n,r],"notEqual"),this.broadcastedBinaryOp(n,r,"bool",function(o,i){return o!==i?1:0})},e.prototype.less=function(n,r){return X([n,r],"less"),this.broadcastedBinaryOp(n,r,"bool",function(o,i){return o<i?1:0})},e.prototype.lessEqual=function(n,r){return X([n,r],"lessEqual"),this.broadcastedBinaryOp(n,r,"bool",function(o,i){return o<=i?1:0})},e.prototype.greater=function(n,r){return X([n,r],"greater"),this.broadcastedBinaryOp(n,r,"bool",function(o,i){return o>i?1:0})},e.prototype.greaterEqual=function(n,r){return X([n,r],"greaterEqual"),this.broadcastedBinaryOp(n,r,"bool",function(o,i){return o>=i?1:0})},e.prototype.logicalNot=function(n){X(n,"logicalNot");for(var r=this.readSync(n.dataId),o=new Uint8Array(r.length),i=0;i<r.length;++i)o[i]=r[i]?0:1;return this.makeOutput(o,n.shape,"bool")},e.prototype.logicalAnd=function(n,r){return X([n,r],"logicalAnd"),this.broadcastedBinaryOp(n,r,"bool",function(o,i){return o&&i})},e.prototype.logicalOr=function(n,r){return X([n,r],"logicalOr"),this.broadcastedBinaryOp(n,r,"bool",function(o,i){return o||i})},e.prototype.select=function(n,r,o){X([n,r,o],"select");for(var i=this.readSync(n.dataId),a=this.readSync(r.dataId),s=this.readSync(o.dataId),u=Ye(r.shape,Mt(r.dtype,o.dtype)),l=this.readSync(u.dataId),c=0,d=n.rank===0||n.rank>1||r.rank===1?1:se(r.shape.slice(1)),f=0;f<i.length;f++)for(var h=0;h<d;h++)i[f]===1?l[c++]=a[f]:l[c++]=s[f];return u},e.prototype.where=function(n){X([n],"where");var r=this.readSync(n.dataId);return xy(n.shape,r)},e.prototype.topk=function(n,r,o){return X(n,"topk"),yS(this.readSync(n.dataId),n.shape,n.dtype,r)},e.prototype.min=function(n,r){X(n,"min"),kn("min",r,n.rank);for(var o=Ht(n.shape,r),i=o[0],a=o[1],s=Ye(i,n.dtype),u=se(a),l=this.readSync(s.dataId),c=this.readSync(n.dataId),d=0;d<l.length;++d){for(var f=d*u,h=c[f],v=0;v<u;++v){var p=c[f+v];p<h&&(h=p)}l[d]=h}return s},e.prototype.minimum=function(n,r){return X([n,r],"minimum"),this.broadcastedBinaryOp(n,r,n.dtype,function(o,i){return Math.min(o,i)})},e.prototype.mod=function(n,r){return X([n,r],"mod"),this.broadcastedBinaryOp(n,r,n.dtype,function(o,i){var a=o%i;return o<0&&i<0||o>=0&&i>=0?a:(a+i)%i})},e.prototype.max=function(n,r){X(n,"max"),kn("max",r,n.rank);for(var o=Ht(n.shape,r),i=o[0],a=o[1],s=Ye(i,n.dtype),u=se(a),l=this.readSync(s.dataId),c=this.readSync(n.dataId),d=0;d<l.length;++d){for(var f=d*u,h=c[f],v=0;v<u;++v){var p=c[f+v];p>h&&(h=p)}l[d]=h}return s},e.prototype.maximum=function(n,r){return X([n,r],"maximum"),this.broadcastedBinaryOp(n,r,n.dtype,function(o,i){return Math.max(o,i)})},e.prototype.all=function(n,r){X(n,"all"),kn("all",r,n.rank);for(var o=Ht(n.shape,r),i=o[0],a=o[1],s=Ye(i,n.dtype),u=se(a),l=this.readSync(s.dataId),c=this.readSync(n.dataId),d=0;d<l.length;++d){for(var f=d*u,h=c[f],v=0;v<u;++v){var p=c[f+v];h=h&&p}l[d]=h}return s},e.prototype.any=function(n,r){X(n,"any"),kn("any",r,n.rank);for(var o=Ht(n.shape,r),i=o[0],a=o[1],s=Ye(i,n.dtype),u=se(a),l=this.readSync(s.dataId),c=this.readSync(n.dataId),d=0;d<l.length;++d){for(var f=d*u,h=c[f],v=0;v<u;++v){var p=c[f+v];h=h||p}l[d]=h}return s},e.prototype.squaredDifference=function(n,r){return X([n,r],"squaredDifference"),this.broadcastedBinaryOp(n,r,n.dtype,function(o,i){var a=o-i;return a*a})},e.prototype.ceil=function(n){X(n,"ceil");for(var r=this.readSync(n.dataId),o=new Float32Array(r.length),i=0;i<r.length;++i)o[i]=Math.ceil(r[i]);return this.makeOutput(o,n.shape,"float32")},e.prototype.floor=function(n){X(n,"floor");for(var r=this.readSync(n.dataId),o=new Float32Array(r.length),i=0;i<r.length;++i)o[i]=Math.floor(r[i]);return this.makeOutput(o,n.shape,"float32")},e.prototype.sign=function(n){X(n,"x");for(var r=this.readSync(n.dataId),o=new Float32Array(r.length),i=0;i<r.length;++i)r[i]<0?o[i]=-1:r[i]>0?o[i]=1:o[i]=0;return this.makeOutput(o,n.shape,"float32")},e.prototype.isNaN=function(n){X(n,"x");for(var r=this.readSync(n.dataId),o=new Uint8Array(r.length),i=0;i<r.length;++i)Number.isNaN(r[i])&&(o[i]=1);return this.makeOutput(o,n.shape,"bool")},e.prototype.isInf=function(n){X(n,"x");for(var r=this.readSync(n.dataId),o=new Uint8Array(r.length),i=0;i<r.length;++i)Math.abs(r[i])===1/0&&(o[i]=1);return this.makeOutput(o,n.shape,"bool")},e.prototype.isFinite=function(n){X(n,"x");for(var r=this.readSync(n.dataId),o=new Uint8Array(r.length),i=0;i<r.length;++i)Number.isFinite(r[i])&&(o[i]=1);return this.makeOutput(o,n.shape,"bool")},e.prototype.round=function(n){X(n,"round");for(var r=this.readSync(n.dataId),o=new Float32Array(r.length),i=0;i<r.length;++i){var a=Math.floor(r[i]);r[i]-a<.5?o[i]=Math.floor(r[i]):r[i]-a>.5?o[i]=Math.ceil(r[i]):o[i]=a%2==0?a:a+1}return this.makeOutput(o,n.shape,"float32")},e.prototype.exp=function(n){X(n,"exp");for(var r=this.readSync(n.dataId),o=new Float32Array(r.length),i=0;i<r.length;++i)o[i]=Math.exp(r[i]);return this.makeOutput(o,n.shape,"float32")},e.prototype.expm1=function(n){X(n,"expm1");for(var r=this.readSync(n.dataId),o=new Float32Array(r.length),i=0;i<r.length;++i)o[i]=Math.expm1(r[i]);return this.makeOutput(o,n.shape,"float32")},e.prototype.log=function(n){X(n,"log");for(var r=this.readSync(n.dataId),o=new Float32Array(r.length),i=0;i<r.length;++i){var a=r[i];o[i]=Math.log(a)}return this.makeOutput(o,n.shape,"float32")},e.prototype.log1p=function(n){X(n,"log1p");for(var r=this.readSync(n.dataId),o=new Float32Array(r.length),i=0;i<r.length;++i){var a=r[i];o[i]=Math.log1p(a)}return this.makeOutput(o,n.shape,"float32")},e.prototype.sqrt=function(n){X(n,"sqrt");for(var r=this.readSync(n.dataId),o=new Float32Array(r.length),i=0;i<r.length;++i){var a=r[i];o[i]=Math.sqrt(a)}return this.makeOutput(o,n.shape,"float32")},e.prototype.rsqrt=function(n){X(n,"rsqrt");for(var r=this.readSync(n.dataId),o=new Float32Array(r.length),i=0;i<r.length;++i){var a=r[i];o[i]=1/Math.sqrt(a)}return this.makeOutput(o,n.shape,"float32")},e.prototype.reciprocal=function(n){X(n,"reciprocal");for(var r=this.readSync(n.dataId),o=new Float32Array(r.length),i=0;i<r.length;++i)o[i]=1/r[i];return this.makeOutput(o,n.shape,"float32")},e.prototype.linear=function(n){return n},e.prototype.relu=function(n){X(n,"relu");for(var r=Ye(n.shape,n.dtype),o=this.readSync(r.dataId),i=this.readSync(n.dataId),a=0;a<i.length;++a)o[a]=Math.max(0,i[a]);return r},e.prototype.relu6=function(n){X(n,"relu");for(var r=Ye(n.shape,n.dtype),o=this.readSync(r.dataId),i=this.readSync(n.dataId),a=0;a<i.length;++a)o[a]=Math.min(Math.max(0,i[a]),6);return r},e.prototype.prelu=function(n,r){return X([n,r],"prelu"),this.broadcastedBinaryOp(n,r,n.dtype,function(o,i){return o<0?i*o:o})},e.prototype.elu=function(n){X(n,"elu");for(var r=new Float32Array(n.size),o=this.readSync(n.dataId),i=0;i<o.length;++i){var a=o[i];r[i]=a>=0?a:Math.exp(a)-1}return this.makeOutput(r,n.shape,"float32")},e.prototype.eluDer=function(n,r){X([n,r],"eluDer");for(var o=new Float32Array(r.size),i=this.readSync(r.dataId),a=this.readSync(n.dataId),s=0;s<i.length;++s){var u=i[s];o[s]=u>=1?a[s]:a[s]*(u+1)}return this.makeOutput(o,r.shape,"float32")},e.prototype.selu=function(n){X(n,"selu");for(var r=_y,o=Ey,i=new Float32Array(n.size),a=this.readSync(n.dataId),s=0;s<a.length;++s){var u=a[s];i[s]=u>=0?o*u:r*(Math.exp(u)-1)}return this.makeOutput(i,n.shape,"float32")},e.prototype.clip=function(n,r,o){X(n,"clip");for(var i=new Float32Array(n.size),a=this.readSync(n.dataId),s=0;s<a.length;++s){var u=a[s];i[s]=u>o?o:u<r?r:u}return this.makeOutput(i,n.shape,"float32")},e.prototype.abs=function(n){for(var r=new Float32Array(n.size),o=this.readSync(n.dataId),i=0;i<o.length;++i)r[i]=Math.abs(o[i]);return this.makeOutput(r,n.shape,"float32")},e.prototype.complexAbs=function(n){for(var r=new Float32Array(n.size),o=this.readSync(n.dataId),i=0;i<n.size;++i){var a=o[2*i],s=o[2*i+1];r[i]=Math.hypot(a,s)}return this.makeOutput(r,n.shape,"float32")},e.prototype.int=function(n){X(n,"int");for(var r=new Int32Array(n.size),o=this.readSync(n.dataId),i=0;i<o.length;++i)r[i]=o[i];return this.makeOutput(r,n.shape,"int32")},e.prototype.sigmoid=function(n){X(n,"sigmoid");for(var r=new Float32Array(n.size),o=this.readSync(n.dataId),i=0;i<o.length;++i)r[i]=1/(1+Math.exp(-o[i]));return this.makeOutput(r,n.shape,"float32")},e.prototype.softplus=function(n){X(n,"softplus");for(var r=Math.log(11920928955078125e-23)+2,o=new Float32Array(n.size),i=this.readSync(n.dataId),a=0;a<i.length;++a){var s=i[a]>-r,u=i[a]<r,l=Math.exp(i[a]),c=void 0;c=u?l:s?i[a]:Math.log(1+l),o[a]=c}return this.makeOutput(o,n.shape,"float32")},e.prototype.sin=function(n){X(n,"sin");for(var r=new Float32Array(n.size),o=this.readSync(n.dataId),i=0;i<o.length;++i)r[i]=Math.sin(o[i]);return this.makeOutput(r,n.shape,"float32")},e.prototype.cos=function(n){X(n,"cos");for(var r=new Float32Array(n.size),o=this.readSync(n.dataId),i=0;i<o.length;++i)r[i]=Math.cos(o[i]);return this.makeOutput(r,n.shape,"float32")},e.prototype.tan=function(n){X(n,"tan");for(var r=new Float32Array(n.size),o=this.readSync(n.dataId),i=0;i<o.length;++i)r[i]=Math.tan(o[i]);return this.makeOutput(r,n.shape,"float32")},e.prototype.asin=function(n){X(n,"asin");for(var r=new Float32Array(n.size),o=this.readSync(n.dataId),i=0;i<o.length;++i)r[i]=Math.asin(o[i]);return this.makeOutput(r,n.shape,"float32")},e.prototype.acos=function(n){X(n,"acos");for(var r=new Float32Array(n.size),o=this.readSync(n.dataId),i=0;i<o.length;++i)r[i]=Math.acos(o[i]);return this.makeOutput(r,n.shape,"float32")},e.prototype.atan=function(n){X(n,"atan");for(var r=new Float32Array(n.size),o=this.readSync(n.dataId),i=0;i<o.length;++i)r[i]=Math.atan(o[i]);return this.makeOutput(r,n.shape,"float32")},e.prototype.atan2=function(n,r){return X([n,r],"atan2"),this.broadcastedBinaryOp(n,r,n.dtype,function(o,i){return Math.atan2(o,i)})},e.prototype.sinh=function(n){X(n,"sinh");for(var r=new Float32Array(n.size),o=this.readSync(n.dataId),i=0;i<o.length;++i)r[i]=Math.sinh(o[i]);return this.makeOutput(r,n.shape,"float32")},e.prototype.cosh=function(n){X(n,"cosh");for(var r=new Float32Array(n.size),o=this.readSync(n.dataId),i=0;i<o.length;++i)r[i]=Math.cosh(o[i]);return this.makeOutput(r,n.shape,"float32")},e.prototype.tanh=function(n){X(n,"tanh");for(var r=new Float32Array(n.size),o=this.readSync(n.dataId),i=0;i<o.length;++i)r[i]=Y4(o[i]);return this.makeOutput(r,n.shape,"float32")},e.prototype.asinh=function(n){X(n,"asinh");for(var r=new Float32Array(n.size),o=this.readSync(n.dataId),i=0;i<o.length;++i)r[i]=Math.asinh(o[i]);return this.makeOutput(r,n.shape,"float32")},e.prototype.acosh=function(n){X(n,"acosh");for(var r=new Float32Array(n.size),o=this.readSync(n.dataId),i=0;i<o.length;++i)r[i]=Math.acosh(o[i]);return this.makeOutput(r,n.shape,"float32")},e.prototype.atanh=function(n){X(n,"atanh");for(var r=new Float32Array(n.size),o=this.readSync(n.dataId),i=0;i<o.length;++i)r[i]=Math.atanh(o[i]);return this.makeOutput(r,n.shape,"float32")},e.prototype.erf=function(n){X(n,"erf");for(var r=new Float32Array(n.size),o=this.readSync(n.dataId),i=0;i<o.length;++i){var a=Math.sign(o[i]),s=Math.abs(o[i]),u=1/(1+.3275911*s);r[i]=a*(1-((((1.061405429*u-1.453152027)*u+1.421413741)*u-.284496736)*u+.254829592)*u*Math.exp(-s*s))}return this.makeOutput(r,n.shape,"float32")},e.prototype.step=function(n,r){r===void 0&&(r=0),X(n,"step");for(var o=new Float32Array(n.size),i=this.readSync(n.dataId),a=0;a<i.length;++a){var s=i[a];isNaN(s)?o[a]=NaN:o[a]=s>0?1:r}return this.makeOutput(o,n.shape,"float32")},e.prototype.fusedConv2d=function(n){var r=n.input,o=n.filter,i=n.convInfo,a=n.bias,s=n.activation,u=n.preluActivationWeights,l=this.conv2d(r,o,i);return a&&(l=this.add(l,a)),s&&(l=Ap(this,l,s,u)),l},e.prototype.conv2d=function(n,r,o){X([n,r],"conv2d");for(var i=o.filterHeight,a=o.filterWidth,s=o.dilationHeight,u=o.dilationWidth,l=o.padInfo.left,c=o.padInfo.top,d=o.dataFormat==="channelsLast",f=ge(o.outShape,n.dtype),h=n.strides[0],v=d?n.strides[1]:n.strides[2],p=d?n.strides[2]:1,m=d?1:n.strides[1],g=f.strides[0],y=d?f.strides[1]:f.strides[2],w=d?f.strides[2]:1,x=d?1:f.strides[1],b=this.readSync(n.dataId),_=this.readSync(r.dataId),E=f.values,C=0;C<o.batchSize;++C)for(var R=C*h,S=C*g,P=0;P<o.outHeight;++P)for(var A=S+P*y,B=P*o.strideHeight-c,M=0;M<i;M++){var j=B+M*s;if(!(j<0||j>=o.inHeight))for(var W=M*r.strides[0],U=R+j*v,D=0;D<o.outWidth;++D)for(var F=A+D*w,$=D*o.strideWidth-l,q=0;q<a;q++){var K=$+q*u;if(!(K<0||K>=o.inWidth))for(var Q=U+K*p,Z=W+q*r.strides[1],ue=0;ue<o.inChannels;++ue){for(var fe=b[Q+ue*m],oe=0;oe<o.outChannels;++oe)E[F+oe*x]+=fe*_[Z+oe];Z+=o.outChannels}}}return f.toTensor()},e.prototype.conv3d=function(n,r,o){for(var i=o.filterDepth,a=o.filterHeight,s=o.filterWidth,u=o.dilationDepth,l=o.dilationHeight,c=o.dilationWidth,d=o.padInfo.front,f=o.padInfo.left,h=o.padInfo.top,v=ge(o.outShape,n.dtype),p=this.readSync(n.dataId),m=this.readSync(r.dataId),g=v.values,y=0;y<o.batchSize;++y)for(var w=y*n.strides[0],x=y*v.strides[0],b=0;b<o.outDepth;++b)for(var _=x+b*v.strides[1],E=b*o.strideDepth-d,C=0;C<i;C++){var R=E+C*u;if(!(R<0||R>=o.inDepth))for(var S=C*r.strides[0],P=w+R*n.strides[1],A=0;A<o.outHeight;++A)for(var B=_+A*v.strides[2],M=A*o.strideHeight-h,j=0;j<a;j++){var W=M+j*l;if(!(W<0||W>=o.inHeight))for(var U=S+j*r.strides[1],D=P+W*n.strides[2],F=0;F<o.outWidth;++F)for(var $=B+F*o.outChannels,q=F*o.strideWidth-f,K=0;K<s;K++){var Q=q+K*c;if(!(Q<0||Q>=o.inWidth))for(var Z=U+K*r.strides[2],ue=D+Q*o.inChannels,fe=Z,oe=0;oe<o.inChannels;++oe){for(var xe=p[ue+oe],ye=0;ye<o.outChannels;++ye)g[$+ye]+=xe*m[fe+ye];fe+=o.outChannels}}}}return v.toTensor()},e.prototype.conv2dDerInput=function(n,r,o){X([n,r],"conv2dDerInput");for(var i=ge(o.inShape,"float32"),a=i.values,s=this.readSync(n.dataId),u=this.readSync(r.dataId),l=r.strides,c=l[0],d=l[1],f=l[2],h=o.batchSize,v=o.filterHeight,p=o.filterWidth,m=o.inChannels,g=o.inHeight,y=o.inWidth,w=o.outChannels,x=o.outHeight,b=o.outWidth,_=o.strideHeight,E=o.strideWidth,C=o.dataFormat,R=v-1-o.padInfo.top,S=p-1-o.padInfo.left,P=C==="channelsLast",A=i.strides[0],B=P?i.strides[1]:i.strides[2],M=P?i.strides[2]:1,j=P?1:i.strides[1],W=n.strides[0],U=P?n.strides[1]:n.strides[2],D=P?n.strides[2]:1,F=P?1:n.strides[1],$=0;$<h;++$)for(var q=0;q<m;++q)for(var K=0;K<g;++K)for(var Q=K-R,Z=Math.max(0,Math.ceil(Q/_)),ue=Math.min(x,(v+Q)/_),fe=0;fe<y;++fe){for(var oe=fe-S,xe=Math.max(0,Math.ceil(oe/E)),ye=Math.min(b,(p+oe)/E),Be=0,me=Z;me<ue;++me)for(var Ae=me*_-Q,Ce=xe;Ce<ye;++Ce)for(var Ue=W*$+U*me+D*Ce,ze=c*(v-1-Ae)+d*(p-1-(Ce*E-oe))+f*q,je=0;je<w;++je)Be+=s[Ue+F*je]*u[ze+je];a[A*$+B*K+M*fe+j*q]=Be}return i.toTensor()},e.prototype.conv3dDerInput=function(n,r,o){for(var i=ge(o.inShape,"float32"),a=i.values,s=i.strides,u=s[0],l=s[1],c=s[2],d=s[3],f=this.readSync(n.dataId),h=n.strides,v=h[0],p=h[1],m=h[2],g=h[3],y=this.readSync(r.dataId),w=r.strides,x=w[0],b=w[1],_=w[2],E=w[3],C=o.batchSize,R=o.filterDepth,S=o.filterHeight,P=o.filterWidth,A=o.inChannels,B=o.inDepth,M=o.inHeight,j=o.inWidth,W=o.outChannels,U=o.outDepth,D=o.outHeight,F=o.outWidth,$=o.strideDepth,q=o.strideHeight,K=o.strideWidth,Q=R-1-o.padInfo.front,Z=S-1-o.padInfo.top,ue=P-1-o.padInfo.left,fe=0;fe<C;++fe)for(var oe=0;oe<A;++oe)for(var xe=0;xe<B;++xe)for(var ye=xe-Q,Be=Math.max(0,Math.ceil(ye/$)),me=Math.min(U,(R+ye)/$),Ae=0;Ae<M;++Ae)for(var Ce=Ae-Z,Ue=Math.max(0,Math.ceil(Ce/q)),ze=Math.min(D,(S+Ce)/q),je=0;je<j;++je){for(var ln=je-ue,jt=Math.max(0,Math.ceil(ln/K)),ft=Math.min(F,(P+ln)/K),to=0,Zt=Be;Zt<me;++Zt)for(var er=Zt*$-ye,Nt=Ue;Nt<ze;++Nt)for(var No=Nt*q-Ce,tr=jt;tr<ft;++tr)for(var Wt=v*fe+p*Zt+m*Nt+g*tr,Cn=x*(R-1-er)+b*(S-1-No)+_*(P-1-(tr*K-ln))+E*oe,$n=0;$n<W;++$n)to+=f[Wt+$n]*y[Cn+$n];a[u*fe+l*xe+c*Ae+d*je+oe]=to}return i.toTensor()},e.prototype.conv2dDerFilter=function(n,r,o){X([n,r],"conv2dDerFilter");for(var i=o.strideHeight,a=o.strideWidth,s=o.filterHeight,u=o.filterWidth,l=o.dataFormat==="channelsLast",c=ge(o.filterShape,"float32"),d=o.padInfo.left,f=o.padInfo.top,h=this.bufferSync(n),v=this.bufferSync(r),p=0;p<s;++p)for(var m=Math.max(0,Math.ceil((f-p)/i)),g=Math.min(o.outHeight,(o.inHeight+f-p)/i),y=0;y<u;++y)for(var w=Math.max(0,Math.ceil((d-y)/a)),x=Math.min(o.outWidth,(o.inWidth+d-y)/a),b=0;b<o.inChannels;++b)for(var _=0;_<o.outChannels;++_){for(var E=0,C=0;C<o.batchSize;++C)for(var R=m;R<g;++R)for(var S=p+R*i-f,P=w;P<x;++P){var A=y+P*a-d;E+=l?h.get(C,S,A,b)*v.get(C,R,P,_):h.get(C,b,S,A)*v.get(C,_,R,P)}c.set(E,p,y,b,_)}return c.toTensor()},e.prototype.conv3dDerFilter=function(n,r,o){for(var i=o.strideDepth,a=o.strideHeight,s=o.strideWidth,u=o.filterDepth,l=o.filterHeight,c=o.filterWidth,d=ge(o.filterShape,"float32"),f=d.values,h=d.strides,v=h[0],p=h[1],m=h[2],g=h[3],y=this.readSync(r.dataId),w=r.strides,x=w[0],b=w[1],_=w[2],E=w[3],C=this.readSync(n.dataId),R=n.strides,S=R[0],P=R[1],A=R[2],B=R[3],M=o.padInfo.front,j=o.padInfo.left,W=o.padInfo.top,U=0;U<u;++U)for(var D=Math.max(0,Math.ceil((M-U)/i)),F=Math.min(o.outDepth,(o.inDepth+M-U)/i),$=U*v,q=0;q<l;++q)for(var K=Math.max(0,Math.ceil((W-q)/a)),Q=Math.min(o.outHeight,(o.inHeight+W-q)/a),Z=q*p+$,ue=0;ue<c;++ue)for(var fe=Math.max(0,Math.ceil((j-ue)/s)),oe=Math.min(o.outWidth,(o.inWidth+j-ue)/s),xe=ue*m+Z,ye=0;ye<o.inChannels;++ye)for(var Be=ye*g+xe,me=0;me<o.outChannels;++me){for(var Ae=0,Ce=0;Ce<o.batchSize;++Ce)for(var Ue=Ce*S,ze=Ce*x,je=D;je<F;++je)for(var ln=(U+je*i-M)*P+Ue,jt=je*b+ze,ft=K;ft<Q;++ft)for(var to=(q+ft*a-W)*A+ln,Zt=ft*_+jt,er=fe;er<oe;++er){var Nt=er*E+Zt;Ae+=C[(ue+er*s-j)*B+to+ye]*y[Nt+me]}f[Be+me]=Ae}return d.toTensor()},e.prototype.fusedDepthwiseConv2D=function(n){var r=n.input,o=n.filter,i=n.convInfo,a=n.bias,s=n.activation,u=n.preluActivationWeights,l=this.depthwiseConv2D(r,o,i);return a&&(l=this.add(l,a)),s&&(l=Ap(this,l,s,u)),l},e.prototype.depthwiseConv2D=function(n,r,o){X([n,r],"depthwiseConv2D");for(var i=o.filterHeight,a=o.filterWidth,s=o.dilationHeight,u=o.dilationWidth,l=o.padInfo.left,c=o.padInfo.top,d=o.outChannels/o.inChannels,f=ge(o.outShape,n.dtype),h=this.readSync(n.dataId),v=this.readSync(r.dataId),p=f.values,m=0;m<o.batchSize;++m)for(var g=m*n.strides[0],y=m*f.strides[0],w=0;w<o.outHeight;++w)for(var x=y+w*f.strides[1],b=w*o.strideHeight-l,_=0;_<i;++_){var E=b+_*s;if(!(E<0||E>=o.inHeight))for(var C=_*r.strides[0],R=g+E*n.strides[1],S=0;S<o.outWidth;++S)for(var P=x+S*f.strides[2],A=S*o.strideWidth-c,B=0;B<a;++B){var M=A+B*u;if(!(M<0||M>=o.inWidth))for(var j=C+B*r.strides[1],W=R+M*o.inChannels,U=P,D=j,F=0;F<o.inChannels;++F){for(var $=h[W+F],q=0;q<d;++q)p[U+q]+=$*v[D+q];U+=d,D+=d}}}return f.toTensor()},e.prototype.depthwiseConv2DDerInput=function(n,r,o){X([n,r],"depthwiseConv2DDerInput");for(var i=ge(o.inShape,"float32"),a=i.values,s=i.strides,u=s[0],l=s[1],c=s[2],d=this.readSync(n.dataId),f=n.strides,h=f[0],v=f[1],p=f[2],m=this.readSync(r.dataId),g=r.strides,y=g[0],w=g[1],x=g[2],b=o.batchSize,_=o.filterHeight,E=o.filterWidth,C=o.inChannels,R=o.inHeight,S=o.inWidth,P=o.outChannels,A=o.outHeight,B=o.outWidth,M=o.strideHeight,j=o.strideWidth,W=_-1-o.padInfo.top,U=E-1-o.padInfo.left,D=P/C,F=0;F<b;++F)for(var $=0;$<C;++$)for(var q=0;q<R;++q)for(var K=q-W,Q=Math.max(0,Math.ceil(K/M)),Z=Math.min(A,(_+K)/M),ue=0;ue<S;++ue){for(var fe=ue-U,oe=Math.max(0,Math.ceil(fe/j)),xe=Math.min(B,(E+fe)/j),ye=0,Be=Q;Be<Z;++Be)for(var me=Be*M-K,Ae=oe;Ae<xe;++Ae)for(var Ce=h*F+v*Be+p*Ae,Ue=y*(_-1-me)+w*(E-1-(Ae*j-fe))+x*$,ze=0;ze<D;++ze)ye+=d[Ce+($*D+ze)]*m[Ue+ze];a[u*F+l*q+c*ue+$]=ye}return i.toTensor()},e.prototype.depthwiseConv2DDerFilter=function(n,r,o){X([n,r],"depthwiseConv2DDerFilter");for(var i=o.strideHeight,a=o.strideWidth,s=o.filterHeight,u=o.filterWidth,l=ge(o.filterShape,"float32"),c=o.padInfo.left,d=o.padInfo.top,f=o.outChannels/o.inChannels,h=this.bufferSync(n),v=this.bufferSync(r),p=0;p<s;++p)for(var m=Math.max(0,Math.ceil((d-p)/i)),g=Math.min(o.outHeight,(o.inHeight+d-p)/i),y=0;y<u;++y)for(var w=Math.max(0,Math.ceil((c-y)/a)),x=Math.min(o.outWidth,(o.inWidth+c-y)/a),b=0;b<o.outChannels;++b){for(var _=Math.trunc(b/f),E=b%f,C=0,R=0;R<o.batchSize;++R)for(var S=m;S<g;++S)for(var P=p+S*i-d,A=w;A<x;++A){var B=y+A*a-c;C+=h.get(R,P,B,_)*v.get(R,S,A,b)}l.set(C,p,y,_,E)}return l.toTensor()},e.prototype.tile=function(n,r){return X(n,"tile"),gS(this.bufferSync(n),r)},e.prototype.pad=function(n,r,o){X(n,"pad");var i=r.map(function(f,h){return f[0]+n.shape[h]+f[1]}),a=r.map(function(f){return f[0]}),s=this.bufferSync(n),u=ge(i,n.dtype);o!==0&&u.values.fill(o);for(var l=0;l<n.size;l++){var c=s.indexToLoc(l),d=c.map(function(f,h){return f+a[h]});u.set.apply(u,[s.get.apply(s,c)].concat(d))}return u.toTensor()},e.prototype.transpose=function(n,r){X(n,"transpose");for(var o=new Array(n.rank),i=0;i<o.length;i++)o[i]=n.shape[r[i]];var a=this.readSync(n.dataId),s=ge(o,n.dtype),u=this.bufferSync(n);for(i=0;i<n.size;++i){for(var l=u.indexToLoc(i),c=new Array(l.length),d=0;d<c.length;d++)c[d]=l[r[d]];var f=s.locToIndex(c);s.values[f]=a[i]}return s.toTensor()},e.prototype.gather=function(n,r,o){X([n,r],"gather");var i=n.shape.slice(),a=this.readSync(r.dataId);i[o]=a.length;for(var s=ge(i,n.dtype),u=this.bufferSync(n),l=0;l<s.size;++l){var c=s.indexToLoc(l),d=c.slice();d[o]=a[c[o]];var f=u.locToIndex(d);s.values[l]=u.values[f]}return s.toTensor()},e.prototype.batchToSpaceND=function(n,r,o){X([n],"batchToSpaceND");var i=r.reduce(function(d,f){return d*f}),a=af(n.shape,r,i),s=sf(a.length,r.length),u=uf(n.shape,r,i),l=oS(o,r.length),c=iS(u,o,r.length);return n.reshape(a).transpose(s).reshape(u).slice(l,c)},e.prototype.spaceToBatchND=function(n,r,o){X([n],"spaceToBatchND");var i=r.reduce(function(f,h){return f*h}),a=[[0,0]];a.push.apply(a,o);for(var s=1+r.length;s<n.shape.length;++s)a.push([0,0]);var u=n.pad(a),l=af(u.shape,r,i,!1),c=sf(l.length,r.length,!1),d=uf(u.shape,r,i,!1);return u.reshape(l).transpose(c).reshape(d)},e.prototype.pool=function(n,r,o){X(n,"pool");for(var i=r.strideHeight,a=r.strideWidth,s=r.dilationHeight,u=r.dilationWidth,l=r.effectiveFilterHeight,c=r.effectiveFilterWidth,d=r.padInfo.top,f=r.padInfo.left,h=o==="max"?Number.NEGATIVE_INFINITY:Number.POSITIVE_INFINITY,v=this.readSync(n.dataId),p=ge(r.outShape,n.dtype),m=p.values,g=r.outShape[1]*r.outShape[2]*r.outShape[3],y=r.outShape[2]*r.outShape[3],w=r.outShape[3],x=0;x<r.batchSize;++x)for(var b=x*g,_=x*n.strides[0],E=0;E<r.inChannels;++E)for(var C=0;C<r.outHeight;++C)for(var R=C*i-d,S=Math.max(0,R),P=Math.min(r.inHeight,l+R),A=b+C*y,B=0;B<r.outWidth;++B){for(var M=B*a-f,j=Math.max(0,M),W=Math.min(r.inWidth,c+M),U=h,D=0,F=0,$=S;$<P;$+=s){for(var q=_+$*n.strides[1],K=j;K<W;K+=u){var Q=v[q+K*n.strides[2]+E];o==="max"&&Q>U?U=Q:o==="avg"&&(D+=Q,F++)}if(isNaN(U))break}m[A+B*w+E]=o==="avg"?D/F:U}return p.toTensor()},e.prototype.maxPool=function(n,r){return this.pool(n,r,"max")},e.prototype.maxPoolPositions=function(n,r){for(var o=ge(r.outShape,"int32"),i=r.strideHeight,a=r.strideWidth,s=r.dilationHeight,u=r.dilationWidth,l=r.effectiveFilterHeight,c=r.effectiveFilterWidth,d=r.padInfo.top,f=r.padInfo.left,h=this.bufferSync(n),v=0;v<r.batchSize;++v)for(var p=0;p<r.inChannels;++p)for(var m=0;m<r.outHeight;++m){for(var g=m*i-d,y=g;y<0;)y+=s;for(var w=Math.min(r.inHeight,l+g),x=0;x<r.outWidth;++x){for(var b=x*a-f,_=b;_<0;)_+=u;for(var E=Math.min(r.inWidth,c+b),C=Number.NEGATIVE_INFINITY,R=-1,S=y;S<w;S+=s)for(var P=S-g,A=_;A<E;A+=u){var B=A-b,M=h.get(v,S,A,p);M>C&&(C=M,R=P*c+B)}o.set(R,v,m,x,p)}}return o.toTensor()},e.prototype.maxPoolBackprop=function(n,r,o,i){X([r,o],"maxPoolBackprop");for(var a=this.maxPoolPositions(r,i),s=i.strideHeight,u=i.strideWidth,l=i.dilationHeight,c=i.dilationWidth,d=i.effectiveFilterHeight,f=i.effectiveFilterWidth,h=f-1-i.padInfo.left,v=d-1-i.padInfo.top,p=ge(r.shape,"float32"),m=this.bufferSync(a),g=this.bufferSync(n),y=0;y<i.batchSize;++y)for(var w=0;w<i.inChannels;++w)for(var x=0;x<i.inHeight;++x)for(var b=0;b<i.inWidth;++b){for(var _=x-v,E=b-h,C=0,R=0;R<d;R+=l){var S=(_+R)/s;if(!(S<0||S>=i.outHeight||Math.floor(S)!==S))for(var P=0;P<f;P+=c){var A=(E+P)/u;if(!(A<0||A>=i.outWidth||Math.floor(A)!==A)){var B=d*f-1-m.get(y,S,A,w)===R*f+P?1:0;B!==0&&(C+=g.get(y,S,A,w)*B)}}}p.set(C,y,x,b,w)}return p.toTensor()},e.prototype.avgPoolBackprop=function(n,r,o){X([n,r],"avgPoolBackprop");for(var i=o.strideHeight,a=o.strideWidth,s=o.filterHeight,u=o.filterWidth,l=o.dilationHeight,c=o.dilationWidth,d=o.effectiveFilterHeight,f=o.effectiveFilterWidth,h=f-1-o.padInfo.left,v=d-1-o.padInfo.top,p=ge(r.shape,"float32"),m=1/(s*u),g=this.bufferSync(n),y=0;y<o.batchSize;++y)for(var w=0;w<o.inChannels;++w)for(var x=0;x<o.inHeight;++x)for(var b=0;b<o.inWidth;++b){for(var _=x-v,E=b-h,C=0,R=0;R<d;R+=l){var S=(_+R)/i;if(!(S<0||S>=o.outHeight||Math.floor(S)!==S))for(var P=0;P<f;P+=c){var A=(E+P)/a;A<0||A>=o.outWidth||Math.floor(A)!==A||(C+=g.get(y,S,A,w))}}p.set(C*m,y,x,b,w)}return p.toTensor()},e.prototype.pool3d=function(n,r,o){X(n,"pool3d");for(var i=r.strideDepth,a=r.strideHeight,s=r.strideWidth,u=r.dilationDepth,l=r.dilationHeight,c=r.dilationWidth,d=r.effectiveFilterDepth,f=r.effectiveFilterHeight,h=r.effectiveFilterWidth,v=r.padInfo.front,p=r.padInfo.top,m=r.padInfo.left,g=o==="max"?Number.NEGATIVE_INFINITY:Number.POSITIVE_INFINITY,y=this.readSync(n.dataId),w=ge(r.outShape,n.dtype),x=w.values,b=r.outShape[1]*r.outShape[2]*r.outShape[3]*r.outShape[4],_=r.outShape[2]*r.outShape[3]*r.outShape[4],E=r.outShape[3]*r.outShape[4],C=r.outShape[4],R=0;R<r.batchSize;++R)for(var S=R*b,P=R*n.strides[0],A=0;A<r.inChannels;++A)for(var B=0;B<r.outDepth;++B){for(var M=B*i-v,j=M;j<0;)j+=u;for(var W=Math.min(r.inDepth,d+M),U=S+B*_,D=0;D<r.outHeight;++D){for(var F=D*a-p,$=F;$<0;)$+=l;for(var q=Math.min(r.inHeight,f+F),K=U+D*E,Q=0;Q<r.outWidth;++Q){for(var Z=Q*s-m,ue=Z;ue<0;)ue+=c;for(var fe=Math.min(r.inWidth,h+Z),oe=K+Q*C,xe=g,ye=0,Be=0,me=j;me<W;me+=u){for(var Ae=P+me*n.strides[1],Ce=$;Ce<q;Ce+=l){for(var Ue=Ae+Ce*n.strides[2],ze=ue;ze<fe;ze+=c){var je=y[Ue+ze*n.strides[3]+A];if(o==="max"&&je>xe?xe=je:o==="avg"&&(ye+=je,Be++),isNaN(xe))break}if(isNaN(xe))break}if(isNaN(xe))break}x[oe+A]=o==="avg"?ye/Be:xe}}}return w.toTensor()},e.prototype.avgPool3d=function(n,r){return X(n,"avgPool3d"),this.pool3d(n,r,"avg").toFloat()},e.prototype.avgPool3dBackprop=function(n,r,o){X([n,r],"avgPool3dBackprop");for(var i=o.strideDepth,a=o.strideHeight,s=o.strideWidth,u=o.filterDepth,l=o.filterHeight,c=o.filterWidth,d=o.dilationDepth,f=o.dilationHeight,h=o.dilationWidth,v=o.effectiveFilterDepth,p=o.effectiveFilterHeight,m=o.effectiveFilterWidth,g=v-1-o.padInfo.front,y=m-1-o.padInfo.left,w=p-1-o.padInfo.top,x=ge(r.shape,"float32"),b=1/(u*l*c),_=this.bufferSync(n),E=0;E<o.batchSize;++E)for(var C=0;C<o.inChannels;++C)for(var R=0;R<o.inDepth;++R)for(var S=0;S<o.inHeight;++S)for(var P=0;P<o.inWidth;++P){for(var A=R-g,B=S-w,M=P-y,j=0,W=0;W<v;W+=d){var U=(A+W)/i;if(!(U<0||U>=o.outDepth||Math.floor(U)!==U))for(var D=0;D<p;D+=f){var F=(B+D)/a;if(!(F<0||F>=o.outHeight||Math.floor(F)!==F))for(var $=0;$<m;$+=h){var q=(M+$)/s;q<0||q>=o.outWidth||Math.floor(q)!==q||(j+=_.get(E,U,F,q,C))}}}x.set(j*b,E,R,S,P,C)}return x.toTensor()},e.prototype.maxPool3d=function(n,r){return X(n,"maxPool3d"),this.pool3d(n,r,"max").toFloat()},e.prototype.maxPool3dPositions=function(n,r){for(var o=ge(r.outShape,"int32"),i=r.strideDepth,a=r.strideHeight,s=r.strideWidth,u=r.dilationDepth,l=r.dilationHeight,c=r.dilationWidth,d=r.effectiveFilterDepth,f=r.effectiveFilterHeight,h=r.effectiveFilterWidth,v=r.padInfo.front,p=r.padInfo.top,m=r.padInfo.left,g=this.bufferSync(n),y=0;y<r.batchSize;++y)for(var w=0;w<r.inChannels;++w)for(var x=0;x<r.outDepth;++x){for(var b=x*i-v,_=b;_<0;)_+=u;for(var E=Math.min(r.inDepth,d+b),C=0;C<r.outHeight;++C){for(var R=C*a-p,S=R;S<0;)S+=l;for(var P=Math.min(r.inHeight,f+R),A=0;A<r.outWidth;++A){for(var B=A*s-m,M=B;M<0;)M+=c;for(var j=Math.min(r.inWidth,h+B),W=Number.NEGATIVE_INFINITY,U=-1,D=_;D<E;D+=u)for(var F=D-b,$=S;$<P;$+=l)for(var q=$-R,K=M;K<j;K+=c){var Q=K-B,Z=g.get(y,D,$,K,w);Z>=W&&(W=Z,U=F*f*h+q*f+Q)}o.set(U,y,x,C,A,w)}}}return o.toTensor()},e.prototype.maxPool3dBackprop=function(n,r,o,i){X([r,o],"maxPool3dBackprop");for(var a=this.maxPool3dPositions(r,i),s=i.strideDepth,u=i.strideHeight,l=i.strideWidth,c=i.dilationDepth,d=i.dilationHeight,f=i.dilationWidth,h=i.effectiveFilterDepth,v=i.effectiveFilterHeight,p=i.effectiveFilterWidth,m=h-1-i.padInfo.front,g=p-1-i.padInfo.left,y=v-1-i.padInfo.top,w=ge(r.shape,"float32"),x=this.bufferSync(a),b=this.bufferSync(n),_=0;_<i.batchSize;++_)for(var E=0;E<i.inChannels;++E)for(var C=0;C<i.inDepth;++C)for(var R=0;R<i.inHeight;++R)for(var S=0;S<i.inWidth;++S){for(var P=C-m,A=R-y,B=S-g,M=0,j=0;j<h;j+=c){var W=(P+j)/s;if(!(W<0||W>=i.outDepth||Math.floor(W)!==W))for(var U=0;U<v;U+=d){var D=(A+U)/u;if(!(D<0||D>=i.outHeight||Math.floor(D)!==D))for(var F=0;F<p;F+=f){var $=(B+F)/l;if(!($<0||$>=i.outWidth||Math.floor($)!==$)){var q=h*v*p-1-x.get(_,W,D,$,E)===j*v*p+U*p+F?1:0;q!==0&&(M+=b.get(_,W,D,$,E)*q)}}}}w.set(M,_,C,R,S,E)}return w.toTensor()},e.prototype.cast=function(n,r){return hS(n,r,this)},e.prototype.reshape=function(n,r){return Im(n,r)},e.prototype.avgPool=function(n,r){return X(n,"avgPool"),this.pool(n,r,"avg").toFloat()},e.prototype.resizeBilinear=function(n,r,o,i){X(n,"resizeBilinear");for(var a=n.shape,s=a[0],u=a[1],l=a[2],c=a[3],d=this.readSync(n.dataId),f=new Float32Array(se([s,r,o,c])),h=[i&&r>1?u-1:u,i&&o>1?l-1:l],v=[i&&r>1?r-1:r,i&&o>1?o-1:o],p=0,m=h[0]/v[0],g=h[1]/v[1],y=0;y<s;y++)for(var w=0;w<r;w++)for(var x=m*w,b=Math.floor(x),_=x-b,E=Math.min(u-1,Math.ceil(x)),C=y*n.strides[0]+b*n.strides[1],R=y*n.strides[0]+E*n.strides[1],S=0;S<o;S++)for(var P=g*S,A=Math.floor(P),B=P-A,M=Math.min(l-1,Math.ceil(P)),j=C+A*n.strides[2],W=R+A*n.strides[2],U=C+M*n.strides[2],D=R+M*n.strides[2],F=0;F<c;F++){var $=d[j+F],q=d[W+F],K=$+(d[U+F]-$)*B,Q=K+(q+(d[D+F]-q)*B-K)*_;f[p++]=Q}return Lt(f,[s,r,o,c])},e.prototype.resizeBilinearBackprop=function(n,r,o){X([n,r],"resizeBilinearBackprop");for(var i=r.shape,a=i[0],s=i[1],u=i[2],l=i[3],c=n.shape,d=c[1],f=c[2],h=new Float32Array(a*s*u*l),v=[o&&d>1?s-1:s,o&&f>1?u-1:u],p=[o&&d>1?d-1:d,o&&f>1?f-1:f],m=v[0]/p[0],g=v[1]/p[1],y=this.readSync(n.dataId),w=0,x=0;x<a;x++)for(var b=x*r.strides[0],_=0;_<d;_++)for(var E=_*m,C=Math.floor(E),R=Math.min(Math.ceil(E),s-1),S=b+C*r.strides[1],P=b+R*r.strides[1],A=E-C,B=1-A,M=0;M<f;M++)for(var j=M*g,W=Math.floor(j),U=Math.min(Math.ceil(j),u-1),D=j-W,F=1-D,$=S+W*r.strides[2],q=S+U*r.strides[2],K=P+W*r.strides[2],Q=P+U*r.strides[2],Z=B*F,ue=B*D,fe=A*F,oe=A*D,xe=0;xe<l;xe++){var ye=y[w++];h[$+xe]+=ye*Z,h[q+xe]+=ye*ue,h[K+xe]+=ye*fe,h[Q+xe]+=ye*oe}return vn(h,[a,u,s,l],r.dtype)},e.prototype.resizeNearestNeighbor=function(n,r,o,i){X(n,"resizeNearestNeighbor");for(var a=n.shape,s=a[0],u=a[1],l=a[2],c=a[3],d=this.readSync(n.dataId),f=new Float32Array(s*r*o*c),h=[i&&r>1?u-1:u,i&&o>1?l-1:l],v=[i&&r>1?r-1:r,i&&o>1?o-1:o],p=h[0]/v[0],m=h[1]/v[1],g=0,y=0;y<s;y++)for(var w=y*n.strides[0],x=0;x<r;x++)for(var b=p*x,_=w+Math.min(u-1,i?Math.round(b):Math.floor(b))*n.strides[1],E=0;E<o;E++)for(var C=m*E,R=_+Math.min(l-1,i?Math.round(C):Math.floor(C))*n.strides[2],S=0;S<c;S++){var P=d[R+S];f[g++]=P}return Lt(f,[s,r,o,c],n.dtype)},e.prototype.resizeNearestNeighborBackprop=function(n,r,o){X([n,r],"resizeNearestNeighborBackprop");for(var i=r.shape,a=i[0],s=i[1],u=i[2],l=i[3],c=n.shape,d=c[1],f=c[2],h=new Float32Array(a*s*u*l),v=this.readSync(n.dataId),p=[o&&d>1?s-1:s,o&&f>1?u-1:u],m=[o&&d>1?d-1:d,o&&f>1?f-1:f],g=p[0]/m[0],y=p[1]/m[1],w=1/g,x=1/y,b=2*Math.ceil(w)+2,_=2*Math.ceil(x)+2,E=0;E<a;E++)for(var C=E*r.strides[0],R=0;R<s;R++)for(var S=C+R*r.strides[1],P=Math.floor(R*w),A=Math.floor(P-b/2),B=0;B<u;B++)for(var M=S+B*r.strides[2],j=Math.floor(B*x),W=Math.floor(j-_/2),U=0;U<l;U++){for(var D=0,F=0;F<b;F++){var $=F+A;if(!($<0||$>=d)){var q=C+$*n.strides[1],K=$*g;if(R===Math.min(s-1,o?Math.round(K):Math.floor(K)))for(var Q=0;Q<_;Q++){var Z=Q+W;if(!(Z<0||Z>=f)){var ue=q+Z*n.strides[2],fe=Z*y;B===Math.min(u-1,o?Math.round(fe):Math.floor(fe))&&(D+=v[ue+U])}}}}h[M+U]=D}return vn(h,r.shape,r.dtype)},e.prototype.batchNormalization=function(n,r,o,i,a,s){X([n,r,o,a,s],"batchNorm");for(var u=this.readSync(n.dataId),l=this.readSync(r.dataId),c=this.readSync(o.dataId),d=a?this.readSync(a.dataId):new Float32Array([1]),f=s?this.readSync(s.dataId):new Float32Array([0]),h=new Float32Array(u.length),v=f.length,p=d.length,m=c.length,g=l.length,y=0,w=0,x=0,b=0,_=0;_<u.length;++_)h[_]=f[y++]+(u[_]-l[w++])*d[x++]/Math.sqrt(c[b++]+i),y>=v&&(y=0),w>=g&&(w=0),x>=p&&(x=0),b>=m&&(b=0);return vn(h,n.shape)},e.prototype.localResponseNormalization4D=function(n,r,o,i,a){X(n,"localResponseNormalization4D");var s=n.shape[3],u=s-1,l=this.readSync(n.dataId),c=n.size,d=new Float32Array(c);function f(m){for(var g=m%s,y=m-g+Math.max(0,g-r),w=m-g+Math.min(g+r,u),x=0;y<=w;y++){var b=l[y];x+=b*b}return x}for(var h=0;h<c;h++){var v=f(h),p=l[h]*Math.pow(o+i*v,-a);d[h]=p}return vn(d,n.shape)},e.prototype.LRNGrad=function(n,r,o,i,a,s,u){X(n,"LRNGrad");for(var l=n.shape[3],c=this.readSync(n.dataId),d=this.readSync(r.dataId),f=this.readSync(o.dataId),h=new Float32Array(n.size),v=n.size,p=0;p<v;p++){for(var m=p%l,g=p-m+Math.max(0,m-i),y=p-m+Math.min(l,m+i+1),w=0,x=g;x<y;x++)w+=Math.pow(d[x],2);for(w=s*w+a,x=g;x<y;x++){var b=-2*s*u*d[x]*f[p]/w;p===x&&(b+=Math.pow(w,-u)),b*=c[p],h[x]+=b}}return vn(h,n.shape)},e.prototype.multinomial=function(n,r,o,i){X(n,"multinomial");for(var a=r?n:Ro(n),s=a.shape[0],u=a.shape[1],l=Ye([s,o],"int32"),c=this.readSync(l.dataId),d=this.readSync(a.dataId),f=0;f<s;++f){var h=f*u,v=new Float32Array(u-1);v[0]=d[h];for(var p=1;p<v.length;++p)v[p]=v[p-1]+d[h+p];for(var m=nh(i.toString()),g=f*o,y=0;y<o;++y){var w=m();c[g+y]=v.length;for(var x=0;x<v.length;x++)if(w<v[x]){c[g+y]=x;break}}}return l},e.prototype.oneHot=function(n,r,o,i){X(n,"oneHot");var a=new Float32Array(n.size*r);a.fill(i);for(var s=this.readSync(n.dataId),u=0;u<n.size;++u)s[u]>=0&&s[u]<r&&(a[u*r+s[u]]=o);return _i(a,[n.size,r],"int32")},e.prototype.nonMaxSuppression=function(n,r,o,i,a){return X(n,"nonMaxSuppression"),yy(this.readSync(n.dataId),this.readSync(r.dataId),o,i,a)},e.prototype.fft=function(n){return this.fftBatch(n,!1)},e.prototype.ifft=function(n){return this.fftBatch(n,!0)},e.prototype.fftBatch=function(n,r){for(var o=n.shape[0],i=n.shape[1],a=ge(n.shape,"float32"),s=ge(n.shape,"float32"),u=Hn(n).as2D(o,i),l=$r(n).as2D(o,i),c=0;c<o;c++)for(var d=u.slice([c,0],[1,i]),f=l.slice([c,0],[1,i]),h=Ft(d,f),v=this.readSync(this.fftImpl(h,r).dataId),p=0;p<i;p++){var m=Yw(v,p);a.values[c*i+p]=m.real,s.values[c*i+p]=m.imag}return Ft(a.toTensor(),s.toTensor()).as2D(o,i)},e.prototype.fftImpl=function(n,r){var o=n.as1D(),i=o.size;if(this.isExponentOf2(i)){var a=this.fftRadix2(o,i,r).as2D(n.shape[0],n.shape[1]);return r&&(a=Ft(Hn(a).div(ee(i)),$r(a).div(ee(i)))),a}var s=this.readSync(n.dataId),u=function(l){for(var c=new Float32Array(l.length/2),d=new Float32Array(l.length/2),f=0;f<l.length;f+=2)c[f/2]=l[f],d[f/2]=l[f+1];return{real:c,imag:d}}(this.fourierTransformByMatmul(s,i,r));return Ft(u.real,u.imag).as2D(n.shape[0],n.shape[1])},e.prototype.isExponentOf2=function(n){return(n&n-1)==0},e.prototype.fftRadix2=function(n,r,o){if(r===1)return n;var i=this.readSync(n.dataId),a=r/2,s=function(g){for(var y=Math.ceil(g.length/4),w=new Float32Array(y),x=new Float32Array(y),b=0;b<g.length;b+=4)w[Math.floor(b/4)]=g[b],x[Math.floor(b/4)]=g[b+1];return{real:w,imag:x}}(i),u=Ft(s.real,s.imag).as1D(),l=function(g){for(var y=Math.floor(g.length/4),w=new Float32Array(y),x=new Float32Array(y),b=2;b<g.length;b+=4)w[Math.floor(b/4)]=g[b],x[Math.floor(b/4)]=g[b+1];return{real:w,imag:x}}(i),c=Ft(l.real,l.imag).as1D();u=this.fftRadix2(u,a,o),c=this.fftRadix2(c,a,o);var d=function(g,y){for(var w=new Float32Array(g/2),x=new Float32Array(g/2),b=0;b<Math.ceil(g/2);b++){var _=(y?2:-2)*Math.PI*(b/g);w[b]=Math.cos(_),x[b]=Math.sin(_)}return{real:w,imag:x}}(r,o),f=Ft(d.real,d.imag).mul(c),h=u.add(f),v=u.sub(f),p=Hn(h).concat(Hn(v)),m=$r(h).concat($r(v));return Ft(p,m).as1D()},e.prototype.fourierTransformByMatmul=function(n,r,o){for(var i=new Float32Array(2*r),a=0;a<r;a++){for(var s=0,u=0,l=0;l<r;l++){var c=IB(a*l,r,o),d=Yw(n,l);s+=d.real*c.real-d.imag*c.imag,u+=d.real*c.imag+d.imag*c.real}o&&(s/=r,u/=r),TB(i,s,u,a)}return i},e.prototype.depthToSpace=function(n,r,o){I(o==="NHWC",function(){return"Only NHWC dataFormat supported on CPU for depthToSpace. Got "+o}),I(r>1,function(){return"blockSize should be > 1 for depthToSpace, but was: "+r});for(var i=n.shape[0],a=n.shape[1],s=n.shape[2],u=n.shape[3],l=a*r,c=s*r,d=u/(r*r),f=this.readSync(n.dataId),h=new Float32Array(i*l*c*d),v=0,p=0;p<i;++p)for(var m=0;m<l;++m)for(var g=Math.floor(m/r),y=m%r,w=0;w<c;++w)for(var x=Math.floor(w/r),b=(y*r+w%r)*d,_=0;_<d;++_){var E=_+b+u*(x+s*(g+a*p));h[v++]=f[E]}return vn(h,[i,l,c,d])},e.prototype.broadcastedBinaryOp=function(n,r,o,i){var a=Te(n.shape,r.shape),s=ge(a,o),u=this.readSync(n.dataId),l=this.readSync(r.dataId),c=ci(n.shape,a),d=ci(r.shape,a),f=s.values;if(c.length+d.length===0)for(var h=0;h<f.length;++h)f[h]=i(u[h%u.length],l[h%l.length]);else{var v=this.bufferSync(n),p=this.bufferSync(r),m=function(g){var y=s.indexToLoc(g),w=y.slice(-n.rank);c.forEach(function(E){return w[E]=0});var x=v.locToIndex(w),b=y.slice(-r.rank);d.forEach(function(E){return b[E]=0});var _=p.locToIndex(b);f[g]=i(u[x],l[_])};for(h=0;h<f.length;++h)m(h)}return s.toTensor()},e.prototype.broadcastedBinaryComplexOp=function(n,r,o){var i=Te(n.shape,r.shape),a=ge(i,"float32"),s=ge(i,"float32"),u=this.readSync(n.dataId),l=this.readSync(r.dataId),c=ci(n.shape,i),d=ci(r.shape,i),f=a.values,h=s.values;if(c.length+d.length===0)for(var v=0;v<f.length;v++){var p=v%u.length,m=v%l.length,g=o(u[2*p],u[2*p+1],l[2*m],l[2*m+1]);f[v]=g.real,h[v]=g.imag}else{var y=this.bufferSync(this.data.get(n.dataId).complexTensors.real),w=this.bufferSync(this.data.get(r.dataId).complexTensors.real),x=function(b){var _=a.indexToLoc(b),E=_.slice(-n.rank);c.forEach(function(A){return E[A]=0});var C=y.locToIndex(E),R=_.slice(-r.rank);d.forEach(function(A){return R[A]=0});var S=w.locToIndex(R),P=o(u[2*C],u[2*C+1],l[2*S],l[2*S+1]);f[b]=P.real,h[b]=P.imag};for(v=0;v<f.length;v++)x(v)}return this.complex(a.toTensor(),s.toTensor())},e.prototype.split=function(n,r,o){return mS(n,r,o)},e.prototype.dispose=function(){},e.prototype.floatPrecision=function(){return 32},e.prototype.epsilon=function(){return 1e-7},e.prototype.cropAndResize=function(n,r,o,i,a,s){for(var u=n.shape,l=u[0],c=u[1],d=u[2],f=u[3],h=r.shape[0],v=i[0],p=i[1],m=ge([h,v,p,f],"float32"),g=this.readSync(r.dataId),y=this.readSync(o.dataId),w=this.readSync(n.dataId),x=n.strides,b=m.strides,_=0;_<h;_++){var E=4*_,C=g[E],R=g[E+1],S=g[E+2],P=g[E+3],A=y[_];if(!(A>=l))for(var B=v>1?(S-C)*(c-1)/(v-1):0,M=p>1?(P-R)*(d-1)/(p-1):0,j=0;j<v;j++){var W=v>1?C*(c-1)+j*B:.5*(C+S)*(c-1);if(W<0||W>c-1)for(var U=0;U<p;U++)for(var D=0;D<f;D++){var F=D+U*b[2]+j*b[1]+_*b[0];m.values[F]=s}else if(a==="bilinear"){var $=Math.floor(W),q=Math.ceil(W),K=W-$;for(U=0;U<p;U++)if((me=p>1?R*(d-1)+U*M:.5*(R+P)*(d-1))<0||me>d-1)for(D=0;D<f;D++)F=D+U*b[2]+j*b[1]+_*b[0],m.values[F]=s;else{var Q=Math.floor(me),Z=Math.ceil(me),ue=me-Q;for(D=0;D<f;D++){var fe=w[F=D+Q*x[2]+$*x[1]+A*x[0]],oe=w[F=D+Z*x[2]+$*x[1]+A*x[0]],xe=w[F=D+Q*x[2]+q*x[1]+A*x[0]],ye=fe+(oe-fe)*ue,Be=xe+(w[F=D+Z*x[2]+q*x[1]+A*x[0]]-xe)*ue;F=D+U*b[2]+j*b[1]+_*b[0],m.values[F]=ye+(Be-ye)*K}}}else for(U=0;U<p;++U){var me;if((me=p>1?R*(d-1)+U*M:.5*(R+P)*(d-1))<0||me>d-1)for(D=0;D<f;D++)F=D+U*b[2]+j*b[1]+_*b[0],m.values[F]=s;else{var Ae=Math.round(me),Ce=Math.round(W);for(D=0;D<f;D++){var Ue=D+Ae*x[2]+Ce*x[1]+A*x[0],ze=D+U*b[2]+j*b[1]+_*b[0];m.values[ze]=w[Ue]}}}}}return m.toTensor()},e.prototype.sparseToDense=function(n,r,o,i){var a=lf(0,n,o),s=a.sliceRank,u=a.numUpdates,l=a.sliceSize,c=a.strides,d=a.outputSize;return this.scatter(n,r,o,d,l,u,s,c,i,!1)},e.prototype.gatherND=function(n,r){var o=r.shape,i=o[o.length-1],a=aS(n,r),s=a[0],u=a[1],l=a[2],c=a[3];if(u===0)return Lt([],s,n.dtype);for(var d=new Rl([u,l],n.dtype),f=this.readSync(r.dataId),h=this.readSync(n.dataId),v=0;v<u;v++){for(var p=[],m=0,g=0;g<i;g++){var y=f[v*i+g];m+=y*c[g],p.push(y)}if(m<0||m>=n.size/l)throw new Error("Invalid indices: "+p+" does not index into "+n.shape);for(var w=0;w<l;w++)d.values[v*l+w]=h[m*l+w]}return d.toTensor().reshape(s)},e.prototype.scatterND=function(n,r,o){var i=lf(0,n,o),a=i.sliceRank,s=i.numUpdates,u=i.sliceSize,l=i.strides,c=i.outputSize,d=ee(0);return this.scatter(n,r,o,c,u,s,a,l,d,!0)},e.prototype.fill=function(n,r,o){var i=Jd(o=o||Xl(r),se(n));return i.fill(r),L.makeTensor(i,n,o,this)},e.prototype.onesLike=function(n){if(n.dtype==="string")throw new Error("onesLike is not supported for string tensors");return this.fill(n.shape,1,n.dtype)},e.prototype.zerosLike=function(n){var r=Jd(n.dtype,se(n.shape));return this.makeOutput(r,n.shape,n.dtype)},e.prototype.linspace=function(n,r,o){return pS(n,r,o)},e.prototype.scatter=function(n,r,o,i,a,s,u,l,c,d){var f=[i/a,a],h=this.readSync(n.dataId),v=this.readSync(r.dataId);if(i===0)return Lt([],o,r.dtype);var p=new Rl(f,r.dtype);p.values.fill(this.readSync(c.dataId)[0]);for(var m=0;m<s;m++){for(var g=[],y=0,w=0;w<u;w++){var x=h[m*u+w];g.push(x),y+=x*l[w]}if(y<0||y>=i/a)throw new Error("Invalid indices: "+g+" does not index into "+o);for(var b=0;b<a;b++)d?p.values[y*a+b]+=v[m*a+b]:p.values[y*a+b]=r.rank===0?v[0]:v[m*a+b]}return p.toTensor().reshape(o)},e}(dS);L.registerBackend("cpu",function(){return new XU},1);for(var Pp=0,yx=[{kernelName:"NonMaxSuppressionV5",backendName:"cpu",kernelFunc:function(t){var e=t.inputs,n=t.backend,r=t.attrs,o=e,i=o.boxes,a=o.scores,s=r,u=s.maxOutputSize,l=s.iouThreshold,c=s.scoreThreshold,d=s.softNmsSigma,f=n;X(i,"NonMaxSuppressionWithScore");var h=wy(f.data.get(i.dataId).values,f.data.get(a.dataId).values,u,l,c,d);return[h.selectedIndices,h.selectedScores]}},{kernelName:"Square",backendName:"cpu",kernelFunc:function(t){var e=t.inputs,n=t.backend,r=e.x,o=n;X(r,"square");for(var i=o.data.get(r.dataId).values,a=new Float32Array(i.length),s=0;s<i.length;++s){var u=i[s];a[s]=u*u}return{dataId:o.write(a,r.shape,r.dtype),shape:r.shape,dtype:r.dtype}}},{kernelName:Al,backendName:"cpu",kernelFunc:function(t){var e=t.inputs,n=t.backend,r=e,o=r.a,i=r.b,a=n;X([o,i],Al);var s=a.data.get(o.dataId).values,u=a.data.get(i.dataId).values,l=function(f,h,v,p,m,g){var y=Te(f,h),w=y.length,x=Gr(y),b=kl(m,se(y)),_=f.length,E=h.length,C=Gr(f),R=Gr(h),S=ci(f,y),P=ci(h,y);if(S.length+P.length===0)for(var A=0;A<b.length;++A)b[A]=g(v[A%v.length],p[A%p.length]);else{var B=function(M){var j=iL(M,w,x),W=j.slice(-_);S.forEach(function($){return W[$]=0});var U=Ww(W,_,C),D=j.slice(-E);P.forEach(function($){return D[$]=0});var F=Ww(D,E,R);b[M]=g(v[U],p[F])};for(A=0;A<b.length;++A)B(A)}return[b,y]}(o.shape,i.shape,s,u,o.dtype,function(f,h){var v=f-h;return v*v}),c=l[0],d=l[1];return{dataId:a.write(c,d,o.dtype),shape:d,dtype:o.dtype}}}];Pp<yx.length;Pp++)$C(yx[Pp]);var Xa,YU=function(t){this.variableNames=["A"];var e=Kt(),n=t[0],r=t[1];this.outputShape=t,this.userCode=`
      void main() {
        ivec3 coords = getOutputCoords();
        int texR = coords[0];
        int texC = coords[1];
        int depth = coords[2];
        vec2 uv = (vec2(texC, texR) + halfCR) / vec2(`+r+".0, "+n+`.0);

        vec4 values = `+e.texture2D+`(A, uv);
        float value;
        if (depth == 0) {
          value = values.r;
        } else if (depth == 1) {
          value = values.g;
        } else if (depth == 2) {
          value = values.b;
        } else if (depth == 3) {
          value = values.a;
        }

        setOutput(floor(value * 255.0 + 0.5));
      }
    `},QU=function(t){this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0;var e=Kt(),n=t[0],r=t[1];this.outputShape=t,this.userCode=`
      void main() {
        ivec3 coords = getOutputCoords();
        int texR = coords[0];
        int texC = coords[1];
        int depth = coords[2];

        vec4 result = vec4(0.);

        for(int row=0; row<=1; row++) {
          for(int col=0; col<=1; col++) {
            texC = coords[1] + row;
            depth = coords[2] + col;

            vec2 uv = (vec2(texC, texR) + halfCR) /
                       vec2(`+r+".0, "+n+`.0);
            vec4 values = `+e.texture2D+`(A, uv);
            float value;
            if (depth == 0) {
              value = values.r;
            } else if (depth == 1) {
              value = values.g;
            } else if (depth == 2) {
              value = values.b;
            } else if (depth == 3) {
              value = values.a;
            }

            result[row * 2 + col] = floor(value * 255.0 + 0.5);
          }
        }

        `+e.output+` = result;
      }
    `};for(var Dp=0,wx=[{kernelName:"FromPixels",backendName:"webgl",kernelFunc:function(t){var e=t.inputs,n=t.backend,r=t.attrs,o=e.pixels,i=r.numChannels,a=typeof HTMLVideoElement<"u"&&o instanceof HTMLVideoElement,s=typeof HTMLImageElement<"u"&&o instanceof HTMLImageElement,u=a?[o.videoWidth,o.videoHeight]:[o.width,o.height],l=u[0],c=u[1],d=[c,l],f=[c,l,i];(s||a)&&(Xa==null&&(Xa=document.createElement("canvas").getContext("2d")),Xa.canvas.width=l,Xa.canvas.height=c,Xa.drawImage(o,0,0,l,c),o=Xa.canvas);var h=n.makeTensorInfo(d,"int32");n.texData.get(h.dataId).usage=An.PIXELS,n.gpgpu.uploadPixelDataToTexture(n.getTexture(h.dataId),o);var v=H().getBool("WEBGL_PACK")?new QU(f):new YU(f),p=n.runWebGLProgram(v,[h],"int32");return n.disposeData(h.dataId),p}},{kernelName:"NonMaxSuppressionV5",backendName:"webgl",kernelFunc:function(t){var e=t.inputs,n=t.backend,r=t.attrs;nf("tf.nonMaxSuppression() in webgl locks the UI thread. Call tf.nonMaxSuppressionAsync() instead");var o=e,i=o.boxes,a=o.scores,s=r,u=s.maxOutputSize,l=s.iouThreshold,c=s.scoreThreshold,d=s.softNmsSigma,f=n,h=wy(f.readSync(i.dataId),f.readSync(a.dataId),u,l,c,d);return[h.selectedIndices,h.selectedScores]}},{kernelName:"Square",backendName:"webgl",kernelFunc:function(t){var e=t.inputs,n=t.backend,r=e.x,o=n,i=new Ee(r.shape,"return x * x;");return o.runWebGLProgram(i,[r],r.dtype)}},{kernelName:Al,backendName:"webgl",kernelFunc:function(t){var e=t.inputs,n=t.backend,r=e,o=r.a,i=r.b,a=n,s=H().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new ao("return (a - b) * (a - b);",o.shape,i.shape):new st("return (a - b) * (a - b);",o.shape,i.shape);return a.compileAndRun(s,[o,i])}}];Dp<wx.length;Dp++)$C(wx[Dp]);for(var Np=0,xx=[{kernelName:"Square",gradFunc:function(t,e){var n=e[0];return{x:function(){return t.mul(n.toFloat().mul(2))}}}},{kernelName:Al,gradFunc:function(t,e){var n=e[0],r=e[1],o=ee(2);return{a:function(){return Yt(t,Yt(o,St(n,r)))},b:function(){return Yt(t,Yt(o,St(r,n)))}}}}];Np<xx.length;Np++)K4(xx[Np]);var JU=function(){function t(){}return t.prototype.fetch=function(e,n){return fetch(e,n)},t.prototype.now=function(){return performance.now()},t.prototype.encode=function(e,n){if(n!=="utf-8"&&n!=="utf8")throw new Error("Browser's encoder only supports utf-8, but got "+n);return this.textEncoder==null&&(this.textEncoder=new TextEncoder),this.textEncoder.encode(e)},t.prototype.decode=function(e,n){return new TextDecoder(n).decode(e)},t}();H().get("IS_BROWSER")&&H().setPlatform("browser",new JU);var Op,ZU=function(){return require("node-fetch")},ez=function(){function t(){this.util=require("util"),this.textEncoder=new this.util.TextEncoder}return t.prototype.fetch=function(e,n){return H().global.fetch!=null?H().global.fetch(e,n):(Op==null&&(Op=ZU()),Op(e,n))},t.prototype.now=function(){var e=process.hrtime();return 1e3*e[0]+e[1]/1e6},t.prototype.encode=function(e,n){if(n!=="utf-8"&&n!=="utf8")throw new Error("Node built-in encoder only supports utf-8, but got "+n);return this.textEncoder.encode(e)},t.prototype.decode=function(e,n){return e.length===0?"":new this.util.TextDecoder(n).decode(e)},t}();H().get("IS_NODE")&&H().setPlatform("node",new ez);var Dm={float32:4,int32:4,uint16:2,uint8:1,bool:1},mf=4;function uk(t,e){for(var n={},r=0,o=function(s){var u=s.name,l=s.dtype,c=s.shape,d=se(c),f=void 0;if("quantization"in s){var h=s.quantization;if(h.dtype!=="uint8"&&h.dtype!=="uint16")throw new Error("Weight "+s.name+" has unknown quantization dtype "+h.dtype+". Supported quantization dtypes are: 'uint8' and 'uint16'.");var v=Dm[h.dtype],p=t.slice(r,r+d*v),m=h.dtype==="uint8"?new Uint8Array(p):new Uint16Array(p);if(l==="float32")f=Float32Array.from(m,function(_){return _*h.scale+h.min});else{if(l!=="int32")throw new Error("Unsupported dtype in weight '"+u+"': "+l);f=Int32Array.from(m,function(_){return Math.round(_*h.scale+h.min)})}r+=d*v}else if(l==="string"){var g=se(s.shape);f=[];for(var y=0;y<g;y++){var w=new Uint32Array(t.slice(r,r+mf))[0];r+=mf;var x=new Uint8Array(t.slice(r,r+w));f.push(x),r+=w}}else{var b=Dm[l];if(p=t.slice(r,r+d*b),l==="float32")f=new Float32Array(p);else if(l==="int32")f=new Int32Array(p);else{if(l!=="bool")throw new Error("Unsupported dtype in weight '"+u+"': "+l);f=new Uint8Array(p)}r+=d*b}n[u]=Lt(f,c,l)},i=0,a=e;i<a.length;i++)o(a[i]);return n}function tz(t){if(t===null)throw new Error("Invalid input value: "+JSON.stringify(t));var e=0,n=[];t.forEach(function(i){if(e+=i.byteLength,n.push(i.byteLength===i.buffer.byteLength?i:new i.constructor(i)),!(i instanceof Float32Array||i instanceof Int32Array||i instanceof Uint8Array))throw new Error("Unsupported TypedArray subtype: "+i.constructor.name)});var r=new Uint8Array(e),o=0;return n.forEach(function(i){r.set(new Uint8Array(i.buffer),o),o+=i.byteLength}),r.buffer}var Nm=typeof Buffer<"u"&&(typeof Blob>"u"||typeof atob>"u"||typeof btoa>"u");function bx(t){return Nm?Buffer.byteLength(t):new Blob([t]).size}function By(t){var e=0;t.forEach(function(o){e+=o.byteLength});var n=new Uint8Array(e),r=0;return t.forEach(function(o){n.set(new Uint8Array(o),r),r+=o.byteLength}),n.buffer}function _x(t){for(t=t.trim();t.endsWith("/");)t=t.slice(0,t.length-1);var e=t.split("/");return e[e.length-1]}function nc(t){if(t.modelTopology instanceof ArrayBuffer)throw new Error("Expected JSON model topology, received ArrayBuffer.");return{dateSaved:new Date,modelTopologyType:"JSON",modelTopologyBytes:t.modelTopology==null?0:bx(JSON.stringify(t.modelTopology)),weightSpecsBytes:t.weightSpecs==null?0:bx(JSON.stringify(t.weightSpecs)),weightDataBytes:t.weightData==null?0:t.weightData.byteLength}}var Pn=function(){function t(){this.saveRouters=[],this.loadRouters=[]}return t.getInstance=function(){return t.instance==null&&(t.instance=new t),t.instance},t.registerSaveRouter=function(e){t.getInstance().saveRouters.push(e)},t.registerLoadRouter=function(e){t.getInstance().loadRouters.push(e)},t.getSaveHandlers=function(e){return t.getHandlers(e,"save")},t.getLoadHandlers=function(e,n){return t.getHandlers(e,"load",n)},t.getHandlers=function(e,n,r){var o=[];return(n==="load"?t.getInstance().loadRouters:t.getInstance().saveRouters).forEach(function(i){var a=i(e,r);a!==null&&o.push(a)}),o},t}(),Ts="://",Ei=function(){function t(){this.managers={}}return t.getInstance=function(){return t.instance==null&&(t.instance=new t),t.instance},t.registerManager=function(e,n){I(e!=null,function(){return"scheme must not be undefined or null."}),e.endsWith(Ts)&&(e=e.slice(0,e.indexOf(Ts))),I(e.length>0,function(){return"scheme must not be an empty string."});var r=t.getInstance();I(r.managers[e]==null,function(){return"A model store manager is already registered for scheme '"+e+"'."}),r.managers[e]=n},t.getManager=function(e){var n=this.getInstance().managers[e];if(n==null)throw new Error("Cannot find model manager for scheme '"+e+"'");return n},t.getSchemes=function(){return Object.keys(this.getInstance().managers)},t}();function vd(t){if(t.indexOf(Ts)===-1)throw new Error("The url string provided does not contain a scheme. Supported schemes are: "+Ei.getSchemes().join(","));return{scheme:t.split(Ts)[0],path:t.split(Ts)[1]}}function Ex(t,e,n){return n===void 0&&(n=!1),ie(this,void 0,void 0,function(){var r,o,i,a,s,u,l,c,d;return ae(this,function(f){switch(f.label){case 0:return I(t!==e,function(){return"Old path and new path are the same: '"+t+"'"}),I((r=Pn.getLoadHandlers(t)).length>0,function(){return"Copying failed because no load handler is found for source URL "+t+"."}),I(r.length<2,function(){return"Copying failed because more than one ("+r.length+") load handlers for source URL "+t+"."}),o=r[0],I((i=Pn.getSaveHandlers(e)).length>0,function(){return"Copying failed because no save handler is found for destination URL "+e+"."}),I(i.length<2,function(){return"Copying failed because more than one ("+r.length+") save handlers for destination URL "+e+"."}),a=i[0],s=vd(t).scheme,u=vd(t).path,l=s===vd(t).scheme,[4,o.load()];case 1:return c=f.sent(),n&&l?[4,Ei.getManager(s).removeModel(u)]:[3,3];case 2:f.sent(),f.label=3;case 3:return[4,a.save(c)];case 4:return d=f.sent(),!n||l?[3,6]:[4,Ei.getManager(s).removeModel(u)];case 5:f.sent(),f.label=6;case 6:return[2,d.modelArtifactsInfo]}})})}var na="models_store",di="model_info_store";function lk(){if(!H().getBool("IS_BROWSER"))throw new Error("Failed to obtain IndexedDB factory because the current environmentis not a web browser.");var t=window||self,e=t.indexedDB||t.mozIndexedDB||t.webkitIndexedDB||t.msIndexedDB||t.shimIndexedDB;if(e==null)throw new Error("The current browser does not appear to support IndexedDB.");return e}function Om(t){var e=t.result;e.createObjectStore(na,{keyPath:"modelPath"}),e.createObjectStore(di,{keyPath:"modelPath"})}var Is=function(){function t(e){if(this.indexedDB=lk(),e==null||!e)throw new Error("For IndexedDB, modelPath must not be null, undefined or empty.");this.modelPath=e}return t.prototype.save=function(e){return ie(this,void 0,void 0,function(){return ae(this,function(n){if(e.modelTopology instanceof ArrayBuffer)throw new Error("BrowserLocalStorage.save() does not support saving model topology in binary formats yet.");return[2,this.databaseAction(this.modelPath,e)]})})},t.prototype.load=function(){return ie(this,void 0,void 0,function(){return ae(this,function(e){return[2,this.databaseAction(this.modelPath)]})})},t.prototype.databaseAction=function(e,n){var r=this;return new Promise(function(o,i){var a=r.indexedDB.open("tensorflowjs",1);a.onupgradeneeded=function(){return Om(a)},a.onsuccess=function(){var s=a.result;if(n==null){var u=s.transaction(na,"readonly"),l=u.objectStore(na).get(r.modelPath);l.onsuccess=function(){if(l.result==null)return s.close(),i(new Error("Cannot find model with path '"+r.modelPath+"' in IndexedDB."));o(l.result.modelArtifacts)},l.onerror=function(p){return s.close(),i(l.error)},u.oncomplete=function(){return s.close()}}else{var c,d=nc(n),f=s.transaction(di,"readwrite"),h=f.objectStore(di),v=h.put({modelPath:r.modelPath,modelArtifactsInfo:d});v.onsuccess=function(){var p=(c=s.transaction(na,"readwrite")).objectStore(na).put({modelPath:r.modelPath,modelArtifacts:n,modelArtifactsInfo:d});p.onsuccess=function(){return o({modelArtifactsInfo:d})},p.onerror=function(m){var g=(h=f.objectStore(di)).delete(r.modelPath);g.onsuccess=function(){return s.close(),i(p.error)},g.onerror=function(y){return s.close(),i(p.error)}}},v.onerror=function(p){return s.close(),i(v.error)},f.oncomplete=function(){c==null?s.close():c.oncomplete=function(){return s.close()}}}},a.onerror=function(s){return i(a.error)}})},t.URL_SCHEME="indexeddb://",t}(),Cx=function(t){return H().getBool("IS_BROWSER")&&!Array.isArray(t)&&t.startsWith(Is.URL_SCHEME)?(e=t.slice(Is.URL_SCHEME.length),new Is(e)):null;var e};Pn.registerSaveRouter(Cx),Pn.registerLoadRouter(Cx);var nz=function(){function t(){this.indexedDB=lk()}return t.prototype.listModels=function(){return ie(this,void 0,void 0,function(){var e=this;return ae(this,function(n){return[2,new Promise(function(r,o){var i=e.indexedDB.open("tensorflowjs",1);i.onupgradeneeded=function(){return Om(i)},i.onsuccess=function(){var a=i.result,s=a.transaction(di,"readonly"),u=s.objectStore(di).getAll();u.onsuccess=function(){for(var l={},c=0,d=u.result;c<d.length;c++){var f=d[c];l[f.modelPath]=f.modelArtifactsInfo}r(l)},u.onerror=function(l){return a.close(),o(u.error)},s.oncomplete=function(){return a.close()}},i.onerror=function(a){return o(i.error)}})]})})},t.prototype.removeModel=function(e){return ie(this,void 0,void 0,function(){var n=this;return ae(this,function(r){var o;return e=(o=e).startsWith(Is.URL_SCHEME)?o.slice(Is.URL_SCHEME.length):o,[2,new Promise(function(i,a){var s=n.indexedDB.open("tensorflowjs",1);s.onupgradeneeded=function(){return Om(s)},s.onsuccess=function(){var u,l=s.result,c=l.transaction(di,"readwrite"),d=c.objectStore(di),f=d.get(e);f.onsuccess=function(){if(f.result==null)return l.close(),a(new Error("Cannot find model with path '"+e+"' in IndexedDB."));var h=d.delete(e),v=function(){var p=(u=l.transaction(na,"readwrite")).objectStore(na).delete(e);p.onsuccess=function(){return i(f.result.modelArtifactsInfo)},p.onerror=function(m){return a(f.error)}};h.onsuccess=v,h.onerror=function(p){return v(),l.close(),a(f.error)}},f.onerror=function(h){return l.close(),a(f.error)},c.oncomplete=function(){u==null?l.close():u.oncomplete=function(){return l.close()}}},s.onerror=function(u){return a(s.error)}})]})})},t}();if(H().getBool("IS_BROWSER"))try{Ei.registerManager(Is.URL_SCHEME,new nz)}catch{}var ho="/",rs="tensorflowjs_models",ck="info",rz="model_topology",oz="weight_specs",iz="weight_data",az="model_metadata";function dk(t){return{info:[rs,t,ck].join(ho),topology:[rs,t,rz].join(ho),weightSpecs:[rs,t,oz].join(ho),weightData:[rs,t,iz].join(ho),modelMetadata:[rs,t,az].join(ho)}}function sz(t){var e=t.split(ho);if(e.length<3)throw new Error("Invalid key format: "+t);return e.slice(1,e.length-1).join(ho)}var As=function(){function t(e){if(!H().getBool("IS_BROWSER")||typeof window>"u"||window.localStorage===void 0)throw new Error("The current environment does not support local storage.");if(this.LS=window.localStorage,e==null||!e)throw new Error("For local storage, modelPath must not be null, undefined or empty.");this.modelPath=e,this.keys=dk(this.modelPath)}return t.prototype.save=function(e){return ie(this,void 0,void 0,function(){var n,r,o;return ae(this,function(i){if(e.modelTopology instanceof ArrayBuffer)throw new Error("BrowserLocalStorage.save() does not support saving model topology in binary formats yet.");n=JSON.stringify(e.modelTopology),r=JSON.stringify(e.weightSpecs),o=nc(e);try{return this.LS.setItem(this.keys.info,JSON.stringify(o)),this.LS.setItem(this.keys.topology,n),this.LS.setItem(this.keys.weightSpecs,r),this.LS.setItem(this.keys.weightData,function(a){if(Nm)return Buffer.from(a).toString("base64");for(var s=new Uint8Array(a),u="",l=0,c=s.length;l<c;l++)u+=String.fromCharCode(s[l]);return btoa(u)}(e.weightData)),this.LS.setItem(this.keys.modelMetadata,JSON.stringify({format:e.format,generatedBy:e.generatedBy,convertedBy:e.convertedBy,userDefinedMetadata:e.userDefinedMetadata})),[2,{modelArtifactsInfo:o}]}catch{throw this.LS.removeItem(this.keys.info),this.LS.removeItem(this.keys.topology),this.LS.removeItem(this.keys.weightSpecs),this.LS.removeItem(this.keys.weightData),this.LS.removeItem(this.keys.modelMetadata),new Error("Failed to save model '"+this.modelPath+"' to local storage: size quota being exceeded is a possible cause of this failure: modelTopologyBytes="+o.modelTopologyBytes+", weightSpecsBytes="+o.weightSpecsBytes+", weightDataBytes="+o.weightDataBytes+".")}return[2]})})},t.prototype.load=function(){return ie(this,void 0,void 0,function(){var e,n,r,o,i,a,s;return ae(this,function(u){if((e=JSON.parse(this.LS.getItem(this.keys.info)))==null)throw new Error("In local storage, there is no model with name '"+this.modelPath+"'");if(e.modelTopologyType!=="JSON")throw new Error("BrowserLocalStorage does not support loading non-JSON model topology yet.");if(n={},(r=JSON.parse(this.LS.getItem(this.keys.topology)))==null)throw new Error("In local storage, the topology of model '"+this.modelPath+"' is missing.");if(n.modelTopology=r,(o=JSON.parse(this.LS.getItem(this.keys.weightSpecs)))==null)throw new Error("In local storage, the weight specs of model '"+this.modelPath+"' are missing.");if(n.weightSpecs=o,(i=this.LS.getItem(this.keys.modelMetadata))!=null&&(a=JSON.parse(i),n.format=a.format,n.generatedBy=a.generatedBy,n.convertedBy=a.convertedBy,n.userDefinedMetadata=a.userDefinedMetadata),(s=this.LS.getItem(this.keys.weightData))==null)throw new Error("In local storage, the binary weight values of model '"+this.modelPath+"' are missing.");return n.weightData=function(l){if(Nm){var c=Buffer.from(l,"base64");return c.buffer.slice(c.byteOffset,c.byteOffset+c.byteLength)}for(var d=atob(l),f=new Uint8Array(d.length),h=0;h<d.length;++h)f.set([d.charCodeAt(h)],h);return f.buffer}(s),[2,n]})})},t.URL_SCHEME="localstorage://",t}(),Sx=function(t){return H().getBool("IS_BROWSER")&&!Array.isArray(t)&&t.startsWith(As.URL_SCHEME)?(e=t.slice(As.URL_SCHEME.length),new As(e)):null;var e};Pn.registerSaveRouter(Sx),Pn.registerLoadRouter(Sx);var uz=function(){function t(){I(H().getBool("IS_BROWSER"),function(){return"Current environment is not a web browser"}),I(typeof window>"u"||window.localStorage!==void 0,function(){return"Current browser does not appear to support localStorage"}),this.LS=window.localStorage}return t.prototype.listModels=function(){return ie(this,void 0,void 0,function(){var e,n,r,o,i,a;return ae(this,function(s){for(e={},n=rs+ho,r=ho+ck,o=0;o<this.LS.length;++o)(i=this.LS.key(o)).startsWith(n)&&i.endsWith(r)&&(a=sz(i),e[a]=JSON.parse(this.LS.getItem(i)));return[2,e]})})},t.prototype.removeModel=function(e){return ie(this,void 0,void 0,function(){var n,r;return ae(this,function(o){var i;if(e=(i=e).startsWith(As.URL_SCHEME)?i.slice(As.URL_SCHEME.length):i,n=dk(e),this.LS.getItem(n.info)==null)throw new Error("Cannot find model at path '"+e+"'");return r=JSON.parse(this.LS.getItem(n.info)),this.LS.removeItem(n.info),this.LS.removeItem(n.topology),this.LS.removeItem(n.weightSpecs),this.LS.removeItem(n.weightData),[2,r]})})},t}();if(H().getBool("IS_BROWSER"))try{Ei.registerManager(As.URL_SCHEME,new uz)}catch{}var lz="model",cz=".json",dz=".weights.bin";function kx(t){return new Promise(function(e){return setTimeout(e)}).then(t)}var Fp=function(){function t(e){if(!H().getBool("IS_BROWSER"))throw new Error("browserDownloads() cannot proceed because the current environment is not a browser.");e.startsWith(t.URL_SCHEME)&&(e=e.slice(t.URL_SCHEME.length)),e!=null&&e.length!==0||(e=lz),this.modelTopologyFileName=e+cz,this.weightDataFileName=e+dz}return t.prototype.save=function(e){return ie(this,void 0,void 0,function(){var n,r,o,i,a,s;return ae(this,function(u){switch(u.label){case 0:if(typeof document>"u")throw new Error("Browser downloads are not supported in this environment since `document` is not present");if(n=window.URL.createObjectURL(new Blob([e.weightData],{type:"application/octet-stream"})),!(e.modelTopology instanceof ArrayBuffer))return[3,1];throw new Error("BrowserDownloads.save() does not support saving model topology in binary formats yet.");case 1:return r=[{paths:["./"+this.weightDataFileName],weights:e.weightSpecs}],o={modelTopology:e.modelTopology,format:e.format,generatedBy:e.generatedBy,convertedBy:e.convertedBy,weightsManifest:r},i=window.URL.createObjectURL(new Blob([JSON.stringify(o)],{type:"application/json"})),(a=this.jsonAnchor==null?document.createElement("a"):this.jsonAnchor).download=this.modelTopologyFileName,a.href=i,[4,kx(function(){return a.dispatchEvent(new MouseEvent("click"))})];case 2:return u.sent(),e.weightData==null?[3,4]:((s=this.weightDataAnchor==null?document.createElement("a"):this.weightDataAnchor).download=this.weightDataFileName,s.href=n,[4,kx(function(){return s.dispatchEvent(new MouseEvent("click"))})]);case 3:u.sent(),u.label=4;case 4:return[2,{modelArtifactsInfo:nc(e)}]}})})},t.URL_SCHEME="downloads://",t}(),fz=function(){function t(e){if(e==null||e.length<1)throw new Error("When calling browserFiles, at least 1 file is required, but received "+e);this.files=e}return t.prototype.load=function(){return ie(this,void 0,void 0,function(){var e,n,r=this;return ae(this,function(o){return e=this.files[0],n=this.files.slice(1),[2,new Promise(function(i,a){var s=new FileReader;s.onload=function(u){var l=JSON.parse(u.target.result),c=l.modelTopology;if(c!=null){n.length===0&&i({modelTopology:c});var d=l.weightsManifest;if(d!=null){var f;try{f=r.checkManifestAndWeightFiles(d,n)}catch(m){return void a(m)}var h=[],v=[],p=[];d.forEach(function(m){m.paths.forEach(function(g){v.push(g),p.push(null)}),h.push.apply(h,m.weights)}),d.forEach(function(m){m.paths.forEach(function(g){var y=new FileReader;y.onload=function(w){var x=w.target.result,b=v.indexOf(g);p[b]=x,p.indexOf(null)===-1&&i({modelTopology:c,weightSpecs:h,weightData:By(p),format:l.format,generatedBy:l.generatedBy,convertedBy:l.convertedBy,userDefinedMetadata:l.userDefinedMetadata})},y.onerror=function(w){return a("Failed to weights data from file of path '"+g+"'.")},y.readAsArrayBuffer(f[g])})})}else a(new Error("weightManifest field is missing from file "+e.name))}else a(new Error("modelTopology field is missing from file "+e.name))},s.onerror=function(u){return a("Failed to read model topology and weights manifest JSON from file '"+e.name+"'. BrowserFiles supports loading Keras-style tf.Model artifacts only.")},s.readAsText(e)})]})})},t.prototype.checkManifestAndWeightFiles=function(e,n){for(var r=[],o=n.map(function(u){return _x(u.name)}),i={},a=0,s=e;a<s.length;a++)s[a].paths.forEach(function(u){var l=_x(u);if(r.indexOf(l)!==-1)throw new Error("Duplicate file basename found in weights manifest: '"+l+"'");if(r.push(l),o.indexOf(l)===-1)throw new Error("Weight file with basename '"+l+"' is not provided.");i[u]=n[o.indexOf(l)]});if(r.length!==n.length)throw new Error("Mismatch in the number of files in weights manifest ("+r.length+") and the number of weight files provided ("+n.length+").");return i},t}();function Rx(t,e,n,r){(function(i){I(i!=null&&Array.isArray(i)&&i.length>0,function(){return"promises must be a none empty array"})})(t),function(i,a){I(i>=0&&i<=1,function(){return"Progress fraction must be in range [0, 1], but got startFraction "+i}),I(a>=0&&a<=1,function(){return"Progress fraction must be in range [0, 1], but got endFraction "+a}),I(a>=i,function(){return"startFraction must be no more than endFraction, but got startFraction "+i+" and endFraction "+a})}(n=n??0,r=r??1);var o=0;return Promise.all(t.map(function(i){return i.then(function(a){var s=n+ ++o/t.length*(r-n);return e(s),a}),i}))}function fk(t,e){return ie(this,void 0,void 0,function(){var n,r,o,i,a,s,u,l,c;return ae(this,function(d){switch(d.label){case 0:return e==null&&(e={}),n=e.fetchFunc==null?H().platform.fetch:e.fetchFunc,r=t.map(function(f){return n(f,e.requestInit,{isBinary:!0})}),o=0,i=.5,e.onProgress!=null?[3,2]:[4,Promise.all(r)];case 1:return a=d.sent(),[3,4];case 2:return[4,Rx(r,e.onProgress,o,i)];case 3:a=d.sent(),d.label=4;case 4:return s=a.map(function(f){return f.arrayBuffer()}),u=.5,l=1,e.onProgress!=null?[3,6]:[4,Promise.all(s)];case 5:return c=d.sent(),[3,8];case 6:return[4,Rx(s,e.onProgress,u,l)];case 7:c=d.sent(),d.label=8;case 8:return[2,c]}})})}function Tx(t){var e=this;return function(n,r,o){return r===void 0&&(r=""),ie(e,void 0,void 0,function(){var i,a,s,u,l,c,d,f,h,v;return ae(this,function(p){switch(p.label){case 0:if(i=n.map(function(){return!1}),a={},s=o!=null?o.map(function(){return!1}):[],u=[],n.forEach(function(m,g){var y=0;m.weights.forEach(function(w){var x="quantization"in w?w.quantization.dtype:w.dtype,b=Dm[x]*se(w.shape),_=function(){i[g]=!0,a[g]==null&&(a[g]=[]),a[g].push({manifestEntry:w,groupOffset:y,sizeBytes:b})};o!=null?o.forEach(function(E,C){E===w.name&&(_(),s[C]=!0)}):_(),u.push(w.name),y+=b})}),!s.every(function(m){return m}))throw l=o.filter(function(m,g){return!s[g]}),new Error("Could not find weights in manifest with names: "+l.join(", ")+`. 
Manifest JSON has weights with names: `+u.join(", ")+".");return c=i.reduce(function(m,g,y){return g&&m.push(y),m},[]),d=[],c.forEach(function(m){n[m].paths.forEach(function(g){var y=r+(r.endsWith("/")?"":"/")+g;d.push(y)})}),[4,t(d)];case 1:return f=p.sent(),h={},v=0,c.forEach(function(m){for(var g=n[m].paths.length,y=0,w=0;w<g;w++)y+=f[v+w].byteLength;for(var x=new ArrayBuffer(y),b=new Uint8Array(x),_=0,E=0;E<g;E++){var C=new Uint8Array(f[v+E]);b.set(C,_),_+=C.byteLength}a[m].forEach(function(R){var S=uk(x.slice(R.groupOffset,R.groupOffset+R.sizeBytes),[R.manifestEntry]);for(var P in S)h[P]=S[P]}),v+=g}),[2,h]}})})}}Pn.registerSaveRouter(function(t){return H().getBool("IS_BROWSER")&&!Array.isArray(t)&&t.startsWith(Fp.URL_SCHEME)?function(e){return e===void 0&&(e="model"),new Fp(e)}(t.slice(Fp.URL_SCHEME.length)):null});var hk=function(){function t(e,n){if(this.DEFAULT_METHOD="POST",n==null&&(n={}),this.weightPathPrefix=n.weightPathPrefix,this.onProgress=n.onProgress,n.fetchFunc!=null?(I(typeof n.fetchFunc=="function",function(){return"Must pass a function that matches the signature of `fetch` (see https://developer.mozilla.org/en-US/docs/Web/API/Fetch_API)"}),this.fetch=n.fetchFunc):this.fetch=H().platform.fetch,I(e!=null&&e.length>0,function(){return"URL path for http must not be null, undefined or empty."}),Array.isArray(e)&&I(e.length===2,function(){return"URL paths for http must have a length of 2, (actual length is "+e.length+")."}),this.path=e,n.requestInit!=null&&n.requestInit.body!=null)throw new Error("requestInit is expected to have no pre-existing body, but has one.");this.requestInit=n.requestInit||{}}return t.prototype.save=function(e){return ie(this,void 0,void 0,function(){var n,r,o,i;return ae(this,function(a){switch(a.label){case 0:if(e.modelTopology instanceof ArrayBuffer)throw new Error("BrowserHTTPRequest.save() does not support saving model topology in binary formats yet.");return(n=Object.assign({method:this.DEFAULT_METHOD},this.requestInit)).body=new FormData,r=[{paths:["./model.weights.bin"],weights:e.weightSpecs}],o={modelTopology:e.modelTopology,format:e.format,generatedBy:e.generatedBy,convertedBy:e.convertedBy,userDefinedMetadata:e.userDefinedMetadata,weightsManifest:r},n.body.append("model.json",new Blob([JSON.stringify(o)],{type:"application/json"}),"model.json"),e.weightData!=null&&n.body.append("model.weights.bin",new Blob([e.weightData],{type:"application/octet-stream"}),"model.weights.bin"),[4,this.fetch(this.path,n)];case 1:if((i=a.sent()).ok)return[2,{modelArtifactsInfo:nc(e),responses:[i]}];throw new Error("BrowserHTTPRequest.save() failed due to HTTP response status "+i.status+".")}})})},t.prototype.load=function(){return ie(this,void 0,void 0,function(){var e,n,r,o,i,a,s,u,l,c,d,f;return ae(this,function(h){switch(h.label){case 0:return[4,this.fetch(this.path,this.requestInit)];case 1:if(!(e=h.sent()).ok)throw new Error("Request to "+this.path+" failed with status code "+e.status+". Please verify this URL points to the model JSON of the model to load.");h.label=2;case 2:return h.trys.push([2,4,,5]),[4,e.json()];case 3:return n=h.sent(),[3,5];case 4:throw h.sent(),r="Failed to parse model JSON of response from "+this.path+".",this.path.endsWith(".pb")?r+=" Your path contains a .pb file extension. Support for .pb models have been removed in TensorFlow.js 1.0 in favor of .json models. You can re-convert your Python TensorFlow model using the TensorFlow.js 1.0 conversion scripts or you can convert your.pb models with the 'pb2json'NPM script in the tensorflow/tfjs-converter repository.":r+=" Please make sure the server is serving valid JSON for this request.",new Error(r);case 5:if(o=n.modelTopology,i=n.weightsManifest,a=n.generatedBy,s=n.convertedBy,u=n.format,l=n.userDefinedMetadata,o==null&&i==null)throw new Error("The JSON from HTTP path "+this.path+" contains neither model topology or manifest for weights.");return i==null?[3,7]:[4,this.loadWeights(i)];case 6:f=h.sent(),c=f[0],d=f[1],h.label=7;case 7:return[2,{modelTopology:o,weightSpecs:c,weightData:d,userDefinedMetadata:l,generatedBy:a,convertedBy:s,format:u}]}})})},t.prototype.loadWeights=function(e){return ie(this,void 0,void 0,function(){var n,r,o,i,a,s,u,l,c,d,f;return ae(this,function(h){switch(h.label){case 0:for(n=Array.isArray(this.path)?this.path[1]:this.path,r=function(v){var p=v.lastIndexOf("/"),m=v.lastIndexOf("?"),g=v.substring(0,p),y=m>p?v.substring(m):"";return[g+"/",y]}(n),o=r[0],i=r[1],a=this.weightPathPrefix||o,s=[],u=0,l=e;u<l.length;u++)c=l[u],s.push.apply(s,c.weights);return d=[],e.forEach(function(v){v.paths.forEach(function(p){d.push(a+p+i)})}),[4,fk(d,{requestInit:this.requestInit,fetchFunc:this.fetch,onProgress:this.onProgress})];case 1:return f=h.sent(),[2,[s,By(f)]]}})})},t.URL_SCHEME_REGEX=/^https?:\/\//,t}();function Fm(t){return t.match(hk.URL_SCHEME_REGEX)!=null}var Ix=function(t,e){return typeof fetch>"u"?null:(Array.isArray(t)?t.every(function(n){return Fm(n)}):Fm(t))?Mm(t,{onProgress:e}):null};function Mm(t,e){return new hk(t,e)}Pn.registerSaveRouter(Ix),Pn.registerLoadRouter(Ix);var Mp=function(){function t(e){this.modelArtifacts=e}return t.prototype.load=function(){return ie(this,void 0,void 0,function(){return ae(this,function(e){return[2,this.modelArtifacts]})})},t}(),hz=function(){function t(e){this.saveHandler=e}return t.prototype.save=function(e){return ie(this,void 0,void 0,function(){return ae(this,function(n){return[2,this.saveHandler(e)]})})},t}(),pk=Object.freeze({browserFiles:function(t){return new fz(t)},browserHTTPRequest:function(t,e){return Mm(t,e)},concatenateArrayBuffers:By,decodeWeights:uk,encodeWeights:function(t,e){return ie(this,void 0,void 0,function(){var n,r,o,i,a,s=this;return ae(this,function(u){switch(u.label){case 0:for(n=[],r=[],o=Array.isArray(t)?t.map(function(l){return l.name}):Object.keys(t),i=function(l){var c=o[l],d=Array.isArray(t)?t[l].tensor:t[c];if(d.dtype!=="float32"&&d.dtype!=="int32"&&d.dtype!=="bool"&&d.dtype!=="string")throw new Error("Unsupported dtype in weight '"+c+"': "+d.dtype);var f={name:c,shape:d.shape,dtype:d.dtype};if(d.dtype==="string"){var h=new Promise(function(v){return ie(s,void 0,void 0,function(){var p,m,g,y,w,x,b;return ae(this,function(_){switch(_.label){case 0:return[4,d.bytes()];case 1:for(p=_.sent(),m=p.reduce(function(E,C){return E+C.length},0)+mf*p.length,g=new Uint8Array(m),y=0,w=0;w<p.length;w++)x=p[w],b=new Uint8Array(new Uint32Array([x.length]).buffer),g.set(b,y),y+=mf,g.set(x,y),y+=x.length;return v(g),[2]}})})});r.push(h)}else r.push(d.data());e!=null&&(f.group=e),n.push(f)},a=0;a<o.length;++a)i(a);return[4,Promise.all(r)];case 1:return[2,{data:tz(u.sent()),specs:n}]}})})},fromMemory:function(t,e,n,r){return arguments.length===1?t.modelTopology!=null||t.weightSpecs!=null?new Mp(t):(console.warn("Please call tf.io.fromMemory() with only one argument. The argument should be of type ModelArtifacts. The multi-argument signature of tf.io.fromMemory() has been deprecated and will be removed in a future release."),new Mp({modelTopology:t})):(console.warn("Please call tf.io.fromMemory() with only one argument. The argument should be of type ModelArtifacts. The multi-argument signature of tf.io.fromMemory() has been deprecated and will be removed in a future release."),new Mp({modelTopology:t,weightSpecs:e,weightData:n,trainingConfig:r}))},getLoadHandlers:function(t,e){return Pn.getLoadHandlers(t,e)},getModelArtifactsInfoForJSON:nc,getSaveHandlers:function(t){return Pn.getSaveHandlers(t)},http:Mm,isHTTPScheme:Fm,loadWeights:function(t,e,n,r){return e===void 0&&(e=""),ie(this,void 0,void 0,function(){return ae(this,function(o){return[2,Tx(function(i){return fk(i,{requestInit:r})})(t,e,n)]})})},registerLoadRouter:function(t){return Pn.registerLoadRouter(t)},registerSaveRouter:function(t){return Pn.registerSaveRouter(t)},weightsLoaderFactory:Tx,withSaveHandler:function(t){return new hz(t)},copyModel:function(t,e){return ie(this,void 0,void 0,function(){return ae(this,function(n){return[2,Ex(t,e,!1)]})})},listModels:function(){return ie(this,void 0,void 0,function(){var t,e,n,r,o,i,a;return ae(this,function(s){switch(s.label){case 0:t=Ei.getSchemes(),e={},n=0,r=t,s.label=1;case 1:return n<r.length?(o=r[n],[4,Ei.getManager(o).listModels()]):[3,4];case 2:for(a in i=s.sent())e[o+Ts+a]=i[a];s.label=3;case 3:return n++,[3,1];case 4:return[2,e]}})})},moveModel:function(t,e){return ie(this,void 0,void 0,function(){return ae(this,function(n){return[2,Ex(t,e,!0)]})})},removeModel:function(t){return ie(this,void 0,void 0,function(){var e;return ae(this,function(n){return e=vd(t),[2,Ei.getManager(e.scheme).removeModel(e.path)]})})}}),Ya;O({confusionMatrix_:function(t,e,n){var r=T(t,"labels","confusionMatrix"),o=T(e,"predictions","confusionMatrix");I(n==null||n>0&&Number.isInteger(n),function(){return"If provided, numClasses must be a positive integer, but got "+n}),I(r.rank===1,function(){return"Expected the rank of labels to be 1, but got "+r.rank}),I(o.rank===1,function(){return"Expected the rank of predictions to be 1, but got "+o.rank}),I(r.shape[0]===o.shape[0],function(){return"Mismatch in the number of examples: "+r.shape[0]+" vs. "+o.shape[0]+". Labels and predictions should have the same number of elements."}),I(n>0&&Number.isInteger(n),function(){return"numClasses is required to be a positive integer, but got "+n});var i=Rm(r.asType("int32"),n),a=Rm(o.asType("int32"),n);return i.transpose().matMul(a).asType("int32")}});var pz=O({fromPixels_:function(t,e){if(e===void 0&&(e=3),e>4)throw new Error("Cannot construct Tensor with more than 4 channels from pixels.");if(t==null)throw new Error("pixels passed to tf.browser.fromPixels() can not be null");var n=!1,r=!1,o=!1,i=!1,a=!1;if(t.data instanceof Uint8Array)n=!0;else if(typeof ImageData<"u"&&t instanceof ImageData)r=!0;else if(typeof HTMLVideoElement<"u"&&t instanceof HTMLVideoElement)o=!0;else if(typeof HTMLImageElement<"u"&&t instanceof HTMLImageElement)i=!0;else{if(t.getContext==null)throw new Error("pixels passed to tf.browser.fromPixels() must be either an HTMLVideoElement, HTMLImageElement, HTMLCanvasElement, ImageData in browser, or OffscreenCanvas, ImageData in webworker or {data: Uint32Array, width: number, height: number}, but was "+t.constructor.name);a=!0}if(o&&o&&t.readyState<2)throw new Error("The video element has not loaded data yet. Please wait for `loadeddata` event on the <video> element.");if(BC("FromPixels",L.backendName)!=null)return L.runKernel("FromPixels",{pixels:t},{numChannels:e});var s,u,l=o?[t.videoWidth,t.videoHeight]:[t.width,t.height],c=l[0],d=l[1];if(a?s=t.getContext("2d").getImageData(0,0,c,d).data:r||n?s=t.data:(i||o)&&(Ya==null&&(Ya=document.createElement("canvas").getContext("2d")),Ya.canvas.width=c,Ya.canvas.height=d,Ya.drawImage(t,0,0,c,d),s=Ya.getImageData(0,0,c,d).data),e===4)u=new Int32Array(s);else{var f=c*d;u=new Int32Array(f*e);for(var h=0;h<f;h++)for(var v=0;v<e;++v)u[h*e+v]=s[4*h+v]}return hy(u,[d,c,e],"int32")}}),$y=Object.freeze({toPixels:function(t,e){return ie(this,void 0,void 0,function(){var n,r,o,i,a,s,u,l,c,d,f,h,v,p,m,g,y,w,x,b,_,E,C;return ae(this,function(R){switch(R.label){case 0:if(n=T(t,"img","toPixels"),t instanceof nt||(n=n.toInt()),n.rank!==2&&n.rank!==3)throw new Error("toPixels only supports rank 2 or 3 tensors, got rank "+n.rank+".");if(r=n.shape.slice(0,2),o=r[0],i=r[1],(a=n.rank===2?1:n.shape[2])>4||a===2)throw new Error("toPixels only supports depth of size 1, 3 or 4 but got "+a);return[4,n.data()];case 1:return s=R.sent(),u=n.min(),l=n.max(),[4,Promise.all([u.data(),l.data()])];case 2:if(c=R.sent(),d=c[0],f=c[1],h=d[0],v=f[0],u.dispose(),l.dispose(),n.dtype==="float32"){if(h<0||v>1)throw new Error("Tensor values for a float32 Tensor must be in the range [0 - 1] but got range ["+h+" - "+v+"].")}else{if(n.dtype!=="int32")throw new Error("Unsupported type for toPixels: "+n.dtype+". Please use float32 or int32 tensors.");if(h<0||v>255)throw new Error("Tensor values for a int32 Tensor must be in the range [0 - 255] but got range ["+h+" - "+v+"].")}for(p=n.dtype==="float32"?255:1,m=new Uint8ClampedArray(i*o*4),g=0;g<o*i;++g)y=void 0,w=void 0,x=void 0,b=void 0,a===1?(y=s[g]*p,w=s[g]*p,x=s[g]*p,b=255):a===3?(y=s[3*g]*p,w=s[3*g+1]*p,x=s[3*g+2]*p,b=255):a===4&&(y=s[4*g]*p,w=s[4*g+1]*p,x=s[4*g+2]*p,b=s[4*g+3]*p),m[(_=4*g)+0]=Math.round(y),m[_+1]=Math.round(w),m[_+2]=Math.round(x),m[_+3]=Math.round(b);return e!=null&&(e.width=i,e.height=o,E=e.getContext("2d"),C=new ImageData(m,i,o),E.putImageData(C,0,0)),n!==t&&n.dispose(),[2,m]}})})},fromPixels:pz}),vz=function(){function t(){}return t.prototype.getClassName=function(){return this.constructor.className},t.fromConfig=function(e,n){return new e(n)},t}(),mz=function(){function t(){this.classNameMap={}}return t.getMap=function(){return t.instance==null&&(t.instance=new t),t.instance},t.register=function(e){t.getMap().classNameMap[e.className]=[e,e.fromConfig]},t}();function Oa(t){I(t.className!=null,function(){return"Class being registered does not have the static className property defined."}),I(typeof t.className=="string",function(){return"className is required to be a string, but got type "+typeof t.className}),I(t.className.length>0,function(){return"Class being registered has an empty-string as its className, which is disallowed."}),mz.register(t)}var Fa=function(t){function e(){return t!==null&&t.apply(this,arguments)||this}return Cr(e,t),e.prototype.minimize=function(n,r,o){r===void 0&&(r=!1);var i=this.computeGradients(n,o),a=i.value,s=i.grads;if(o!=null){var u=o.map(function(l){return{name:l.name,tensor:s[l.name]}});this.applyGradients(u)}else this.applyGradients(s);return bn(s),r?a:(a.dispose(),null)},Object.defineProperty(e.prototype,"iterations",{get:function(){return this.iterations_==null&&(this.iterations_=0),this.iterations_},enumerable:!0,configurable:!0}),e.prototype.incrementIterations=function(){this.iterations_=this.iterations+1},e.prototype.computeGradients=function(n,r){return kB(n,r)},e.prototype.dispose=function(){this.iterations_!=null&&bn(this.iterations_)},e.prototype.saveIterations=function(){return ie(this,void 0,void 0,function(){return ae(this,function(n){return this.iterations_==null&&(this.iterations_=0),[2,{name:"iter",tensor:ee(this.iterations_,"int32")}]})})},e.prototype.getWeights=function(){return ie(this,void 0,void 0,function(){return ae(this,function(n){throw new Error("getWeights() is not implemented for this optimizer yet.")})})},e.prototype.setWeights=function(n){return ie(this,void 0,void 0,function(){return ae(this,function(r){throw new Error("setWeights() is not implemented for this optimizer class "+this.getClassName())})})},e.prototype.extractIterations=function(n){return ie(this,void 0,void 0,function(){var r;return ae(this,function(o){switch(o.label){case 0:return r=this,[4,n[0].tensor.data()];case 1:return r.iterations_=o.sent()[0],[2,n.slice(1)]}})})},e}(vz);Object.defineProperty(Fa,Symbol.hasInstance,{value:function(t){return t.minimize!=null&&t.computeGradients!=null&&t.applyGradients!=null}});var gz=function(t){function e(n,r,o){o===void 0&&(o=null);var i=t.call(this)||this;return i.learningRate=n,i.rho=r,i.epsilon=o,i.accumulatedGrads=[],i.accumulatedUpdates=[],o==null&&(i.epsilon=L.backend.epsilon()),i}return Cr(e,t),e.prototype.applyGradients=function(n){var r=this;(Array.isArray(n)?n.map(function(o){return o.name}):Object.keys(n)).forEach(function(o,i){var a=L.registeredVariables[o];r.accumulatedGrads[i]==null&&(r.accumulatedGrads[i]={originalName:o+"/accum_grad",variable:ne(function(){return Ne(a).variable(!1)})}),r.accumulatedUpdates[i]==null&&(r.accumulatedUpdates[i]={originalName:o+"/accum_var",variable:ne(function(){return Ne(a).variable(!1)})});var s=Array.isArray(n)?n[i].tensor:n[o];if(s!=null){var u=r.accumulatedGrads[i].variable,l=r.accumulatedUpdates[i].variable;ne(function(){var c=u.mul(r.rho).add(s.square().mul(1-r.rho)),d=l.add(r.epsilon).sqrt().div(u.add(r.epsilon).sqrt()).mul(s),f=l.mul(r.rho).add(d.square().mul(1-r.rho));u.assign(c),l.assign(f);var h=d.mul(-r.learningRate).add(a);a.assign(h)})}}),this.incrementIterations()},e.prototype.dispose=function(){this.accumulatedUpdates!=null&&(bn(this.accumulatedGrads.map(function(n){return n.variable})),bn(this.accumulatedUpdates.map(function(n){return n.variable})))},e.prototype.getWeights=function(){return ie(this,void 0,void 0,function(){var n;return ae(this,function(r){switch(r.label){case 0:return n=this.accumulatedGrads.concat(this.accumulatedUpdates),[4,this.saveIterations()];case 1:return[2,[r.sent()].concat(n.map(function(o){return{name:o.originalName,tensor:o.variable}}))]}})})},e.prototype.setWeights=function(n){return ie(this,void 0,void 0,function(){var r;return ae(this,function(o){switch(o.label){case 0:return[4,this.extractIterations(n)];case 1:return n=o.sent(),r=n.length/2,this.accumulatedGrads=n.slice(0,r).map(function(i){return{originalName:i.name,variable:i.tensor.variable(!1)}}),this.accumulatedUpdates=n.slice(r,2*r).map(function(i){return{originalName:i.name,variable:i.tensor.variable(!1)}}),[2]}})})},e.prototype.getConfig=function(){return{learningRate:this.learningRate,rho:this.rho,epsilon:this.epsilon}},e.fromConfig=function(n,r){return new n(r.learningRate,r.rho,r.epsilon)},e.className="Adadelta",e}(Fa);Oa(gz);var yz=function(t){function e(n,r){r===void 0&&(r=.1);var o=t.call(this)||this;return o.learningRate=n,o.initialAccumulatorValue=r,o.accumulatedGrads=[],o}return Cr(e,t),e.prototype.applyGradients=function(n){var r=this;(Array.isArray(n)?n.map(function(o){return o.name}):Object.keys(n)).forEach(function(o,i){var a=L.registeredVariables[o];r.accumulatedGrads[i]==null&&(r.accumulatedGrads[i]={originalName:o+"/accumulator",variable:ne(function(){return qr(a.shape,r.initialAccumulatorValue).variable(!1)})});var s=Array.isArray(n)?n[i].tensor:n[o];if(s!=null){var u=r.accumulatedGrads[i].variable;ne(function(){var l=u.add(s.square());u.assign(l);var c=s.div(l.add(L.backend.epsilon()).sqrt()).mul(-r.learningRate).add(a);a.assign(c)})}}),this.incrementIterations()},e.prototype.dispose=function(){this.accumulatedGrads!=null&&bn(this.accumulatedGrads.map(function(n){return n.variable}))},e.prototype.getWeights=function(){return ie(this,void 0,void 0,function(){return ae(this,function(n){switch(n.label){case 0:return[4,this.saveIterations()];case 1:return[2,[n.sent()].concat(this.accumulatedGrads.map(function(r){return{name:r.originalName,tensor:r.variable}}))]}})})},e.prototype.setWeights=function(n){return ie(this,void 0,void 0,function(){return ae(this,function(r){switch(r.label){case 0:return[4,this.extractIterations(n)];case 1:return n=r.sent(),this.accumulatedGrads=n.map(function(o){return{originalName:o.name,variable:o.tensor.variable(!1)}}),[2]}})})},e.prototype.getConfig=function(){return{learningRate:this.learningRate,initialAccumulatorValue:this.initialAccumulatorValue}},e.fromConfig=function(n,r){return new n(r.learningRate,r.initialAccumulatorValue)},e.className="Adagrad",e}(Fa);Oa(yz);var wz=function(t){function e(n,r,o,i){i===void 0&&(i=null);var a=t.call(this)||this;return a.learningRate=n,a.beta1=r,a.beta2=o,a.epsilon=i,a.accumulatedFirstMoment=[],a.accumulatedSecondMoment=[],ne(function(){a.accBeta1=ee(r).variable(),a.accBeta2=ee(o).variable()}),i==null&&(a.epsilon=L.backend.epsilon()),a}return Cr(e,t),e.prototype.applyGradients=function(n){var r=this,o=Array.isArray(n)?n.map(function(i){return i.name}):Object.keys(n);ne(function(){var i=St(1,r.accBeta1),a=St(1,r.accBeta2);o.forEach(function(s,u){var l=L.registeredVariables[s];r.accumulatedFirstMoment[u]==null&&(r.accumulatedFirstMoment[u]={originalName:s+"/m",variable:ne(function(){return Ne(l).variable(!1)})}),r.accumulatedSecondMoment[u]==null&&(r.accumulatedSecondMoment[u]={originalName:s+"/v",variable:ne(function(){return Ne(l).variable(!1)})});var c=Array.isArray(n)?n[u].tensor:n[s];if(c!=null){var d=r.accumulatedFirstMoment[u].variable,f=r.accumulatedSecondMoment[u].variable,h=d.mul(r.beta1).add(c.mul(1-r.beta1)),v=f.mul(r.beta2).add(c.square().mul(1-r.beta2)),p=h.div(i),m=v.div(a);d.assign(h),f.assign(v);var g=p.div(m.sqrt().add(r.epsilon)).mul(-r.learningRate).add(l);l.assign(g)}}),r.accBeta1.assign(r.accBeta1.mul(r.beta1)),r.accBeta2.assign(r.accBeta2.mul(r.beta2))}),this.incrementIterations()},e.prototype.dispose=function(){this.accBeta1.dispose(),this.accBeta2.dispose(),this.accumulatedFirstMoment!=null&&bn(this.accumulatedFirstMoment.map(function(n){return n.variable})),this.accumulatedSecondMoment!=null&&bn(this.accumulatedSecondMoment.map(function(n){return n.variable}))},e.prototype.getWeights=function(){return ie(this,void 0,void 0,function(){var n;return ae(this,function(r){switch(r.label){case 0:return n=this.accumulatedFirstMoment.concat(this.accumulatedSecondMoment),[4,this.saveIterations()];case 1:return[2,[r.sent()].concat(n.map(function(o){return{name:o.originalName,tensor:o.variable}}))]}})})},e.prototype.setWeights=function(n){return ie(this,void 0,void 0,function(){var r,o=this;return ae(this,function(i){switch(i.label){case 0:return[4,this.extractIterations(n)];case 1:return n=i.sent(),ne(function(){o.accBeta1.assign(pf(o.beta1,o.iterations_+1)),o.accBeta2.assign(pf(o.beta2,o.iterations_+1))}),r=n.length/2,this.accumulatedFirstMoment=n.slice(0,r).map(function(a){return{originalName:a.name,variable:a.tensor.variable(!1)}}),this.accumulatedSecondMoment=n.slice(r,2*r).map(function(a){return{originalName:a.name,variable:a.tensor.variable(!1)}}),[2]}})})},e.prototype.getConfig=function(){return{learningRate:this.learningRate,beta1:this.beta1,beta2:this.beta2,epsilon:this.epsilon}},e.fromConfig=function(n,r){return new n(r.learningRate,r.beta1,r.beta2,r.epsilon)},e.className="Adam",e}(Fa);Oa(wz);var xz=function(t){function e(n,r,o,i,a){i===void 0&&(i=null),a===void 0&&(a=0);var s=t.call(this)||this;return s.learningRate=n,s.beta1=r,s.beta2=o,s.epsilon=i,s.decay=a,s.accumulatedFirstMoment=[],s.accumulatedWeightedInfNorm=[],ne(function(){s.iteration=ee(0).variable(),s.accBeta1=ee(r).variable()}),i==null&&(s.epsilon=L.backend.epsilon()),s}return Cr(e,t),e.prototype.applyGradients=function(n){var r=this,o=Array.isArray(n)?n.map(function(i){return i.name}):Object.keys(n);ne(function(){var i=St(1,r.accBeta1),a=pr(-r.learningRate,r.iteration.mul(r.decay).add(1));o.forEach(function(s,u){var l=L.registeredVariables[s];r.accumulatedFirstMoment[u]==null&&(r.accumulatedFirstMoment[u]={originalName:s+"/m",variable:Ne(l).variable(!1)}),r.accumulatedWeightedInfNorm[u]==null&&(r.accumulatedWeightedInfNorm[u]={originalName:s+"/v",variable:Ne(l).variable(!1)});var c=Array.isArray(n)?n[u].tensor:n[s];if(c!=null){var d=r.accumulatedFirstMoment[u].variable,f=r.accumulatedWeightedInfNorm[u].variable,h=d.mul(r.beta1).add(c.mul(1-r.beta1)),v=f.mul(r.beta2),p=c.abs(),m=v.maximum(p);d.assign(h),f.assign(m);var g=a.div(i).mul(h.div(m.add(r.epsilon))).add(l);l.assign(g)}}),r.iteration.assign(r.iteration.add(1)),r.accBeta1.assign(r.accBeta1.mul(r.beta1))}),this.incrementIterations()},e.prototype.dispose=function(){this.accBeta1.dispose(),this.iteration.dispose(),this.accumulatedFirstMoment!=null&&bn(this.accumulatedFirstMoment.map(function(n){return n.variable})),this.accumulatedWeightedInfNorm!=null&&bn(this.accumulatedWeightedInfNorm.map(function(n){return n.variable}))},e.prototype.getWeights=function(){return ie(this,void 0,void 0,function(){return ae(this,function(n){throw new Error("getWeights() is not implemented for Adamax yet.")})})},e.prototype.setWeights=function(n){return ie(this,void 0,void 0,function(){return ae(this,function(r){throw new Error("setWeights() is not implemented for Adamax yet.")})})},e.prototype.getConfig=function(){return{learningRate:this.learningRate,beta1:this.beta1,beta2:this.beta2,epsilon:this.epsilon,decay:this.decay}},e.fromConfig=function(n,r){return new n(r.learningRate,r.beta1,r.beta2,r.epsilon,r.decay)},e.className="Adamax",e}(Fa);Oa(xz);var vk=function(t){function e(n){var r=t.call(this)||this;return r.learningRate=n,r.setLearningRate(n),r}return Cr(e,t),e.prototype.applyGradients=function(n){var r=this;(Array.isArray(n)?n.map(function(o){return o.name}):Object.keys(n)).forEach(function(o,i){var a=Array.isArray(n)?n[i].tensor:n[o];if(a!=null){var s=L.registeredVariables[o];ne(function(){var u=r.c.mul(a).add(s);s.assign(u)})}}),this.incrementIterations()},e.prototype.setLearningRate=function(n){this.learningRate=n,this.c!=null&&this.c.dispose(),this.c=jL(ee(-n))},e.prototype.dispose=function(){this.c.dispose()},e.prototype.getWeights=function(){return ie(this,void 0,void 0,function(){return ae(this,function(n){switch(n.label){case 0:return[4,this.saveIterations()];case 1:return[2,[n.sent()]]}})})},e.prototype.setWeights=function(n){return ie(this,void 0,void 0,function(){return ae(this,function(r){switch(r.label){case 0:return[4,this.extractIterations(n)];case 1:if((n=r.sent()).length!==0)throw new Error("SGD optimizer does not have settable weights.");return[2]}})})},e.prototype.getConfig=function(){return{learningRate:this.learningRate}},e.fromConfig=function(n,r){return new n(r.learningRate)},e.className="SGD",e}(Fa);Oa(vk);var bz=function(t){function e(n,r,o){o===void 0&&(o=!1);var i=t.call(this,n)||this;return i.learningRate=n,i.momentum=r,i.useNesterov=o,i.accumulations=[],i.m=ee(i.momentum),i}return Cr(e,t),e.prototype.applyGradients=function(n){var r=this;(Array.isArray(n)?n.map(function(o){return o.name}):Object.keys(n)).forEach(function(o,i){var a=L.registeredVariables[o];r.accumulations[i]==null&&(r.accumulations[i]={originalName:o+"/momentum",variable:ne(function(){return Ne(a).variable(!1)})});var s=r.accumulations[i].variable,u=Array.isArray(n)?n[i].tensor:n[o];u!=null&&ne(function(){var l,c=r.m.mul(s).add(u);l=r.useNesterov?r.c.mul(u.add(c.mul(r.m))).add(a):r.c.mul(c).add(a),s.assign(c),a.assign(l)})}),this.incrementIterations()},e.prototype.dispose=function(){this.m.dispose(),this.accumulations!=null&&bn(this.accumulations.map(function(n){return n.variable}))},e.prototype.setMomentum=function(n){this.momentum=n},e.prototype.getWeights=function(){return ie(this,void 0,void 0,function(){return ae(this,function(n){switch(n.label){case 0:return[4,this.saveIterations()];case 1:return[2,[n.sent()].concat(this.accumulations.map(function(r){return{name:r.originalName,tensor:r.variable}}))]}})})},e.prototype.setWeights=function(n){return ie(this,void 0,void 0,function(){return ae(this,function(r){switch(r.label){case 0:return[4,this.extractIterations(n)];case 1:return n=r.sent(),this.accumulations=n.map(function(o){return{originalName:o.name,variable:o.tensor.variable(!1)}}),[2]}})})},e.prototype.getConfig=function(){return{learningRate:this.learningRate,momentum:this.momentum,useNesterov:this.useNesterov}},e.fromConfig=function(n,r){return new n(r.learningRate,r.momentum,r.useNesterov)},e.className="Momentum",e}(vk);Oa(bz);var _z=function(t){function e(n,r,o,i,a){r===void 0&&(r=.9),o===void 0&&(o=0),i===void 0&&(i=null),a===void 0&&(a=!1);var s=t.call(this)||this;if(s.learningRate=n,s.decay=r,s.momentum=o,s.epsilon=i,s.accumulatedMeanSquares=[],s.accumulatedMoments=[],s.accumulatedMeanGrads=[],s.centered=a,i==null&&(s.epsilon=L.backend.epsilon()),n==null)throw new Error("learningRate for RMSPropOptimizer must be defined.");return s}return Cr(e,t),e.prototype.applyGradients=function(n){var r=this;(Array.isArray(n)?n.map(function(o){return o.name}):Object.keys(n)).forEach(function(o,i){var a=L.registeredVariables[o];r.accumulatedMeanSquares[i]==null&&(r.accumulatedMeanSquares[i]={originalName:o+"/rms",variable:ne(function(){return Ne(a).variable(!1)})}),r.accumulatedMoments[i]==null&&(r.accumulatedMoments[i]={originalName:o+"/momentum",variable:ne(function(){return Ne(a).variable(!1)})}),r.accumulatedMeanGrads[i]==null&&r.centered&&(r.accumulatedMeanGrads[i]={originalName:o+"/mg",variable:ne(function(){return Ne(a).variable(!1)})});var s=Array.isArray(n)?n[i].tensor:n[o];if(s!=null){var u=r.accumulatedMeanSquares[i].variable,l=r.accumulatedMoments[i].variable;ne(function(){var c=u.mul(r.decay).add(s.square().mul(1-r.decay));if(r.centered){var d=r.accumulatedMeanGrads[i].variable,f=d.mul(r.decay).add(s.mul(1-r.decay)),h=l.mul(r.momentum).add(s.mul(r.learningRate).div(c.sub(f.square().add(r.epsilon)).sqrt()));u.assign(c),d.assign(f),l.assign(h);var v=a.sub(h);a.assign(v)}else{var p=u.mul(r.decay).add(s.square().mul(1-r.decay));h=l.mul(r.momentum).add(s.mul(r.learningRate).div(p.add(r.epsilon).sqrt())),u.assign(p),l.assign(h),v=a.sub(h),a.assign(v)}})}}),this.incrementIterations()},e.prototype.dispose=function(){this.accumulatedMeanSquares!=null&&bn(this.accumulatedMeanSquares.map(function(n){return n.variable})),this.accumulatedMeanGrads!=null&&this.centered&&bn(this.accumulatedMeanGrads.map(function(n){return n.variable})),this.accumulatedMoments!=null&&bn(this.accumulatedMoments.map(function(n){return n.variable}))},e.prototype.getWeights=function(){return ie(this,void 0,void 0,function(){var n;return ae(this,function(r){switch(r.label){case 0:return n=this.accumulatedMeanSquares.concat(this.accumulatedMoments),this.centered&&n.push.apply(n,this.accumulatedMeanGrads),[4,this.saveIterations()];case 1:return[2,[r.sent()].concat(n.map(function(o){return{name:o.originalName,tensor:o.variable}}))]}})})},e.prototype.setWeights=function(n){return ie(this,void 0,void 0,function(){var r;return ae(this,function(o){switch(o.label){case 0:return[4,this.extractIterations(n)];case 1:return n=o.sent(),r=this.centered?n.length/3:n.length/2,this.accumulatedMeanSquares=n.slice(0,r).map(function(i){return{originalName:i.name,variable:i.tensor.variable(!1)}}),this.accumulatedMoments=n.slice(r,2*r).map(function(i){return{originalName:i.name,variable:i.tensor.variable(!1)}}),this.centered&&(this.accumulatedMeanGrads=n.slice(2*r,3*r).map(function(i){return{originalName:i.name,variable:i.tensor.variable(!1)}})),[2]}})})},e.prototype.getConfig=function(){return{learningRate:this.learningRate,decay:this.decay,momentum:this.momentum,epsilon:this.epsilon,centered:this.centered}},e.fromConfig=function(n,r){return new n(r.learningRate,r.decay,r.momentum,r.epsilon,r.centered)},e.className="RMSProp",e}(Fa);Oa(_z);nt.prototype.squaredDifference=function(t){return AS(this,t)},V=KU;/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var Lm=function(t,e){return Lm=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,r){n.__proto__=r}||function(n,r){for(var o in r)r.hasOwnProperty(o)&&(n[o]=r[o])},Lm(t,e)};function ve(t,e){Lm(t,e);function n(){this.constructor=t}t.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}var qt=function(){return qt=Object.assign||function(e){for(var n,r=1,o=arguments.length;r<o;r++){n=arguments[r];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},qt.apply(this,arguments)};function ce(t,e,n,r){function o(i){return i instanceof n?i:new n(function(a){a(i)})}return new(n||(n=Promise))(function(i,a){function s(c){try{l(r.next(c))}catch(d){a(d)}}function u(c){try{l(r.throw(c))}catch(d){a(d)}}function l(c){c.done?i(c.value):o(c.value).then(s,u)}l((r=r.apply(t,[])).next())})}function de(t,e){var n={label:0,sent:function(){if(i[0]&1)throw i[1];return i[1]},trys:[],ops:[]},r,o,i,a;return a={next:s(0),throw:s(1),return:s(2)},typeof Symbol=="function"&&(a[Symbol.iterator]=function(){return this}),a;function s(l){return function(c){return u([l,c])}}function u(l){if(r)throw new TypeError("Generator is already executing.");for(;n;)try{if(r=1,o&&(i=l[0]&2?o.return:l[0]?o.throw||((i=o.return)&&i.call(o),0):o.next)&&!(i=i.call(o,l[1])).done)return i;switch(o=0,i&&(l=[l[0]&2,i.value]),l[0]){case 0:case 1:i=l;break;case 4:return n.label++,{value:l[1],done:!1};case 5:n.label++,o=l[1],l=[0];continue;case 7:l=n.ops.pop(),n.trys.pop();continue;default:if(i=n.trys,!(i=i.length>0&&i[i.length-1])&&(l[0]===6||l[0]===2)){n=0;continue}if(l[0]===3&&(!i||l[1]>i[0]&&l[1]<i[3])){n.label=l[1];break}if(l[0]===6&&n.label<i[1]){n.label=i[1],i=l;break}if(i&&n.label<i[2]){n.label=i[2],n.ops.push(l);break}i[2]&&n.ops.pop(),n.trys.pop();continue}l=e.call(t,n)}catch(c){l=[6,c],o=0}finally{r=i=0}if(l[0]&5)throw l[1];return{value:l[0]?l[1]:void 0,done:!0}}}function tl(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;for(var r=Array(t),o=0,e=0;e<n;e++)for(var i=arguments[e],a=0,s=i.length;a<s;a++,o++)r[o]=i[a];return r}var Ps=function(){function t(e,n){if(!pa(e)||!pa(n))throw new Error("Dimensions.constructor - expected width and height to be valid numbers, instead have "+JSON.stringify({width:e,height:n}));this._width=e,this._height=n}return Object.defineProperty(t.prototype,"width",{get:function(){return this._width},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"height",{get:function(){return this._height},enumerable:!0,configurable:!0}),t.prototype.reverse=function(){return new t(1/this.width,1/this.height)},t}();function ch(t,e){return t instanceof nt&&t.shape.length===e}function Ez(t){return ch(t,2)}function dh(t){return ch(t,3)}function Ci(t){return ch(t,4)}function Cz(t){return t%1!==0}function Ax(t){return t%2===0}function Sz(t,e){e===void 0&&(e=2);var n=Math.pow(10,e);return Math.floor(t*n)/n}function Px(t){return t&&t.width&&t.height}function kz(t,e){var n=t.width,r=t.height,o=e/Math.max(r,n);return new Ps(Math.round(n*o),Math.round(r*o))}function jy(t){return t.reduce(function(e,n){return e.add(n)},new Fe(0,0)).div(new Fe(t.length,t.length))}function Pl(t,e,n){return Array(t).fill(0).map(function(r,o){return e+o*n})}function pa(t){return!!t&&t!==1/0&&t!==-1/0&&!isNaN(t)||t===0}function Dx(t){return pa(t)&&0<=t&&t<=1}var Fe=function(){function t(e,n){this._x=e,this._y=n}return Object.defineProperty(t.prototype,"x",{get:function(){return this._x},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"y",{get:function(){return this._y},enumerable:!0,configurable:!0}),t.prototype.add=function(e){return new t(this.x+e.x,this.y+e.y)},t.prototype.sub=function(e){return new t(this.x-e.x,this.y-e.y)},t.prototype.mul=function(e){return new t(this.x*e.x,this.y*e.y)},t.prototype.div=function(e){return new t(this.x/e.x,this.y/e.y)},t.prototype.abs=function(){return new t(Math.abs(this.x),Math.abs(this.y))},t.prototype.magnitude=function(){return Math.sqrt(Math.pow(this.x,2)+Math.pow(this.y,2))},t.prototype.floor=function(){return new t(Math.floor(this.x),Math.floor(this.y))},t}(),Ai=function(){function t(e,n){n===void 0&&(n=!0);var r=e||{},o=[r.left,r.top,r.right,r.bottom].every(pa),i=[r.x,r.y,r.width,r.height].every(pa);if(!i&&!o)throw new Error("Box.constructor - expected box to be IBoundingBox | IRect, instead have "+JSON.stringify(r));var a=i?[r.x,r.y,r.width,r.height]:[r.left,r.top,r.right-r.left,r.bottom-r.top],s=a[0],u=a[1],l=a[2],c=a[3];t.assertIsValidBox({x:s,y:u,width:l,height:c},"Box.constructor",n),this._x=s,this._y=u,this._width=l,this._height=c}return t.isRect=function(e){return!!e&&[e.x,e.y,e.width,e.height].every(pa)},t.assertIsValidBox=function(e,n,r){if(r===void 0&&(r=!1),!t.isRect(e))throw new Error(n+" - invalid box: "+JSON.stringify(e)+", expected object with properties x, y, width, height");if(!r&&(e.width<0||e.height<0))throw new Error(n+" - width ("+e.width+") and height ("+e.height+") must be positive numbers")},Object.defineProperty(t.prototype,"x",{get:function(){return this._x},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"y",{get:function(){return this._y},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"width",{get:function(){return this._width},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"height",{get:function(){return this._height},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"left",{get:function(){return this.x},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"top",{get:function(){return this.y},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"right",{get:function(){return this.x+this.width},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"bottom",{get:function(){return this.y+this.height},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"area",{get:function(){return this.width*this.height},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"topLeft",{get:function(){return new Fe(this.left,this.top)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"topRight",{get:function(){return new Fe(this.right,this.top)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"bottomLeft",{get:function(){return new Fe(this.left,this.bottom)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"bottomRight",{get:function(){return new Fe(this.right,this.bottom)},enumerable:!0,configurable:!0}),t.prototype.round=function(){var e=[this.x,this.y,this.width,this.height].map(function(a){return Math.round(a)}),n=e[0],r=e[1],o=e[2],i=e[3];return new t({x:n,y:r,width:o,height:i})},t.prototype.floor=function(){var e=[this.x,this.y,this.width,this.height].map(function(a){return Math.floor(a)}),n=e[0],r=e[1],o=e[2],i=e[3];return new t({x:n,y:r,width:o,height:i})},t.prototype.toSquare=function(){var e=this,n=e.x,r=e.y,o=e.width,i=e.height,a=Math.abs(o-i);return o<i&&(n-=a/2,o+=a),i<o&&(r-=a/2,i+=a),new t({x:n,y:r,width:o,height:i})},t.prototype.rescale=function(e){var n=Px(e)?e.width:e,r=Px(e)?e.height:e;return new t({x:this.x*n,y:this.y*r,width:this.width*n,height:this.height*r})},t.prototype.pad=function(e,n){var r=[this.x-e/2,this.y-n/2,this.width+e,this.height+n],o=r[0],i=r[1],a=r[2],s=r[3];return new t({x:o,y:i,width:a,height:s})},t.prototype.clipAtImageBorders=function(e,n){var r=this,o=r.x,i=r.y,a=r.right,s=r.bottom,u=Math.max(o,0),l=Math.max(i,0),c=a-u,d=s-l,f=Math.min(c,e-u),h=Math.min(d,n-l);return new t({x:u,y:l,width:f,height:h}).floor()},t.prototype.shift=function(e,n){var r=this,o=r.width,i=r.height,a=this.x+e,s=this.y+n;return new t({x:a,y:s,width:o,height:i})},t.prototype.padAtBorders=function(e,n){var r=this.width+1,o=this.height+1,i=1,a=1,s=r,u=o,l=this.left,c=this.top,d=this.right,f=this.bottom;return d>n&&(s=-d+n+r,d=n),f>e&&(u=-f+e+o,f=e),l<1&&(u=2-l,l=1),c<1&&(u=2-c,c=1),{dy:a,edy:u,dx:i,edx:s,y:c,ey:f,x:l,ex:d,w:r,h:o}},t.prototype.calibrate=function(e){return new t({left:this.left+e.left*this.width,top:this.top+e.top*this.height,right:this.right+e.right*this.width,bottom:this.bottom+e.bottom*this.height}).toSquare().round()},t}(),fh=function(t){ve(e,t);function e(n,r,o,i,a){return a===void 0&&(a=!1),t.call(this,{left:n,top:r,right:o,bottom:i},a)||this}return e}(Ai),mk=function(){function t(e,n,r,o,i){this._imageDims=new Ps(i.width,i.height),this._score=e,this._classScore=n,this._className=r,this._box=new Ai(o).rescale(this._imageDims)}return Object.defineProperty(t.prototype,"score",{get:function(){return this._score},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"classScore",{get:function(){return this._classScore},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"className",{get:function(){return this._className},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"box",{get:function(){return this._box},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"imageDims",{get:function(){return this._imageDims},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"imageWidth",{get:function(){return this.imageDims.width},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"imageHeight",{get:function(){return this.imageDims.height},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"relativeBox",{get:function(){return new Ai(this._box).rescale(this.imageDims.reverse())},enumerable:!0,configurable:!0}),t.prototype.forSize=function(e,n){return new t(this.score,this.classScore,this.className,this.relativeBox,{width:e,height:n})},t}(),eo=function(t){ve(e,t);function e(n,r,o){return t.call(this,n,n,"",r,o)||this}return e.prototype.forSize=function(n,r){var o=t.prototype.forSize.call(this,n,r),i=o.score,a=o.relativeBox,s=o.imageDims;return new e(i,a,s)},e}(mk);function Rz(t,e,n){n===void 0&&(n=!0);var r=Math.max(0,Math.min(t.right,e.right)-Math.max(t.left,e.left)),o=Math.max(0,Math.min(t.bottom,e.bottom)-Math.max(t.top,e.top)),i=r*o;return n?i/(t.area+e.area-i):i/Math.min(t.area,e.area)}function Tz(t){var e=t.map(function(s){return s.x}),n=t.map(function(s){return s.y}),r=e.reduce(function(s,u){return u<s?u:s},1/0),o=n.reduce(function(s,u){return u<s?u:s},1/0),i=e.reduce(function(s,u){return s<u?u:s},0),a=n.reduce(function(s,u){return s<u?u:s},0);return new fh(r,o,i,a)}function Dl(t,e,n,r){r===void 0&&(r=!0);for(var o=e.map(function(s,u){return{score:s,boxIndex:u}}).sort(function(s,u){return s.score-u.score}).map(function(s){return s.boxIndex}),i=[],a=function(){var s=o.pop();i.push(s);for(var u=o,l=[],c=0;c<u.length;c++){var d=u[c],f=t[s],h=t[d];l.push(Rz(f,h,r))}o=o.filter(function(v,p){return l[p]<=n})};o.length>0;)a();return i}function rc(t,e){return ne(function(){var n=e[0],r=e[1],o=e[2],i=qr(tl(t.shape.slice(0,3),[1]),n),a=qr(tl(t.shape.slice(0,3),[1]),r),s=qr(tl(t.shape.slice(0,3),[1]),o),u=_t([i,a,s],3);return St(t,u)})}function Iz(t,e){return e===void 0&&(e=!1),ne(function(){var n=t.shape.slice(1),r=n[0],o=n[1];if(r===o)return t;var i=Math.abs(r-o),a=Math.round(i*(e?.5:1)),s=r>o?2:1,u=function(h){var v=t.shape.slice();return v[s]=h,qr(v,0)},l=u(a),c=i-l.shape[s],d=e&&c?u(c):null,f=[d,t,l].filter(function(h){return!!h}).map(function(h){return h.toFloat()});return _t(f,s)})}function Lp(t){return 1/(1+Math.exp(-t))}var Wy=function(t){ve(e,t);function e(n,r,o,i,a){return a===void 0&&(a=!1),t.call(this,{x:n,y:r,width:o,height:i},a)||this}return e}(Ai),Az=.5,Pz=.43,Dz=.45,gf=function(){function t(e,n,r){r===void 0&&(r=new Fe(0,0));var o=n.width,i=n.height;this._imgDims=new Ps(o,i),this._shift=r,this._positions=e.map(function(a){return a.mul(new Fe(o,i)).add(r)})}return Object.defineProperty(t.prototype,"shift",{get:function(){return new Fe(this._shift.x,this._shift.y)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"imageWidth",{get:function(){return this._imgDims.width},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"imageHeight",{get:function(){return this._imgDims.height},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"positions",{get:function(){return this._positions},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"relativePositions",{get:function(){var e=this;return this._positions.map(function(n){return n.sub(e._shift).div(new Fe(e.imageWidth,e.imageHeight))})},enumerable:!0,configurable:!0}),t.prototype.forSize=function(e,n){return new this.constructor(this.relativePositions,{width:e,height:n})},t.prototype.shiftBy=function(e,n){return new this.constructor(this.relativePositions,this._imgDims,new Fe(e,n))},t.prototype.shiftByPoint=function(e){return this.shiftBy(e.x,e.y)},t.prototype.align=function(e,n){if(n===void 0&&(n={}),e){var r=e instanceof eo?e.box.floor():new Ai(e);return this.shiftBy(r.x,r.y).align(null,n)}var o=Object.assign({},{useDlibAlignment:!1,minBoxPadding:.2},n),i=o.useDlibAlignment,a=o.minBoxPadding;return i?this.alignDlib():this.alignMinBbox(a)},t.prototype.alignDlib=function(){var e=this.getRefPointsForAlignment(),n=e[0],r=e[1],o=e[2],i=function(d){return o.sub(d).magnitude()},a=(i(n)+i(r))/2,s=Math.floor(a/Dz),u=jy(e),l=Math.floor(Math.max(0,u.x-Az*s)),c=Math.floor(Math.max(0,u.y-Pz*s));return new Wy(l,c,Math.min(s,this.imageWidth+l),Math.min(s,this.imageHeight+c))},t.prototype.alignMinBbox=function(e){var n=Tz(this.positions);return n.pad(n.width*e,n.height*e)},t.prototype.getRefPointsForAlignment=function(){throw new Error("getRefPointsForAlignment not implemented by base class")},t}(),Nz=function(t){ve(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}return e.prototype.getRefPointsForAlignment=function(){var n=this.positions;return[n[0],n[1],jy([n[3],n[4]])]},e}(gf),Oz=function(t){ve(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}return e.prototype.getJawOutline=function(){return this.positions.slice(0,17)},e.prototype.getLeftEyeBrow=function(){return this.positions.slice(17,22)},e.prototype.getRightEyeBrow=function(){return this.positions.slice(22,27)},e.prototype.getNose=function(){return this.positions.slice(27,36)},e.prototype.getLeftEye=function(){return this.positions.slice(36,42)},e.prototype.getRightEye=function(){return this.positions.slice(42,48)},e.prototype.getMouth=function(){return this.positions.slice(48,68)},e.prototype.getRefPointsForAlignment=function(){return[this.getLeftEye(),this.getRightEye(),this.getMouth()].map(jy)},e}(gf),Nx=function(){function t(e,n){this._label=e,this._distance=n}return Object.defineProperty(t.prototype,"label",{get:function(){return this._label},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"distance",{get:function(){return this._distance},enumerable:!0,configurable:!0}),t.prototype.toString=function(e){return e===void 0&&(e=!0),""+this.label+(e?" ("+Sz(this.distance)+")":"")},t}(),Ox=function(t){ve(e,t);function e(n,r){var o=t.call(this,n)||this;return o._label=r,o}return e.assertIsValidLabeledBox=function(n,r){if(Ai.assertIsValidBox(n,r),!pa(n.label))throw new Error(r+" - expected property label ("+n.label+") to be a number")},Object.defineProperty(e.prototype,"label",{get:function(){return this._label},enumerable:!0,configurable:!0}),e}(Ai),Kc=function(){function t(e,n){if(typeof e!="string")throw new Error("LabeledFaceDescriptors - constructor expected label to be a string");if(!Array.isArray(n)||n.some(function(r){return!(r instanceof Float32Array)}))throw new Error("LabeledFaceDescriptors - constructor expected descriptors to be an array of Float32Array");this._label=e,this._descriptors=n}return Object.defineProperty(t.prototype,"label",{get:function(){return this._label},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"descriptors",{get:function(){return this._descriptors},enumerable:!0,configurable:!0}),t.prototype.toJSON=function(){return{label:this.label,descriptors:this.descriptors.map(function(e){return Array.from(e)})}},t.fromJSON=function(e){var n=e.descriptors.map(function(r){return new Float32Array(r)});return new t(e.label,n)},t}();(function(t){ve(e,t);function e(n,r,o,i){var a=t.call(this,n,r)||this;return a._score=o,a._classScore=i,a}return e.assertIsValidPredictedBox=function(n,r){if(Ox.assertIsValidLabeledBox(n,r),!Dx(n.score)||!Dx(n.classScore))throw new Error(r+" - expected properties score ("+n.score+") and ("+n.classScore+") to be a number between [0, 1]")},Object.defineProperty(e.prototype,"score",{get:function(){return this._score},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"classScore",{get:function(){return this._classScore},enumerable:!0,configurable:!0}),e})(Ox);function Fz(t){return t.detection instanceof eo}function Uy(t,e){var n={detection:e};return Object.assign({},t,n)}function gk(){var t=window.fetch||function(){throw new Error("fetch - missing fetch implementation for browser environment")},e=function(){throw new Error("readFile - filesystem not available for browser environment")};return{Canvas:HTMLCanvasElement,CanvasRenderingContext2D,Image:HTMLImageElement,ImageData,Video:HTMLVideoElement,createCanvasElement:function(){return document.createElement("canvas")},createImageElement:function(){return document.createElement("img")},fetch:t,readFile:e}}function yk(t){var e="";if(!t)try{t=require("fs")}catch(r){e=r.toString()}var n=t?function(r){return new Promise(function(o,i){t.readFile(r,function(a,s){return a?i(a):o(s)})})}:function(){throw new Error("readFile - failed to require fs in nodejs environment with error: "+e)};return{readFile:n}}function wk(){var t=global.Canvas||global.HTMLCanvasElement,e=global.Image||global.HTMLImageElement,n=function(){if(t)return new t;throw new Error("createCanvasElement - missing Canvas implementation for nodejs environment")},r=function(){if(e)return new e;throw new Error("createImageElement - missing Image implementation for nodejs environment")},o=global.fetch||function(){throw new Error("fetch - missing fetch implementation for nodejs environment")},i=yk();return qt({Canvas:t||function(){function a(){}return a}(),CanvasRenderingContext2D:global.CanvasRenderingContext2D||function(){function a(){}return a}(),Image:e||function(){function a(){}return a}(),ImageData:global.ImageData||function(){function a(){}return a}(),Video:global.HTMLVideoElement||function(){function a(){}return a}(),createCanvasElement:n,createImageElement:r,fetch:o},i)}function xk(){return typeof window=="object"&&typeof document<"u"&&typeof HTMLImageElement<"u"&&typeof HTMLCanvasElement<"u"&&typeof HTMLVideoElement<"u"&&typeof ImageData<"u"&&typeof CanvasRenderingContext2D<"u"}function bk(){return typeof global=="object"&&typeof require=="function"&&typeof module<"u"&&typeof process<"u"&&!!process.version}var gt;function Mz(){if(!gt)throw new Error("getEnv - environment is not defined, check isNodejs() and isBrowser()");return gt}function Bm(t){gt=t}function zy(){xk()&&Bm(gk()),bk()&&Bm(wk())}function Lz(t){if(gt||zy(),!gt)throw new Error("monkeyPatch - environment is not defined, check isNodejs() and isBrowser()");var e=t.Canvas,n=e===void 0?gt.Canvas:e,r=t.Image,o=r===void 0?gt.Image:r;gt.Canvas=n,gt.Image=o,gt.createCanvasElement=t.createCanvasElement||function(){return new n},gt.createImageElement=t.createImageElement||function(){return new o},gt.ImageData=t.ImageData||gt.ImageData,gt.Video=t.Video||gt.Video,gt.fetch=t.fetch||gt.fetch,gt.readFile=t.readFile||gt.readFile}var Jt={getEnv:Mz,setEnv:Bm,initialize:zy,createBrowserEnv:gk,createFileSystem:yk,createNodejsEnv:wk,monkeyPatch:Lz,isBrowser:xk,isNodejs:bk};zy();function _k(t){return!Jt.isNodejs()&&typeof t=="string"?document.getElementById(t):t}function Sa(t){var e=Jt.getEnv(),n=e.Canvas,r=e.CanvasRenderingContext2D;if(t instanceof r)return t;var o=_k(t);if(!(o instanceof n))throw new Error("resolveContext2d - expected canvas to be of instance of Canvas");var i=o.getContext("2d");if(!i)throw new Error("resolveContext2d - canvas 2d context is null");return i}var Fx;(function(t){t.TOP_LEFT="TOP_LEFT",t.TOP_RIGHT="TOP_RIGHT",t.BOTTOM_LEFT="BOTTOM_LEFT",t.BOTTOM_RIGHT="BOTTOM_RIGHT"})(Fx||(Fx={}));function Ek(t){var e=Jt.getEnv(),n=e.Image,r=e.Video;return t instanceof n&&t.complete||t instanceof r&&t.readyState>=3}function Bz(t){return new Promise(function(e,n){if(t instanceof Jt.getEnv().Canvas||Ek(t))return e();function r(i){i.currentTarget&&(i.currentTarget.removeEventListener("load",r),i.currentTarget.removeEventListener("error",o),e(i))}function o(i){i.currentTarget&&(i.currentTarget.removeEventListener("load",r),i.currentTarget.removeEventListener("error",o),n(i))}t.addEventListener("load",r),t.addEventListener("error",o)})}function Ck(t){var e=Jt.getEnv(),n=e.Image,r=e.Video;return t instanceof n?new Ps(t.naturalWidth,t.naturalHeight):t instanceof r?new Ps(t.videoWidth,t.videoHeight):new Ps(t.width,t.height)}function hh(t){var e=t.width,n=t.height,r=Jt.getEnv().createCanvasElement,o=r();return o.width=e,o.height=n,o}function Vy(t,e){var n=Jt.getEnv().ImageData;if(!(t instanceof n)&&!Ek(t))throw new Error("createCanvasFromMedia - media has not finished loading yet");var r=Ck(t),o=r.width,i=r.height,a=hh({width:o,height:i});return t instanceof n?Sa(a).putImageData(t,0,0):Sa(a).drawImage(t,0,0,o,i),a}function $z(t,e){return ce(this,void 0,void 0,function(){var n,r,o,i,a,s;return de(this,function(u){switch(u.label){case 0:return n=Jt.getEnv().createCanvasElement(),r=t.shape.slice(Ci(t)?1:0),o=r[0],i=r[1],a=r[2],s=ne(function(){return t.as3D(o,i,a).toInt()}),[4,$y.toPixels(s,n)];case 1:return u.sent(),s.dispose(),[2,n]}})})}function Mx(t){var e=Jt.getEnv(),n=e.Image,r=e.Canvas,o=e.Video;return t instanceof n||t instanceof r||t instanceof o}function jz(t,e,n){n===void 0&&(n=!1);var r=Jt.getEnv(),o=r.Image,i=r.Canvas;if(!(t instanceof o||t instanceof i))throw new Error("imageToSquare - expected arg0 to be HTMLImageElement | HTMLCanvasElement");var a=Ck(t),s=e/Math.max(a.height,a.width),u=s*a.width,l=s*a.height,c=hh({width:e,height:e}),d=t instanceof i?t:Vy(t),f=Math.abs(u-l)/2,h=n&&u<l?f:0,v=n&&l<u?f:0;return Sa(c).drawImage(d,h,v,u,l),c}var yf=function(){function t(e,n){var r=this;if(n===void 0&&(n=!1),this._imageTensors=[],this._canvases=[],this._treatAsBatchInput=!1,this._inputDimensions=[],!Array.isArray(e))throw new Error("NetInput.constructor - expected inputs to be an Array of TResolvedNetInput or to be instanceof tf.Tensor4D, instead have "+e);this._treatAsBatchInput=n,this._batchSize=e.length,e.forEach(function(o,i){if(dh(o)){r._imageTensors[i]=o,r._inputDimensions[i]=o.shape;return}if(Ci(o)){var a=o.shape[0];if(a!==1)throw new Error("NetInput - tf.Tensor4D with batchSize "+a+" passed, but not supported in input array");r._imageTensors[i]=o,r._inputDimensions[i]=o.shape.slice(1);return}var s=o instanceof Jt.getEnv().Canvas?o:Vy(o);r._canvases[i]=s,r._inputDimensions[i]=[s.height,s.width,3]})}return Object.defineProperty(t.prototype,"imageTensors",{get:function(){return this._imageTensors},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"canvases",{get:function(){return this._canvases},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isBatchInput",{get:function(){return this.batchSize>1||this._treatAsBatchInput},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"batchSize",{get:function(){return this._batchSize},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"inputDimensions",{get:function(){return this._inputDimensions},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"inputSize",{get:function(){return this._inputSize},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"reshapedInputDimensions",{get:function(){var e=this;return Pl(this.batchSize,0,1).map(function(n,r){return e.getReshapedInputDimensions(r)})},enumerable:!0,configurable:!0}),t.prototype.getInput=function(e){return this.canvases[e]||this.imageTensors[e]},t.prototype.getInputDimensions=function(e){return this._inputDimensions[e]},t.prototype.getInputHeight=function(e){return this._inputDimensions[e][0]},t.prototype.getInputWidth=function(e){return this._inputDimensions[e][1]},t.prototype.getReshapedInputDimensions=function(e){if(typeof this.inputSize!="number")throw new Error("getReshapedInputDimensions - inputSize not set, toBatchTensor has not been called yet");var n=this.getInputWidth(e),r=this.getInputHeight(e);return kz({width:n,height:r},this.inputSize)},t.prototype.toBatchTensor=function(e,n){var r=this;return n===void 0&&(n=!0),this._inputSize=e,ne(function(){var o=Pl(r.batchSize,0,1).map(function(a){var s=r.getInput(a);if(s instanceof nt){var u=Ci(s)?s:s.expandDims();return u=Iz(u,n),(u.shape[1]!==e||u.shape[2]!==e)&&(u=Ny.resizeBilinear(u,[e,e])),u.as3D(e,e,3)}if(s instanceof Jt.getEnv().Canvas)return $y.fromPixels(jz(s,e,n));throw new Error("toBatchTensor - at batchIdx "+a+", expected input to be instanceof tf.Tensor or instanceof HTMLCanvasElement, instead have "+s)}),i=Fn(o.map(function(a){return a.toFloat()})).as4D(r.batchSize,e,e,3);return i})},t}();function Dt(t){return ce(this,void 0,void 0,function(){var e,n,r;return de(this,function(o){switch(o.label){case 0:if(t instanceof yf)return[2,t];if(e=Array.isArray(t)?t:[t],!e.length)throw new Error("toNetInput - empty array passed as input");return n=function(i){return Array.isArray(t)?" at input index "+i+":":""},r=e.map(_k),r.forEach(function(i,a){if(!Mx(i)&&!dh(i)&&!Ci(i))throw typeof e[a]=="string"?new Error("toNetInput -"+n(a)+" string passed, but could not resolve HTMLElement for element id "+e[a]):new Error("toNetInput -"+n(a)+" expected media to be of type HTMLImageElement | HTMLVideoElement | HTMLCanvasElement | tf.Tensor3D, or to be an element id");if(Ci(i)){var s=i.shape[0];if(s!==1)throw new Error("toNetInput -"+n(a)+" tf.Tensor4D with batchSize "+s+" passed, but not supported in input array")}}),[4,Promise.all(r.map(function(i){return Mx(i)&&Bz(i)}))];case 1:return o.sent(),[2,new yf(r,Array.isArray(t))]}})})}function Hy(t,e){return ce(this,void 0,void 0,function(){var n,r,o,i,a,s,u;return de(this,function(l){switch(l.label){case 0:return n=Jt.getEnv().Canvas,r=t,t instanceof n?[3,5]:[4,Dt(t)];case 1:if(o=l.sent(),o.batchSize>1)throw new Error("extractFaces - batchSize > 1 not supported");return i=o.getInput(0),i instanceof n?(a=i,[3,4]):[3,2];case 2:return[4,$z(i)];case 3:a=l.sent(),l.label=4;case 4:r=a,l.label=5;case 5:return s=Sa(r),u=e.map(function(c){return c instanceof eo?c.forSize(r.width,r.height).box.floor():c}).map(function(c){return c.clipAtImageBorders(r.width,r.height)}),[2,u.map(function(c){var d=c.x,f=c.y,h=c.width,v=c.height,p=hh({width:h,height:v});return Sa(p).putImageData(s.getImageData(d,f,h,v),0,0),p})]}})})}function Gy(t,e){return ce(this,void 0,void 0,function(){return de(this,function(n){if(!dh(t)&&!Ci(t))throw new Error("extractFaceTensors - expected image tensor to be 3D or 4D");if(Ci(t)&&t.shape[0]>1)throw new Error("extractFaceTensors - batchSize > 1 not supported");return[2,ne(function(){var r=t.shape.slice(Ci(t)?1:0),o=r[0],i=r[1],a=r[2],s=e.map(function(l){return l instanceof eo?l.forSize(i,o).box:l}).map(function(l){return l.clipAtImageBorders(i,o)}),u=s.map(function(l){var c=l.x,d=l.y,f=l.width,h=l.height;return QS(t.as3D(o,i,a),[d,c,0],[h,f,a])});return u})]})})}function Wz(t,e){return ce(this,void 0,void 0,function(){var n,r;return de(this,function(o){switch(o.label){case 0:return n=Jt.getEnv().fetch,[4,n(t,e)];case 1:if(r=o.sent(),!(r.status<400))throw new Error("failed to fetch: ("+r.status+") "+r.statusText+", from url: "+r.url);return[2,r]}})})}function Uz(t){return ce(this,void 0,void 0,function(){return de(this,function(e){switch(e.label){case 0:return[4,Wz(t)];case 1:return[2,e.sent().json()]}})})}function Sk(t,e){var n=e+"-weights_manifest.json";if(!t)return{modelBaseUri:"",manifestUri:n};if(t==="/")return{modelBaseUri:"/",manifestUri:"/"+n};var r=t.startsWith("http://")?"http://":t.startsWith("https://")?"https://":"";t=t.replace(r,"");var o=t.split("/").filter(function(s){return s}),i=t.endsWith(".json")?o[o.length-1]:n,a=r+(t.endsWith(".json")?o.slice(0,o.length-1):o).join("/");return a=t.startsWith("/")?"/"+a:a,{modelBaseUri:a,manifestUri:a==="/"?"/"+i:a+"/"+i}}function zz(t,e){return ce(this,void 0,void 0,function(){var n,r,o,i;return de(this,function(a){switch(a.label){case 0:return n=Sk(t,e),r=n.manifestUri,o=n.modelBaseUri,[4,Uz(r)];case 1:return i=a.sent(),[2,pk.loadWeights(i,o)]}})})}var Io=function(){function t(e){this._name=e,this._params=void 0,this._paramMappings=[]}return Object.defineProperty(t.prototype,"params",{get:function(){return this._params},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"paramMappings",{get:function(){return this._paramMappings},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isLoaded",{get:function(){return!!this.params},enumerable:!0,configurable:!0}),t.prototype.getParamFromPath=function(e){var n=this.traversePropertyPath(e),r=n.obj,o=n.objProp;return r[o]},t.prototype.reassignParamFromPath=function(e,n){var r=this.traversePropertyPath(e),o=r.obj,i=r.objProp;o[i].dispose(),o[i]=n},t.prototype.getParamList=function(){var e=this;return this._paramMappings.map(function(n){var r=n.paramPath;return{path:r,tensor:e.getParamFromPath(r)}})},t.prototype.getTrainableParams=function(){return this.getParamList().filter(function(e){return e.tensor instanceof ru})},t.prototype.getFrozenParams=function(){return this.getParamList().filter(function(e){return!(e.tensor instanceof ru)})},t.prototype.variable=function(){var e=this;this.getFrozenParams().forEach(function(n){var r=n.path,o=n.tensor;e.reassignParamFromPath(r,o.variable())})},t.prototype.freeze=function(){var e=this;this.getTrainableParams().forEach(function(n){var r=n.path,o=n.tensor,i=Lt(o.dataSync());o.dispose(),e.reassignParamFromPath(r,i)})},t.prototype.dispose=function(e){e===void 0&&(e=!0),this.getParamList().forEach(function(n){if(e&&n.tensor.isDisposed)throw new Error("param tensor has already been disposed for path "+n.path);n.tensor.dispose()}),this._params=void 0},t.prototype.serializeParams=function(){return new Float32Array(this.getParamList().map(function(e){var n=e.tensor;return Array.from(n.dataSync())}).reduce(function(e,n){return e.concat(n)}))},t.prototype.load=function(e){return ce(this,void 0,void 0,function(){return de(this,function(n){switch(n.label){case 0:return e instanceof Float32Array?(this.extractWeights(e),[2]):[4,this.loadFromUri(e)];case 1:return n.sent(),[2]}})})},t.prototype.loadFromUri=function(e){return ce(this,void 0,void 0,function(){var n;return de(this,function(r){switch(r.label){case 0:if(e&&typeof e!="string")throw new Error(this._name+".loadFromUri - expected model uri");return[4,zz(e,this.getDefaultModelName())];case 1:return n=r.sent(),this.loadFromWeightMap(n),[2]}})})},t.prototype.loadFromDisk=function(e){return ce(this,void 0,void 0,function(){var n,r,o,i,a,s,u,l,c,d;return de(this,function(f){switch(f.label){case 0:if(e&&typeof e!="string")throw new Error(this._name+".loadFromDisk - expected model file path");return n=Jt.getEnv().readFile,r=Sk(e,this.getDefaultModelName()),o=r.manifestUri,i=r.modelBaseUri,a=function(h){return Promise.all(h.map(function(v){return n(v).then(function(p){return p.buffer})}))},s=pk.weightsLoaderFactory(a),c=(l=JSON).parse,[4,n(o)];case 1:return u=c.apply(l,[f.sent().toString()]),[4,s(u,i)];case 2:return d=f.sent(),this.loadFromWeightMap(d),[2]}})})},t.prototype.loadFromWeightMap=function(e){var n=this.extractParamsFromWeigthMap(e),r=n.paramMappings,o=n.params;this._paramMappings=r,this._params=o},t.prototype.extractWeights=function(e){var n=this.extractParams(e),r=n.paramMappings,o=n.params;this._paramMappings=r,this._params=o},t.prototype.traversePropertyPath=function(e){if(!this.params)throw new Error("traversePropertyPath - model has no loaded params");var n=e.split("/").reduce(function(i,a){if(!i.nextObj.hasOwnProperty(a))throw new Error("traversePropertyPath - object does not have property "+a+", for path "+e);return{obj:i.nextObj,objProp:a,nextObj:i.nextObj[a]}},{nextObj:this.params}),r=n.obj,o=n.objProp;if(!r||!o||!(r[o]instanceof nt))throw new Error("traversePropertyPath - parameter is not a tensor, for path "+e);return{obj:r,objProp:o}},t}();function Dn(t,e,n){return ne(function(){var r=Ty(t,e.depthwise_filter,e.pointwise_filter,n,"same");return r=ke(r,e.bias),r})}function Bp(t,e,n){return n===void 0&&(n=!1),ne(function(){var r=rt(n?ke(Zn(t,e.conv0.filters,[2,2],"same"),e.conv0.bias):Dn(t,e.conv0,[2,2])),o=Dn(r,e.conv1,[1,1]),i=rt(ke(r,o)),a=Dn(i,e.conv2,[1,1]);return rt(ke(r,ke(o,a)))})}function Xc(t,e,n,r){return n===void 0&&(n=!1),r===void 0&&(r=!0),ne(function(){var o=rt(n?ke(Zn(t,e.conv0.filters,r?[2,2]:[1,1],"same"),e.conv0.bias):Dn(t,e.conv0,r?[2,2]:[1,1])),i=Dn(o,e.conv1,[1,1]),a=rt(ke(o,i)),s=Dn(a,e.conv2,[1,1]),u=rt(ke(o,ke(i,s))),l=Dn(u,e.conv3,[1,1]);return rt(ke(o,ke(i,ke(s,l))))})}function yr(t,e,n,r){return n===void 0&&(n="same"),r===void 0&&(r=!1),ne(function(){var o=ke(Zn(t,e.filters,[1,1],n),e.bias);return r?rt(o):o})}function Ao(t,e){Object.keys(t).forEach(function(n){e.some(function(r){return r.originalPath===n})||t[n].dispose()})}function ph(t,e){return function(n,r,o,i){var a=vn(t(n*r*o*o),[o,o,n,r]),s=pt(t(r));return e.push({paramPath:i+"/filters"},{paramPath:i+"/bias"}),{filters:a,bias:s}}}function qy(t,e){return function(n,r,o){var i=_i(t(n*r),[n,r]),a=pt(t(r));return e.push({paramPath:o+"/weights"},{paramPath:o+"/bias"}),{weights:i,bias:a}}}var kk=function(){function t(e,n,r){this.depthwise_filter=e,this.pointwise_filter=n,this.bias=r}return t}();function Ky(t,e){return function(n,r,o){var i=vn(t(9*n),[3,3,n,1]),a=vn(t(n*r),[1,1,n,r]),s=pt(t(r));return e.push({paramPath:o+"/depthwise_filter"},{paramPath:o+"/pointwise_filter"},{paramPath:o+"/bias"}),new kk(i,a,s)}}function Xy(t){return function(e){var n=t(e+"/depthwise_filter",4),r=t(e+"/pointwise_filter",4),o=t(e+"/bias",1);return new kk(n,r,o)}}function $i(t,e){return function(n,r,o){var i=t[n];if(!ch(i,r))throw new Error("expected weightMap["+n+"] to be a Tensor"+r+"D, instead have "+i);return e.push({originalPath:n,paramPath:o||n}),i}}function Po(t){var e=t;function n(o){var i=e.slice(0,o);return e=e.slice(o),i}function r(){return e}return{extractWeights:n,getRemainingWeights:r}}function Rk(t,e){var n=ph(t,e),r=Ky(t,e);function o(a,s,u,l){l===void 0&&(l=!1);var c=l?n(a,s,3,u+"/conv0"):r(a,s,u+"/conv0"),d=r(s,s,u+"/conv1"),f=r(s,s,u+"/conv2");return{conv0:c,conv1:d,conv2:f}}function i(a,s,u,l){l===void 0&&(l=!1);var c=o(a,s,u,l),d=c.conv0,f=c.conv1,h=c.conv2,v=r(s,s,u+"/conv3");return{conv0:d,conv1:f,conv2:h,conv3:v}}return{extractDenseBlock3Params:o,extractDenseBlock4Params:i}}function Vz(t){var e=[],n=Po(t),r=n.extractWeights,o=n.getRemainingWeights,i=Rk(r,e).extractDenseBlock4Params,a=i(3,32,"dense0",!0),s=i(32,64,"dense1"),u=i(64,128,"dense2"),l=i(128,256,"dense3");if(o().length!==0)throw new Error("weights remaing after extract: "+o().length);return{paramMappings:e,params:{dense0:a,dense1:s,dense2:u,dense3:l}}}function Tk(t){return function(e){var n=t(e+"/filters",4),r=t(e+"/bias",1);return{filters:n,bias:r}}}function Ik(t,e){var n=$i(t,e),r=Tk(n),o=Xy(n);function i(s,u){u===void 0&&(u=!1);var l=u?r(s+"/conv0"):o(s+"/conv0"),c=o(s+"/conv1"),d=o(s+"/conv2");return{conv0:l,conv1:c,conv2:d}}function a(s,u){u===void 0&&(u=!1);var l=u?r(s+"/conv0"):o(s+"/conv0"),c=o(s+"/conv1"),d=o(s+"/conv2"),f=o(s+"/conv3");return{conv0:l,conv1:c,conv2:d,conv3:f}}return{extractDenseBlock3Params:i,extractDenseBlock4Params:a}}function Hz(t){var e=[],n=Ik(t,e).extractDenseBlock4Params,r={dense0:n("dense0",!0),dense1:n("dense1"),dense2:n("dense2"),dense3:n("dense3")};return Ao(t,e),{params:r,paramMappings:e}}var Ak=function(t){ve(e,t);function e(){return t.call(this,"FaceFeatureExtractor")||this}return e.prototype.forwardInput=function(n){var r=this.params;if(!r)throw new Error("FaceFeatureExtractor - load model before inference");return ne(function(){var o=n.toBatchTensor(112,!0),i=[122.782,117.001,104.298],a=rc(o,i).div(ee(255)),s=Xc(a,r.dense0,!0);return s=Xc(s,r.dense1),s=Xc(s,r.dense2),s=Xc(s,r.dense3),s=tc(s,[7,7],[2,2],"valid"),s})},e.prototype.forward=function(n){return ce(this,void 0,void 0,function(){var r;return de(this,function(o){switch(o.label){case 0:return r=this.forwardInput,[4,Dt(n)];case 1:return[2,r.apply(this,[o.sent()])]}})})},e.prototype.getDefaultModelName=function(){return"face_feature_extractor_model"},e.prototype.extractParamsFromWeigthMap=function(n){return Hz(n)},e.prototype.extractParams=function(n){return Vz(n)},e}(Io);function Wr(t,e){return ne(function(){return ke(sh(t,e.weights),e.bias)})}function Gz(t,e,n){var r=[],o=Po(t),i=o.extractWeights,a=o.getRemainingWeights,s=qy(i,r),u=s(e,n,"fc");if(a().length!==0)throw new Error("weights remaing after extract: "+a().length);return{paramMappings:r,params:{fc:u}}}function qz(t){var e=[],n=$i(t,e);function r(i){var a=n(i+"/weights",2),s=n(i+"/bias",1);return{weights:a,bias:s}}var o={fc:r("fc")};return Ao(t,e),{params:o,paramMappings:e}}function Pk(t){var e={},n={};return Object.keys(t).forEach(function(r){var o=r.startsWith("fc")?n:e;o[r]=t[r]}),{featureExtractorMap:e,classifierMap:n}}var Dk=function(t){ve(e,t);function e(n,r){var o=t.call(this,n)||this;return o._faceFeatureExtractor=r,o}return Object.defineProperty(e.prototype,"faceFeatureExtractor",{get:function(){return this._faceFeatureExtractor},enumerable:!0,configurable:!0}),e.prototype.runNet=function(n){var r=this,o=this.params;if(!o)throw new Error(this._name+" - load model before inference");return ne(function(){var i=n instanceof yf?r.faceFeatureExtractor.forwardInput(n):n;return Wr(i.as2D(i.shape[0],-1),o.fc)})},e.prototype.dispose=function(n){n===void 0&&(n=!0),this.faceFeatureExtractor.dispose(n),t.prototype.dispose.call(this,n)},e.prototype.loadClassifierParams=function(n){var r=this.extractClassifierParams(n),o=r.params,i=r.paramMappings;this._params=o,this._paramMappings=i},e.prototype.extractClassifierParams=function(n){return Gz(n,this.getClassifierChannelsIn(),this.getClassifierChannelsOut())},e.prototype.extractParamsFromWeigthMap=function(n){var r=Pk(n),o=r.featureExtractorMap,i=r.classifierMap;return this.faceFeatureExtractor.loadFromWeightMap(o),qz(i)},e.prototype.extractParams=function(n){var r=this.getClassifierChannelsIn(),o=this.getClassifierChannelsOut(),i=o*r+o,a=n.slice(0,n.length-i),s=n.slice(n.length-i);return this.faceFeatureExtractor.extractWeights(a),this.extractClassifierParams(s)},e}(Io),Lx=["neutral","happy","sad","angry","fearful","disgusted","surprised"],Kz=function(){function t(e){var n=this;if(e.length!==7)throw new Error("FaceExpressions.constructor - expected probabilities.length to be 7, have: "+e.length);Lx.forEach(function(r,o){n[r]=e[o]})}return t.prototype.asSortedArray=function(){var e=this;return Lx.map(function(n){return{expression:n,probability:e[n]}}).sort(function(n,r){return r.probability-n.probability})},t}(),Xz=function(t){ve(e,t);function e(n){return n===void 0&&(n=new Ak),t.call(this,"FaceExpressionNet",n)||this}return e.prototype.forwardInput=function(n){var r=this;return ne(function(){return Ro(r.runNet(n))})},e.prototype.forward=function(n){return ce(this,void 0,void 0,function(){var r;return de(this,function(o){switch(o.label){case 0:return r=this.forwardInput,[4,Dt(n)];case 1:return[2,r.apply(this,[o.sent()])]}})})},e.prototype.predictExpressions=function(n){return ce(this,void 0,void 0,function(){var r,o,i,a,s=this;return de(this,function(u){switch(u.label){case 0:return[4,Dt(n)];case 1:return r=u.sent(),[4,this.forwardInput(r)];case 2:return o=u.sent(),[4,Promise.all(Et(o).map(function(l){return ce(s,void 0,void 0,function(){var c;return de(this,function(d){switch(d.label){case 0:return[4,l.data()];case 1:return c=d.sent(),l.dispose(),[2,c]}})})}))];case 3:return i=u.sent(),o.dispose(),a=i.map(function(l){return new Kz(l)}),[2,r.isBatchInput?a:a[0]]}})})},e.prototype.getDefaultModelName=function(){return"face_expression_model"},e.prototype.getClassifierChannelsIn=function(){return 256},e.prototype.getClassifierChannelsOut=function(){return 7},e}(Dk);function Nk(t,e){var n={expressions:e};return Object.assign({},t,n)}function Yz(t){return Fz(t)&&t.landmarks instanceof gf&&t.unshiftedLandmarks instanceof gf&&t.alignedRect instanceof eo}function Yy(t,e){var n=t.detection.box,r=e.shiftBy(n.x,n.y),o=r.align(),i=t.detection.imageDims,a=new eo(t.detection.score,o.rescale(i.reverse()),i),s={landmarks:r,unshiftedLandmarks:e,alignedRect:a};return Object.assign({},t,s)}function Qz(t,e){var n=ph(t,e),r=Ky(t,e);function o(a,s,u){var l=r(a,s,u+"/separable_conv0"),c=r(s,s,u+"/separable_conv1"),d=n(a,s,1,u+"/expansion_conv");return{separable_conv0:l,separable_conv1:c,expansion_conv:d}}function i(a,s){var u=r(a,a,s+"/separable_conv0"),l=r(a,a,s+"/separable_conv1"),c=r(a,a,s+"/separable_conv2");return{separable_conv0:u,separable_conv1:l,separable_conv2:c}}return{extractConvParams:n,extractSeparableConvParams:r,extractReductionBlockParams:o,extractMainBlockParams:i}}function Jz(t,e){var n=[],r=Po(t),o=r.extractWeights,i=r.getRemainingWeights,a=Qz(o,n),s=a.extractConvParams,u=a.extractSeparableConvParams,l=a.extractReductionBlockParams,c=a.extractMainBlockParams,d=s(3,32,3,"entry_flow/conv_in"),f=l(32,64,"entry_flow/reduction_block_0"),h=l(64,128,"entry_flow/reduction_block_1"),v={conv_in:d,reduction_block_0:f,reduction_block_1:h},p={};Pl(e,0,1).forEach(function(w){p["main_block_"+w]=c(128,"middle_flow/main_block_"+w)});var m=l(128,256,"exit_flow/reduction_block"),g=u(256,512,"exit_flow/separable_conv"),y={reduction_block:m,separable_conv:g};if(i().length!==0)throw new Error("weights remaing after extract: "+i().length);return{paramMappings:n,params:{entry_flow:v,middle_flow:p,exit_flow:y}}}function Zz(t,e){var n=$i(t,e),r=Tk(n),o=Xy(n);function i(s){var u=o(s+"/separable_conv0"),l=o(s+"/separable_conv1"),c=r(s+"/expansion_conv");return{separable_conv0:u,separable_conv1:l,expansion_conv:c}}function a(s){var u=o(s+"/separable_conv0"),l=o(s+"/separable_conv1"),c=o(s+"/separable_conv2");return{separable_conv0:u,separable_conv1:l,separable_conv2:c}}return{extractConvParams:r,extractSeparableConvParams:o,extractReductionBlockParams:i,extractMainBlockParams:a}}function e5(t,e){var n=[],r=Zz(t,n),o=r.extractConvParams,i=r.extractSeparableConvParams,a=r.extractReductionBlockParams,s=r.extractMainBlockParams,u=o("entry_flow/conv_in"),l=a("entry_flow/reduction_block_0"),c=a("entry_flow/reduction_block_1"),d={conv_in:u,reduction_block_0:l,reduction_block_1:c},f={};Pl(e,0,1).forEach(function(m){f["main_block_"+m]=s("middle_flow/main_block_"+m)});var h=a("exit_flow/reduction_block"),v=i("exit_flow/separable_conv"),p={reduction_block:h,separable_conv:v};return Ao(t,n),{params:{entry_flow:d,middle_flow:f,exit_flow:p},paramMappings:n}}function Ok(t,e,n){return ke(Zn(t,e.filters,n,"same"),e.bias)}function $p(t,e,n){n===void 0&&(n=!0);var r=n?rt(t):t;return r=Dn(r,e.separable_conv0,[1,1]),r=Dn(rt(r),e.separable_conv1,[1,1]),r=Rt(r,[3,3],[2,2],"same"),r=ke(r,Ok(t,e.expansion_conv,[2,2])),r}function t5(t,e){var n=Dn(rt(t),e.separable_conv0,[1,1]);return n=Dn(rt(n),e.separable_conv1,[1,1]),n=Dn(rt(n),e.separable_conv2,[1,1]),n=ke(n,t),n}var n5=function(t){ve(e,t);function e(n){var r=t.call(this,"TinyXception")||this;return r._numMainBlocks=n,r}return e.prototype.forwardInput=function(n){var r=this,o=this.params;if(!o)throw new Error("TinyXception - load model before inference");return ne(function(){var i=n.toBatchTensor(112,!0),a=[122.782,117.001,104.298],s=rc(i,a).div(ee(256)),u=rt(Ok(s,o.entry_flow.conv_in,[2,2]));return u=$p(u,o.entry_flow.reduction_block_0,!1),u=$p(u,o.entry_flow.reduction_block_1),Pl(r._numMainBlocks,0,1).forEach(function(l){u=t5(u,o.middle_flow["main_block_"+l])}),u=$p(u,o.exit_flow.reduction_block),u=rt(Dn(u,o.exit_flow.separable_conv,[1,1])),u})},e.prototype.forward=function(n){return ce(this,void 0,void 0,function(){var r;return de(this,function(o){switch(o.label){case 0:return r=this.forwardInput,[4,Dt(n)];case 1:return[2,r.apply(this,[o.sent()])]}})})},e.prototype.getDefaultModelName=function(){return"tiny_xception_model"},e.prototype.extractParamsFromWeigthMap=function(n){return e5(n,this._numMainBlocks)},e.prototype.extractParams=function(n){return Jz(n,this._numMainBlocks)},e}(Io);function r5(t){var e=[],n=Po(t),r=n.extractWeights,o=n.getRemainingWeights,i=qy(r,e),a=i(512,1,"fc/age"),s=i(512,2,"fc/gender");if(o().length!==0)throw new Error("weights remaing after extract: "+o().length);return{paramMappings:e,params:{fc:{age:a,gender:s}}}}function o5(t){var e=[],n=$i(t,e);function r(i){var a=n(i+"/weights",2),s=n(i+"/bias",1);return{weights:a,bias:s}}var o={fc:{age:r("fc/age"),gender:r("fc/gender")}};return Ao(t,e),{params:o,paramMappings:e}}var wf;(function(t){t.FEMALE="female",t.MALE="male"})(wf||(wf={}));var i5=function(t){ve(e,t);function e(n){n===void 0&&(n=new n5(2));var r=t.call(this,"AgeGenderNet")||this;return r._faceFeatureExtractor=n,r}return Object.defineProperty(e.prototype,"faceFeatureExtractor",{get:function(){return this._faceFeatureExtractor},enumerable:!0,configurable:!0}),e.prototype.runNet=function(n){var r=this,o=this.params;if(!o)throw new Error(this._name+" - load model before inference");return ne(function(){var i=n instanceof yf?r.faceFeatureExtractor.forwardInput(n):n,a=tc(i,[7,7],[2,2],"valid").as2D(i.shape[0],-1),s=Wr(a,o.fc.age).as1D(),u=Wr(a,o.fc.gender);return{age:s,gender:u}})},e.prototype.forwardInput=function(n){var r=this;return ne(function(){var o=r.runNet(n),i=o.age,a=o.gender;return{age:i,gender:Ro(a)}})},e.prototype.forward=function(n){return ce(this,void 0,void 0,function(){var r;return de(this,function(o){switch(o.label){case 0:return r=this.forwardInput,[4,Dt(n)];case 1:return[2,r.apply(this,[o.sent()])]}})})},e.prototype.predictAgeAndGender=function(n){return ce(this,void 0,void 0,function(){var r,o,i,a,s,u,l=this;return de(this,function(c){switch(c.label){case 0:return[4,Dt(n)];case 1:return r=c.sent(),[4,this.forwardInput(r)];case 2:return o=c.sent(),i=Et(o.age),a=Et(o.gender),s=i.map(function(d,f){return{ageTensor:d,genderTensor:a[f]}}),[4,Promise.all(s.map(function(d){var f=d.ageTensor,h=d.genderTensor;return ce(l,void 0,void 0,function(){var v,p,m,g,y;return de(this,function(w){switch(w.label){case 0:return[4,f.data()];case 1:return v=w.sent()[0],[4,h.data()];case 2:return p=w.sent()[0],m=p>.5,g=m?wf.MALE:wf.FEMALE,y=m?p:1-p,f.dispose(),h.dispose(),[2,{age:v,gender:g,genderProbability:y}]}})})}))];case 3:return u=c.sent(),o.age.dispose(),o.gender.dispose(),[2,r.isBatchInput?u:u[0]]}})})},e.prototype.getDefaultModelName=function(){return"age_gender_model"},e.prototype.dispose=function(n){n===void 0&&(n=!0),this.faceFeatureExtractor.dispose(n),t.prototype.dispose.call(this,n)},e.prototype.loadClassifierParams=function(n){var r=this.extractClassifierParams(n),o=r.params,i=r.paramMappings;this._params=o,this._paramMappings=i},e.prototype.extractClassifierParams=function(n){return r5(n)},e.prototype.extractParamsFromWeigthMap=function(n){var r=Pk(n),o=r.featureExtractorMap,i=r.classifierMap;return this.faceFeatureExtractor.loadFromWeightMap(o),o5(i)},e.prototype.extractParams=function(n){var r=1539,o=n.slice(0,n.length-r),i=n.slice(n.length-r);return this.faceFeatureExtractor.extractWeights(o),this.extractClassifierParams(i)},e}(Io),Fk=function(t){ve(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}return e.prototype.postProcess=function(n,r,o){var i=o.map(function(s){var u=s.width,l=s.height,c=r/Math.max(l,u);return{width:u*c,height:l*c}}),a=i.length;return ne(function(){var s=function(f,h){return Fn([qr([68],f),qr([68],h)],1).as2D(1,136).as1D()},u=function(f,h){var v=i[f],p=v.width,m=v.height;return h(p,m)?Math.abs(p-m)/2:0},l=function(f){return u(f,function(h,v){return h<v})},c=function(f){return u(f,function(h,v){return v<h})},d=n.mul(qr([a,136],r)).sub(Fn(Array.from(Array(a),function(f,h){return s(l(h),c(h))}))).div(Fn(Array.from(Array(a),function(f,h){return s(i[h].width,i[h].height)})));return d})},e.prototype.forwardInput=function(n){var r=this;return ne(function(){var o=r.runNet(n);return r.postProcess(o,n.inputSize,n.inputDimensions.map(function(i){var a=i[0],s=i[1];return{height:a,width:s}}))})},e.prototype.forward=function(n){return ce(this,void 0,void 0,function(){var r;return de(this,function(o){switch(o.label){case 0:return r=this.forwardInput,[4,Dt(n)];case 1:return[2,r.apply(this,[o.sent()])]}})})},e.prototype.detectLandmarks=function(n){return ce(this,void 0,void 0,function(){var r,o,i,a=this;return de(this,function(s){switch(s.label){case 0:return[4,Dt(n)];case 1:return r=s.sent(),o=ne(function(){return Et(a.forwardInput(r))}),[4,Promise.all(o.map(function(u,l){return ce(a,void 0,void 0,function(){var c,d,f,h,v;return de(this,function(p){switch(p.label){case 0:return f=(d=Array).from,[4,u.data()];case 1:return c=f.apply(d,[p.sent()]),h=c.filter(function(m,g){return Ax(g)}),v=c.filter(function(m,g){return!Ax(g)}),[2,new Oz(Array(68).fill(0).map(function(m,g){return new Fe(h[g],v[g])}),{height:r.getInputHeight(l),width:r.getInputWidth(l)})]}})})}))];case 2:return i=s.sent(),o.forEach(function(u){return u.dispose()}),[2,r.isBatchInput?i:i[0]]}})})},e.prototype.getClassifierChannelsOut=function(){return 136},e}(Dk),Mk=function(t){ve(e,t);function e(n){return n===void 0&&(n=new Ak),t.call(this,"FaceLandmark68Net",n)||this}return e.prototype.getDefaultModelName=function(){return"face_landmark_68_model"},e.prototype.getClassifierChannelsIn=function(){return 256},e}(Fk);function a5(t){var e=[],n=Ik(t,e).extractDenseBlock3Params,r={dense0:n("dense0",!0),dense1:n("dense1"),dense2:n("dense2")};return Ao(t,e),{params:r,paramMappings:e}}function s5(t){var e=[],n=Po(t),r=n.extractWeights,o=n.getRemainingWeights,i=Rk(r,e).extractDenseBlock3Params,a=i(3,32,"dense0",!0),s=i(32,64,"dense1"),u=i(64,128,"dense2");if(o().length!==0)throw new Error("weights remaing after extract: "+o().length);return{paramMappings:e,params:{dense0:a,dense1:s,dense2:u}}}var u5=function(t){ve(e,t);function e(){return t.call(this,"TinyFaceFeatureExtractor")||this}return e.prototype.forwardInput=function(n){var r=this.params;if(!r)throw new Error("TinyFaceFeatureExtractor - load model before inference");return ne(function(){var o=n.toBatchTensor(112,!0),i=[122.782,117.001,104.298],a=rc(o,i).div(ee(255)),s=Bp(a,r.dense0,!0);return s=Bp(s,r.dense1),s=Bp(s,r.dense2),s=tc(s,[14,14],[2,2],"valid"),s})},e.prototype.forward=function(n){return ce(this,void 0,void 0,function(){var r;return de(this,function(o){switch(o.label){case 0:return r=this.forwardInput,[4,Dt(n)];case 1:return[2,r.apply(this,[o.sent()])]}})})},e.prototype.getDefaultModelName=function(){return"face_feature_extractor_tiny_model"},e.prototype.extractParamsFromWeigthMap=function(n){return a5(n)},e.prototype.extractParams=function(n){return s5(n)},e}(Io),l5=function(t){ve(e,t);function e(n){return n===void 0&&(n=new u5),t.call(this,"FaceLandmark68TinyNet",n)||this}return e.prototype.getDefaultModelName=function(){return"face_landmark_68_tiny_model"},e.prototype.getClassifierChannelsIn=function(){return 128},e}(Fk);(function(t){ve(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}return e})(Mk);function c5(t,e){return ke(Yt(t,e.weights),e.biases)}function Qy(t,e,n,r,o){o===void 0&&(o="same");var i=e.conv,a=i.filters,s=i.bias,u=Zn(t,a,n,o);return u=ke(u,s),u=c5(u,e.scale),r?rt(u):u}function d5(t,e){return Qy(t,e,[1,1],!0)}function Lk(t,e){return Qy(t,e,[1,1],!1)}function Bk(t,e){return Qy(t,e,[2,2],!0,"valid")}function f5(t,e){function n(s,u,l){var c=t(s),d=c.length/(u*l*l);if(Cz(d))throw new Error("depth has to be an integer: "+d+", weights.length: "+c.length+", numFilters: "+u+", filterSize: "+l);return ne(function(){return Ii(vn(c,[u,d,l,l]),[2,3,1,0])})}function r(s,u,l,c){var d=n(s,u,l),f=pt(t(u));return e.push({paramPath:c+"/filters"},{paramPath:c+"/bias"}),{filters:d,bias:f}}function o(s,u){var l=pt(t(s)),c=pt(t(s));return e.push({paramPath:u+"/weights"},{paramPath:u+"/biases"}),{weights:l,biases:c}}function i(s,u,l,c){var d=r(s,u,l,c+"/conv"),f=o(u,c+"/scale");return{conv:d,scale:f}}function a(s,u,l,c,d){d===void 0&&(d=!1);var f=i((d?.5:1)*s,u,l,c+"/conv1"),h=i(s,u,l,c+"/conv2");return{conv1:f,conv2:h}}return{extractConvLayerParams:i,extractResidualLayerParams:a}}function h5(t){var e=Po(t),n=e.extractWeights,r=e.getRemainingWeights,o=[],i=f5(n,o),a=i.extractConvLayerParams,s=i.extractResidualLayerParams,u=a(4704,32,7,"conv32_down"),l=s(9216,32,3,"conv32_1"),c=s(9216,32,3,"conv32_2"),d=s(9216,32,3,"conv32_3"),f=s(36864,64,3,"conv64_down",!0),h=s(36864,64,3,"conv64_1"),v=s(36864,64,3,"conv64_2"),p=s(36864,64,3,"conv64_3"),m=s(147456,128,3,"conv128_down",!0),g=s(147456,128,3,"conv128_1"),y=s(147456,128,3,"conv128_2"),w=s(589824,256,3,"conv256_down",!0),x=s(589824,256,3,"conv256_1"),b=s(589824,256,3,"conv256_2"),_=s(589824,256,3,"conv256_down_out"),E=ne(function(){return Ii(_i(n(256*128),[128,256]),[1,0])});if(o.push({paramPath:"fc"}),r().length!==0)throw new Error("weights remaing after extract: "+r().length);var C={conv32_down:u,conv32_1:l,conv32_2:c,conv32_3:d,conv64_down:f,conv64_1:h,conv64_2:v,conv64_3:p,conv128_down:m,conv128_1:g,conv128_2:y,conv256_down:w,conv256_1:x,conv256_2:b,conv256_down_out:_,fc:E};return{params:C,paramMappings:o}}function p5(t,e){var n=$i(t,e);function r(a){var s=n(a+"/scale/weights",1),u=n(a+"/scale/biases",1);return{weights:s,biases:u}}function o(a){var s=n(a+"/conv/filters",4),u=n(a+"/conv/bias",1),l=r(a);return{conv:{filters:s,bias:u},scale:l}}function i(a){return{conv1:o(a+"/conv1"),conv2:o(a+"/conv2")}}return{extractConvLayerParams:o,extractResidualLayerParams:i}}function v5(t){var e=[],n=p5(t,e),r=n.extractConvLayerParams,o=n.extractResidualLayerParams,i=r("conv32_down"),a=o("conv32_1"),s=o("conv32_2"),u=o("conv32_3"),l=o("conv64_down"),c=o("conv64_1"),d=o("conv64_2"),f=o("conv64_3"),h=o("conv128_down"),v=o("conv128_1"),p=o("conv128_2"),m=o("conv256_down"),g=o("conv256_1"),y=o("conv256_2"),w=o("conv256_down_out"),x=t.fc;if(e.push({originalPath:"fc",paramPath:"fc"}),!Ez(x))throw new Error("expected weightMap[fc] to be a Tensor2D, instead have "+x);var b={conv32_down:i,conv32_1:a,conv32_2:s,conv32_3:u,conv64_down:l,conv64_1:c,conv64_2:d,conv64_3:f,conv128_down:h,conv128_1:v,conv128_2:p,conv256_down:m,conv256_1:g,conv256_2:y,conv256_down_out:w,fc:x};return Ao(t,e),{params:b,paramMappings:e}}function Tr(t,e){var n=d5(t,e.conv1);return n=Lk(n,e.conv2),n=ke(n,t),n=rt(n),n}function Yc(t,e){var n=Bk(t,e.conv1);n=Lk(n,e.conv2);var r=tc(t,2,2,"valid"),o=Ye(r.shape),i=r.shape[3]!==n.shape[3],a=r.shape[1]!==n.shape[1]||r.shape[2]!==n.shape[2];if(a){var s=tl(n.shape);s[1]=1;var u=Ye(s);n=_t([n,u],1);var l=tl(n.shape);l[2]=1;var c=Ye(l);n=_t([n,c],2)}return r=i?_t([r,o],3):r,n=ke(r,n),n=rt(n),n}var m5=function(t){ve(e,t);function e(){return t.call(this,"FaceRecognitionNet")||this}return e.prototype.forwardInput=function(n){var r=this.params;if(!r)throw new Error("FaceRecognitionNet - load model before inference");return ne(function(){var o=n.toBatchTensor(150,!0).toFloat(),i=[122.782,117.001,104.298],a=rc(o,i).div(ee(256)),s=Bk(a,r.conv32_down);s=Rt(s,3,2,"valid"),s=Tr(s,r.conv32_1),s=Tr(s,r.conv32_2),s=Tr(s,r.conv32_3),s=Yc(s,r.conv64_down),s=Tr(s,r.conv64_1),s=Tr(s,r.conv64_2),s=Tr(s,r.conv64_3),s=Yc(s,r.conv128_down),s=Tr(s,r.conv128_1),s=Tr(s,r.conv128_2),s=Yc(s,r.conv256_down),s=Tr(s,r.conv256_1),s=Tr(s,r.conv256_2),s=Yc(s,r.conv256_down_out);var u=s.mean([1,2]),l=sh(u,r.fc);return l})},e.prototype.forward=function(n){return ce(this,void 0,void 0,function(){var r;return de(this,function(o){switch(o.label){case 0:return r=this.forwardInput,[4,Dt(n)];case 1:return[2,r.apply(this,[o.sent()])]}})})},e.prototype.computeFaceDescriptor=function(n){return ce(this,void 0,void 0,function(){var r,o,i,a=this;return de(this,function(s){switch(s.label){case 0:return[4,Dt(n)];case 1:return r=s.sent(),o=ne(function(){return Et(a.forwardInput(r))}),[4,Promise.all(o.map(function(u){return u.data()}))];case 2:return i=s.sent(),o.forEach(function(u){return u.dispose()}),[2,r.isBatchInput?i:i[0]]}})})},e.prototype.getDefaultModelName=function(){return"face_recognition_model"},e.prototype.extractParamsFromWeigthMap=function(n){return v5(n)},e.prototype.extractParams=function(n){return h5(n)},e}(Io);function $k(t,e){var n={descriptor:e};return Object.assign({},t,n)}function jk(t,e){var n={age:e};return Object.assign({},t,n)}function Wk(t,e,n){var r={gender:e,genderProbability:n};return Object.assign({},t,r)}var Uk=function(){function t(e){var n=e===void 0?{}:e,r=n.minFaceSize,o=n.scaleFactor,i=n.maxNumScales,a=n.scoreThresholds,s=n.scaleSteps;if(this._name="MtcnnOptions",this._minFaceSize=r||20,this._scaleFactor=o||.709,this._maxNumScales=i||10,this._scoreThresholds=a||[.6,.7,.7],this._scaleSteps=s,typeof this._minFaceSize!="number"||this._minFaceSize<0)throw new Error(this._name+" - expected minFaceSize to be a number > 0");if(typeof this._scaleFactor!="number"||this._scaleFactor<=0||this._scaleFactor>=1)throw new Error(this._name+" - expected scaleFactor to be a number between 0 and 1");if(typeof this._maxNumScales!="number"||this._maxNumScales<0)throw new Error(this._name+" - expected maxNumScales to be a number > 0");if(!Array.isArray(this._scoreThresholds)||this._scoreThresholds.length!==3||this._scoreThresholds.some(function(u){return typeof u!="number"}))throw new Error(this._name+" - expected scoreThresholds to be an array of numbers of length 3");if(this._scaleSteps&&(!Array.isArray(this._scaleSteps)||this._scaleSteps.some(function(u){return typeof u!="number"})))throw new Error(this._name+" - expected scaleSteps to be an array of numbers")}return Object.defineProperty(t.prototype,"minFaceSize",{get:function(){return this._minFaceSize},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"scaleFactor",{get:function(){return this._scaleFactor},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"maxNumScales",{get:function(){return this._maxNumScales},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"scoreThresholds",{get:function(){return this._scoreThresholds},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"scaleSteps",{get:function(){return this._scaleSteps},enumerable:!0,configurable:!0}),t}();function g5(t,e){function n(u,l){var c=vn(t(9*u),[3,3,u,1]),d=pt(t(u)),f=pt(t(u)),h=pt(t(u)),v=pt(t(u));return e.push({paramPath:l+"/filters"},{paramPath:l+"/batch_norm_scale"},{paramPath:l+"/batch_norm_offset"},{paramPath:l+"/batch_norm_mean"},{paramPath:l+"/batch_norm_variance"}),{filters:c,batch_norm_scale:d,batch_norm_offset:f,batch_norm_mean:h,batch_norm_variance:v}}function r(u,l,c,d,f){var h=vn(t(u*l*c*c),[c,c,u,l]),v=pt(t(l));return e.push({paramPath:d+"/filters"},{paramPath:d+"/"+(f?"batch_norm_offset":"bias")}),{filters:h,bias:v}}function o(u,l,c,d){var f=r(u,l,c,d,!0),h=f.filters,v=f.bias;return{filters:h,batch_norm_offset:v}}function i(u,l,c){var d=n(u,c+"/depthwise_conv"),f=o(u,l,1,c+"/pointwise_conv");return{depthwise_conv:d,pointwise_conv:f}}function a(){var u=o(3,32,3,"mobilenetv1/conv_0"),l=i(32,64,"mobilenetv1/conv_1"),c=i(64,128,"mobilenetv1/conv_2"),d=i(128,128,"mobilenetv1/conv_3"),f=i(128,256,"mobilenetv1/conv_4"),h=i(256,256,"mobilenetv1/conv_5"),v=i(256,512,"mobilenetv1/conv_6"),p=i(512,512,"mobilenetv1/conv_7"),m=i(512,512,"mobilenetv1/conv_8"),g=i(512,512,"mobilenetv1/conv_9"),y=i(512,512,"mobilenetv1/conv_10"),w=i(512,512,"mobilenetv1/conv_11"),x=i(512,1024,"mobilenetv1/conv_12"),b=i(1024,1024,"mobilenetv1/conv_13");return{conv_0:u,conv_1:l,conv_2:c,conv_3:d,conv_4:f,conv_5:h,conv_6:v,conv_7:p,conv_8:m,conv_9:g,conv_10:y,conv_11:w,conv_12:x,conv_13:b}}function s(){var u=o(1024,256,1,"prediction_layer/conv_0"),l=o(256,512,3,"prediction_layer/conv_1"),c=o(512,128,1,"prediction_layer/conv_2"),d=o(128,256,3,"prediction_layer/conv_3"),f=o(256,128,1,"prediction_layer/conv_4"),h=o(128,256,3,"prediction_layer/conv_5"),v=o(256,64,1,"prediction_layer/conv_6"),p=o(64,128,3,"prediction_layer/conv_7"),m=r(512,12,1,"prediction_layer/box_predictor_0/box_encoding_predictor"),g=r(512,9,1,"prediction_layer/box_predictor_0/class_predictor"),y=r(1024,24,1,"prediction_layer/box_predictor_1/box_encoding_predictor"),w=r(1024,18,1,"prediction_layer/box_predictor_1/class_predictor"),x=r(512,24,1,"prediction_layer/box_predictor_2/box_encoding_predictor"),b=r(512,18,1,"prediction_layer/box_predictor_2/class_predictor"),_=r(256,24,1,"prediction_layer/box_predictor_3/box_encoding_predictor"),E=r(256,18,1,"prediction_layer/box_predictor_3/class_predictor"),C=r(256,24,1,"prediction_layer/box_predictor_4/box_encoding_predictor"),R=r(256,18,1,"prediction_layer/box_predictor_4/class_predictor"),S=r(128,24,1,"prediction_layer/box_predictor_5/box_encoding_predictor"),P=r(128,18,1,"prediction_layer/box_predictor_5/class_predictor"),A={box_encoding_predictor:m,class_predictor:g},B={box_encoding_predictor:y,class_predictor:w},M={box_encoding_predictor:x,class_predictor:b},j={box_encoding_predictor:_,class_predictor:E},W={box_encoding_predictor:C,class_predictor:R},U={box_encoding_predictor:S,class_predictor:P};return{conv_0:u,conv_1:l,conv_2:c,conv_3:d,conv_4:f,conv_5:h,conv_6:v,conv_7:p,box_predictor_0:A,box_predictor_1:B,box_predictor_2:M,box_predictor_3:j,box_predictor_4:W,box_predictor_5:U}}return{extractMobilenetV1Params:a,extractPredictionLayerParams:s}}function y5(t){var e=[],n=Po(t),r=n.extractWeights,o=n.getRemainingWeights,i=g5(r,e),a=i.extractMobilenetV1Params,s=i.extractPredictionLayerParams,u=a(),l=s(),c=hy(r(5118*4),[1,5118,4]),d={extra_dim:c};if(e.push({paramPath:"output_layer/extra_dim"}),o().length!==0)throw new Error("weights remaing after extract: "+o().length);return{params:{mobilenetv1:u,prediction_layer:l,output_layer:d},paramMappings:e}}function w5(t,e){var n=$i(t,e);function r(l,c,d){var f=n(l+"/Conv2d_"+c+"_pointwise/weights",4,d+"/filters"),h=n(l+"/Conv2d_"+c+"_pointwise/convolution_bn_offset",1,d+"/batch_norm_offset");return{filters:f,batch_norm_offset:h}}function o(l){var c="mobilenetv1/conv_"+l,d="MobilenetV1/Conv2d_"+l+"_depthwise",f=c+"/depthwise_conv",h=c+"/pointwise_conv",v=n(d+"/depthwise_weights",4,f+"/filters"),p=n(d+"/BatchNorm/gamma",1,f+"/batch_norm_scale"),m=n(d+"/BatchNorm/beta",1,f+"/batch_norm_offset"),g=n(d+"/BatchNorm/moving_mean",1,f+"/batch_norm_mean"),y=n(d+"/BatchNorm/moving_variance",1,f+"/batch_norm_variance");return{depthwise_conv:{filters:v,batch_norm_scale:p,batch_norm_offset:m,batch_norm_mean:g,batch_norm_variance:y},pointwise_conv:r("MobilenetV1",l,h)}}function i(){return{conv_0:r("MobilenetV1",0,"mobilenetv1/conv_0"),conv_1:o(1),conv_2:o(2),conv_3:o(3),conv_4:o(4),conv_5:o(5),conv_6:o(6),conv_7:o(7),conv_8:o(8),conv_9:o(9),conv_10:o(10),conv_11:o(11),conv_12:o(12),conv_13:o(13)}}function a(l,c){var d=n(l+"/weights",4,c+"/filters"),f=n(l+"/biases",1,c+"/bias");return{filters:d,bias:f}}function s(l){var c=a("Prediction/BoxPredictor_"+l+"/BoxEncodingPredictor","prediction_layer/box_predictor_"+l+"/box_encoding_predictor"),d=a("Prediction/BoxPredictor_"+l+"/ClassPredictor","prediction_layer/box_predictor_"+l+"/class_predictor");return{box_encoding_predictor:c,class_predictor:d}}function u(){return{conv_0:r("Prediction",0,"prediction_layer/conv_0"),conv_1:r("Prediction",1,"prediction_layer/conv_1"),conv_2:r("Prediction",2,"prediction_layer/conv_2"),conv_3:r("Prediction",3,"prediction_layer/conv_3"),conv_4:r("Prediction",4,"prediction_layer/conv_4"),conv_5:r("Prediction",5,"prediction_layer/conv_5"),conv_6:r("Prediction",6,"prediction_layer/conv_6"),conv_7:r("Prediction",7,"prediction_layer/conv_7"),box_predictor_0:s(0),box_predictor_1:s(1),box_predictor_2:s(2),box_predictor_3:s(3),box_predictor_4:s(4),box_predictor_5:s(5)}}return{extractMobilenetV1Params:i,extractPredictionLayerParams:u}}function x5(t){var e=[],n=w5(t,e),r=n.extractMobilenetV1Params,o=n.extractPredictionLayerParams,i=t["Output/extra_dim"];if(e.push({originalPath:"Output/extra_dim",paramPath:"output_layer/extra_dim"}),!dh(i))throw new Error("expected weightMap['Output/extra_dim'] to be a Tensor3D, instead have "+i);var a={mobilenetv1:r(),prediction_layer:o(),output_layer:{extra_dim:i}};return Ao(t,e),{params:a,paramMappings:e}}function Pr(t,e,n){return ne(function(){var r=Zn(t,e.filters,n,"same");return r=ke(r,e.batch_norm_offset),Cy(r,0,6)})}var b5=.0010000000474974513;function _5(t,e,n){return ne(function(){var r=ah(t,e.filters,n,"same");return r=MS(r,e.batch_norm_mean,e.batch_norm_variance,e.batch_norm_offset,e.batch_norm_scale,b5),Cy(r,0,6)})}function E5(t){return[2,4,6,12].some(function(e){return e===t})?[2,2]:[1,1]}function C5(t,e){return ne(function(){var n=null,r=Pr(t,e.conv_0,[2,2]),o=[e.conv_1,e.conv_2,e.conv_3,e.conv_4,e.conv_5,e.conv_6,e.conv_7,e.conv_8,e.conv_9,e.conv_10,e.conv_11,e.conv_12,e.conv_13];if(o.forEach(function(i,a){var s=a+1,u=E5(s);r=_5(r,i.depthwise_conv,u),r=Pr(r,i.pointwise_conv,[1,1]),s===11&&(n=r)}),n===null)throw new Error("mobileNetV1 - output of conv layer 11 is null");return{out:r,conv11:n}})}function S5(t,e,n,r,o){var i=t.shape[0],a=Math.min(n,i),s=e.map(function(c,d){return{score:c,boxIndex:d}}).filter(function(c){return c.score>o}).sort(function(c,d){return d.score-c.score}),u=function(c){return c<=r?1:0},l=[];return s.forEach(function(c){if(!(l.length>=a)){for(var d=c.score,f=l.length-1;f>=0;--f){var h=k5(t,c.boxIndex,l[f]);if(h!==0&&(c.score*=u(h),c.score<=o))break}d===c.score&&l.push(c.boxIndex)}}),l}function k5(t,e,n){var r=t.arraySync(),o=Math.min(r[e][0],r[e][2]),i=Math.min(r[e][1],r[e][3]),a=Math.max(r[e][0],r[e][2]),s=Math.max(r[e][1],r[e][3]),u=Math.min(r[n][0],r[n][2]),l=Math.min(r[n][1],r[n][3]),c=Math.max(r[n][0],r[n][2]),d=Math.max(r[n][1],r[n][3]),f=(a-o)*(s-i),h=(c-u)*(d-l);if(f<=0||h<=0)return 0;var v=Math.max(o,u),p=Math.max(i,l),m=Math.min(a,c),g=Math.min(s,d),y=Math.max(m-v,0)*Math.max(g-p,0);return y/(f+h-y)}function R5(t){var e=Et(Ii(t,[1,0])),n=[St(e[2],e[0]),St(e[3],e[1])],r=[ke(e[0],pr(n[0],ee(2))),ke(e[1],pr(n[1],ee(2)))];return{sizes:n,centers:r}}function T5(t,e){var n=R5(t),r=n.sizes,o=n.centers,i=Et(Ii(e,[1,0])),a=pr(Yt(Pm(pr(i[2],ee(5))),r[0]),ee(2)),s=ke(Yt(pr(i[0],ee(10)),r[0]),o[0]),u=pr(Yt(Pm(pr(i[3],ee(5))),r[1]),ee(2)),l=ke(Yt(pr(i[1],ee(10)),r[1]),o[1]);return Ii(Fn([St(s,a),St(l,u),ke(s,a),ke(l,u)]),[1,0])}function I5(t,e,n){return ne(function(){var r=t.shape[0],o=T5(vr(ks(n.extra_dim,[r,1,1]),[-1,4]),vr(t,[-1,4]));o=vr(o,[r,o.shape[0]/r,4]);var i=DS(Xr(e,[0,0,1],[-1,-1,-1])),a=Xr(i,[0,0,0],[-1,-1,1]);a=vr(a,[r,a.shape[1]]);var s=Et(o),u=Et(a);return{boxes:s,scores:u}})}function Qa(t,e){return ne(function(){var n=t.shape[0],r=vr(yr(t,e.box_encoding_predictor),[n,-1,1,4]),o=vr(yr(t,e.class_predictor),[n,-1,3]);return{boxPredictionEncoding:r,classPrediction:o}})}function A5(t,e,n){return ne(function(){var r=Pr(t,n.conv_0,[1,1]),o=Pr(r,n.conv_1,[2,2]),i=Pr(o,n.conv_2,[1,1]),a=Pr(i,n.conv_3,[2,2]),s=Pr(a,n.conv_4,[1,1]),u=Pr(s,n.conv_5,[2,2]),l=Pr(u,n.conv_6,[1,1]),c=Pr(l,n.conv_7,[2,2]),d=Qa(e,n.box_predictor_0),f=Qa(t,n.box_predictor_1),h=Qa(o,n.box_predictor_2),v=Qa(a,n.box_predictor_3),p=Qa(u,n.box_predictor_4),m=Qa(c,n.box_predictor_5),g=_t([d.boxPredictionEncoding,f.boxPredictionEncoding,h.boxPredictionEncoding,v.boxPredictionEncoding,p.boxPredictionEncoding,m.boxPredictionEncoding],1),y=_t([d.classPrediction,f.classPrediction,h.classPrediction,v.classPrediction,p.classPrediction,m.classPrediction],1);return{boxPredictions:g,classPredictions:y}})}var oc=function(){function t(e){var n=e===void 0?{}:e,r=n.minConfidence,o=n.maxResults;if(this._name="SsdMobilenetv1Options",this._minConfidence=r||.5,this._maxResults=o||100,typeof this._minConfidence!="number"||this._minConfidence<=0||this._minConfidence>=1)throw new Error(this._name+" - expected minConfidence to be a number between 0 and 1");if(typeof this._maxResults!="number")throw new Error(this._name+" - expected maxResults to be a number")}return Object.defineProperty(t.prototype,"minConfidence",{get:function(){return this._minConfidence},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"maxResults",{get:function(){return this._maxResults},enumerable:!0,configurable:!0}),t}(),zk=function(t){ve(e,t);function e(){return t.call(this,"SsdMobilenetv1")||this}return e.prototype.forwardInput=function(n){var r=this.params;if(!r)throw new Error("SsdMobilenetv1 - load model before inference");return ne(function(){var o=n.toBatchTensor(512,!1).toFloat(),i=St(Yt(o,ee(.007843137718737125)),ee(1)),a=C5(i,r.mobilenetv1),s=A5(a.out,a.conv11,r.prediction_layer),u=s.boxPredictions,l=s.classPredictions;return I5(u,l,r.output_layer)})},e.prototype.forward=function(n){return ce(this,void 0,void 0,function(){var r;return de(this,function(o){switch(o.label){case 0:return r=this.forwardInput,[4,Dt(n)];case 1:return[2,r.apply(this,[o.sent()])]}})})},e.prototype.locateFaces=function(n,r){return r===void 0&&(r={}),ce(this,void 0,void 0,function(){var o,i,a,s,u,l,c,d,f,h,v,p,m,g,y,w,x,b,_,E,C;return de(this,function(R){switch(R.label){case 0:return o=new oc(r),i=o.maxResults,a=o.minConfidence,[4,Dt(n)];case 1:for(s=R.sent(),u=this.forwardInput(s),l=u.boxes,c=u.scores,d=l[0],f=c[0],h=1;h<l.length;h++)l[h].dispose(),c[h].dispose();return m=(p=Array).from,[4,f.data()];case 2:return v=m.apply(p,[R.sent()]),g=.5,y=S5(d,v,i,g,a),w=s.getReshapedInputDimensions(0),x=s.inputSize,b=x/w.width,_=x/w.height,E=d.arraySync(),C=y.map(function(S){var P=[Math.max(0,E[S][0]),Math.min(1,E[S][2])].map(function(U){return U*_}),A=P[0],B=P[1],M=[Math.max(0,E[S][1]),Math.min(1,E[S][3])].map(function(U){return U*b}),j=M[0],W=M[1];return new eo(v[S],new Wy(j,A,W-j,B-A),{height:s.getInputHeight(0),width:s.getInputWidth(0)})}),d.dispose(),f.dispose(),[2,C]}})})},e.prototype.getDefaultModelName=function(){return"ssd_mobilenetv1_model"},e.prototype.extractParamsFromWeigthMap=function(n){return x5(n)},e.prototype.extractParams=function(n){return y5(n)},e}(Io);(function(t){ve(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}return e})(zk);var P5=.4,D5=[new Fe(.738768,.874946),new Fe(2.42204,2.65704),new Fe(4.30971,7.04493),new Fe(10.246,4.59428),new Fe(12.6868,11.8741)],N5=[new Fe(1.603231,2.094468),new Fe(6.041143,7.080126),new Fe(2.882459,3.518061),new Fe(4.266906,5.178857),new Fe(9.041765,10.66308)],O5=[117.001,114.697,97.404],F5="tiny_yolov2_model",M5="tiny_yolov2_separable_conv_model",Qc=function(t){return typeof t=="number"};function L5(t){if(!t)throw new Error("invalid config: "+t);if(typeof t.withSeparableConvs!="boolean")throw new Error("config.withSeparableConvs has to be a boolean, have: "+t.withSeparableConvs);if(!Qc(t.iouThreshold)||t.iouThreshold<0||t.iouThreshold>1)throw new Error("config.iouThreshold has to be a number between [0, 1], have: "+t.iouThreshold);if(!Array.isArray(t.classes)||!t.classes.length||!t.classes.every(function(e){return typeof e=="string"}))throw new Error("config.classes has to be an array class names: string[], have: "+JSON.stringify(t.classes));if(!Array.isArray(t.anchors)||!t.anchors.length||!t.anchors.map(function(e){return e||{}}).every(function(e){return Qc(e.x)&&Qc(e.y)}))throw new Error("config.anchors has to be an array of { x: number, y: number }, have: "+JSON.stringify(t.anchors));if(t.meanRgb&&(!Array.isArray(t.meanRgb)||t.meanRgb.length!==3||!t.meanRgb.every(Qc)))throw new Error("config.meanRgb has to be an array of shape [number, number, number], have: "+JSON.stringify(t.meanRgb))}function Jy(t){return ne(function(){var e=Yt(t,ee(.10000000149011612));return ke(rt(St(t,e)),e)})}function Wo(t,e){return ne(function(){var n=Da(t,[[0,0],[1,1],[1,1],[0,0]]);return n=Zn(n,e.conv.filters,[1,1],"valid"),n=St(n,e.bn.sub),n=Yt(n,e.bn.truediv),n=ke(n,e.conv.bias),Jy(n)})}function Uo(t,e){return ne(function(){var n=Da(t,[[0,0],[1,1],[1,1],[0,0]]);return n=Ty(n,e.depthwise_filter,e.pointwise_filter,[1,1],"valid"),n=ke(n,e.bias),Jy(n)})}function B5(t,e){var n=ph(t,e);function r(a,s){var u=pt(t(a)),l=pt(t(a));return e.push({paramPath:s+"/sub"},{paramPath:s+"/truediv"}),{sub:u,truediv:l}}function o(a,s,u){var l=n(a,s,3,u+"/conv"),c=r(s,u+"/bn");return{conv:l,bn:c}}var i=Ky(t,e);return{extractConvParams:n,extractConvWithBatchNormParams:o,extractSeparableConvParams:i}}function $5(t,e,n,r){var o=Po(t),i=o.extractWeights,a=o.getRemainingWeights,s=[],u=B5(i,s),l=u.extractConvParams,c=u.extractConvWithBatchNormParams,d=u.extractSeparableConvParams,f;if(e.withSeparableConvs){var h=r[0],v=r[1],p=r[2],m=r[3],g=r[4],y=r[5],w=r[6],x=r[7],b=r[8],_=e.isFirstLayerConv2d?l(h,v,3,"conv0"):d(h,v,"conv0"),E=d(v,p,"conv1"),C=d(p,m,"conv2"),R=d(m,g,"conv3"),S=d(g,y,"conv4"),P=d(y,w,"conv5"),A=x?d(w,x,"conv6"):void 0,B=b?d(x,b,"conv7"):void 0,M=l(b||x||w,5*n,1,"conv8");f={conv0:_,conv1:E,conv2:C,conv3:R,conv4:S,conv5:P,conv6:A,conv7:B,conv8:M}}else{var h=r[0],v=r[1],p=r[2],m=r[3],g=r[4],y=r[5],w=r[6],x=r[7],b=r[8],_=c(h,v,"conv0"),E=c(v,p,"conv1"),C=c(p,m,"conv2"),R=c(m,g,"conv3"),S=c(g,y,"conv4"),P=c(y,w,"conv5"),A=c(w,x,"conv6"),B=c(x,b,"conv7"),M=l(b,5*n,1,"conv8");f={conv0:_,conv1:E,conv2:C,conv3:R,conv4:S,conv5:P,conv6:A,conv7:B,conv8:M}}if(a().length!==0)throw new Error("weights remaing after extract: "+a().length);return{params:f,paramMappings:s}}function j5(t,e){var n=$i(t,e);function r(s){var u=n(s+"/sub",1),l=n(s+"/truediv",1);return{sub:u,truediv:l}}function o(s){var u=n(s+"/filters",4),l=n(s+"/bias",1);return{filters:u,bias:l}}function i(s){var u=o(s+"/conv"),l=r(s+"/bn");return{conv:u,bn:l}}var a=Xy(n);return{extractConvParams:o,extractConvWithBatchNormParams:i,extractSeparableConvParams:a}}function W5(t,e){var n=[],r=j5(t,n),o=r.extractConvParams,i=r.extractConvWithBatchNormParams,a=r.extractSeparableConvParams,s;if(e.withSeparableConvs){var u=e.filterSizes&&e.filterSizes.length||9;s={conv0:e.isFirstLayerConv2d?o("conv0"):a("conv0"),conv1:a("conv1"),conv2:a("conv2"),conv3:a("conv3"),conv4:a("conv4"),conv5:a("conv5"),conv6:u>7?a("conv6"):void 0,conv7:u>8?a("conv7"):void 0,conv8:o("conv8")}}else s={conv0:i("conv0"),conv1:i("conv1"),conv2:i("conv2"),conv3:i("conv3"),conv4:i("conv4"),conv5:i("conv5"),conv6:i("conv6"),conv7:i("conv7"),conv8:o("conv8")};return Ao(t,n),{params:s,paramMappings:n}}var Bx;(function(t){t[t.XS=224]="XS",t[t.SM=320]="SM",t[t.MD=416]="MD",t[t.LG=608]="LG"})(Bx||(Bx={}));var Zy=function(){function t(e){var n=e===void 0?{}:e,r=n.inputSize,o=n.scoreThreshold;if(this._name="TinyYolov2Options",this._inputSize=r||416,this._scoreThreshold=o||.5,typeof this._inputSize!="number"||this._inputSize%32!==0)throw new Error(this._name+" - expected inputSize to be a number divisible by 32");if(typeof this._scoreThreshold!="number"||this._scoreThreshold<=0||this._scoreThreshold>=1)throw new Error(this._name+" - expected scoreThreshold to be a number between 0 and 1")}return Object.defineProperty(t.prototype,"inputSize",{get:function(){return this._inputSize},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"scoreThreshold",{get:function(){return this._scoreThreshold},enumerable:!0,configurable:!0}),t}(),Vk=function(t){ve(e,t);function e(n){var r=t.call(this,"TinyYolov2")||this;return L5(n),r._config=n,r}return Object.defineProperty(e.prototype,"config",{get:function(){return this._config},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"withClassScores",{get:function(){return this.config.withClassScores||this.config.classes.length>1},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"boxEncodingSize",{get:function(){return 5+(this.withClassScores?this.config.classes.length:0)},enumerable:!0,configurable:!0}),e.prototype.runTinyYolov2=function(n,r){var o=Wo(n,r.conv0);return o=Rt(o,[2,2],[2,2],"same"),o=Wo(o,r.conv1),o=Rt(o,[2,2],[2,2],"same"),o=Wo(o,r.conv2),o=Rt(o,[2,2],[2,2],"same"),o=Wo(o,r.conv3),o=Rt(o,[2,2],[2,2],"same"),o=Wo(o,r.conv4),o=Rt(o,[2,2],[2,2],"same"),o=Wo(o,r.conv5),o=Rt(o,[2,2],[1,1],"same"),o=Wo(o,r.conv6),o=Wo(o,r.conv7),yr(o,r.conv8,"valid",!1)},e.prototype.runMobilenet=function(n,r){var o=this.config.isFirstLayerConv2d?Jy(yr(n,r.conv0,"valid",!1)):Uo(n,r.conv0);return o=Rt(o,[2,2],[2,2],"same"),o=Uo(o,r.conv1),o=Rt(o,[2,2],[2,2],"same"),o=Uo(o,r.conv2),o=Rt(o,[2,2],[2,2],"same"),o=Uo(o,r.conv3),o=Rt(o,[2,2],[2,2],"same"),o=Uo(o,r.conv4),o=Rt(o,[2,2],[2,2],"same"),o=Uo(o,r.conv5),o=Rt(o,[2,2],[1,1],"same"),o=r.conv6?Uo(o,r.conv6):o,o=r.conv7?Uo(o,r.conv7):o,yr(o,r.conv8,"valid",!1)},e.prototype.forwardInput=function(n,r){var o=this,i=this.params;if(!i)throw new Error("TinyYolov2 - load model before inference");return ne(function(){var a=n.toBatchTensor(r,!1).toFloat();return a=o.config.meanRgb?rc(a,o.config.meanRgb):a,a=a.div(ee(256)),o.config.withSeparableConvs?o.runMobilenet(a,i):o.runTinyYolov2(a,i)})},e.prototype.forward=function(n,r){return ce(this,void 0,void 0,function(){var o;return de(this,function(i){switch(i.label){case 0:return o=this.forwardInput,[4,Dt(n)];case 1:return[4,o.apply(this,[i.sent(),r])];case 2:return[2,i.sent()]}})})},e.prototype.detect=function(n,r){return r===void 0&&(r={}),ce(this,void 0,void 0,function(){var o,i,a,s,u,l,c,d,f,h,v,p,m,g,y=this;return de(this,function(w){switch(w.label){case 0:return o=new Zy(r),i=o.inputSize,a=o.scoreThreshold,[4,Dt(n)];case 1:return s=w.sent(),[4,this.forwardInput(s,i)];case 2:return u=w.sent(),l=ne(function(){return Et(u)[0].expandDims()}),c={width:s.getInputWidth(0),height:s.getInputHeight(0)},[4,this.extractBoxes(l,s.getReshapedInputDimensions(0),a)];case 3:return d=w.sent(),u.dispose(),l.dispose(),f=d.map(function(x){return x.box}),h=d.map(function(x){return x.score}),v=d.map(function(x){return x.classScore}),p=d.map(function(x){return y.config.classes[x.label]}),m=Dl(f.map(function(x){return x.rescale(i)}),h,this.config.iouThreshold,!0),g=m.map(function(x){return new mk(h[x],v[x],p[x],f[x],c)}),[2,g]}})})},e.prototype.getDefaultModelName=function(){return""},e.prototype.extractParamsFromWeigthMap=function(n){return W5(n,this.config)},e.prototype.extractParams=function(n){var r=this.config.filterSizes||e.DEFAULT_FILTER_SIZES,o=r?r.length:void 0;if(o!==7&&o!==8&&o!==9)throw new Error("TinyYolov2 - expected 7 | 8 | 9 convolutional filters, but found "+o+" filterSizes in config");return $5(n,this.config,this.boxEncodingSize,r)},e.prototype.extractBoxes=function(n,r,o){return ce(this,void 0,void 0,function(){var i,a,s,u,l,c,d,f,h,v,p,m,g,y,w,x,b,_,E,C,R,S,P,A,B,M,j,W,U,D=this;return de(this,function(F){switch(F.label){case 0:return i=r.width,a=r.height,s=Math.max(i,a),u=s/i,l=s/a,c=n.shape[1],d=this.config.anchors.length,f=ne(function(){var $=n.reshape([c,c,d,D.boxEncodingSize]),q=$.slice([0,0,0,0],[c,c,d,4]),K=$.slice([0,0,0,4],[c,c,d,1]),Q=D.withClassScores?Ro($.slice([0,0,0,5],[c,c,d,D.config.classes.length]),3):ee(0);return[q,K,Q]}),h=f[0],v=f[1],p=f[2],m=[],[4,v.array()];case 1:return g=F.sent(),[4,h.array()];case 2:y=F.sent(),w=0,F.label=3;case 3:if(!(w<c))return[3,12];x=0,F.label=4;case 4:if(!(x<c))return[3,11];b=0,F.label=5;case 5:return b<d?(_=Lp(g[w][x][b][0]),!o||_>o?(E=(x+Lp(y[w][x][b][0]))/c*u,C=(w+Lp(y[w][x][b][1]))/c*l,R=Math.exp(y[w][x][b][2])*this.config.anchors[b].x/c*u,S=Math.exp(y[w][x][b][3])*this.config.anchors[b].y/c*l,P=E-R/2,A=C-S/2,B={row:w,col:x,anchor:b},this.withClassScores?[4,this.extractPredictedClass(p,B)]:[3,7]):[3,9]):[3,10];case 6:return U=F.sent(),[3,8];case 7:U={classScore:1,label:0},F.label=8;case 8:M=U,j=M.classScore,W=M.label,m.push(qt({box:new fh(P,A,P+R,A+S),score:_,classScore:_*j,label:W},B)),F.label=9;case 9:return b++,[3,5];case 10:return x++,[3,4];case 11:return w++,[3,3];case 12:return h.dispose(),v.dispose(),p.dispose(),[2,m]}})})},e.prototype.extractPredictedClass=function(n,r){return ce(this,void 0,void 0,function(){var o,i,a,s;return de(this,function(u){switch(u.label){case 0:return o=r.row,i=r.col,a=r.anchor,[4,n.array()];case 1:return s=u.sent(),[2,Array(this.config.classes.length).fill(0).map(function(l,c){return s[o][i][a][c]}).map(function(l,c){return{classScore:l,label:c}}).reduce(function(l,c){return l.classScore>c.classScore?l:c})]}})})},e.DEFAULT_FILTER_SIZES=[3,16,32,64,128,256,512,1024,1024],e}(Io),U5=function(t){ve(e,t);function e(n){n===void 0&&(n=!0);var r=this,o=Object.assign({},{withSeparableConvs:n,iouThreshold:P5,classes:["face"]},n?{anchors:N5,meanRgb:O5}:{anchors:D5,withClassScores:!0});return r=t.call(this,o)||this,r}return Object.defineProperty(e.prototype,"withSeparableConvs",{get:function(){return this.config.withSeparableConvs},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"anchors",{get:function(){return this.config.anchors},enumerable:!0,configurable:!0}),e.prototype.locateFaces=function(n,r){return ce(this,void 0,void 0,function(){var o;return de(this,function(i){switch(i.label){case 0:return[4,this.detect(n,r)];case 1:return o=i.sent(),[2,o.map(function(a){return new eo(a.score,a.relativeBox,{width:a.imageWidth,height:a.imageHeight})})]}})})},e.prototype.getDefaultModelName=function(){return this.withSeparableConvs?M5:F5},e.prototype.extractParamsFromWeigthMap=function(n){return t.prototype.extractParamsFromWeigthMap.call(this,n)},e}(Vk),z5=function(t){ve(e,t);function e(){var n=t!==null&&t.apply(this,arguments)||this;return n._name="TinyFaceDetectorOptions",n}return e}(Zy),ic=function(){function t(){}return t.prototype.then=function(e){return ce(this,void 0,void 0,function(){var n;return de(this,function(r){switch(r.label){case 0:return n=e,[4,this.run()];case 1:return[2,n.apply(void 0,[r.sent()])]}})})},t.prototype.run=function(){return ce(this,void 0,void 0,function(){return de(this,function(e){throw new Error("ComposableTask - run is not implemented")})})},t}();function vh(t,e,n,r,o){return o===void 0&&(o=function(i){var a=i.alignedRect;return a}),ce(this,void 0,void 0,function(){var i,a,s,u,l;return de(this,function(c){switch(c.label){case 0:return i=t.map(function(d){return Yz(d)?o(d):d.detection}),s=r,s?[3,5]:e instanceof nt?[4,Gy(e,i)]:[3,2];case 1:return u=c.sent(),[3,4];case 2:return[4,Hy(e,i)];case 3:u=c.sent(),c.label=4;case 4:s=u,c.label=5;case 5:return a=s,[4,n(a)];case 6:return l=c.sent(),a.forEach(function(d){return d instanceof nt&&d.dispose()}),[2,l]}})})}function e0(t,e,n,r,o){return ce(this,void 0,void 0,function(){var i=this;return de(this,function(a){return[2,vh([t],e,function(s){return ce(i,void 0,void 0,function(){return de(this,function(u){return[2,n(s[0])]})})},r,o)]})})}function V5(t){return ne(function(){return Fn(Et(t,3).reverse(),3)})}var Jc=2,xf=12;function H5(t,e){var n=ph(t,e),r=qy(t,e);function o(l,c){var d=pt(t(l));return e.push({paramPath:c}),d}function i(l,c,d){d===void 0&&(d=!1);var f=n(l[0],l[1],3,c+"/conv1"),h=o(l[1],c+"/prelu1_alpha"),v=n(l[1],l[2],3,c+"/conv2"),p=o(l[2],c+"/prelu2_alpha"),m=n(l[2],l[3],d?2:3,c+"/conv3"),g=o(l[3],c+"/prelu3_alpha");return{conv1:f,prelu1_alpha:h,conv2:v,prelu2_alpha:p,conv3:m,prelu3_alpha:g}}function a(){var l=i([3,10,16,32],"pnet"),c=n(32,2,1,"pnet/conv4_1"),d=n(32,4,1,"pnet/conv4_2");return qt(qt({},l),{conv4_1:c,conv4_2:d})}function s(){var l=i([3,28,48,64],"rnet",!0),c=r(576,128,"rnet/fc1"),d=o(128,"rnet/prelu4_alpha"),f=r(128,2,"rnet/fc2_1"),h=r(128,4,"rnet/fc2_2");return qt(qt({},l),{fc1:c,prelu4_alpha:d,fc2_1:f,fc2_2:h})}function u(){var l=i([3,32,64,64],"onet"),c=n(64,128,2,"onet/conv4"),d=o(128,"onet/prelu4_alpha"),f=r(1152,256,"onet/fc1"),h=o(256,"onet/prelu5_alpha"),v=r(256,2,"onet/fc2_1"),p=r(256,4,"onet/fc2_2"),m=r(256,10,"onet/fc2_3");return qt(qt({},l),{conv4:c,prelu4_alpha:d,fc1:f,prelu5_alpha:h,fc2_1:v,fc2_2:p,fc2_3:m})}return{extractPNetParams:a,extractRNetParams:s,extractONetParams:u}}function G5(t){var e=Po(t),n=e.extractWeights,r=e.getRemainingWeights,o=[],i=H5(n,o),a=i.extractPNetParams,s=i.extractRNetParams,u=i.extractONetParams,l=a(),c=s(),d=u();if(r().length!==0)throw new Error("weights remaing after extract: "+r().length);return{params:{pnet:l,rnet:c,onet:d},paramMappings:o}}function q5(t,e){var n=$i(t,e);function r(c){var d=n(c+"/weights",4,c+"/filters"),f=n(c+"/bias",1);return{filters:d,bias:f}}function o(c){var d=n(c+"/weights",2),f=n(c+"/bias",1);return{weights:d,bias:f}}function i(c){return n(c,1)}function a(c){var d=r(c+"/conv1"),f=i(c+"/prelu1_alpha"),h=r(c+"/conv2"),v=i(c+"/prelu2_alpha"),p=r(c+"/conv3"),m=i(c+"/prelu3_alpha");return{conv1:d,prelu1_alpha:f,conv2:h,prelu2_alpha:v,conv3:p,prelu3_alpha:m}}function s(){var c=a("pnet"),d=r("pnet/conv4_1"),f=r("pnet/conv4_2");return qt(qt({},c),{conv4_1:d,conv4_2:f})}function u(){var c=a("rnet"),d=o("rnet/fc1"),f=i("rnet/prelu4_alpha"),h=o("rnet/fc2_1"),v=o("rnet/fc2_2");return qt(qt({},c),{fc1:d,prelu4_alpha:f,fc2_1:h,fc2_2:v})}function l(){var c=a("onet"),d=r("onet/conv4"),f=i("onet/prelu4_alpha"),h=o("onet/fc1"),v=i("onet/prelu5_alpha"),p=o("onet/fc2_1"),m=o("onet/fc2_2"),g=o("onet/fc2_3");return qt(qt({},c),{conv4:d,prelu4_alpha:f,fc1:h,prelu5_alpha:v,fc2_1:p,fc2_2:m,fc2_3:g})}return{extractPNetParams:s,extractRNetParams:u,extractONetParams:l}}function K5(t){var e=[],n=q5(t,e),r=n.extractPNetParams,o=n.extractRNetParams,i=n.extractONetParams,a=r(),s=o(),u=i();return Ao(t,e),{params:{pnet:a,rnet:s,onet:u},paramMappings:e}}function $m(t,e){var n=e[0],r=e[1];return{height:Math.floor(n*t),width:Math.floor(r*t)}}function X5(t,e,n){for(var r=n[0],o=n[1],i=xf/t,a=[],s=Math.min(r,o)*i,u=0;s>=12;)a.push(i*Math.pow(e,u)),s=s*e,u+=1;return a}var t0=function(t){ve(e,t);function e(n,r,o,i){return t.call(this,{left:n,top:r,right:o,bottom:i},!0)||this}return e}(Ai);function Hk(t){return ne(function(){return Yt(St(t,ee(127.5)),ee(.0078125))})}function Ds(t,e){return ne(function(){return ke(rt(t),Yt(e,hf(rt(hf(t)))))})}function n0(t,e,n){return n===void 0&&(n=!1),ne(function(){var r=yr(t,e.conv1,"valid");return r=Ds(r,e.prelu1_alpha),r=Rt(r,n?[2,2]:[3,3],[2,2],"same"),r=yr(r,e.conv2,"valid"),r=Ds(r,e.prelu2_alpha),r=n?r:Rt(r,[3,3],[2,2],"valid"),r=yr(r,e.conv3,"valid"),r=Ds(r,e.prelu3_alpha),r})}function Y5(t,e){return ne(function(){var n=n0(t,e,!0),r=yr(n,e.conv4_1,"valid"),o=Vn(uh(r,3),3),i=Ro(St(r,o),3),a=yr(n,e.conv4_2,"valid");return{prob:i,regions:a}})}function Q5(t,e){return ne(function(){var n=$m(e,t.shape.slice(1)),r=n.height,o=n.width,i=Ny.resizeBilinear(t,[r,o]),a=Hk(i);return Ii(a,[0,2,1,3])})}function J5(t,e,n,r){for(var o=[],i=t.arraySync(),a=0;a<t.shape[0];a++)for(var s=0;s<t.shape[1];s++)i[a][s]>=r&&o.push(new Fe(s,a));var u=o.map(function(l){var c=new fh(Math.round((l.y*Jc+1)/n),Math.round((l.x*Jc+1)/n),Math.round((l.y*Jc+xf)/n),Math.round((l.x*Jc+xf)/n)),d=i[l.y][l.x],f=e.arraySync(),h=new t0(f[l.y][l.x][0],f[l.y][l.x][1],f[l.y][l.x][2],f[l.y][l.x][3]);return{cell:c,score:d,region:h}});return u}function Z5(t,e,n,r,o){o.stage1=[];var i=e.map(function(f){return ne(function(){var h={scale:f},v=Q5(t,f),p=Date.now(),m=Y5(v,r),g=m.prob,y=m.regions;h.pnet=Date.now()-p;var w=Et(Et(g,3)[1])[0],x=Et(y)[0];return{scoresTensor:w,regionsTensor:x,scale:f,statsForScale:h}})}),a=i.map(function(f){var h=f.scoresTensor,v=f.regionsTensor,p=f.scale,m=f.statsForScale,g=J5(h,v,p,n);if(h.dispose(),v.dispose(),!g.length)return o.stage1.push(m),[];var y=Date.now(),w=Dl(g.map(function(x){return x.cell}),g.map(function(x){return x.score}),.5);return m.nms=Date.now()-y,m.numBoxes=w.length,o.stage1.push(m),w.map(function(x){return g[x]})}),s=a.reduce(function(f,h){return f.concat(h)},[]),u=[],l=[];if(s.length>0){var c=Date.now(),d=Dl(s.map(function(f){return f.cell}),s.map(function(f){return f.score}),.7);o.stage1_nms=Date.now()-c,l=d.map(function(f){return s[f].score}),u=d.map(function(f){return s[f]}).map(function(f){var h=f.cell,v=f.region;return new fh(h.left+v.left*h.width,h.top+v.top*h.height,h.right+v.right*h.width,h.bottom+v.bottom*h.height).toSquare().round()})}return{boxes:u,scores:l}}function Gk(t,e,n){var r=n.width,o=n.height;return ce(this,void 0,void 0,function(){var i,a,s,u=this;return de(this,function(l){switch(l.label){case 0:return i=Sa(t),[4,Promise.all(e.map(function(c){return ce(u,void 0,void 0,function(){var d,f,h,v,p,m,g,y;return de(this,function(w){return d=c.padAtBorders(t.height,t.width),f=d.y,h=d.ey,v=d.x,p=d.ex,m=v-1,g=f-1,y=i.getImageData(m,g,p-m,h-g),[2,Jt.isNodejs()?Vy(y):createImageBitmap(y)]})})}))];case 1:return a=l.sent(),s=[],a.forEach(function(c){var d=hh({width:r,height:o}),f=Sa(d);f.drawImage(c,0,0,r,o);for(var h=f.getImageData(0,0,r,o).data,v=[],p=0;p<h.length;p+=4)v.push(h[p+2]),v.push(h[p+1]),v.push(h[p]);s.push(v)}),[2,s.map(function(c){var d=ne(function(){var f=Ii(vn(c,[1,r,o,3]),[0,2,1,3]).toFloat();return Hk(f)});return d})]}})})}function e6(t,e){return ne(function(){var n=n0(t,e),r=vr(n,[n.shape[0],e.fc1.weights.shape[0]]),o=Wr(r,e.fc1),i=Ds(o,e.prelu4_alpha),a=Wr(i,e.fc2_1),s=Vn(uh(a,1),1),u=Ro(St(a,s),1),l=Wr(i,e.fc2_2),c=Et(u,1)[1];return{scores:c,regions:l}})}function t6(t,e,n,r,o){return ce(this,void 0,void 0,function(){var i,a,s,u,l,c,d,f,h,v,p,m,g,y;return de(this,function(w){switch(w.label){case 0:return i=Date.now(),[4,Gk(t,e,{width:24,height:24})];case 1:return a=w.sent(),o.stage2_extractImagePatches=Date.now()-i,i=Date.now(),s=a.map(function(x){var b=e6(x,r);return x.dispose(),b}),o.stage2_rnet=Date.now()-i,u=s.length>1?_t(s.map(function(x){return x.scores})):s[0].scores,d=(c=Array).from,[4,u.data()];case 2:return l=d.apply(c,[w.sent()]),u.dispose(),f=l.map(function(x,b){return{score:x,idx:b}}).filter(function(x){return x.score>n}).map(function(x){var b=x.idx;return b}),h=f.map(function(x){return e[x]}),v=f.map(function(x){return l[x]}),p=[],m=[],h.length>0&&(i=Date.now(),g=Dl(h,v,.7),o.stage2_nms=Date.now()-i,y=g.map(function(x){var b=s[f[x]].regions.arraySync();return new t0(b[0][0],b[0][1],b[0][2],b[0][3])}),m=g.map(function(x){return v[x]}),p=g.map(function(x,b){return h[x].calibrate(y[b])})),s.forEach(function(x){x.regions.dispose(),x.scores.dispose()}),[2,{boxes:p,scores:m}]}})})}function n6(t,e){return ne(function(){var n=n0(t,e);n=Rt(n,[2,2],[2,2],"same"),n=yr(n,e.conv4,"valid"),n=Ds(n,e.prelu4_alpha);var r=vr(n,[n.shape[0],e.fc1.weights.shape[0]]),o=Wr(r,e.fc1),i=Ds(o,e.prelu5_alpha),a=Wr(i,e.fc2_1),s=Vn(uh(a,1),1),u=Ro(St(a,s),1),l=Wr(i,e.fc2_2),c=Wr(i,e.fc2_3),d=Et(u,1)[1];return{scores:d,regions:l,points:c}})}function r6(t,e,n,r,o){return ce(this,void 0,void 0,function(){var i,a,s,u,l,c,d,f,h,v,p,m,g,y,w;return de(this,function(x){switch(x.label){case 0:return i=Date.now(),[4,Gk(t,e,{width:48,height:48})];case 1:return a=x.sent(),o.stage3_extractImagePatches=Date.now()-i,i=Date.now(),s=a.map(function(b){var _=n6(b,r);return b.dispose(),_}),o.stage3_onet=Date.now()-i,u=s.length>1?_t(s.map(function(b){return b.scores})):s[0].scores,d=(c=Array).from,[4,u.data()];case 2:return l=d.apply(c,[x.sent()]),u.dispose(),f=l.map(function(b,_){return{score:b,idx:_}}).filter(function(b){return b.score>n}).map(function(b){var _=b.idx;return _}),h=f.map(function(b){var _=s[b].regions.arraySync();return new t0(_[0][0],_[0][1],_[0][2],_[0][3])}),v=f.map(function(b,_){return e[b].calibrate(h[_])}),p=f.map(function(b){return l[b]}),m=[],g=[],y=[],v.length>0&&(i=Date.now(),w=Dl(v,p,.7,!1),o.stage3_nms=Date.now()-i,m=w.map(function(b){return v[b]}),g=w.map(function(b){return p[b]}),y=w.map(function(b,_){return Array(5).fill(0).map(function(E,C){var R=s[b].points.arraySync();return new Fe(R[0][C]*(m[_].width+1)+m[_].left,R[0][C+5]*(m[_].height+1)+m[_].top)})})),s.forEach(function(b){b.regions.dispose(),b.scores.dispose(),b.points.dispose()}),[2,{boxes:m,scores:g,points:y}]}})})}var o6=function(t){ve(e,t);function e(){return t.call(this,"Mtcnn")||this}return e.prototype.load=function(n){return ce(this,void 0,void 0,function(){return de(this,function(r){return console.warn("mtcnn is deprecated and will be removed soon"),[2,t.prototype.load.call(this,n)]})})},e.prototype.loadFromDisk=function(n){return ce(this,void 0,void 0,function(){return de(this,function(r){return console.warn("mtcnn is deprecated and will be removed soon"),[2,t.prototype.loadFromDisk.call(this,n)]})})},e.prototype.forwardInput=function(n,r){return r===void 0&&(r={}),ce(this,void 0,void 0,function(){var o,i,a,s,u,l,c,d,f,h,v,p,m,g,y,w,x,b,_,E,C;return de(this,function(R){switch(R.label){case 0:if(o=this.params,!o)throw new Error("Mtcnn - load model before inference");if(i=n.canvases[0],!i)throw new Error("Mtcnn - inputCanvas is not defined, note that passing tensors into Mtcnn.forwardInput is not supported yet.");return a={},s=Date.now(),u=ne(function(){return V5(Vn($y.fromPixels(i)).toFloat())}),l=function(S){return u.dispose(),a.total=Date.now()-s,S},c=u.shape.slice(1),d=c[0],f=c[1],h=new Uk(r),v=h.minFaceSize,p=h.scaleFactor,m=h.maxNumScales,g=h.scoreThresholds,y=h.scaleSteps,w=(y||X5(v,p,[d,f])).filter(function(S){var P=$m(S,[d,f]);return Math.min(P.width,P.height)>xf}).slice(0,m),a.scales=w,a.pyramid=w.map(function(S){return $m(S,[d,f])}),x=Date.now(),[4,Z5(u,w,g[0],o.pnet,a)];case 1:return b=R.sent(),a.total_stage1=Date.now()-x,b.boxes.length?(a.stage2_numInputBoxes=b.boxes.length,x=Date.now(),[4,t6(i,b.boxes,g[1],o.rnet,a)]):[2,l({results:[],stats:a})];case 2:return _=R.sent(),a.total_stage2=Date.now()-x,_.boxes.length?(a.stage3_numInputBoxes=_.boxes.length,x=Date.now(),[4,r6(i,_.boxes,g[2],o.onet,a)]):[2,l({results:[],stats:a})];case 3:return E=R.sent(),a.total_stage3=Date.now()-x,C=E.boxes.map(function(S,P){return Yy(Uy({},new eo(E.scores[P],new Wy(S.left/f,S.top/d,S.width/f,S.height/d),{height:d,width:f})),new Nz(E.points[P].map(function(A){return A.sub(new Fe(S.left,S.top)).div(new Fe(S.width,S.height))}),{width:S.width,height:S.height}))}),[2,l({results:C,stats:a})]}})})},e.prototype.forward=function(n,r){return r===void 0&&(r={}),ce(this,void 0,void 0,function(){var o;return de(this,function(i){switch(i.label){case 0:return o=this.forwardInput,[4,Dt(n)];case 1:return[4,o.apply(this,[i.sent(),r])];case 2:return[2,i.sent().results]}})})},e.prototype.forwardWithStats=function(n,r){return r===void 0&&(r={}),ce(this,void 0,void 0,function(){var o;return de(this,function(i){switch(i.label){case 0:return o=this.forwardInput,[4,Dt(n)];case 1:return[2,o.apply(this,[i.sent(),r])]}})})},e.prototype.getDefaultModelName=function(){return"mtcnn_model"},e.prototype.extractParamsFromWeigthMap=function(n){return K5(n)},e.prototype.extractParams=function(n){return G5(n)},e}(Io),i6=.4,a6=[new Fe(1.603231,2.094468),new Fe(6.041143,7.080126),new Fe(2.882459,3.518061),new Fe(4.266906,5.178857),new Fe(9.041765,10.66308)],s6=[117.001,114.697,97.404],u6=function(t){ve(e,t);function e(){var n=this,r={withSeparableConvs:!0,iouThreshold:i6,classes:["face"],anchors:a6,meanRgb:s6,isFirstLayerConv2d:!0,filterSizes:[3,16,32,64,128,256,512]};return n=t.call(this,r)||this,n}return Object.defineProperty(e.prototype,"anchors",{get:function(){return this.config.anchors},enumerable:!0,configurable:!0}),e.prototype.locateFaces=function(n,r){return ce(this,void 0,void 0,function(){var o;return de(this,function(i){switch(i.label){case 0:return[4,this.detect(n,r)];case 1:return o=i.sent(),[2,o.map(function(a){return new eo(a.score,a.relativeBox,{width:a.imageWidth,height:a.imageHeight})})]}})})},e.prototype.getDefaultModelName=function(){return"tiny_face_detector_model"},e.prototype.extractParamsFromWeigthMap=function(n){return t.prototype.extractParamsFromWeigthMap.call(this,n)},e}(Vk),Kn={ssdMobilenetv1:new zk,tinyFaceDetector:new u6,tinyYolov2:new U5,mtcnn:new o6,faceLandmark68Net:new Mk,faceLandmark68TinyNet:new l5,faceRecognitionNet:new m5,faceExpressionNet:new Xz,ageGenderNet:new i5},qk=function(t){ve(e,t);function e(n,r,o){var i=t.call(this)||this;return i.parentTask=n,i.input=r,i.extractedFaces=o,i}return e}(ic),r0=function(t){ve(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}return e.prototype.run=function(){return ce(this,void 0,void 0,function(){var n,r,o=this;return de(this,function(i){switch(i.label){case 0:return[4,this.parentTask];case 1:return n=i.sent(),[4,vh(n,this.input,function(a){return ce(o,void 0,void 0,function(){return de(this,function(s){switch(s.label){case 0:return[4,Promise.all(a.map(function(u){return Kn.faceExpressionNet.predictExpressions(u)}))];case 1:return[2,s.sent()]}})})},this.extractedFaces)];case 2:return r=i.sent(),[2,n.map(function(a,s){return Nk(a,r[s])})]}})})},e.prototype.withAgeAndGender=function(){return new s0(this,this.input)},e}(qk),o0=function(t){ve(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}return e.prototype.run=function(){return ce(this,void 0,void 0,function(){var n,r;return de(this,function(o){switch(o.label){case 0:return[4,this.parentTask];case 1:return n=o.sent(),n?[4,e0(n,this.input,function(i){return Kn.faceExpressionNet.predictExpressions(i)},this.extractedFaces)]:[2];case 2:return r=o.sent(),[2,Nk(n,r)]}})})},e.prototype.withAgeAndGender=function(){return new u0(this,this.input)},e}(qk),i0=function(t){ve(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}return e.prototype.withAgeAndGender=function(){return new l0(this,this.input)},e.prototype.withFaceDescriptors=function(){return new d0(this,this.input)},e}(r0),a0=function(t){ve(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}return e.prototype.withAgeAndGender=function(){return new c0(this,this.input)},e.prototype.withFaceDescriptor=function(){return new f0(this,this.input)},e}(o0),Kk=function(t){ve(e,t);function e(n,r,o){var i=t.call(this)||this;return i.parentTask=n,i.input=r,i.extractedFaces=o,i}return e}(ic),s0=function(t){ve(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}return e.prototype.run=function(){return ce(this,void 0,void 0,function(){var n,r,o=this;return de(this,function(i){switch(i.label){case 0:return[4,this.parentTask];case 1:return n=i.sent(),[4,vh(n,this.input,function(a){return ce(o,void 0,void 0,function(){return de(this,function(s){switch(s.label){case 0:return[4,Promise.all(a.map(function(u){return Kn.ageGenderNet.predictAgeAndGender(u)}))];case 1:return[2,s.sent()]}})})},this.extractedFaces)];case 2:return r=i.sent(),[2,n.map(function(a,s){var u=r[s],l=u.age,c=u.gender,d=u.genderProbability;return jk(Wk(a,c,d),l)})]}})})},e.prototype.withFaceExpressions=function(){return new r0(this,this.input)},e}(Kk),u0=function(t){ve(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}return e.prototype.run=function(){return ce(this,void 0,void 0,function(){var n,r,o,i,a;return de(this,function(s){switch(s.label){case 0:return[4,this.parentTask];case 1:return n=s.sent(),n?[4,e0(n,this.input,function(u){return Kn.ageGenderNet.predictAgeAndGender(u)},this.extractedFaces)]:[2];case 2:return r=s.sent(),o=r.age,i=r.gender,a=r.genderProbability,[2,jk(Wk(n,i,a),o)]}})})},e.prototype.withFaceExpressions=function(){return new o0(this,this.input)},e}(Kk),l0=function(t){ve(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}return e.prototype.withFaceExpressions=function(){return new i0(this,this.input)},e.prototype.withFaceDescriptors=function(){return new d0(this,this.input)},e}(s0),c0=function(t){ve(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}return e.prototype.withFaceExpressions=function(){return new a0(this,this.input)},e.prototype.withFaceDescriptor=function(){return new f0(this,this.input)},e}(u0),Xk=function(t){ve(e,t);function e(n,r){var o=t.call(this)||this;return o.parentTask=n,o.input=r,o}return e}(ic),d0=function(t){ve(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}return e.prototype.run=function(){return ce(this,void 0,void 0,function(){var n,r;return de(this,function(o){switch(o.label){case 0:return[4,this.parentTask];case 1:return n=o.sent(),[4,vh(n,this.input,function(i){return Promise.all(i.map(function(a){return Kn.faceRecognitionNet.computeFaceDescriptor(a)}))},null,function(i){return i.landmarks.align(null,{useDlibAlignment:!0})})];case 2:return r=o.sent(),[2,r.map(function(i,a){return $k(n[a],i)})]}})})},e.prototype.withFaceExpressions=function(){return new i0(this,this.input)},e.prototype.withAgeAndGender=function(){return new l0(this,this.input)},e}(Xk),f0=function(t){ve(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}return e.prototype.run=function(){return ce(this,void 0,void 0,function(){var n,r;return de(this,function(o){switch(o.label){case 0:return[4,this.parentTask];case 1:return n=o.sent(),n?[4,e0(n,this.input,function(i){return Kn.faceRecognitionNet.computeFaceDescriptor(i)},null,function(i){return i.landmarks.align(null,{useDlibAlignment:!0})})]:[2];case 2:return r=o.sent(),[2,$k(n,r)]}})})},e.prototype.withFaceExpressions=function(){return new a0(this,this.input)},e.prototype.withAgeAndGender=function(){return new c0(this,this.input)},e}(Xk),Yk=function(t){ve(e,t);function e(n,r,o){var i=t.call(this)||this;return i.parentTask=n,i.input=r,i.useTinyLandmarkNet=o,i}return Object.defineProperty(e.prototype,"landmarkNet",{get:function(){return this.useTinyLandmarkNet?Kn.faceLandmark68TinyNet:Kn.faceLandmark68Net},enumerable:!0,configurable:!0}),e}(ic),l6=function(t){ve(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}return e.prototype.run=function(){return ce(this,void 0,void 0,function(){var n,r,o,i,a,s=this;return de(this,function(u){switch(u.label){case 0:return[4,this.parentTask];case 1:return n=u.sent(),r=n.map(function(l){return l.detection}),this.input instanceof nt?[4,Gy(this.input,r)]:[3,3];case 2:return i=u.sent(),[3,5];case 3:return[4,Hy(this.input,r)];case 4:i=u.sent(),u.label=5;case 5:return o=i,[4,Promise.all(o.map(function(l){return s.landmarkNet.detectLandmarks(l)}))];case 6:return a=u.sent(),o.forEach(function(l){return l instanceof nt&&l.dispose()}),[2,n.map(function(l,c){return Yy(l,a[c])})]}})})},e.prototype.withFaceExpressions=function(){return new i0(this,this.input)},e.prototype.withAgeAndGender=function(){return new l0(this,this.input)},e.prototype.withFaceDescriptors=function(){return new d0(this,this.input)},e}(Yk),c6=function(t){ve(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}return e.prototype.run=function(){return ce(this,void 0,void 0,function(){var n,r,o,i,a;return de(this,function(s){switch(s.label){case 0:return[4,this.parentTask];case 1:return n=s.sent(),n?(r=n.detection,this.input instanceof nt?[4,Gy(this.input,[r])]:[3,3]):[2];case 2:return i=s.sent(),[3,5];case 3:return[4,Hy(this.input,[r])];case 4:i=s.sent(),s.label=5;case 5:return o=i,[4,this.landmarkNet.detectLandmarks(o[0])];case 6:return a=s.sent(),o.forEach(function(u){return u instanceof nt&&u.dispose()}),[2,Yy(n,a)]}})})},e.prototype.withFaceExpressions=function(){return new a0(this,this.input)},e.prototype.withAgeAndGender=function(){return new c0(this,this.input)},e.prototype.withFaceDescriptor=function(){return new f0(this,this.input)},e}(Yk),Qk=function(t){ve(e,t);function e(n,r){r===void 0&&(r=new oc);var o=t.call(this)||this;return o.input=n,o.options=r,o}return e}(ic),Jk=function(t){ve(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}return e.prototype.run=function(){return ce(this,void 0,void 0,function(){var n,r,o,i;return de(this,function(a){switch(a.label){case 0:return n=this,r=n.input,o=n.options,o instanceof Uk?[4,Kn.mtcnn.forward(r,o)]:[3,2];case 1:return[2,a.sent().map(function(s){return s.detection})];case 2:if(i=o instanceof z5?function(s){return Kn.tinyFaceDetector.locateFaces(s,o)}:o instanceof oc?function(s){return Kn.ssdMobilenetv1.locateFaces(s,o)}:o instanceof Zy?function(s){return Kn.tinyYolov2.locateFaces(s,o)}:null,!i)throw new Error("detectFaces - expected options to be instance of TinyFaceDetectorOptions | SsdMobilenetv1Options | MtcnnOptions | TinyYolov2Options");return[2,i(r)]}})})},e.prototype.runAndExtendWithFaceDetections=function(){var n=this;return new Promise(function(r){return ce(n,void 0,void 0,function(){var o;return de(this,function(i){switch(i.label){case 0:return[4,this.run()];case 1:return o=i.sent(),[2,r(o.map(function(a){return Uy({},a)}))]}})})})},e.prototype.withFaceLandmarks=function(n){return n===void 0&&(n=!1),new l6(this.runAndExtendWithFaceDetections(),this.input,n)},e.prototype.withFaceExpressions=function(){return new r0(this.runAndExtendWithFaceDetections(),this.input)},e.prototype.withAgeAndGender=function(){return new s0(this.runAndExtendWithFaceDetections(),this.input)},e}(Qk),d6=function(t){ve(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}return e.prototype.run=function(){return ce(this,void 0,void 0,function(){var n,r;return de(this,function(o){switch(o.label){case 0:return[4,new Jk(this.input,this.options)];case 1:return n=o.sent(),r=n[0],n.forEach(function(i){i.score>r.score&&(r=i)}),[2,r]}})})},e.prototype.runAndExtendWithFaceDetection=function(){var n=this;return new Promise(function(r){return ce(n,void 0,void 0,function(){var o;return de(this,function(i){switch(i.label){case 0:return[4,this.run()];case 1:return o=i.sent(),[2,r(o?Uy({},o):void 0)]}})})})},e.prototype.withFaceLandmarks=function(n){return n===void 0&&(n=!1),new c6(this.runAndExtendWithFaceDetection(),this.input,n)},e.prototype.withFaceExpressions=function(){return new o0(this.runAndExtendWithFaceDetection(),this.input)},e.prototype.withAgeAndGender=function(){return new u0(this.runAndExtendWithFaceDetection(),this.input)},e}(Qk);function YV(t,e){return e===void 0&&(e=new oc),new d6(t,e)}function QV(t,e){return e===void 0&&(e=new oc),new Jk(t,e)}function f6(t,e){if(t.length!==e.length)throw new Error("euclideanDistance: arr1.length !== arr2.length");var n=Array.from(t),r=Array.from(e);return Math.sqrt(n.map(function(o,i){return o-r[i]}).reduce(function(o,i){return o+Math.pow(i,2)},0))}(function(){function t(e,n){n===void 0&&(n=.6),this._distanceThreshold=n;var r=Array.isArray(e)?e:[e];if(!r.length)throw new Error("FaceRecognizer.constructor - expected atleast one input");var o=1,i=function(){return"person "+o++};this._labeledDescriptors=r.map(function(a){if(a instanceof Kc)return a;if(a instanceof Float32Array)return new Kc(i(),[a]);if(a.descriptor&&a.descriptor instanceof Float32Array)return new Kc(i(),[a.descriptor]);throw new Error("FaceRecognizer.constructor - expected inputs to be of type LabeledFaceDescriptors | WithFaceDescriptor<any> | Float32Array | Array<LabeledFaceDescriptors | WithFaceDescriptor<any> | Float32Array>")})}return Object.defineProperty(t.prototype,"labeledDescriptors",{get:function(){return this._labeledDescriptors},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"distanceThreshold",{get:function(){return this._distanceThreshold},enumerable:!0,configurable:!0}),t.prototype.computeMeanDistance=function(e,n){return n.map(function(r){return f6(r,e)}).reduce(function(r,o){return r+o},0)/(n.length||1)},t.prototype.matchDescriptor=function(e){var n=this;return this.labeledDescriptors.map(function(r){var o=r.descriptors,i=r.label;return new Nx(i,n.computeMeanDistance(e,o))}).reduce(function(r,o){return r.distance<o.distance?r:o})},t.prototype.findBestMatch=function(e){var n=this.matchDescriptor(e);return n.distance<this.distanceThreshold?n:new Nx("unknown",n.distance)},t.prototype.toJSON=function(){return{distanceThreshold:this.distanceThreshold,labeledDescriptors:this.labeledDescriptors.map(function(e){return e.toJSON()})}},t.fromJSON=function(e){var n=e.labeledDescriptors.map(function(r){return Kc.fromJSON(r)});return new t(n,e.distanceThreshold)},t})();var Zk="AlertDialog",[h6,JV]=Oi(Zk,[yC]),Do=yC(),eR=t=>{const{__scopeAlertDialog:e,...n}=t,r=Do(e);return G.jsx(L4,{...r,...n,modal:!0})};eR.displayName=Zk;var p6="AlertDialogTrigger",tR=k.forwardRef((t,e)=>{const{__scopeAlertDialog:n,...r}=t,o=Do(n);return G.jsx(B4,{...o,...r,ref:e})});tR.displayName=p6;var v6="AlertDialogPortal",nR=t=>{const{__scopeAlertDialog:e,...n}=t,r=Do(e);return G.jsx($4,{...r,...n})};nR.displayName=v6;var m6="AlertDialogOverlay",rR=k.forwardRef((t,e)=>{const{__scopeAlertDialog:n,...r}=t,o=Do(n);return G.jsx(j4,{...o,...r,ref:e})});rR.displayName=m6;var Ns="AlertDialogContent",[g6,y6]=h6(Ns),w6=d_("AlertDialogContent"),oR=k.forwardRef((t,e)=>{const{__scopeAlertDialog:n,children:r,...o}=t,i=Do(n),a=k.useRef(null),s=Pt(e,a),u=k.useRef(null);return G.jsx(N4,{contentName:Ns,titleName:iR,docsSlug:"alert-dialog",children:G.jsx(g6,{scope:n,cancelRef:u,children:G.jsxs(W4,{role:"alertdialog",...i,...o,ref:s,onOpenAutoFocus:De(o.onOpenAutoFocus,l=>{var c;l.preventDefault(),(c=u.current)==null||c.focus({preventScroll:!0})}),onPointerDownOutside:l=>l.preventDefault(),onInteractOutside:l=>l.preventDefault(),children:[G.jsx(w6,{children:r}),G.jsx(b6,{contentRef:a})]})})})});oR.displayName=Ns;var iR="AlertDialogTitle",aR=k.forwardRef((t,e)=>{const{__scopeAlertDialog:n,...r}=t,o=Do(n);return G.jsx(U4,{...o,...r,ref:e})});aR.displayName=iR;var sR="AlertDialogDescription",uR=k.forwardRef((t,e)=>{const{__scopeAlertDialog:n,...r}=t,o=Do(n);return G.jsx(z4,{...o,...r,ref:e})});uR.displayName=sR;var x6="AlertDialogAction",lR=k.forwardRef((t,e)=>{const{__scopeAlertDialog:n,...r}=t,o=Do(n);return G.jsx(OC,{...o,...r,ref:e})});lR.displayName=x6;var cR="AlertDialogCancel",dR=k.forwardRef((t,e)=>{const{__scopeAlertDialog:n,...r}=t,{cancelRef:o}=y6(cR,n),i=Do(n),a=Pt(e,o);return G.jsx(OC,{...i,...r,ref:a})});dR.displayName=cR;var b6=({contentRef:t})=>{const e=`\`${Ns}\` requires a description for the component to be accessible for screen reader users.

You can add a description to the \`${Ns}\` by passing a \`${sR}\` component as a child, which also benefits sighted users by adding visible context to the dialog.

Alternatively, you can use your own component as a description by assigning it an \`id\` and passing the same value to the \`aria-describedby\` prop in \`${Ns}\`. If the description is confusing or duplicative for sighted users, you can use the \`@radix-ui/react-visually-hidden\` primitive as a wrapper around your description component.

For more information, see https://radix-ui.com/primitives/docs/components/alert-dialog`;return k.useEffect(()=>{var r;document.getElementById((r=t.current)==null?void 0:r.getAttribute("aria-describedby"))||console.warn(e)},[e,t]),null},ZV=eR,eH=tR,tH=nR,nH=rR,rH=oR,oH=lR,iH=dR,aH=aR,sH=uR,_6=k.createContext(void 0);function fR(t){const e=k.useContext(_6);return t||e||"ltr"}var jp="rovingFocusGroup.onEntryFocus",E6={bubbles:!1,cancelable:!0},ac="RovingFocusGroup",[jm,hR,C6]=f_(ac),[S6,pR]=Oi(ac,[C6]),[k6,R6]=S6(ac),vR=k.forwardRef((t,e)=>G.jsx(jm.Provider,{scope:t.__scopeRovingFocusGroup,children:G.jsx(jm.Slot,{scope:t.__scopeRovingFocusGroup,children:G.jsx(T6,{...t,ref:e})})}));vR.displayName=ac;var T6=k.forwardRef((t,e)=>{const{__scopeRovingFocusGroup:n,orientation:r,loop:o=!1,dir:i,currentTabStopId:a,defaultCurrentTabStopId:s,onCurrentTabStopIdChange:u,onEntryFocus:l,preventScrollOnEntryFocus:c=!1,...d}=t,f=k.useRef(null),h=Pt(e,f),v=fR(i),[p,m]=Bf({prop:a,defaultProp:s??null,onChange:u,caller:ac}),[g,y]=k.useState(!1),w=xr(l),x=hR(n),b=k.useRef(!1),[_,E]=k.useState(0);return k.useEffect(()=>{const C=f.current;if(C)return C.addEventListener(jp,w),()=>C.removeEventListener(jp,w)},[w]),G.jsx(k6,{scope:n,orientation:r,dir:v,loop:o,currentTabStopId:p,onItemFocus:k.useCallback(C=>m(C),[m]),onItemShiftTab:k.useCallback(()=>y(!0),[]),onFocusableItemAdd:k.useCallback(()=>E(C=>C+1),[]),onFocusableItemRemove:k.useCallback(()=>E(C=>C-1),[]),children:G.jsx(Ve.div,{tabIndex:g||_===0?-1:0,"data-orientation":r,...d,ref:h,style:{outline:"none",...t.style},onMouseDown:De(t.onMouseDown,()=>{b.current=!0}),onFocus:De(t.onFocus,C=>{const R=!b.current;if(C.target===C.currentTarget&&R&&!g){const S=new CustomEvent(jp,E6);if(C.currentTarget.dispatchEvent(S),!S.defaultPrevented){const P=x().filter(W=>W.focusable),A=P.find(W=>W.active),B=P.find(W=>W.id===p),j=[A,B,...P].filter(Boolean).map(W=>W.ref.current);yR(j,c)}}b.current=!1}),onBlur:De(t.onBlur,()=>y(!1))})})}),mR="RovingFocusGroupItem",gR=k.forwardRef((t,e)=>{const{__scopeRovingFocusGroup:n,focusable:r=!0,active:o=!1,tabStopId:i,children:a,...s}=t,u=Xu(),l=i||u,c=R6(mR,n),d=c.currentTabStopId===l,f=hR(n),{onFocusableItemAdd:h,onFocusableItemRemove:v,currentTabStopId:p}=c;return k.useEffect(()=>{if(r)return h(),()=>v()},[r,h,v]),G.jsx(jm.ItemSlot,{scope:n,id:l,focusable:r,active:o,children:G.jsx(Ve.span,{tabIndex:d?0:-1,"data-orientation":c.orientation,...s,ref:e,onMouseDown:De(t.onMouseDown,m=>{r?c.onItemFocus(l):m.preventDefault()}),onFocus:De(t.onFocus,()=>c.onItemFocus(l)),onKeyDown:De(t.onKeyDown,m=>{if(m.key==="Tab"&&m.shiftKey){c.onItemShiftTab();return}if(m.target!==m.currentTarget)return;const g=P6(m,c.orientation,c.dir);if(g!==void 0){if(m.metaKey||m.ctrlKey||m.altKey||m.shiftKey)return;m.preventDefault();let w=f().filter(x=>x.focusable).map(x=>x.ref.current);if(g==="last")w.reverse();else if(g==="prev"||g==="next"){g==="prev"&&w.reverse();const x=w.indexOf(m.currentTarget);w=c.loop?D6(w,x+1):w.slice(x+1)}setTimeout(()=>yR(w))}}),children:typeof a=="function"?a({isCurrentTabStop:d,hasTabStop:p!=null}):a})})});gR.displayName=mR;var I6={ArrowLeft:"prev",ArrowUp:"prev",ArrowRight:"next",ArrowDown:"next",PageUp:"first",Home:"first",PageDown:"last",End:"last"};function A6(t,e){return e!=="rtl"?t:t==="ArrowLeft"?"ArrowRight":t==="ArrowRight"?"ArrowLeft":t}function P6(t,e,n){const r=A6(t.key,n);if(!(e==="vertical"&&["ArrowLeft","ArrowRight"].includes(r))&&!(e==="horizontal"&&["ArrowUp","ArrowDown"].includes(r)))return I6[r]}function yR(t,e=!1){const n=document.activeElement;for(const r of t)if(r===n||(r.focus({preventScroll:e}),document.activeElement!==n))return}function D6(t,e){return t.map((n,r)=>t[(e+r)%t.length])}var N6=vR,O6=gR,mh="Tabs",[F6,uH]=Oi(mh,[pR]),wR=pR(),[M6,h0]=F6(mh),xR=k.forwardRef((t,e)=>{const{__scopeTabs:n,value:r,onValueChange:o,defaultValue:i,orientation:a="horizontal",dir:s,activationMode:u="automatic",...l}=t,c=fR(s),[d,f]=Bf({prop:r,onChange:o,defaultProp:i??"",caller:mh});return G.jsx(M6,{scope:n,baseId:Xu(),value:d,onValueChange:f,orientation:a,dir:c,activationMode:u,children:G.jsx(Ve.div,{dir:c,"data-orientation":a,...l,ref:e})})});xR.displayName=mh;var bR="TabsList",_R=k.forwardRef((t,e)=>{const{__scopeTabs:n,loop:r=!0,...o}=t,i=h0(bR,n),a=wR(n);return G.jsx(N6,{asChild:!0,...a,orientation:i.orientation,dir:i.dir,loop:r,children:G.jsx(Ve.div,{role:"tablist","aria-orientation":i.orientation,...o,ref:e})})});_R.displayName=bR;var ER="TabsTrigger",CR=k.forwardRef((t,e)=>{const{__scopeTabs:n,value:r,disabled:o=!1,...i}=t,a=h0(ER,n),s=wR(n),u=RR(a.baseId,r),l=TR(a.baseId,r),c=r===a.value;return G.jsx(O6,{asChild:!0,...s,focusable:!o,active:c,children:G.jsx(Ve.button,{type:"button",role:"tab","aria-selected":c,"aria-controls":l,"data-state":c?"active":"inactive","data-disabled":o?"":void 0,disabled:o,id:u,...i,ref:e,onMouseDown:De(t.onMouseDown,d=>{!o&&d.button===0&&d.ctrlKey===!1?a.onValueChange(r):d.preventDefault()}),onKeyDown:De(t.onKeyDown,d=>{[" ","Enter"].includes(d.key)&&a.onValueChange(r)}),onFocus:De(t.onFocus,()=>{const d=a.activationMode!=="manual";!c&&!o&&d&&a.onValueChange(r)})})})});CR.displayName=ER;var SR="TabsContent",kR=k.forwardRef((t,e)=>{const{__scopeTabs:n,value:r,forceMount:o,children:i,...a}=t,s=h0(SR,n),u=RR(s.baseId,r),l=TR(s.baseId,r),c=r===s.value,d=k.useRef(c);return k.useEffect(()=>{const f=requestAnimationFrame(()=>d.current=!1);return()=>cancelAnimationFrame(f)},[]),G.jsx(Ta,{present:o||c,children:({present:f})=>G.jsx(Ve.div,{"data-state":c?"active":"inactive","data-orientation":s.orientation,role:"tabpanel","aria-labelledby":u,hidden:!f,id:l,tabIndex:0,...a,ref:e,style:{...t.style,animationDuration:d.current?"0s":void 0},children:f&&i})})});kR.displayName=SR;function RR(t,e){return`${t}-trigger-${e}`}function TR(t,e){return`${t}-content-${e}`}var lH=xR,cH=_R,dH=CR,fH=kR;export{_V as $,G6 as A,Y6 as B,q6 as C,H6 as D,lV as E,Kn as F,oV as G,QV as H,z5 as I,YV as J,OV as K,uV as L,LV as M,X6 as N,j4 as O,W6 as P,nV as Q,z6 as R,$6 as S,V6 as T,gV as U,U6 as V,rV as W,yV as X,aV as Y,J6 as Z,vV as _,K6 as a,pV as a0,Z6 as a1,nH as a2,rH as a3,aH as a4,sH as a5,oH as a6,iH as a7,tH as a8,ZV as a9,eH as aa,iV as ab,hV as ac,cV as ad,mV as ae,cH as af,dH as ag,fH as ah,lH as ai,sV as aj,qf as ak,IV as al,PV as am,MV as an,FV as ao,lF as ap,aA as aq,xV as b,YA as c,TV as d,RV as e,KV as f,fV as g,tV as h,CE as i,G as j,NV as k,W4 as l,OC as m,U4 as n,z4 as o,$4 as p,L4 as q,k as r,B4 as s,wV as t,DV as u,XV as v,KO as w,dV as x,Q6 as y,eV as z};
